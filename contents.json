{
 "0": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306           实验时间：2019.5.20  三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 SQL（Structured Query Language），结构化查询语言，它是一种对数据库进行 访问与操作的数据子语言。SQL可嵌入到编程语言(如JAVA、C#等)中执行或在DBS工具中执行。 SQL不仅仅是一个查询工具，还用于控制DBS提供给用户的所有功能。 在PostgreSQL服务器中，通过执行SQL语句对数据库进行各种操作。 五、实验内容 使用JetBrains DataGrip数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用JetBrains DataGrip数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： JetBrains DataGrip DBS系统： PostgreSQL 11 七、实验步骤 创建图书销售管理系统数据库BookSale 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计 编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证 八、实验数据及结果分析 创建图书销售管理系统数据库BookSale CREATE DATABASE BookSale  在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 CREATE TABLE publish( \tpublishNo CHAR(12) PRIMARY KEY, \tpublishName varchar(40), \tpublishPhone varchar(20), \tpublishAddress varchar(60) ); CREATE TABLE author( \tauthorNo char(12) PRIMARY KEY, \tauthorName char(6), \tauthorAddress varchar(80), \tauthorPhone char(11) ); CREATE TABLE book( \tbookISBN CHAR(22) PRIMARY KEY, \tpublishNo char(12), \tbookName varchar(80), \tauthorNo char(12), \tprice money, \tbookContent text, \tconstraint publishNo_FK foreign key(publishNo) \treferences publish(publishNo) \ton update cascade, \tconstraint authorNo_FK foreign key(authorNo) \treferences author(authorNo) \ton update cascade ); CREATE TABLE store( \tbookISBN char(22) PRIMARY KEY, \tstoreNum int2, \tconstraint bookISBN_FK foreign key(bookISBN) \treferences book(bookISBN) \ton update cascade ); CREATE TABLE sale( \tsaleNo serial PRIMARY KEY, \tbookISBN char(22), \tsaleDate date, \tsaleNum numeric, \tsaleSum money, \tconstraint bookISBN_FK foreign key(bookISBN) \treferences book(bookISBN) \ton update cascade )  CREATE INDEX ISBN ON book(bookISBN);    CREATE VIEW priceView AS  SELECT* FROM book WHERE price<'30'   对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 增： INSERT INTO author VALUES('001','鲁迅','绍兴','11111111111'); INSERT INTO author VALUES('002','周树人','浙江','22222222222'); INSERT INTO author VALUES('003','刘大','河北','33333333333'); INSERT INTO author VALUES('004','王二麻子','广东','44444444444'); \t  INSERT INTO publish VALUES('01','中国人民大学出版社','3367454','北京市'); INSERT INTO publish VALUES('02','机械工业出版社','884561','河北');  INSERT INTO book VALUES('1','01','神曲','003','23','第一章第二章第三章'); INSERT INTO book VALUES('2','02','哈姆雷特','004','46','第四章第二章第三章');  INSERT INTO sale VALUES('0001','1','2019-6-10','2','46'); INSERT INTO sale VALUES('0002','2','2019-6-9','1','46');  INSERT INTO store VALUES('1','35'); INSERT INTO store VALUES('2','85');  改： UPDATE author  SET authorName ='但丁' WHERE authorName ='刘大'   删： delete  from author where authorname='周树人'   查： select * from author join book on author.authorno=book.authorno where bookname='神曲'  编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 create or replace function Pro_CurrentSale(out numsum numeric,out moneysum money)  as $current$ declare \tnumsum numeric;moneysum money; begin \tselect sum(salenum) into $1 as salenum from sale \twhere saledate=current_date; \tselect sum(salesum) into $2 as salesum from sale \twhere saledate=current_date; end; $current$ language plpgsql;  编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 select Pro_CurrentSale()  编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 create or replace function change()        returns trigger as $change$        begin               raise notice '1';               if(TG_OP = 'INSERT') then                      raise notice '2';                      update store set storenum = storenum - new.salenum                      where bookisbn = new.bookisbn;                      raise notice '3';               end if;        return null;        end;        $change$ language plpgsql;  create trigger Tri_InsertSale after insert on sale for each row execute procedure change();   对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 使用Insert操作之前：  对sale表进行Insert操作：  触发器出发之后：  九、总结及心得体会 通过此次实验熟悉了数据库各种基本SQL语句的使用，熟悉了对数据库管理工具Jetbrains DataGrip的使用，理解了数据库中各种类型数据的存储方法和数据之间的约束关系。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306           实验时间：2019.5.27 三、实验目的 了解该DBS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 在SQL语言中，数据控制SQL语句是一种可对用户数据访问权进行控制 的操作语句，它可以控制特定用户或角色对数据表、视图、存储过程、 触发器等数据库对象的访问权限 \t用户要访问数据库，必须先在DBS中创建其账号，并成为 数据库的用户。此后，用户每次访问数据库，都需要在 DBS进行身份验证，只有合法用户才能进入系统，访问操 作数据库对象。在DBS中，为了方便对众多用户及其权限进行管理，通常 将一组具有相同权限的用户定义为角色(Role)。 五、实验内容 使用JetBrains DataGrip数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用JetBrains DataGrip数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： JetBrains DataGrip DBS系统： PostgreSQL 11 七、实验步骤 针对图书销售管理系统数据库，设计数据存取权限控制模型。在数据库中，创建客户（R_Customer）、商家（R_Seller）角色，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller并为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 针对图书销售管理系统数据库，设计数据存取权限控制模型。在数据库中，创建客户（R_Customer）、商家（R_Seller）角色，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 CREATE ROLE \"R_Customer\" WITH  \tLOGIN  \tNOSUPERUSER  \tNOCREATEDB  \tNOCREATEROLE  \tINHERIT  \tNOREPLICATION  \tNOBYPASSRLS \tCONNECTION LIMIT -1; CREATE ROLE \"R_Seller\" WITH  \tLOGIN  \tNOSUPERUSER  \tNOCREATEDB  \tNOCREATEROLE  \tINHERIT  \tNOREPLICATION  \tNOBYPASSRLS \tCONNECTION LIMIT -1;  GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON store TO \"R_Seller\";  GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON sale TO \"R_Customer\"; GRANT SELECT ON store TO \"R_Customer\";  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller并为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 create user \"U_Customer\" with \tin role \"R_Customer\"; create user \"U_Seller\" with \tin role \"R_Seller\";  分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 （1） 以U_Customer登录：  对表sale执行uodate 操作失败： （2） \t\t以U_Seller登录： \t\t \t\t对表sale执行插入操作： \t 九、总结及心得体会 \t通过此次实验理解了数据库中用户与角色的关系以及它们的意义，自己动手熟悉了数据库中角色和用户的相关操作",
  "studentID": "2017221101019"
 },
 "1": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t           实验时间：2019/05/21      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 存储过程 PostgreSQL对存储过程的描述是：存储过程和用户自定义函数（UDF）是SQL和过程语句的集合，它存储于数据库服务器并能被SQL接口调用。 总结下来存储过程有如下特性： 存储于数据库服务器 一次编译后可多次调用 设计良好的数据库应用程序很可能会用到它 由SQL和过程语句来定义 应用程序通过SQL接口来调用 触发器 触发器是一种由事件自动触发执行的特殊存储过程，这些事件可以是对一个表进行 INSERT、UPDATE、DELETE 等操作。 触发器经常用于加强数据的完整性约束和业务规则上的约束等。 创建触发器的步骤： 先为触发器建一个执行函数，此函数的返回类型为触发器类型 trigger；然后即可创建相应的触发器。例如当删除学生表(student)中的一条记录时，把这个学生在成绩表 (score) 中的成绩记录也删除掉，这时就可以使用触发器。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）创建数据库BookSale   （2）创建数据库表、视图、索引等对象  （3）进行数据增删查改SQL操作 ① 增  ② 删  ③ 查  ④ 改  （4）编写函数Pro CurrentSale 实现当日图书销售量及销售金额汇总统计  （5）编写过程语句块，实现对函数Pro CurrentSale的调用，并输出统计结果  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理 ① 创建存储过程Tri_InsertSale  ② 创建触发器  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证 ① 首先查询sale表和stock表在insert之前的数据  ② 插入sale记录后再查询stock  八、实验数据及结果分析 （1）数据库创建结果   （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 运行结果   对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 ① 插入，以author表为例查看插入的数据  \n\t② 删除，可见作者译文的信息被删除了  ③ 查找  ④ 修改，可见作者可心的地区被修改了  （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 可见存储过程创建成功  （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果  可见在2019-06-05这一天的销售总额为40元，销售总量为1本。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 存储过程创建成功，返回类型为trigger  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证 ① 查询sale表  ② 查询stock表  ③ 插入sale记录后再次查询stock表发现库存书籍0000000001的数量由1000变成了996，时间从2019-06-05变成了2019-06-09   九、总结及心得体会 通过本次实验，我了解到触发器是一种由事件自动触发执行的特殊存储过程，这些事件可以是对一个表进行 INSERT、UPDATE、DELETE 等操作。触发器经常用于加强数据的完整性约束和业务规则上的约束等。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306\t\t          实验时间：2019/05/22      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 PostgreSQL权限分为两部分，一部分是“系统权限”或者数据库用户的属性，可以授予role或user（两者区别在于login权限）；一部分为数据库对象上的操作权限。对超级用户不做权限检查，其它走acl。对于数据库对象，开始只有所有者和超级用户可以做任何操作，其它走acl。在pg里，对acl模型做了简化，组和角色都是role，用户和角色的区别是角色没有login权限。 可以用下面的命令创建和删除角色， CREATE ROLE name; DROP ROLE name; 为了方便，也可以在 shell 命令上直接调用程序 createuser 和 dropuser，这些工具对相应命令提供了封装: createuser name dropuser name 数据库对象上的权限有：SELECT，INSERT， UPDATE，DELETE，RULE， REFERENCES，TRIGGER，CREATE， TEMPORARY，EXECUTE，和 USAGE等。 视图pg_roles提供访问数据库角色有关信息的接口。 它只是一个表的公开可读部分的视图，把口令字段用空白填充了。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 说明：本节需学生编写内容。学生应针对本实验，给出具体实验步骤内容。 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 （1）设计并创建数据库角色R_Customer和R_Seller  （2）根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限  （3）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller并分别分派客户（R_Client）、商家（R_Seller）角色  （4）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性 ① 断开连接服务器后修改PostgreSQL 11属性中的用户名  ② 使用U_Customer登录进行SELECT语句查询表Sale的结果如下：  ③ 断开连接服务器后修改PostgreSQL 11属性中的用户名  ④ 使用U_Seller登录进行SELECT语句查询表Sale的结果如下：  九、总结及心得体会 我学会了如何给数据库的不同用户设置权限。这样可以保障数据库的安全性，避免误操作、人为破坏、数据泄露等。同时还能起到数据隔离的作用，即不同的权限能看到及操作不同的数据。此外，设置权限还可以明确职责，不同职位、不同身份的人能看到的东西是不一样的。",
  "studentID": "2017221101026"
 },
 "2": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：\t信软楼306\t\t\t\t      实验时间：2019.5.20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1、首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系、通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2、基于数据库设计方案，通过SQL编程执行来完成对数据库的实现操作。在本实验中，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写SQL语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 实验步骤 创建数据库BookSale  创建数据库表、视图、索引等对象  进行数据增删查改SQL操作 （1）、在表中插入适当数据方便之后操作 （2）、增加一条数据到publisher表 （3）、删除一条publisher表数据 、修改一条publisher表数据 、创建视图 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 创建触发器函数 创建触发器  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  八、实验数据及结果分析 1、图书销售管理系统数据库BookSale创建操作  2、在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象  3、对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （1）、以author表为例查看插入的数据  （2）、查看增加后的结果  、查看删除后的结果  、查询修改后的结果  查询创建好的视图  存储过程创建成功  查看统计结果发现查询成功。   创建成功界面  对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 stock表本来没有数据  在sale插入数据之后，将库存数据进行记录  触发器执行之后的book表数据被更改   九、总结及心得体会     通过这次实验，我锻炼了自己在创建数据库时的许多技巧与能力。同时在创建过程中，也真正理解了一些SQL语句的原理。在实验指导书中，也有一些语法错误，在执行错误的时候，更能激发自己的求知欲，去主动探寻出错的地方，这样使得对一些知识点的记忆更加深刻。\n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称： 信软楼306 \t\t\t\t\t 实验时间：2019.05.22        三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库  数据的安全性。  2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。  3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作  的时候就会受到不同程度的制约。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。  2. 在 pgAdmin4 中 的 BookSale 数据库中，使用SQL语句创建客户（R_Customer）角色、商家（R_Seller）角色。  3.在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对客户  （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。  4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。  5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理  数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两  用户不同的角色权限。  实验数据及结果分析 1、数据存取权限控制模型如下：  客户角色安全模型  商家角色安全模型  2、设计并创建数据库角色R_Customer和R_Seller  3.在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对客（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。    4、在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。    5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理  数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两  用户不同的角色权限。  首先用U_Customer身份登入数据库。  测试一：查询 book 表 客户用户可查看 book 表，权限正确。  测试二：删除 book 表中的数据  删除失败，客户用户不具有删除 book 表中数据的权限，权限正确。   以U_Seller身份登入数据库  测试一：查看 customer  商家用户具有查看客户表的权限，权限正确。  测试二：从 stock 表中删除一条数据 商家用户不具有删除 stock 表数据的权限，权限正确。  九、总结及心得体会 通过这次实验，我了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。这次实验对我今后数据库的学习打下了坚实的基础。 ",
  "studentID": "2017221101027"
 },
 "3": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t\t\t  实验时间：2019.5.20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 创建数据库与创建表： 在数据库系统中，最大的对象就是数据库本身，SQL为我们提供了数据库对象的创建和维护语句。创建数据库语句为: CREATE DATABASE <数据库名称> 在创建完数据库后，我们就需要创建数据库中的关系表。因为在关系数据库中，数据是以数据库表的形式组织存在的。在创建数据库表的同时，我们也需要指定表中的列具有的属性，包括列名、数据类型、完整性约束等。这些属性决定了一个列是否为主键、是否为外键、是否非空、数据类型，默认值、取值范围等。其一般格式为： CREATE TABLE <数据库表名> (<列名1>  <数据类型>  <列完整性约束>, <列名2>  <数据类型>  <列完整性约束>, <列名3>  <数据类型>  <列完整性约束>, ……             );  数据操作SQL语句 数据操作语言是一类以表中数据为操作对象的语句集，主要包括了INSERT、UPDATE、DELETE三大类语句。INSERT用于数据插入，UPDATE用于数据更新，DELETE用于数据删除，其格式依次为： INSERT INTO  <基本表> [<列名表>]  VALUES(列值表);  UPDATE <基本表> SET <列名1>=<表达式1> [<列名2>=<表达式2>……] [WHERE <条件表达式>];  DELETE FROM <表名> [WHERE  <条件表达式>];  数据查询SQL语句 在SQL中，实现对数据库表进行数据查询处理的语句只有SELECT语句一种，其功能丰富，组合条件使用灵活，其基本语句格式为： SELECT  [ALL|DISTINCT]  <目标列>[,<目标列>…] [  INTO <新表>] FROM  <表名>[,<表名>…] [WHERE  <条件表达式>] [GROUP BY <列名> [HAVING<条件表达式>] [ORDER BY <列名> [ASC | DESC]]; 我们可以通过WHERE语句的嵌套或JOIN…ON…语句的连接来查询多表。  索引与视图 在数据库中，通常一些表包含大量的数据，此时如果我们采用逐个搜索的方式去查询，效率就会很低。这时，我们可以在数据库中创建一个索引来帮助我们查询，加快查询的速度。索引具有类似图书目录的索引结构，并将索引列的值以及索引指针数据保存在索引结构中。当然，索引本身也会给数据库系统带来开销，包括创建和维护索引的开销、索引本身需要占用的物理空间等，因此我们一般只在需要快速查询或数据量较大的表中建立索引，其他表中则没有这个必要。创建索引的SQL语句格式为：     CREATE INDEX <表名> ON < (<列名>[,….])>; 视图是由一个或几个基础表或其他视图的SELECT查询结果创建生成，它的所有数据来源于基表或其他视图。使用视图我们可以简化SELECT查询操作，提高数据访问安全性，提供一定程度的数据逻辑独立性以及集中展示用户所感兴趣的数据集。创建视图的SQL语句格式为： CREATE  VIEW  <视图名> [(列名1),(列名2),…] AS <SELECT查询>;  函数 在SQL中，我们可以用函数对SELECT查询的结果集进行处理，这些函数可以是DBMS内置的函数，也可以是用户自己编写的函数。内置函数大概分为聚合函数、算术函数、字符串函数、日期时间函数、数据类型转换函数等五大类。 sql函数的优点有： 允许标准组件式编程，提高了SQL语句的重用性、共享性和可移植性。 可以减少重复编写程序段的工作量，提高程序可读性。 提高程序编译和运行效率，产生质量较高的目标代码，满足算法设计的“正确性、可读性、健壮性、效率与低存储量需求”的基本要求。 能够实现较快的执行速度，能够减少网络流量 sql函数的缺点有： sql本身是一种结构化查询语言，而存储过程则是过程性的，其业务处理过程较为复杂，特别是在大型系统中效率较低。 如果存储过程的参数或返回数据发生变化，一般需要修改存储过程的代码，较为麻烦。 开发调试较为复杂 可移植性差。由于不同sql数据库的操作语句存在差异，一般存储过程是无法在不同的sql系统中通用的。  触发器 触发器（trigger）是SQL server 提供给程序员和数据分析员来保证数据完整性的一种方法，它是与表事件相关的特殊的存储过程，它的执行不是由程序调用，也不是手工启动，而是由事件来触发，当对一个表进行操作（ insert，delete， update）时就会激活它执行。触发器经常用于加强数据的完整性约束和业务规则等。 触发器可以从 DBA_TRIGGERS ，USER_TRIGGERS 数据字典中查到。 触发器与存储过程最大的区别是运行方式的不同，触发器不能执行EXECUTE语句调用，而是在用户执行Transact-SQL语句时自动触发执行而存储过程需要用户，应用程序或者触发器来显示地调用并执行。因此，触发器可以实现某些更为复杂的约束。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1、创建图书销售管理系统数据库BookSale。 CREATE DATABASE BookSale;   创建数据库表。 CREATE TABLE Writer( \tWriterID\t\tchar(12)\t\tNOT NULL, \tWriterName\t\tvarchar(40)\t\tNULL, \tWriterAddress\tvarchar(80)\t\tNULL, \tWriterPhone\t\tchar(11)\t\tNULL, \tCONSTRAINT\tWriter_PK\tPRIMARY KEY(WriterID) );  CREATE TABLE Publisher(\t \tPublisherID\t\tchar(12)\tNOT NULL, \tPublisherName\t\tvarchar(40)\tNULL, \tPublisherPhone\tvarchar(11)\tNULL, \tPublisherAddress\tvarchar(80)\tNULL, \tCONSTRAINT\tPublisher_PK\tPRIMARY KEY(PublisherID) );  CREATE TABLE Book( \tISBN\t\t\tchar(22)\tNOT NULL, \tWriterID\t\tchar(12)\tNOT NULL, \tPublisherID\tchar(12)\tNOT NULL, \tBookName\t\tvarchar(80)\tNULL, \tPublishDate\tdate\t\tNULL, \tPrice\t\t\tmoney\t\tNULL, \tCONSTRAINT\tBook_PK\t\tPRIMARY KEY(ISBN), \tCONSTRAINT\tBook_Writer_FK\tFOREIGN KEY(WriterID) \t\t\t\t\t\tREFERENCES Writer(WriterID) \t\t\t\t\t\tON UPDATE CASCADE, \tCONSTRAINT\tBook_Publisher_FK\tFOREIGN KEY(PublisherID) \t\t\t\t\t\tREFERENCES Publisher(PublisherID) \t\t\t\t\t\tON UPDATE CASCADE );  CREATE TABLE Store( \tStoreNumber\tchar(12)\tNOT NULL, \tStoreName\t\tvarchar(40)\tNULL, \tPostcode\t\tchar(6)\t\tNULL, \tStoreAddress\tvarchar(80)\tNULL, \tCONSTRAINT\tStore_PK\tPRIMARY KEY(StoreNumber) );  CREATE TABLE Sale( \tSaleSerial\t\tserial\t\tNOT NULL, \tISBN\t\t\tchar(22)\tNOT NULL, \tStoreNumber\tchar(12)\tNOT NULL, \tSaleDate\t\tdate\t\tNULL, \tSaleSum\t\tnumeric\t\tNULL, \tSalePrice\t\tmoney\t\tNULL, \tCONSTRAINT\tSale_PK\t\tPRIMARY KEY(SaleSerial), \tCONSTRAINT\tSale_Book_FK\tFOREIGN KEY(ISBN) \t\t\t\t\tREFERENCES\tBook(ISBN) \t\t\t\t\tON UPDATE CASCADE, \tCONSTRAINT\tSale_Store_FK\tFOREIGN KEY(StoreNumber) \t\t\t\t\tREFERENCES\tStore(StoreNumber) \t\t\t\t\tON UPDATE CASCADE );  CREATE TABLE Stock(     StoreNumber        char(12)         NOT NULL,     ISBN            \tchar(22)         NOT NULL,     StockSum            int2                NOT NULL,     CONSTRAINT STOCK_PK PRIMARY KEY (ISBN, StoreNumber),     CONSTRAINT  STOCK_BOOK_FK FOREIGN KEY(ISBN)         REFERENCES  BOOK (ISBN)         ON UPDATE CASCADE         ON DELETE CASCADE,     CONSTRAINT  STOCK_STORE_FK FOREIGN KEY(StoreNumber)         REFERENCES  STORE (StoreNumber)         ON UPDATE CASCADE         ON DELETE CASCADE );  插入数据。 INSERT INTO Writer VALUES('000000000001','陈鸣','四川省成都市成华区一环路北一段','13200000001'); INSERT INTO Writer VALUES('000000000002','肖刚','四川省成都市成华区猛追湾街道','13200000002');  INSERT INTO Publisher VALUES('CBS000000001','机械工业出版社','12211110001','北京市西城区百万庄大街22号');  INSERT INTO Book VALUES('9787111599715','000000000001','CBS000000001','计算机网络','2019-01-01',89.0); INSERT INTO Book VALUES('9787111205517','000000000002','CBS000000001','系统分析与设计方法','2007-08-01',45.4);  INSERT INTO Store VALUES('STORE0000001','电子科大书店','610054','成都市建设北路二段4号');  INSERT INTO Sale VALUES('1','9787111599715','STORE0000001','2019-04-14','4',356.0); INSERT INTO Sale VALUES('2','9787111599715','STORE0000001','2019-05-20','2',178.0); INSERT INTO Sale VALUES('3','9787111205517','STORE0000001','2019-06-01','9',408.6);  INSERT INTO STOCK VALUES('STORE0000001','9787111599715','50'); INSERT INTO STOCK VALUES('STORE0000001','9787111205517','40');  4、创建索引。 CREATE INDEX Book_Index ON Book(ISBN); CREATE INDEX Writer_Index ON Writer(WriterID); CREATE INDEX Publisher_Index ON Publisher(PublisherID);     5、创建视图。 CREATE VIEW BookSaleMoney AS SELECT B.BookName AS 书籍名称, sum(S.SalePrice) as 销售额 FROM Book AS B JOIN Sale AS S ON B.ISBN=S.ISBN GROUP BY B.ISBN    进行数据增、删、改SQL操作。 增。 INSERT INTO Writer VALUES('000000000003','汤小丹','四川省成都市建设北路二段1号','13200000003');  SELECT * FROM Writer WHERE WriterName='汤小丹'  删。 DELETE FROM Writer WHERE WriterName='汤小丹'   改。 UPDATE Book SET Price = '69.0' WHERE BookName='计算机网络'    编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 CREATE FUNCTION Pro_CurrentSale(IN SaleDate date, OUT SaleSum integer, OUT SaleMoney money) RETURNS RECORD AS $$ DECLARE BEGIN SELECT SUM(Sale.SaleSum) INTO SaleSum FROM Sale WHERE Sale.SaleDate=SaleDate; SELECT SUM(Sale.SalePrice) INTO SaleMoney FROM Sale WHERE Sale.SaleDate=SaleDate; END; $$ LANGUAGE plpgsql;  编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 CREATE OR REPLACE FUNCTION Tri_InsertSale()     RETURNS TRIGGER AS $Tri_InsertSale$     BEGIN         IF(TG_OP='INSERT') THEN             UPDATE STOCK             SET Stocksum=Stocksum-NEW.Salesum              WHERE NEW.StoreNumber=Stock.StoreNumber AND NEW.ISBN=Stock.ISBN;          END IF;       RETURN NULL;     END;     $Tri_InsertSale$     LANGUAGE plpgsql;      CREATE TRIGGER Tri_InsertSale AFTER INSERT ON Sale FOR EACH ROW EXECUTE PROCEDURE Tri_InsertSale()    插入数据前  插入Sale表的数据   实验结果，符合预期  八、总结及心得体会 在本次实验中，我们主要实现了一个图书销售管理系统的设计、编写库表、性能优化以及编写函数、触发器等。通过本次实验，加深了我对SQL数据库编程的理解和认识，更让我认识到知识的掌握，仅靠学习理论知识是远远不够的，要与实际动手操作相结合才能更好地理解和分析问题。我日后会不断加深各方面知识的学习，弥补自己的不足。实验给了我们实践的机会，给了我们理论结合实际的机会，从实验中可以学到很多东西，更培养了我们的动手能力和自学能力，还有更重要的是对待事情严谨的态度，我定会以更加严谨认真的态度对待每次实验。  \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：杨蕊绮  \t\t\t\t\t          实验时间：2019.5.27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 数据库安全管理 SQL Server的安全模型分为三层结构，分别为服务器安全管理、数据库安全管理和数据库对象的访问权限管理。用户访问数据库时需要经历的三个阶段及相应的安全认证过程： 第一阶段：用户首先登陆到SQL Server实例。在登陆时，系统要对其进行身份验证，被认为是合法时才能登录到SQL Server实例。 第二阶段：用户在每个要访问的数据库里必须获得一个用户账号。SQL Server实例将SQL Server登陆映射到数据库用户账号上，在这个数据库的用户账号上定义数据库的管理和数据对象的访问安全策略。 第三个阶段：用户访问数据库。用户访问数据对象时，系统要检查用户是否具有访问数据库对象、执行动作的权限，经过语句许可权限的验证，才能实现对数据的操作。  角色与用户 用户是数据库的使用者和管理者，数据库通过设置用户及安全属性来控制用户对数据库的访问。数据库的用户分两类，一类是创建数据库时系统预定义的用户，一类是根据应用由DBA创建的用户。 假如我们直接给每一个用户赋予权限，这将是一个巨大又麻烦的工作，同时也不方便DBA进行管理。通过采用角色，使得： 权限管理更方便。将角色赋予多个用户，实现不同用户相同的授权。如果要修改这些用户的权限，只需修改角色即可。 角色的权限可以激活和关闭。使得DBA可以方便的选择是否赋予用户某个角色。 提高性能，使用角色减少了数据字典中授权记录的数量，通过关闭角色使得在语句执行过程中减少了权限的确认。 在postgreSQL中，数据库角色和用户的区别在于是否能够登陆数据库。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1、创建客户（R_Customer）、商家（R_Seller）角色。 2、为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 3、创建客户用户U_Customer、商家用户U_Seller。 4、以用户U_Customer身份访问图书销售管理数据库，进行数据存储验证权限。 5、以用户U_Seller身份访问图书销售管理数据库，进行数据存储验证权限。 八、实验数据及结果分析 1、创建客户（R_Customer）、商家（R_Seller）角色。       为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  GRANT SELECT ON Writer TO \"R_Customer\"; GRANT SELECT ON Book TO \"R_Customer\"; GRANT SELECT ON Publisher TO \"R_Customer\"; GRANT SELECT ON Store TO \"R_Customer\";  GRANT SELECT,INSERT,UPDATE,DELETE ON Stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON Sale TO \"R_Seller\";   创建客户用户U_Customer、商家用户U_Seller。     以用户U_Customer身份访问图书销售管理数据库，进行数据存储验证权限。   以用户U_Seller身份访问图书销售管理数据库，进行数据存储验证权限。   九、总结及心得体会 在本次实验中，我们主要进行了创建数据库角色和用户并登陆验证其数据存储权限的工作。通过本次实验，加深了我对数据库安全管理有了更为深刻的理解，并使得我们能够在日常工作中轻松地设计出一个可以应用的SQL数据库以及数据库中角色、用户等各数据库项安全管理的相关实体。更让我认识到知识的掌握，仅靠学习理论知识是远远不够的，要与实际动手操作相结合才能更好地理解和分析问题。我日后会不断加深各方面知识的学习，弥补自己的不足。实验给了我们实践的机会，给了我们理论结合实际的机会，从实验中可以学到很多东西，更培养了我们的动手能力和自学能力，还有更重要的是对待事情严谨的态度，我定会以更加严谨认真的态度对待每次实验。 ",
  "studentID": "2017221102029"
 },
 "4": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t           实验时间： 20190520 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过SQL 编程执行来完成对数据库的实现操作。在本实验中，使用SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1. 在数据库服务器中，采用SQL 语句执行方式，创建图书销售管理系统数据库BookSale。 2.在BookSale 数据库中，采用SQL 语句执行方式，创建book（图书表）、auther（作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为book、auther、publisher、customer 表准备样本数据，采用SQL 语句执行方式，将样本数据插入到表中。采用SQL 语句对book、auther、publisher、customer 表进行数据修改、删除、查询、统计等访问操作。 4.创建视图BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图Book_View 进行数据查询访问操作。 5.编写触发器函数，实现在sale 表数据插入时，级联操作stock 表，将图书的库存流水进行记录，同时级联更新book 表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备sale 表的样本数据，并将其插入sale 表，插入之后查看stock 表是否有对应的更新，并对比插入sale 数据前后book 中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 八、实验数据及结果分析 1.创建数据库 SQL语句进行数据库创建。 界面如图1-1所示； 图 1-1 数据库创建及结果 成功创建数据库。 2.创建数据库表及主外键和索引 明确图书销售系统实体及实体属性和联系再通过SQL语句创建表，表对应实体，实体属性对应列，主外键将表联系起来。 createtableAuther( AU_IDCHAR(18)notnull, AU_NameVARCHAR(20)notnull, AU_GenderCHAR(2)notnull, AU_PhoneVARCHAR(11)notnull, AU_AddressVARCHAR(50)notnull, constraintPK_AUTHERprimarykey(AU_ID) ); createtableBook( Book_ISBNCHAR(13)notnull, AU_IDCHAR(18)null, PUB_IDCHAR(11)null, Book_NameVARCHAR(50)notnull, Book_PubdateDATEnotnull, Book_PriceMONEYnotnull, Book_CategoryVARCHAR(20)notnull, Book_StockINT4notnull, Book_NotesVARCHAR(100)null, Book_ListVARCHAR(100)null, constraintPK_BOOKprimarykey(Book_ISBN) ); createtableCUSTOMER( CUST_IDCHAR(18)notnull, CUST_NameVARCHAR(20)notnull, CUST_PhoneVARCHAR(15)notnull, CUST_AddressVARCHAR(50)notnull, CUST_EmailVARCHAR(50)notnull, constraintPK_CUSTOMERprimarykey(CUST_ID) ); createtablePublisher( PUB_IDCHAR(11)notnull, PUB_NameVARCHAR(20)notnull, PUB_PhoneVARCHAR(15)notnull, PUB_AddressVARCHAR(50)notnull, constraintPK_PUBLISHERprimarykey(PUB_ID) ); createtableSale( SALE_IDVARCHAR(11)notnull, Book_ISBNCHAR(13)null, CUST_IDCHAR(18)null, SALE_DateDATEnotnull, SALE_QTYINT4notnull, SALE_AmountMONEYnotnull, constraintPK_SALEprimarykey(SALE_ID) ); createtableStock( Stock_IDVARCHAR(10)notnull, Book_ISBNCHAR(13)null, Stock_ChangeINT4notnull, Stock_OperationCHAR(4)notnull, Stock_DatetimeDATEnotnull, constraintPK_STOCKprimarykey(Stock_ID) ); altertableBook addconstraintFK_BOOK_BOOK_AUTH_AUTHERforeignkey(AU_ID) referencesAuther(AU_ID) ondeleterestrictonupdaterestrict; altertableBook addconstraintFK_BOOK_BOOK_PUBL_PUBLISHEforeignkey(PUB_ID) referencesPublisher(PUB_ID) ondeleterestrictonupdaterestrict; altertableSale addconstraintFK_SALE_BOOK_SALE_BOOKforeignkey(Book_ISBN) referencesBook(Book_ISBN) ondeleterestrictonupdaterestrict; altertableSale addconstraintFK_SALE_CUSTOMER__CUSTOMERforeignkey(CUST_ID) referencesCUSTOMER(CUST_ID) ondeleterestrictonupdaterestrict; altertableStock addconstraintFK_STOCK_BOOK_STOC_BOOKforeignkey(Book_ISBN) referencesBook(Book_ISBN) ondeleterestrictonupdaterestrict; 将SQL程序提交到服务器执行有图1-2所示。 图 1-2 创建数据库表 可见到新添加的数据库表对象。 成功创建数据库表。 3.插入数据样本并增删改查 先准备样本数据，尽可能使数据能满足后续数据处理操作要求。 1）插入数据 SQL程序如下： InsertintoAuthervalues('123456789123450001','王天','男','13554874593','四川省成都市成华区建设北路二段十号'); InsertintoAuthervalues('123456789123450002','叶无双','男','15812387538','浙江省杭州市天路区梅田路二十八号'); InsertintoAuthervalues('123456789123450003','李婷','女','18575615472','北京市朝阳区梅山路二巷八号'); InsertintoPUBLISHERvalues('PUB00000001','高等教育出版社','010-65321854','北京'); InsertintoPUBLISHERvalues('PUB00000002','电子工业出版社','010-65329857','北京'); InsertintoPUBLISHERvalues('PUB00000003','人民邮电出版社','010-65325987','北京'); InsertintoBOOKvalues('9787115502742','123456789123450001','PUB00000001','Web前端开发最佳实践','2016-01-01','59','IT技术','100'); InsertintoBOOKvalues('9875325415577','123456789123450002','PUB00000002','JavaEEWeb编程','2008-01-01','52','IT技术','200'); InsertintoBOOKvalues('9865365975234','123456789123450003','PUB00000003','数据库实验指导','2013-08-1','29','IT技术','150'); Insertintocustomervalues('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insertintocustomervalues('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十九号','657873215@qq.com'); Insertintocustomervalues('542244197812121687','鲁丽','13615869875','北京市朝阳区梅山路二巷十六号','647864378@qq.com'); 送入服务器处理有图1-3所示。 图 1-3 插入数据SQL语句执行情况 以publiser表为例展示增删改查情况。 查看publiser表有SQL语句：select * from publisher; 结果如图1-4所示。  图 1-4 查询publisher表数据 插入数据成功。 2）增加数据到publisher表并查询表数据 SQL语句： InsertintoPUBLISHERvalues('PUB00000004','清华大学出版社','010-65323169','北京'); select*frompublisher; 运行结果如图1-5所示。  图 1-5 插入新数据到publisher表并查询 插入表数据成功。 3）删除表数据并查询 SQL语句： deletefrompublisherwherepub_id='PUB00000004'; select*frompublisher; 执行结果如图1-6所示。 图 1-6 删除表数据并查询 正确删除相应表数据，删除操作成功。 4）修改一条表数据并查询 SQL语句如下： updatepublishersetpub_address='南京'wherepub_id='PUB00000003'; select*frompublisher; 语句运行结果如图1-7所示。  图 1-7 更新publisher表的数据及查询结果 可见对应的数据确实被修改，更新操作成功。       4.创建视图 创建视图实现查询图书信息。 有SQL语句： createviewview_BOOK_AUTHER_PUBLISHERas selectB.book_nameas\"图书\",AU.au_nameas\"作者\",PU.pub_nameas\"出版社\",B.book_priceas\"图书价格\" frombookasBjoinautherasAUonB.au_id=AU.au_idjoinpublisherasPUonB.pub_id=PU.pub_id; select*fromview_BOOK_AUTHER_PUBLISHER; 创建视图情况以及查询视图结果如图1-8所示。   图 1-8 创建视图及查询视图结果 成功建立视图并且数据对应正确。 5.建立触发器函数 触发器函数，创建一个函数实现在有销售数据插入sale表时，同在库存表stock中插入图书的库存表花记录，并修改对应图书表book的库存数。 触发器函数SQL语句： CREATEORREPLACEFUNCTIONInsertSale()RETURNSTRIGGERAS$$ BEGIN IF(TG_OP='INSERT')THEN INSERTINTOstockvalues(new.sale_id,new.book_isbn,new.sale_qty,'出库',new.sale_date); updatebookset book_stock=book.book_stock-new.sale_qtywherebook.book_isbn=new.book_isbn; RETURNNEW; ENDIF; RETURNNULL; END; $$LANGUAGEplpgsql; 操作运行界面如图1-9所示。  图 1-9 创建触发器函数 6.创建触发器 执行上步编写的触发器函数。 创建触发器SQL语句： CREATETRIGGERTri_InsertSale AFTERINSERTONSALE FOREACHROWEXECUTEPROCEDUREInsertSale(); 操作界面如图1-10所示。 图 1-10 创建触发器 7.测试触发器 在销售表中插入几个样本数据后查看库存表和图书表数据。 SQL语句： Insertintosalevalues('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885'); Insertintosalevalues('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040'); Insertintosalevalues('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450');           结果如图1-11和图1-12所示。 图 1-11 测试触发器插入数据后stock表数据 图 1-12 测试触发器插入数据后book表数据 Stock 表本来没有数据，在sale 插入数据之后，将库存数据进行记录，记录数据 正确，同时更新了book 表中各对应图书的库存量，更新数据正确，触发器功能实现正确。 8.创建存储过程 SQL语句如下： CREATEORREPLACEFUNCTIONcountsale(OUTamountint,OUTallmoneymoney)as$count$ BEGIN selectsum(sale_qty)intoamountFROMsaleWHEREsale_date='2019-05-20'; selectsum(sale_amount)intoallmoneyFROMsaleWHEREsale_date='2019-05-20'; END; $count$LANGUAGEplpgsql; 语句运行操作页面如图1-13所示。 图 1-13 创建存储过程 9.调用存储过程 SQL语句如下： Select*fromcountsale() 语句运行操作页面如图1-14所示。 图 1-14 调用存储过程 调用存储过程输出的总销售量和总金额数据正确，存储过程功能正确。 九、总结及心得体会 经过本次实验，我了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，锻炼了数据库SQL编程访问能力。同时也掌握了基本的数据库触发器、存储过程SQL编程方法，增加了数据库后端编程能力。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306\t          实验时间：20190527 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2.在pgAdmin4 中的BookSale 数据库中， 使用SQL 语句创建客户（R_Customer）角色、商家（R_Seller）角色。 3.在pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在pgAdmin4 中，分别创建客户用户U_Customer、商家用户U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户U_Customer、商家用户U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。 八、实验数据及结果分析 1.针对图书销售管理系统，设计数据存取权限控制模型。 实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家，客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以对库存表只有查看权限。他们的数据库存取访问权限控制模型设计如图2-1 与图2-2 所示。   图 2-1 客户角色安全模型  图 2-2 商家角色安全模型 3.创建客户角色和商家角色 SQL语句进行创建客户角色： CREATEROLE\"R_Customer\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTIONLIMIT-1 运行界面如图2-3所示。     图 2-3 创建客户角色 SQL语句进行创建商家角色： CREATEROLE\"R_Seller\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTIONLIMIT-1 运行界面如图2-4所示。 图 2-4 创建商家角色    图 2-5 完成创建角色 结果分析：在角色用户表中看到R_Customer,R_Seller，角色创建成功。 3.赋予客户、商家角色权限 SQL语句： GRANTSELECTONbookTO\"R_Customer\"; GRANTSELECTONautherTO\"R_Customer\"; GRANTSELECTONpublisherTO\"R_Customer\"; GRANTSELECT,INSERT,UPDATE,DELETEONbookTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONautherTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONpublisherTO\"R_Seller\"; GRANTSELECTONstockTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONsaleTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONcustomerTO\"R_Seller\"; 运行界面如图2-6所示。  图 2-6 赋予角色权限 权限赋予成功。 4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 SQL语句如下： CREATEUSER\"U_Customer\"WITH LOGIN CONNECTIONLIMIT-1 INROLE\"R_Customer\" PASSWORD'123456'; CREATEUSER\"U_Seller\"WITH LOGIN CONNECTIONLIMIT-1 INROLE\"R_Seller\" PASSWORD'123456'; 运行界面及结果如图2-7所示。 图 2-7 创建两个用户 在角色用户表中发现U_Customer,U_Seller，创建用户成功。 5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否成功赋予权限 用客户用户和商家用户进行登录，通过对各表进行增删查改操作来观察操作结果来验证是否与赋予他们的权限一致。 登录客户用户如图2-8所示。 图 2-8 登录客户用户 测试一：查看book表 SQL语句：select * from book 运行界面及结果如图2-9所示。 图 2-9 客户用户查看book表数据 客户用户可查看book 表，权限正确。   测试二：删除book表中数据 SQL语句：delete from book where book_isbn = '9787115502742' 运行界面及结果如图2-10所示。 图 2-10 客户用户删除book表数据 删除失败，客户用户不具有删除book 表中数据的权限，权限正确。  测试三：查看auther表 SQL语句：select* from auther 运行界面及结果如图2-11所示。 图 2-11 客户用户查看auther表数据 客户用户可查看auther 表，权限正确。  测试四： SQL语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路18555 号') 运行界面及结果如图2-12所示。 图 2-12 客户用户插入一条新数据到auther表 客户用户无法在auther 表中插入数据，权限正确。  测试五：查看sale表 SQL语句：select * from sale 运行界面及结果如图2-13所示。 图 2-13 客户用户查看sale表 客户用户无查看销售表的权限，权限正确。五个测试均验证通过，测试客户用户的权限正确。  测试完客户用户之后，登录商家用户来进行下一步的测试。 登录商家用户如图2-14所示。 图 2-14 登录商家用户 测试一：查看customer表 SQL语句：select * from customer 运行界面及结果如图2-15所示。 图 2-15 商家用户查看customer表 商家用户具有查看客户表的权限，权限正确。  测试二： 插入一条数据到auther表 SQL语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路18555 号') 运行界面及结果如图2-16所示。 图 2-16 插入新数据到auther表 查看表数据如图2-17所示。 图 2-17 商家用户查询插入一条新数据后的auther表 auther 表中新增了如上插入的数据，商家用户具有插入auther 表数据的权限，权限正确。  测试三：从stock表中删除一条数据  SQL语句：delete from stock where stock_id = 'SA00001' 运行界面及结果如图2-18所示。 图 2-18  商家用户不具有删除stock 表数据的权限，权限正确。  测试四：更新sale表的一条数据 SQL语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001' 运行界面及结果如图2-19所示。 图 2-19 商家用户更新一条sale表数据并查看 商家用户具有查看客户表的权限，权限正确。 sale 表中对应的数据被修改正确，商家用户具有修改sale 数据的权限，权限正确。 通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确。   九、总结及心得体会 经过本次实验我了解了DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，形成了数据库管理能力。学习了在图书销售管理系统数据库中，创建必要的角色和用户，并完成角色与用户的权限管理。 ",
  "studentID": "2017221103016"
 },
 "5": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t           实验时间：2019/05/20 三、实验目的  针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。  四、实验原理  1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。  五、实验内容  使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验设备及环境  “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11  七、实验步骤  1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建各表，以及各表主键外键的创建，并为给表创建视图、索引。 3.准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对表进行数据修改、删除、查询等访问操作。 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，测试函数功能。 6.编写触发器Tri_InsertSale，实现在 Market表数据插入时，级联操作 Stock 表，将图书的库存流水进行记录。 7.测试触发器的功能，准备Market表的样本数据，并将其插入Market表，插入之后查看Stock表是否有对应的更新，并对比插入Market数据前后Stock中对应数据的修改情况。  八、实验数据及结果分析  创建 BookSale 数据库 CREATEDATABASE “BookSale” 运行结果如下： 图8-1 数据库创建结果 创建各数据库表以及视图和索引 创建数据库表SQL语句如下 CREATETABLEPublish( pIDcharacter(12)NOTNULL, pnamecharactervarying(40), pphonecharactervarying(20), paddresscharactervarying(60), CONSTRAINTPublish_PKPRIMARYKEY(pID) );  CREATETABLEBook( bISBNcharacter(22) NOTNULL, pIDcharacter(12)\tNOTNULL, bnamecharactervarying(80), bpricemoney, CONSTRAINTBook_PKPRIMARYKEY(bISBN), CONSTRAINTBook_Publish_FKFOREIGNKEY(pID) REFERENCESPublish(pID) ONUPDATECASCADE ); CREATETABLEStock( bISBNcharacter(22)NOTNULL, samountnumeric, CONSTRAINTStore_PKPRIMARYKEY(bISBN), CONSTRAINTStore_Book_FKFOREIGNKEY(bISBN) REFERENCESBook(bISBN) ONUPDATECASCADE ); CREATETABLEMarket( mIDcharacter(12)NOTNULL, bISBNcharacter(22)NOTNULL, mdatedate, mamountnumeric, mmoneymoney, CONSTRAINTMarket_PKPRIMARYKEY(mID), CONSTRAINTMarket_Book_FKFOREIGNKEY(bISBN) REFERENCESBook(bISBN) ONUPDATECASCADE ); 数据库表创建结果如下：  图8-2数据库表创建结果 2）视图创建SQL语句如下： CREATEVIEWstock_viewAS SELECTbISBN,samount FROMstore;  CREATEVIEWbook_viewAS SELECTbISBN,pID,bname,bprice FROMbook;  CREATEVIEWmarket_viewAS SELECTmID,bISBN,mdate,mamount,mmoney FROMmarket;  CREATEVIEWpublish_viewAS SELECTpID,pname,pphone,paddress FROMpublish; 视图创建结果如下： 图8-3数据库视图创建结果 3）索引创建SQL语句如下 CREATEINDEXStock_IndexONStock(bISBN); CREATEINDEXBook_IndexONBook(bname); CREATEINDEXMarket_IndexONMarket(mID); CREATEINDEXPublish_IndexONPublish(pname); 索引创建结果如下  图8-4数据库索引创建结果 数据库操作：增删改查 INSERTINTOpublishVALUES('p001','Chushude','4008823823','aplaceyoucanfind'); INSERTINTOpublishVALUES('p002','Banshude','4008823856','aplaceyoucannotfind');  INSERTINTObookVALUES('565-1-366-14619-1','p001','Shu',5); INSERTINTObookVALUES('565-1-366-14619-2','p001','Book',6); INSERTINTObookVALUES('565-1-366-14619-3','p002','zhi',5); INSERTINTObookVALUES('565-1-366-14619-4','p002','Paper',6);  INSERTINTOstockVALUES('565-1-366-14619-1',50); INSERTINTOstockVALUES('565-1-366-14619-4',20);  DELETEFROMbookWHEREbISBN='565-1-366-14619-2';  UPDATEbookSETbname='Baozhi'WHEREbISBN='565-1-366-14619-3';  SELECT*FROMbook; 运行结果如下  图8-5数据库操作结果 5.创建函数Pro_CurrentSale createorreplacefunctionPro_CurrentSale(OUTamountint,OUTamoneymoney,INddate) AS$$ BEGIN SELECTSUM(mamount)INTOamountFROMmarketWHEREmdate=d; SELECTSUM(mmoney)INTOamoneyFROMmarketWHEREmdate=d; END $$LANGUAGEplpgsql; 编译结果如下：  图8-6 函数Pro_CurrentSale编译结果 测试数据与调用SQL语句 INSERTINTOmarketVALUES('m001','565-1-366-14619-1','2019-01-03',5,25); INSERTINTOmarketVALUES('m002','565-1-366-14619-4','2019-01-03',3,18); INSERTINTOmarketVALUES('m003','565-1-366-14619-1','2019-01-04',2,10);  SELECT*FROMPro_CurrentSale('2019-01-04'); 函数调用结果如下  图8-7 函数Pro_CurrentSale运行结果 5.创建触发器Tri_InsertSale CREATEORREPLACEFUNCTIONInsertSale() RETURNSTRIGGERAS$$ BEGIN IF(TG_OP='INSERT')THEN UPDATEstockSETsamount=samount-new.mamountWHEREbISBN=new.bISBN; RETURNNEW; ENDIF; RETURNNULL; END; $$LANGUAGEplpgsql;  CREATETRIGGERTri_InsertSale AFTERINSERTONmarket FOREACHROWEXECUTEPROCEDUREInsertSale(); 创建结果如下  图8-8 触发器Tri_InsertSale创建结果 测试数据与查询SQL语句 INSERTINTOmarktVALUES('m004','565-1-366-14619-1','2019-01-01',4,20); SELECT*FROMstock; 触发器运行结果如下  图8-9 触发器Tri_InsertSale触发结果  九、总结及心得体会  通过这次实验，初步了解了PostgreSQL与图形化界面pgAdmin4的使用。虽然图形化界面有许多可以直接设置的方式，但用SQL语句进行操作能展示更多细节，普适性也更好。  \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306\t          实验时间：2019/05/27      三、实验目的  了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理  1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。  五、实验内容  使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验设备及环境  “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11  七、实验步骤  1.针对图书销售管理系统，设计数据存取权限表。 2. 在 pgAdmin4中 的BookSale数 据 库 中 ， 使 用 SQL语 句 创 建 客 户（R_Customer）角色、商家（R_Seller）角色。 3. 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析  针对图书销售管理系统，设计角色权限表 创建客户角色和商家角色 CREATEUSER\"U_Customer\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT REPLICATION NOBYPASSRLS CONNECTIONLIMIT-1; INROLE\"R_Customer\" PASSWORD'123456'; CREATEUSER\"U_Seller\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT REPLICATION NOBYPASSRLS CONNECTIONLIMIT-1; INROLE\"R_Seller\" PASSWORD'123456'; 创建结果如下  图8-1 角色创建结果 赋予客户、商家角色权限 GRANTSELECTONStockTO\"R_Customer\"; GRANTSELECTONBookTO\"R_Customer\"; GRANTSELECTONPublishTO\"R_Customer\"; GRANTSELECTONMarketTO\"R_Customer\";  GRANTSELECT,INSERT,UPDATE,DELETEONStockTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONBookTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONPublishTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONMarketTO\"R_Seller\"; 创建客户用户和商家用户，并将客户角色和商家角色赋予他们 CREATEUSER\"U_Customer\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT REPLICATION NOBYPASSRLS CONNECTIONLIMIT-1; INROLE\"R_Customer\" PASSWORD'123456'; CREATEUSER\"U_Seller\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT REPLICATION NOBYPASSRLS CONNECTIONLIMIT-1; INROLE\"R_Seller\" PASSWORD'123456'; 用户创建结果如下  图8-2 用户创建结果 分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功 测试客户用户  图8-3 用客户用户登录  图8-4 用客户用户插入数据  图8-5 用客户用户修改数据  图8-6 用客户用户删除数据  图8-7 用客户用户查询数据 由结果可知客户用户只有查询数据的权限。 测试商家用户  图8-8 用商家用户登录  图8-9 用商家用户插入数据  图8-10 用商家用户修改数据  图8-11 用商家用户删除数据  图8-11 用商家用户查询数据 由结果可知商家用户有添加、修改、删除、查询数据的权限。  九、总结及心得体会  通过这次实验，掌握了数据库用户管理的方法。在实际应用中，同一数据库对不同用户的使用方法不同，为了保证安全，应当赋予不同的权限，而每个用户都设置过于繁琐，将其归类为角色可以节省大量重复工作。",
  "studentID": "2017221103021"
 },
 "6": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t实验时间：2019-5-20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 图书销售管理系统数据库BookSale创建操作 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther（作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、sale（销售表），以及各表主键外键的创建，并为给表创建索引。 为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验数据及结果分析 1. 创建 BookSale 数据库 实现思路与方法：使用 SQL 语句来进行数据库的创建。 SQL 语句：create database \"BookSale\" 运行操作界面如图 1-1 所示。  图 1-1 创建数据库 数据库操作结果面如图 1-2 所示。 图 1-2 数据库创建完成 结果分析：成功创建数据库。 2. 创建各数据库表以及表中主外键和索引 实现思路与方法：首先明确图书销售管理系统的实体、实体属性以及各实体之间的联系，再通过 SQL 语句对表进行创建，表对应实体，实体属性对应表中的列，通过主外键来将表联系起来。 其执行作界面如图 1-3 所示。 图 1-3 创建数据库表 SQL 程序执行结果 当SQL 程序成功执行后，可以在数据库看到新添加的数据库表对象，如图  1-4 所示。 图 1-4 图书销售数据库表对象 结果分析：成功创建各数据库表。  3.插入样本数据并对 publisher 表进行增删查改操作 实现思路与方法：首先准备样本数据，尽可能使得数据符合实际应用并且能满足后续的数据处理操作。这里以 publisher 表为例，给出该表的数据增、删、查、改 SQL 语句操作访问。 1）执行 SQL 语句，插入样本数据到图书销售数据库 图 1-5 插入样本数据 SQL 程序执行 查看 publisher 表数据的 SQL 语句如下： select * from publiser; 运行该 SQL 语句，其执行结果如图 1-6 所示。 图 1-6 查询 publisher 表数据 结果分析：插入表数据成功无误。 2）增加一条数据到 publisher 表 SQL 语 句 ： Insert into PUBLISHER values('PUB00000004',' 清 华 大 学 出 版 社','010-65323169','北京'); 运行操作界面如图 1-7 所示。 1-7   插入一条新数据到 publisher 表 执行结果如图 1-8 所示。 3）删除一条 publisher 表数据 SQL 语句：delete from publisher where pub_id = 'PUB00000004'; 运行操作界面如图 1-9 所示。 1-9 删除 publisher 表的一条数据 其执行结果如图 1-10 所示 1-10 查询删除数据后的 publisher 表 结果分析：确实删除掉了对应的 pub_id 的数据，删除操作执行成功 4）修改一条 publisher 表数据 SQL 语句：update publisher set pub_address = '南京' where pub_id = 'PUB00000003'；该语句运行操作结果如图 1-11 所示。 再对 piblisher 进行查询，其执行结果如图 1-12 所示。 1-12 查询更新数据后的 publisher 表 结果分析：对应 pub_id 的数据确实被成功修改。 4. 创建视图 实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数据查询。创建完视图之后可用 select 语句来查看视图，用法：select * from 视图名。例如，创建视图 BOOK_AUTHER_PUBLISHER 实现图书信息查询， 1-13 创建视图 采用如下 SQL 语句实现视图数据查询： select * from BOOK_AUTHER_PUBLISHER 该 SQL 语句执行结果如图 1-14 所示。 \t1-14 查看视图 结果分析：视图展示数据对应正确且按需展示，视图创建成功。 5. 创建触发器函数 实现思路与方法：创建触发器函数实现在有一条销售数据插入 sale 表时，同时在库存表 stock 中插入图书的库存变化记录，并修改对应图书表 book 的库存数，为后续的创建触发器提供函数方法。 运行操作界面如图 1-15 所示 图 1-15 创建触发器函数  6.创建触发器 实现思路与方法：创建触发器，关联销售表，在销售表插入一个新数据之后，执行上一步编写的触发器函数。 \t运行操作界面如图 1-16 所示。 7.测试触发器 实现思路与方法：在销售表中插入几个样本数据，之后再查看库存表和图书表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插入销售表的数据一致。 图 1-17 测试触发器 结果展示，查看 stock 表数据以及对比 book 表数据 Stock 表数据如图 1-18 所示 图 1-18 查看测试触发器之后的 stock 表数据 Book 表之前的数据如图 1-19 所示 图 1-19 查看 book 表在测试触发器之前的数据 触发器执行之后的 book 表数据如图 1-20 所示。 图 1-20 查看 book 表在测试触发器之后的数据 结果分析： Stock 表本来没有数据，在 sale 插入数据之后，将库存数据进行记录，记录数据正确，同时更新了 book 表中各对应图书的库存量，更新数据正确，触发器功能实现正确 8. 创建存储过程 实现思路与方法：通过存储过程实现某日图书销售数量和金额统计。 9.调用存储过程 实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况 一致，调用存储过程 SQL 语句如下： Select * from countsale() 存储过程调用语句执行结果如图 1-22 所示。 图 1-22 调用存储过程 结果分析：调用存储过程输出的总销售量和总金额数据正确，存储过程功能正确。 九、总结及心得体会 通过本次实验，我了解了SQL语言中DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。  \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306\t\t\t\t实验时间：2019-5-22      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 针对图书销售管理系统数据库，设计数据存取权限控制模型。 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、 实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 实验步骤 针对图书销售管理系统，在设计数据存取权限控制模型。 在 pgAdmin4 中的 BookSale 数据库中，使用 SQL 语句创建客户（R_Customer）角色、商家（R_Seller）角色。 在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对客户（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。 八、实验数据及结果分析 1. 针对图书销售管理系统，设计数据存取权限控制模型。 实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家，客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以对库存表只有查看权限。他们的数据库存取访问权限控制模型设计如图 2-1 与图2-2所示。 图 2-1 客户角色安全模型 图 2-2 商家角色安全模型 2.创建客户角色和商家角色 实现思路与方法：使用 SQL 语句进行角色创建，因为客户角色和商家角色都是普通角色，因此除了登录的功能之外其他的高级权限都为 no。 创建客户角色的 SQL 运行界面如图 2-3 所示。 图 2-3 创建客户角色 创建商家角色的运行界面如图 2-4 所示。  图 2-4 创建商家角色 创建两个角色的结果展示如图 2-5 所示。 图 2-5 完成创建两个角色 结果分析：在角色用户表中看到 R_Customer,R_Seller，角色创建成功。  3.赋予客户、商家角色权限 实现思路与方法：使用 SQL 语句给两个角色赋予在步骤 1 定义的权限。 赋予客户角色 SQL 语句： GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON auther TO \"R_Customer\"; GRANT SELECT ON publisher TO \"R_Customer\"; 运行界面如图 2-6 所示。 图 2-6 赋予客户角色权限 赋予商家角色 SQL 语句： GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\"; GRANT SELECT ON stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\"; 运行界面如图 2-7 所示。 图 2-7 赋予商家角色权限 结果分析：权限赋予成功。 4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 实现思路与方法：使用 SQL 语句创建用户，并将对应的角色赋予他们。 SQL 运行界面如图 2-8 所示。 图 2-8 创建两个用户 运行结果如图 2-9 所示。 图 2-9 完成创建两个用户 结果分析：在角色用户表中发现 U_Customer,U_Seller，创建用户成功。 5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功。 实现思路与方法：用客户用户和商家用户进行登录，通过对各表进行增删查改操作来观察操作结果来验证是否与赋予他们的权限一致。 首先我们来登录客户用户来进行测试。 登录客户用户如图 2-10 所示。 测试一：查看 book 表 SQL 语句：select * from book 运行界面和结果展示如图 2-11 所示： 图 2-11 客户用户查看 book 表数据 结果分析：客户用户可查看 book 表，权限正确。  测试二：删除 book 表中的数据 SQL 语句：delete from book where book_isbn = '9787115502742' 运行界面和结果展示如图 2-12 所示： 图 2-12 客户用户删除 book 表数据 结果分析：删除失败，客户用户不具有删除 book 表中数据的权限，权限正确。  测试三：查看 auther 表  SQL 语句：select * from auther  运行界面和结果展示如图 2-13 所示： 图2-13 客户用户查看 auther 表 结果分析：客户用户可查看 auther 表，权限正确。 测试四：插入一条数据到 auther 表中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-14 所示。 图 2-14 客户用户插入一条新数据到 auther 表 结果分析：客户用户无法在 auther 表中插入数据，权限正确  测试五：查看 sale 表 SQL 语句：select * from sale 运行界面如图 2-15 所示。 图 2-15 客户用户查看 sale 表 结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过，测试客户用户的权限正确。  测试完客户用户之后，我们登录商家用户来进行下一步的测试。 登录商家用户如图 2-16 所示： 图 2-16 登录商家用户 测试一：查看 customer SQL 语句：select * from customer 运行界面和结果展示如图 2-17 所示。 图2-17 商家用户查看 customer 表 结果分析：商家用户具有查看客户表的权限，权限正确。  测试二：插入一条数据到 auther 中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-18 所示 图 2-18 商家用户插入一条新数据到 auther 表 通过查看 auther 表进行结果展示如图 2-19 所示： 图 2-19 商家用户查询插入一条新数据后的 auther 表 结果分析：auther 表中新增了如上插入的数据，商家用户具有插入 auther 表数据的权限，权限正确。  测试三：从 stock 表中删除一条数据 SQL 语句：delete from stock where stock_id = 'SA00001' 运行界面如图 2-20 所示。 图 2-20 商家用户删除一条 stock 表数据 结果分析：商家用户不具有删除 stock 表数据的权限，权限正确。  测试四：更新 sale 表的一条数据 SQL 语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001' 运行界面如图 2-21 所示。 图 2-21 商家用户更新一条 sale 表数据 结果展示，通过查看 sale 来查看结果如图 2-22 所示 图 2-22 商家用户查看 sale 表数据 结果分析：sale 表中对应的数据被修改正确，商家用户具有修改 sale 数据的权限，权限正确。通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确。 九、总结及心得体会 通过本次实验，我了解了该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。 ",
  "studentID": "2017221103027"
 },
 "7": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t\t\t   实验时间： 5.20     三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 \t在数据库应用系统中，采用E-R图方法展示系统概念数据模型，逻辑数据模型的设计过程，抽象出系统的实体及实体关系，熟悉PowerDesigner相关功能完成物理数据模型设计，并对设计数据库模型完善和检验。 \t对数据库通过DBMS执行SQL语句实现CREATE TABLE,ALTER TABLE,DROP TABLE；通过执行INSERT,UPDATE,DELETE语句实现数据的添加、修改、删除。使用pgadmin工具执行SQL语句，实现对数据库对象及数据的操作。 \t在PostgreSql数据库中，用PL/pgSQL编程实现存储过程、触发器和游标。按照PL/pgSQL提供的语句和程序结构、实现数据库后端功能编程处理，使用开发工具pgAdmin执行PL/pgSQL程序。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 步骤一 创建图书销售管理系统 步骤二 数据库建模设计 步骤三 创建数据库表，视图，索引等对象。 步骤四 对以实现数据进行增删改查等SQL操作 步骤五 编程实现函数设计 步骤六 编程实现触发器设计 八、实验数据及结果分析 步骤一 创建图书销售管理系统  \t\t图1-1 数据库创建语句及结果图 步骤二 数据库建模设计 抽取实体：图书、商店、销售、出版社、作者、折扣。 分析实体联系，完成概念数据模型，细化完成图书管理系统逻辑数据模型。 对可能存在的不规范设计进行完善，使其完成3NF范式。 完成实体到关系表的转换，将实体联系转换为主外键关系。  \t\t 图2-1 数据库物理数据模型图  步骤三 创建数据库表，视图，索引等对象。  \t图3-1 创建地区表及作者表结果图  \t图3-2 创建出版社表、目录表、商店表、折扣表图  \t\t图3-3 创建图书表  \t\t图3-4 创建库存表及编著排名表   \t\t\t图3-5 创建销售表 为已创建的数据库创建必要的视图，创建视图：  \t图3-6 创建查询book简要信息的视图 为提高查询速度，创建索引：  图3-7 创建依据书籍isbn的索引     \t\t图3-8 图形化方式创建依据目录名的索引   添加数据库数据：      步骤四：创建SQL语句完成增删改查。   \t\t\t\t\t图4-1 数据库book表增删改查功能SQL语句  步骤五: 编写函数Pro_CurrentSale()如下：  \t\t\t\t\t图5-1 创建函数Pro_CurrentSale统计当日销量 编写函数调用程序：  \t\t\t\t\t\t图5-2 编写函数调用语句及运行结果  步骤六编写触发器：  \t\t\t\t\t\t\t图6-1 创建触发器执行函数  \t\t\t\t\t\t\t图6-2创建触发器  对触发器进行检测如下：  \t\t\t  图6-3 sales原表数据图   \t\t\t 图6-3 Stock表原表数据   \t\t\t图6-4对sales表执行插入操作  \t\t图6-5 插入后Stock表数据图 \t由上图可以看出对销售表进行插入操作后，触发器启动对库存表也做出了修改，随着相应商店的图书的售出，使对应书店该图书的stocknum 减少了50。 九、总结及心得体会 \t本次实验集中于基本的数据库语言，理解试验数据库的创建、设计和数据库表的设计，实现和SQL语句的增删改查操作。本次实验也进行了触发器编程与函数编程，对一些基本的功能进行使用，加深了对课堂教学内容的实践，对基本知识有新的体会。                 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：  信软楼西306\t\t\t\t\t   实验时间： 2019.5.27     三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 \t 在PostgreSQL数据库系统中，实现数据存取安全模型是确保数据库安全访问的基本手段。在数据安全存取模型中，需要设计数据库的角色、角色的数据库对象操作权限、数据库用户、数据库用户的角色赋予，以及数据库对象的操作权限集合。根据设计的数据安全存取模型，系统管理员使用数据库管理工具pgAdmin去创建角色，授权系统管理权限和对象操作权限。此外，系统管理员还需创建用户，并对用户赋予必要的角色。之后，用户就可以对数据库对象进行访问。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 \t步骤一：存取权限设计 \t步骤二：用SQL语句创建数据库角色。 \t步骤三：通过GRANT语句赋予不同角色不同权限。 \t步骤四：用SQL语句创建用户 \t步骤五：为不同用户分配不同的角色 \t步骤六：通过使用不同用户登录验证权限正确性。 八、实验数据及结果分析 \t步骤一：存取权限设计 \t \t\t\t\t\t\t表1-1 数据库角色权限控制表 \t步骤二：SQL创建数据库角色 \t运行角色创建语句结果如下： \t \t\t\t\t\t\t\t表2-1 创建数据库相应角色 \t \t\t\t表2-2 角色创建结果表 步骤三：通过GRANT语句赋予不同角色不同权限  \t表3-1 为角色分配不同权限     图3-2 权限分配图 步骤四：SQL语句创建用户    \t图4-1 创建角色语句图 步骤五：为不同用户分配角色   \t\t图5-1 为角色分配用户 步骤六：以不同用户登录验证权限正确性 1、以u_customer身份登录   \t图6-1 登录角色图  图6-2 拥有SELECT权限结果  \t图6-3 未拥有UPDATE权限结果 2、以u_seller身份登录  图6-4 u_seller角色登录  图6-5 拥有DELETE权限  图6-6 未拥有INSERT权限  九、总结及心得体会 \t本次实验主要集中于对数据库权限的控制与实践，实现对数据库角色应当拥有的权限的设计，也包括通过相应语句创建角色和用户，用SQL语句分配角色和权限，实现数据库的安全设计，将平时所学用于实践，加深对平常知识的理解。        ",
  "studentID": "2017221104003"
 },
 "8": {
  "content": "  电子科技大学信息与软件工程学院    实 验 报 告    学    号  2017221104007          姓    名   张世宇                （实验）课程名称   数据库原理及应用      理论教师   张凤荔                实验教师   何中海                    电子科技大学教务处制表  电\t子\t科\t技\t大\t学 实\t验\t报\t告  一、实验一：图书销售管理系统数据库 SQL 编程 二、实验室名称：306\t实验时间：2019/5/06  三、实验目的 针对图书销售管理数据库开发，了解 SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的 SQL 数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行 SQL 编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行 SQL 创建图书销售管理系统数据库 BookSale。 2.在数据库 BookSale 中，执行 SQL 创建数据库表、视图、索引等对象。 3.在数据库 BookSale 中，执行 SQL 进行数据增、删、查、改访问操作。 4. 在 数 据 库 BookSale 中 ， 采 用 PL/pgSQL 语 言 编 写 存 储 过 程 函 数 Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库 BookSale 中，采用 PL/pgSQL 语言编写过程语句块，实现对存储过程函数 Pro_CurrentSale 的调用，并输出统计结果。 6.在数据库 BookSale 中，采用 PL/pgSQL 语言编写编写图书销售表 Insert 触  发器Tri_InsertSale，实现图书库存数据同步修改处理。                     7.在数据库 BookSale 中，对图书销售表 Insert 触发器 Tri_InsertSale 程序进行 功能验证。 8.在数据库 BookSale 中，创建存储过程函数实现图书销售数量和金额统计。在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL、PL/pgSQL 语言， 完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为：  pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP  管 理 工 具 ： pgAdmin4 DBMS  系统： PostgreSQL 11 七、实验步骤 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。  八、实验数据及结果分析 创建 BookSale 数据库 实现思路与方法：使用 SQL 语句来进行数据库的创建。 SQL 语句：create database \"BookSale\" 运行操作界面如图 1-1 所示。               图 1-1 创建数据库 数据库操作结果面如图 1-2 所示。           图 1-2 数据库创建完成 结果分析：成功创建数据库。 创建各数据库表以及表中主外键和索引 实现思路与方法：首先明确图书销售管理系统的实体、实体属性以及各实体之间的联系，再通过 SQL 语句对表进行创建，表对应实体，实体属性对应表中的列，通过主外键来将表联系起来。 SQL 语句： create table Auther ( AU_ID\tCHAR(18)\tnot null, AU_Name\tVARCHAR(20)\tnot null,  AU_Gender\tCHAR(2)\tnot null, AU_Phone\tVARCHAR(11)\tnot null, AU_Address\tVARCHAR(50)\tnot null, constraint PK_AUTHER primary key (AU_ID) ); create table Book ( constraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER ( CUST_ID\tCHAR(18)\tnot null, CUST_Name\tVARCHAR(20)\tnot null, CUST_Phone\tVARCHAR(15) not null, CUST_Address    VARCHAR(50)     not null, CUST_Email\tVARCHAR(50) not null, constraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher ( PUB_ID\tCHAR(11)\tnot null, PUB_Name\tVARCHAR(20)          not null, PUB_Phone\tVARCHAR(15) not null, PUB_Address     VARCHAR(50)     not null, constraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale ( constraint PK_SALE primary key (SALE_ID) ); create table Stock ( Stock_ID\tVARCHAR(10)\tnot null,  constraint PK_STOCK primary key (Stock_ID) ); alter table Book add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) references Auther (AU_ID) on delete restrict on update restrict; alter table Book add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) references Publisher (PUB_ID) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_CUSTOMER CUSTOMER foreign key (CUST_ID) references CUSTOMER (CUST_ID) on delete restrict on update restrict; alter table Stock add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict;  将上面的 SQL 程序，提交到数据库服务器执行，其执行作界面如图 1-3 所示。  图 1-3 创建数据库表 SQL 程序执行结果  当 SQL 程序成功执行后，可以在数据库看到新添加的数据库表对象，如图 1-4 所示。  图 1-4 图书销售数据库表对象 结果分析：成功创建各数据库表。  插入样本数据并对 publisher 表进行增删查改操作 实现思路与方法：首先准备样本数据，尽可能使得数据符合实际应用并且要能满足后续的数据处理操作。这里以 publisher 表为例，给出该表的数据增、删、查、改 SQL 语句操作访问。 1）执行 SQL 语句，插入样本数据到图书销售数据库 Insert into Auther values('330309198504150527','王天','男','13554874593','四川省成都市成华区建设北路二段十号'); Insert into Auther values('540135199103281548','叶无双','男','15812387538','浙江省杭州市天路区梅田路二十八号'); Insert into Auther values('120857198811123587','李婷','女','18575615472','北京市朝阳区梅山路二巷八号 '); Insert into PUBLISHER values('PUB00000001','高等教育出版社','010-65321854','北京'); Insert into PUBLISHER values('PUB00000002','电子工业出版社','010-65329857','北京'); Insert into PUBLISHER values('PUB00000003','人民邮电出版社','010-65325987','北京'); Insert into BOOK values('9787115502742','330309198504150527','PUB00000001','Web 前端开发最佳实践 ','2016-01-01', '59','IT 技术','100'); Insert into BOOK values('9875325415577','540135199103281548','PUB00000002','Java EE Web 编 程  ','2008-01-01', '52','IT 技术','200'); Insert into BOOK values('9865365975234','120857198811123587','PUB00000003',' 数 据 库 实 验 指 导 ','2013-08-1','29','IT 技术', '150'); Insert into customer values('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insert into customer values('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十九号','657873215@qq.com'); Insert into customer values('542244197812121687','鲁丽','13615869875','北京市朝阳区梅山路二巷十六号','647864378@qq.com'); 样本数据插入 SQL 程序的运行操作界面如图 1-5 所示。 图 1-5 插入样本数据 SQL 程序执行 查看 publisher 表数据的 SQL 语句如下： select * from publiser; 运行该 SQL 语句，其执行结果如图 1-6 所示。            图 1-6 查询 publisher 表数据  结果分析：插入表数据成功无误。  2）增加一条数据到 publisher 表 SQL 语 句 ： Insert into PUBLISHER values('PUB00000004',' 清 华 大 学 出 版 社 ','010-65323169','北京'); 运行操作界面如图 1-7 所示。       执行结果如图 1-8 所示。 \n图 1-7 插入一条新数据到 publisher 表     图 1-8 查询插入新数据之后的 publisher 表 结果分析：插入表数据成功。  3）删除一条 publisher 表数据 SQL 语句：delete from publisher where pub_id = 'PUB00000004'; 运行操作界面如图 1-9 所示。    图 1-9 删除 publisher 表的一条数据 其执行结果如图 1-10 所示。          图 1-10 查询删除数据后的 publisher 表 结果分析：确实删除掉了对应的 pub_id 的数据，删除操作执行成功。  4）修改一条 publisher 表数据 SQL 语句：update publisher set pub_address = '南京' where pub_id = 'PUB00000003'; 该语句运行操作结果如图 1-11 所示。  图 1-11 更新 publisher 表的一条数据 再对 piblisher 进行查询，其执行结果如图 1-12 所示。    图 1-12 查询更新数据后的 publisher 表 结果分析：对应 pub_id 的数据确实被成功修改。  4.创建视图 实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数据查询。创建完视图之后可用 select 语句来查看视图，用法：select * from 视图名。例如，创建视图 BOOK_AUTHER_PUBLISHER 实现图书信息查询，其 SQL 语句如下： create view BOOK_AUTHER_PUBLISHER as select B.book_name as \"图书\",AU.au_name as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\" from book as B join auther as AU on B.au_id = AU.au_id join publisher as PU on B.pub_id = PU.pub_id  该 SQL 运行操作结果如图 1-13 所示：          图 1-13  创建视图 采用如下 SQL 语句实现视图数据查询： select * from BOOK_AUTHER_PUBLISHER; 该 SQL 语句执行结果如图 1-14 所示。   图 1-14  查看视图 结果分析：视图展示数据对应正确且按需展示，视图创建成功。  5.创建触发器函数 实现思路与方法：创建触发器函数实现在有一条销售数据插入 sale 表时，同时在库存表 stock 中插入图书的库存变化记录，并修改对应图书表 book 的库存数，为后续的创建触发器提供函数方法。 创建触发器函数 SQL 语句： CREATE OR REPLACE FUNCTION InsertSale() RETURNS TRIGGER AS $$ BEGIN IF (TG_OP = 'INSERT') THEN INSERT INTO stock values(new.sale_id,new.book_isbn,new.sale_qty,' 出 库 ',new.sale_date); update book set book.book_stock = book.book_stock - new.sale_qty where book.book_isbn = new.book_isbn; RETURN NEW;     END; \nEND IF; RETURN NULL;  $$ LANGUAGE plpgsql; 运行操作界面如图 1-15 所示。 图 1-15  创建触发器函数  创建触发器 实现思路与方法：创建触发器，关联销售表，在销售表插入一个新数据之后， 执行上一步编写的触发器函数。 创建触发器 SQL 语句： CREATE TRIGGER Tri_InsertSale AFTER INSERT ON SALE FOR EACH ROW EXECUTE PROCEDURE InsertSale();  运行操作界面如图 1-16 所示。 图 1-16 创建触发器    测试触发器 \n   实现思路与方法：在销售表中插入几个样本数据，之后再查看库存表和图书 表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插入销售表的数据一致。 测试触发器 SQL 语句： Insert into sale values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885'); Insert into sale values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040'); Insert into sale values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450');  运行操作界面如图 1-17 所示。  图 1-17  测试触发器 结果展示，查看 stock 表数据以及对比 book 表数据。  Stock 表数据如图 1-18 所示。 图 1-18 查看测试触发器之后的 stock 表数据 Book 表之前的数据如图 1-19 所示。       图 1-19  查看 book 表在测试触发器之前的数据  触发器执行之后的 book 表数据如图 1-20 所示。     结果分析： \n图 1-20  查看 book 表在测试触发器之后的数据  Stock 表本来没有数据，在 sale 插入数据之后，将库存数据进行记录，记录数据 正确，同时更新了 book 表中各对应图书的库存量，更新数据正确，触发器功能实现正确。  创建存储过程 实现思路与方法：通过存储过程实现某日图书销售数量和金额统计。创建存储过程的 SQL 语句如下。  CREATE OR REPLACE FUNCTION countsale(OUT amount int,OUT allmoney money) as $count$ BEGIN select sum(sale_qty) into amount FROM sale WHERE sale_date = '2019-05-20'; select sum(sale_amount) into allmoney FROM sale WHERE sale_date = '2019-05-20'; END; $count$ LANGUAGE plpgsql; 该 SQL 语句运行操作界面如图 1-21 所示。              调用存储过程 \n   图 1-21  创建存储过程  实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况 一致，调用存储过程 SQL 语句如下： Select * from countsale() 存储过程调用语句执行结果如图 1-22 所示。 图 1-22  调用存储过程 结果分析：调用存储过程输出的总销售量和总金额数据正确，存储过程功能正确。  九、总结及心得体会 本次实验中，我对数据库的基本操作更加熟悉和掌握，而且特别是对函数以及触发器的应用。函数和触发器的相关内容在上课时，因为老师的讲课速度有些快，我并没有很深的理解，掌握上也很生疏，本次实验让我在一定程度上复习了上课的内容。另一方面，我也体会到了数据库工作人员的辛苦。因为，这次实验真的很麻烦，特别是插入数据的过程极其麻烦。  电\t子\t科\t技\t大\t学 实\t验\t报\t告  一、实验二：图书销售管理系统数据库安全管理  二、实验室名称：306\t实验时间：2019/5/27  三、实验目的 了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  4.在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。 5.分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL 语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。 3. 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析 1.针对图书销售管理系统，设计数据存取权限控制模型。 实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家， 客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水  信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以对库存表只有查看权限。他们的数据库存取访问权限控制模型设计如图 2-1 与图 2-2 所示。   图 2-1 客户角色安全模型         2.创建客户角色和商家角色 \n图 2-2 商家角色安全模型  实现思路与方法：使用 SQL 语句进行角色创建，因为客户角色和商家角色 都是普通角色，因此除了登录的功能之外其他的高级权限都为 no。创建客户角色的 SQL 语句： CREATE ROLE \"R_Customer\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1 创建客户角色的 SQL 运行界面如图 2-3 所示。   图 2-3 创建客户角色 创建商家角色的 SQL 语句： CREATE ROLE \"R_Seller\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1  创建商家角色的运行界面如图 2-4 所示。 图 2-4 创建商家角色 创建两个角色的结果展示如图 2-5 所示。 图 2-5 完成创建两个角色 结果分析：在角色用户表中看到 R_Customer,R_Seller，角色创建成功。  3.赋予客户、商家角色权限 实现思路与方法：使用 SQL 语句给两个角色赋予在步骤 1 定义的权限。赋予客户角色 SQL 语句： GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON auther TO \"R_Customer\"; GRANT SELECT ON publisher TO \"R_Customer\";  运行界面如图 2-6 所示。    图 2-6 赋予客户角色权限  赋予商家角色 SQL 语句： GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\"; GRANT SELECT ON stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\";  运行界面如图 2-7 所示。            图 2-7 赋予商家角色权限  结果分析：权限赋予成功。  4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 实现思路与方法：使用 SQL 语句创建用户，并将对应的角色赋予他们。其 SQL 语句如下。 CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '123456';   CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456';  SQL 运行界面如图 2-8 所示。              运行结果如图 2-9 所示。 \n   图 2-8 创建两个用户    图 2-9 完成创建两个用户 结果分析：在角色用户表中发现 U_Customer,U_Seller，创建用户成功。  5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功。 实现思路与方法：用客户用户和商家用户进行登录，通过对各表进行增删查改操作来观察操作结果来验证是否与赋予他们的权限一致。 首先我们来登录客户用户来进行测试。登录客户用户如图 2-10 所示。  图 2-10  登录客户用户  测试一：查看 book 表 SQL 语句：select * from book 运行界面和结果展示如图 2-11 所示。            图 2-11 客户用户查看 book 表数据  结果分析：客户用户可查看 book 表，权限正确。  测试二：删除 book 表中的数据 SQL 语句：delete from book where book_isbn = '9787115502742' 运行界面和结果展示如图 2-12 所示：        图 2-12  客户用户删除 book 表数据 结果分析：删除失败，客户用户不具有删除 book 表中数据的权限，权限正确。  测试三：查看 auther 表 SQL 语句：select * from auther 运行界面和结果展示如图 2-13 所示。   图 2-13 客户用户查看 auther 表 结果分析：客户用户可查看 auther 表，权限正确。  测试四：插入一条数据到 auther 表中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-14 所示。 图 2-14 客户用户插入一条新数据到 auther 表 结果分析：客户用户无法在 auther 表中插入数据，权限正确。  测试五：查看 sale 表 SQL 语句：select * from sale 运行界面如图 2-15 所示。 图 2-15 客户用户查看 sale 表  结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过， 测试客户用户的权限正确。 测试完客户用户之后，我们登录商家用户来进行下一步的测试。登录商家用户如图 2-16 所示。     测试一：查看customer \n图 2-16  登录商家用户  SQL 语句：select * from customer 运行界面和结果展示如图 2-17 所示。 图 2-17 商家用户查看 customer 表 结果分析：商家用户具有查看客户表的权限，权限正确。  测试二：插入一条数据到 auther 中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-18 所示。       图 2-18  商家用户插入一条新数据到 auther 表 通过查看 auther 表进行结果展示如图 2-19 所示。   图 2-19 商家用户查询插入一条新数据后的 auther 表 结果分析：auther 表中新增了如上插入的数据，商家用户具有插入 auther 表数据的权限，权限正确。  测试三：从 stock 表中删除一条数据SQL 语句：delete from stock where stock_id = 'SA00001' 运行界面如图 2-20 所示。 图 2-20 商家用户删除一条 stock 表数据 结果分析：商家用户不具有删除 stock 表数据的权限，权限正确。  测试四：更新 sale 表的一条数据 SQL 语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001' 运行界面如图 2-21 所示。  图 2-21 商家用户更新一条 sale 表数据 结果展示，通过查看 sale 来查看结果如图 2-22 所示。    图 2-22 商家用户查看 sale 表数据 结果分析：sale 表中对应的数据被修改正确，商家用户具有修改 sale 数据的权限，权限正确。通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确。  九、总结及心得体会 本次是在上次实验的基础上对数据库进行安全管理，总的来说难度并不大，并且复杂程度上和第一次相比也要低很多。通过这次试验，我对数据库安全管理以及人员授权管理等方面有了很大的理解进步。受益匪浅。",
  "studentID": "2017221104007"
 },
 "9": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软大楼A306\t\t\t\t\t      实验时间：2019.5.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 \t（1）图书销售管理系统数据库BookSale创建操作 \t\t如图所示，在pgAdmin 4工具上编写并执行SQL语句，创建BookSale数据库， 编写数据库创建语句：create database BookSale;并执行，结果如下：     如下图所示，刷新后，BookSale数据库已创建完成。  （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 \t①执行如下代码创建数据库表： 如图所示，运行代码，消息显示成功返回查询：  生成的数据库表如图所示：  ②执行如下代码创建索引和视图： 如图所示，运行代码，消息显示成功返回查询：  生成的索引如图所示：  至此，地区表Area下的，地区名称AreaName索引，创建成功； 生成的视图如图所示：  至此，作者数据库表下的，用于查看所有地区ID为“0000001”的作者信息的视图创建成功。 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 \t①增添数据操作如下： 如图所示，运行代码，消息显示成功返回查询：  ②删除数据操作如下： 先运用查询语句select * from area对数据库表area中的数据进行查询，结果如下：  再运用删除语句delete from area where areaname=’南京’对数据库表area中的数据进行删除，运行代码，显示成功返回查询：  对area表进行验证，再次使用查询语句select * from area对数据库表area中的数据进行查询，结果如下：  至此，对数据的删除操作已达到预期要求。 ③修改数据操作如下： 运行代码，显示成功返回查询：  再使用数据查询语句select * from area对数据库表area中的数据进行查询，结果如下：  如图所示，地区名称信息“武汉”已经更新为“杭州”。 ③查询数据操作如下： 利用数据查询语句select * from <表明>即可查询相关数据，下面举例查询两个表的数据： a.查询图书信息表：  b.查询出版社信息表：  （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 代码如下： 运行代码，结果如下：  （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 代码如下： 运行代码，结果如下：  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 代码如下： 运行代码，结果如下：  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 首先选择一本图书的库存情况进行打印： \t代码如下： 运行代码，结果如下：  现在我们向sale表中插入数据，售卖3本此店的此书籍，如图所示：  现在查看stock表，发现书籍库存变成了57，验证成功：  九、总结及心得体会 本次实验进行了数据库SQL应用编程的相关学习，将课堂上所学习的SQL语句等相关知识进行了系统性的，综合性的结合实践，切身感受到了一个完整的项目所需要进行的工作是多方面的，也感受到了我们所学习的理论在实际项目中的迫切需求，当一个完整的项目通过一步一步分解进行，直到最终完成时，那种成就感是无可替代的，实验不仅使我们巩固了所学习的理论知识，更锻炼了我们综合实践的能力，并秉承“实践是检验真理的唯一标准”这一原则，将理论知识与现实接轨，真正让知识变得有用武之地，收获良多。\n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称： 信软学院楼西306  \t\t\t\t实验时间：2019.5.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理  1、PostgreSQL PostgreSQL 是一个自由的对象-关系数据库服务器(数据库管理系统)，它在灵活的 BSD-风格许可证下发行。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。 PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99。首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备，比如 IP 类型和几何类型等。其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。 Inprise 的 InterBase 以及SAP等厂商将其原先专有软件开放为自由软件之后才打破了这个唯一。 最后，PostgreSQL拥有一支非常活跃的开发队伍，而且在许多黑客的努力下，PostgreSQL 的质量日益提高。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等，同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。 PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。 2、SQL结构化查询语言 结构化查询语言(Structured Query Language)简称SQL，结构化查询语言是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统。 创建数据库：CREATE DATABASE database-name 删除数据库：drop database dbname 创建新表：create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..) 删除新表：drop table tabname 增加一个列：Alter table tabname add column col type 添加主键：Alter table tabname add primary key(col) 删除主键：Alter table tabname drop primary key(col) 创建索引：create [unique] index idxname on tabname(col….) 删除索引：drop index idxname 创建视图：create view viewname as select statement 删除视图：drop view viewname 创建用户：create user username 创建角色：create role rolename 赋予权限：grant 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 1.针对图书销售管理系统，设计数据存取权限控制模型。 实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家， 客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水  信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以对库存表只有查看权限。他们的数据库存取访问权限控制模型设计如图 2-1 与图2-2 所示。   图 2-1 客户角色安全模型         2.创建客户角色和商家角 \n图 2-2 商家角色安全模型  实现思路与方法：使用 SQL 语句进行角色创建，因为客户角色和商家角色 都是普通角色，因此除了登录的功能之外其他的高级权限都为 no。创建客户角色的 SQL 语句： CREATE ROLE \"R_Customer\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT-1 创建客户角色的 SQL 运行界面如图 2-3 所示。   图 2-3 创建客户角色 创建商家角色的 SQL 语句： CREATE ROLE \"R_Seller\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT-1 创建商家角色的运行界面如图 2-4 所示。 图 2-4 创建商家角色 创建两个角色的结果展示如图 2-5 所示。 图 2-5 完成创建两个角色 结果分析：在角色用户表中看到 R_Customer,R_Seller，角色创建成功。  3.赋予客户、商家角色权限 实现思路与方法：使用 SQL 语句给两个角色赋予在步骤 1 定义的权限。赋予客户角色 SQL 语句： GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON auther TO \"R_Customer\"; GRANT SELECT ON publisher TO \"R_Customer\";  运行界面如图 2-6 所示。    图 2-6 赋予客户角色权限  赋予商家角色 SQL 语句： GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\"; GRANT SELECT ON stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\";  运行界面如图 2-7 所示。            图 2-7 赋予商家角色权限  结果分析：权限赋予成功。  4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 实现思路与方法：使用 SQL 语句创建用户，并将对应的角色赋予他们。其 SQL 语句如下。 CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '12345 CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456 SQL 运行界面如图 2-8 所示。              运行结果如图 2-9 所示。 \n   图 2-8 创建两个用户    图 2-9 完成创建两个用户 结果分析：在角色用户表中发现 U_Customer,U_Seller，创建用户成功。  5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功。 实现思路与方法：用客户用户和商家用户进行登录，通过对各表进行增删查改操作来观察操作结果来验证是否与赋予他们的权限一致。 首先我们来登录客户用户来进行测试。登录客户用户如图 2-10 所示。  图 2-10  登录客户用户  测试一：查看 book 表 SQL 语句：select * from book 运行界面和结果展示如图 2-11 所示。            图 2-11 客户用户查看 book 表数据  结果分析：客户用户可查看 book 表，权限正确。  测试二：删除 book 表中的数据 SQL 语句：delete from book where book_isbn = '9787115502742' 运行界面和结果展示如图 2-12 所示：        图 2-12  客户用户删除 book 表数据 结果分析：删除失败，客户用户不具有删除 book 表中数据的权限，权限正确。  测试三：查看 auther 表 SQL 语句：select * from auther 运行界面和结果展示如图 2-13 所示。   图 2-13 客户用户查看 auther 表 结果分析：客户用户可查看 auther 表，权限正确。  测试四：插入一条数据到 auther 表中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-14 所示。 图 2-14 客户用户插入一条新数据到 auther 表 结果分析：客户用户无法在 auther 表中插入数据，权限正确。  测试五：查看 sale 表 SQL 语句：select * from sale 运行界面如图 2-15 所示。 图 2-15 客户用户查看 sale 表  结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过， 测试客户用户的权限正确。 测试完客户用户之后，我们登录商家用户来进行下一步的测试。登录商家用户如图 2-16 所示。     测试一：查看customer \n图 2-16  登录商家用户  SQL 语句：select * from customer 运行界面和结果展示如图 2-17 所示。 图 2-17 商家用户查看 customer 表 结果分析：商家用户具有查看客户表的权限，权限正确。  测试二：插入一条数据到 auther 中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-18 所示。       图 2-18  商家用户插入一条新数据到 auther 表 通过查看 auther 表进行结果展示如图 2-19 所示。   图 2-19 商家用户查询插入一条新数据后的 auther 表 结果分析：auther 表中新增了如上插入的数据，商家用户具有插入 auther 表数据的权限，权限正确。  测试三：从 stock 表中删除一条数据SQL 语句：delete from stock where stock_id = 'SA00001' 运行界面如图 2-20 所示。 图 2-20 商家用户删除一条 stock 表数据 结果分析：商家用户不具有删除 stock 表数据的权限，权限正确。  测试四：更新 sale 表的一条数据 SQL 语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001' 运行界面如图 2-21 所示。  图 2-21 商家用户更新一条 sale 表数据 结果展示，通过查看 sale 来查看结果如图 2-22 所示。    图 2-22 商家用户查看 sale 表数据 结果分析：sale 表中对应的数据被修改正确，商家用户具有修改 sale 数据的权限，权限正确。通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确。 九、总结及心得体会 本次实验是对图书销售管理系统数据库进行安全管理的相关操作，是在实验一的基础上，在构建好内部实体的框架后，对使用该系统的用户权限进行的限定，可以说，制作好一个性能优良的数据库，构建内在实体固然重要，但是外部的安全保障仍旧不可或缺，因为数据库的使用对象是用户，是为用户服务的，所以我们在用户使用方面需要花费精力去设计。需要避免用户权限过高而可能造成数据库紊乱的情况出现，于是要结合实际情况，对各类用户的权限加以限制，做到既能保证用户身份正产访问、操作数据库，也能保证角色权限不越界。 相比于实验一，实验二的战略性意义更强，我们做软件工程项目，软件的安全性是面向客户、面向对象的，只有一个软件的安全性得到了保障，客户才会信任你的产品，所以我认为在实验二所涉及的知识点上应该付出更多精力去研究和深造。 在今后的学习生活中，我会时刻保持对数据库实验中所涉及到的知识点的高度新鲜，因为这些知识是真正有用，也真正需要的东西，是无论以后科研深造还是走向工作岗位的理论基础，需要时刻巩固和温习。",
  "studentID": "2017221104008"
 },
 "10": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t           实验时间：2019.5.20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 本次实验用到的原理有：SQL语言编程操作，包括：数据库创建、表创建、视图创建、索引创建、sql语言插入、删除、修改、查询数据操作，数据库应用编程，包括：存储过程编程、触发器函数编程、触发器编程。运用上述原理进行对图书销售系统的操作，实现该系统的基本功能。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 创建一个数据库BookSale 创建数据库表、视图、索引 进行数据增、删、查、改SQL操作 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计 编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理 对sale表进行增、删、改操作，观察库存是否同步 实验数据及结果分析 创建数据库 思路：运用create database语句创建一个数据库。 结果分析：成功创建了数据库booksale。  创建数据库表、视图、索引 创建数据库表 思路：通过建立数据模型，设计各表中的属性和表间的关系，最后使用create table语句建立表，需要注意表建立的顺序，含有外键的表需要建立在被引用表的后面。   结果分析：运行结果表示成功建立表和约束，所有的外键都加上了级联删除和级联更新。          创建视图 思路：统计销量最好的书，包括ISBN、销量、价格、书名和库存，根据销量的多少降序输出（用order by实现），需要连接sale、book和repertory三个表，运用create view实现。 结果分析：成功创建了视图hotbook，用于显示近期最火的图书。  创建索引 思路：根据表的主键或其它间作为表的索引，运用create index实现。  增删改查操作。 思路：往数据库表中插入数据（序列插入数据时需要用到nextval(序列名)），用insert into语句实现，对数据进行更改，用到update语句，对数据进行删除，用到delete语句、查询数据，用到select语句。  \t 结果分析：成功往各表中插入数据。 结果分析：成功删除了sale表中日期为2019-5-15的销售记录。  结果分析：成功将sale表中日期为2019-5-11商店编号为000000000002的销售记录的数量改为20，销售金额改为￥360。   结果分析：输出了2019-5-1之后的图书书名、销量、销售金额、时间，按销量降序输出。  编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计 思路：编写函数Pro_CurrentSale，其中包含两个输出参数（当日图书销售量及销售金额）和一个输入参数（日期），需要通过sum（）函数进行汇总，用create function语句实现。  结果分析：成果创建了函数pro_currentsale用于实现当日图书销售量及销售金额汇总。   编写过程语句块，实现对函数Pro_CurrentSale的调用   结果分析：成功调用函数pro_currentsale,输出了日期为2019-5-13的销售数量及销售金额。   编写图书销售表Insert触发器Tri_InsertSale 思路：编写触发器函数，首先要确定触发器关联的表，tri_insertsale触发器与表sale关联，当sale表进行增、删、改操作时触发（用pg_op检测），根据操作的不同对repertor表中的库存进行修改，当进行增操作时，减少库存量，进行删操作时，增加库存量，进行改操作时，更新库存量。然后编写触发器，在检测到sale表的操作后调用触发器函数。   结果分析：成功创建触发器函数tri_insertsale。    结果分析：成功创建触发器stock_trigger用于库存的同步更新。   对sale表进行增、删、改操作，验证触发器功能 思路：先输出初始数据，再对sale表进行增、删、改操作，最后再次输出数据，观察数据是否更新。          结果分析：可以看出在增加了销售量为10的销售记录之后，库存由50减少到40，说明触发器功能正确。             结果分析：可以看出初始库存为40，删除了两条销售数量之和为33的数据后，库存变为73，说明触发器功能正确。  结果分析：可以看出初始库存为43，将销售数量由30改为50后，库存减少了20，说明触发器功能正确。 九、总结及心得体会 \t总结：本次实验的内容较为复杂，需要用到很多关于sql语句的知识，除此之外还有很多小细节导致本次实验的进度缓慢，例如在编写sql语句进行创建表的过程中，需要正确地将表进行排序，拥有外键的表需要最后创建，不引用其它表的属性的表优先创建，在进行插入数据操作时，对于serial类型的属性，需要使用nextval(序列名)进行插入，在编写触发器函数时，需要用到pg_op=’INSERT’检测操作，这里的DELET不能用小写delete，否则将无法识别，这些细节很大程度上影响了完成的速度。 \t心得体会：本次实验的内容丰富，是第一次完成一个比较完整的数据库的实践，虽然实验所花费的时间很长，但是通过完成本次实验，极大地提高了我的实践能力，对于sql语句的使用更加熟练，尤其是细节上的改变，原本使用语句需要多次才能成功，有时还不知道错误的原因，但是现在大部分情况下都能一次通过，并且功能正确，这说明了我从本次实验上学到了很多东西。\n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306 \t\t          实验时间：2019.5.27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 使用sql语句对图书销售系统进行数据安全管理，包括：创建用户、创建角色、分配权限等。创建用户、角色和分配权限的操作需要根据实际情况进行设计之后才能进行。在创建角色和分配权限之后需要进行测试，验证是否正确。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 设计角色的权限，采用类图来表示，用powerdesigner软件实现 在数据库中，用create role语句创建客户（R_Customer）、商家（R_Seller）角色 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限 在数据库中，用create user语句分别创建客户用户U_Customer、商家用户U_Seller 用grant语句分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 设计角色权限 思路：用powerdesigner软件创建类图，用类表示数据库的表，用类间的关系表示角色对表的权限，两个用户U_customer和U_seller分别是R_customer和R_seller的泛化，R_customer角色应该只有查询的权限，R_seller角色除了有查询的权限之外，对库存、编著排名、图书、销售、商店、折扣都有删除、修改和添加的权限。         结果分析：创建了一个类图，用于表示角色对表的权限。   创建客户(R_customer)、商家(R_seller) 思路：用create role语句创建，设置角色的属性为可以登录、非超级用户、不能创建数据库、不能创建角色、可以继承。    结果分析：成功创建了两个角色R_customer与R_seller。  赋予角色数据库对象的权限。 思路：根据上面创建的用于表示权限的类图来赋予角色权限，用grant语句进行赋予权限操作。  创建用户U_customer与U_seller 思路：用create user语句创建用户并设置密码。  结果分析：成功创建了两个用户，闭关将密码赋值为’123456’。  为用户赋予角色 思路：用grant语句将角色赋予用户，使用户具有角色身份。   结果分析：成功为U_customer赋予了R_customer身份，为U_seller赋予了R_seller身份。  用户权限验证 思路：分别用不同的用户登录数据库，并通过查询、修改等操作验证权限是否正确。  顾客权限验证        \t结果分析：由上面两个结果可以看出，顾客用户只有查询的权限，而没有修改的权限，说明权限赋予正确。   商家（U_seller）权限验证    结果分析：由上面的结果可以看出，商家对销售类可以进行修改操作，二对于作者类不能进行修改操作，说明权限赋予正确。    九、总结及心得体会 \t总结：本次实验的内容较为简单，就是一些基础的创建角色并赋予权限的操作，需要用到的语句不多。但是简单的操作也有需要注意的地方，例如在书本上没有详细讲如何更改用户登录，如何断开服务器连接，如何给用户分配角色等，做这次实验的时候就可以自己动手实践，从中可以补全这方面的知识。 \t心得体会：本次实验与上一个实验联系紧密，可以说是一个较为完整的简易管理系统的最后一部分内容，完成了这一部分的内容，理论上设计的销售管理系统就可以投入使用。本次实验的内容虽然比较简单，完成过程比较顺利，但是它是销售系统中很重要的一部分，通过这次实验，真正体会到了数据库系统权限控制的大致逻辑，增强了我的实践能力。 ",
  "studentID": "2017221104011"
 },
 "11": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西306\t      实验时间：2019.5.22 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1、PostgreSQL PostgreSQL 是一个自由的对象-关系数据库服务器(数据库管理系统)，它在灵活的 BSD-风格许可证下发行。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。 PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99。首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备，比如 IP 类型和几何类型等。其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。 Inprise 的 InterBase 以及SAP等厂商将其原先专有软件开放为自由软件之后才打破了这个唯一。 最后，PostgreSQL拥有一支非常活跃的开发队伍，而且在许多黑客的努力下，PostgreSQL 的质量日益提高。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等，同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。 PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。 2、SQL结构化查询语言 (Structured Query Language)简称SQL，结构化查询语言是一种数据库查询和，用于存取数据以及查询、更新和管理。 创建数据库：CREATE DATABASE database-name 删除数据库：drop database dbname 创建新表：create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..) 删除新表：drop table tabname 增加一个列：Alter table tabname add column col type 添加主键：Alter table tabname add primary key(col) 删除主键：Alter table tabname drop primary key(col) 创建索引：create [unique] index idxname on tabname(col….) 删除索引：drop index idxname 创建视图：create view viewname as select statement 删除视图：drop view viewname 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 （1）图书销售管理系统数据库BookSale创建操作 如图1所示，创建数据库BookSale：              图1 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 如图2-图15所示，创建各数据库表、视图及索引等：  首先进入数据库，如图2所示：              图2 创建图书类别（Book_class）表，如图3所示：               图3 创建出版社（Pubisher）表，如图4所示：                图4 创建商店（Store）表，如图5所示：              图5 创建折扣（Discount）表，如图6所示：                  图6 创建地区（Area）表，如图7所示：               图7 创建作者（Author）表，如图8所示：                    图8 创建图书（Book）表，如图9所示：               图9 创建库存（Stock）表，如图10所示：                 图10 创建编著排名（edit_rank）表，如图11所示：               图11 创建销售（sale）表，如图12所示：                  图12 如图13所示，所有表创建完成：               图13 如图14所示，创建视图：                 图14 如图15所示，创建索引：               图15 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 如图16所示，插入数据：            图16 如图17所示，删除数据：             图17 如图17所示，更新数据：                      图17 如图18所示，查询数据：              图18 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 如图19所示，编写函数如下：                  图19 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 如图20所示，执行函数效果如下：              图20 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 如图21所示，创建触发器如下：                   图21  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 对触发器功能验证如下： 首先，原本在000000000001商店库存的书籍000000000000000000000001有十本，如图22所示：              图22 现在我们向sale表中插入数据，售卖3本此店的此书籍，如图23所示：               图23 现在查看stock表，发现书籍库存变成了7，验证成功，如图24所示：                图24 九、总结及心得体会 1.在本次实验中，我在老师的耐心指导下顺利的完成booksale数据库创建及维护等问题。在实验过程中我收获颇丰，了解学习了SQL语句的使用，实现了对此问题的解决，更体会到了关系数据库postgresql的强大之处。 2.通过实验我认清了自己在理论学习中的不足之处，以及容易忽略的知识细节的缺点。这些缺点在我进行实验中给我留下了深刻的印象，导致我不断的修改实验方式。通过本次实验我领悟到了在今后的学习过程中我应该要更多注重知识细节，增加对于知识的深入认识，这样才能避免再次在细节问题上犯错。 3. 在实验改进方面，我认为自己需要在代码实现方面更进一步。整个数据库创建和维护数据表很容易理解，但是我却在实现的时候遇到了问题。比如创建函数时无法返回多个值，通过询问老师才知道函数可以返回表类型，这样就可以返回多值了，如果不够熟悉，很容易在实现过程中遇到问题。所以以后需要加强在该方面的知识学习。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西306 \t      实验时间：2019.5.20 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1、PostgreSQL PostgreSQL 是一个自由的对象-关系数据库服务器(数据库管理系统)，它在灵活的 BSD-风格许可证下发行。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。 PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99。首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备，比如 IP 类型和几何类型等。其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。 Inprise 的 InterBase 以及SAP等厂商将其原先专有软件开放为自由软件之后才打破了这个唯一。 最后，PostgreSQL拥有一支非常活跃的开发队伍，而且在许多黑客的努力下，PostgreSQL 的质量日益提高。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等，同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。 PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。 2、SQL结构化查询语言 (Structured Query Language)简称SQL，结构化查询语言是一种数据库查询和，用于存取数据以及查询、更新和管理。 创建数据库：CREATE DATABASE database-name 删除数据库：drop database dbname 创建新表：create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..) 删除新表：drop table tabname 增加一个列：Alter table tabname add column col type 添加主键：Alter table tabname add primary key(col) 删除主键：Alter table tabname drop primary key(col) 创建索引：create [unique] index idxname on tabname(col….) 删除索引：drop index idxname 创建视图：create view viewname as select statement 删除视图：drop view viewname 创建用户：create user username 创建角色：create role rolename 赋予权限：grant 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 （1）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 创建角色，并赋予系统权限，如图25所示：                       图25 （2）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 为角色赋予数据库对象访问权限，如图26所示：                图26 （3）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 创建用户，如图27所示：                图27 （4）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 为用户赋予角色，如图28所示：             图28 （5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 验证U_Customer，如图29所示：                图29 验证U_Seller，如图30所示：               图30 九、总结及心得体会 1.在本次实验中，我在老师的耐心指导下顺利的完成booksale数据库安全管理，解决了角色创建、用户创建、权限管理以及权限验证等问题。在实验过程中我收获颇丰，了解学习了SQL语句的使用，实现了对此问题的解决，更体会到了关系数据库postgresql的强大之处。 2.通过实验我认清了自己在理论学习中的不足之处，以及容易忽略的知识细节的缺点。这些缺点在我进行实验中给我留下了深刻的印象，导致我不断的修改实验方式。通过本次实验我领悟到了在今后的学习过程中我应该要更多注重知识细节，增加对于知识的深入认识，这样才能避免再次在细节问题上犯错。 3. 在实验改进方面，我认为自己需要在权限管理方面更进一步。权限管理对于数据库的安全会存在很大的影响，如果权限管理不恰当，很荣誉对数据库造成安全性的损失。如果不对权限管理足够熟悉，很容易在实现过程中遇到问题，用户的数据安全就得不到保障。所以以后需要加强在该方面的知识学习。",
  "studentID": "2017221104015"
 },
 "12": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西306\t\t\t  实验时间：2017.5.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 SQL语言语句类型 数据定义语言 数据定义语言（Data Definition Language，DDL）是SQL语言中用于创建、修改或删除数据库对象的语句。 CREATE DATABASE - 创建新数据库 DROP DATABASE C 删除数据库 ALTER DATABASE - 修改数据库属性  CREATE TABLE - 创建新表  ALTER TABLE C 修改数据库表结构 DROP TABLE - 删除表 CREATE INDEX - 创建索引 DROP INDEX - 删除索引  数据操纵语言 数据操纵语言（Data Manipulation Language，DML）是SQL语言中用于增添、修改、删除数据的语句。 INSERT - 向数据库表中插入数据  UPDATE - 更新数据库表中的数据 DELETE - 从数据库表中删除数据  数据查询语言 数据查询语言（Data Query Language，DQL）是SQL语言中用于对数据库进行数据查询的语句。 数据控制语言 数据控制语言（Data Control Language，DCL）是用于对数据库对象访问权进行控制的SQL语句。 GRANT C 授予用户对数据库对象的权限 DENY C 拒绝授予用户对数据库对象的权限 REVOKE C 撤消用户对数据库对象的权限 事务处理语言 事务处理语言（Transaction Process Language，TPL）是SQL语言中用于数据库内部事务处理的语句。 BEGIN TRANSACTION C 开始事务 COMMIT C 提交事务 ROLLBACK C 回滚事务 SQL语言的数据类型 SQL语言基本数据类型 字符：CHAR、VARCHAR、TEXT 整数：SMALLINT、INTEGER 浮点数：NUMBER(n,d)、FLOAT(n,d) 日期：DATE、DATETIME 货币：MONEY Postgre数据库所支持数据类型   五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的硬件设备为PC计算机、服务器以及网络环境，PC计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 创建数据库  图 1-1                            图 1-2 对关系进行数据建模  图 2-1 创建关系表 SQL语句： 执行结果：  图 3-1 创建索引 执行语句： 创建视图 SQL语句： 执行结果：  图 5-1 增、删、查、改 增： 删： 查： 改： 函数和存储过程 函数： 存储过程： 执行语句： CALL Pro_CurrentSale_PROCEDURE('2019-05-20'); 执行结果：  图 7-1 触发器 SQL语句： 执行情况： 插入新数据前： SELECT * FROM Stock \tWHERE shopID='shopID' \t\tAND bookISBN='bookISBN';  图 8-1 插入新数据： INSERT INTO Sale VALUES (         '0',         'bookISBN',         'shopID',         '2019-05-20',         '50',         '500'); 插入新数据后： SELECT * FROM Stock \tWHERE shopID='shopID' \t\tAND bookISBN='bookISBN';  图 8-2 九、总结及心得体会 在这次实验过程中，我为一个图书销售管理系统进行了数据建模，并对一些相关的操作做了定义。在实验的过程中，我编写并练习了数据库、表、索引、视图的建立语句、还定义了几个函数、存储过程、触发器，并通过检验证明了它们的正确性。在老师的指导与帮助下，我巩固了我已经掌握的技能，也学会了我曾经不太熟悉的知识。学生十分感激老师的教诲。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西306\t\t          实验时间：      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 什么是数据库管理 数据库管理(Database Management)是指为保证数据库系统的正常运行和服务质量必须进行的系统管理工作。 为什么需要数据库管理 数据库系统随规模增大,系统会变得异常复杂 多用户数据库应用带来数据库访问复杂性 数据安全和数据隐私对机构和用户都非常重要 数据库系统随数据量增加和使用时间增长其性能会降低 系统遭遇意外事件，数据库损坏或数据丢失 数据库管理目标 保障数据库系统正常稳定运行 充分发挥数据库系统的软硬件处理能力 确保数据库系统安全和用户数据隐私性 有效管理数据库用户及其角色权限 解决数据库系统性能优化、系统故障与数据损坏等问题 最大程度地发挥数据库对其所属机构的作用 数据库管理内容 DBMS系统运行管理 数据库性能监控 数据库索引管理 数据库查询优化 数据库事务并发控制 数据库角色管理 数据库用户管理 数据库对象权限管理 数据安全管理 数据库备份 数据库恢复 数据库管理员（DBA）职责 负责数据库系统开发与运维 负责数据库用户与权限管理 负责数据库备份与数据库恢复管理 负责数据库性能调优管理 DBMS管理功能结构  DBMS系统层次结构  数据库系统面临的安全风险 黑客利用系统漏洞，攻击系统运行、窃取和篡改系统数据。  内部人员非法地泄露、篡改、删除系统的用户数据。  系统运维人员操作失误导致数据被删除或数据库服务器系统宕机。  系统故障导致数据库的数据损坏、数据丢失、数据库实例无法启动。  意外灾害事件（火灾、水灾、地震等自然灾害）导致系统被破坏。 数据库系统安全模型  身份验证：从应用系统层面确认登录用户是否是合法使用者 权限控制：从DBMS系统层面通过存取权限机制控制用户对数据的访问 系统防护：从操作系统层面提供的安全机制防范非法系统访问 加密存储：从数据存储层面通过加密算法对数据库中数据进行加密存储 数据库存取权限控制安全模型  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的硬件设备为PC计算机、服务器以及网络环境，PC计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 针对图书销售管理系统数据库，设计数据存取权限控制模型。 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 设计数据存取权限控制模型  图 1-1 创建角色 SQL语句： 执行结果：  图 2-1 为角色赋予数据库对象权限 SQL：语句 创建用户 SQL语句： 执行结果：  图 4-1 为用户分派角色 SQL语句： 执行结果：   图 5-1                                图 5-2 验证所实现数据存器权限控制模型的正确性  九、总结及心得体会 在这次实验过程中，我为一个图书销售管理系统设计了存取权限控制安全模型，并为一些相关的操作编写了SQL语句。在实验的过程中，我编写并练习了角色、用户的创建与更改的方法，并通过检验证明了它们的正确性。在老师的指导与帮助下，我巩固了我已经掌握的技能，也学会了我曾经不太熟悉的知识。学生十分感激老师的教诲。",
  "studentID": "2017221105001"
 },
 "13": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t\t\t\t  实验时间：2019-5-20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 说明：本节需学生编写内容。学生应根据实验内容，给出完成该实验的具体实验原理。 在数据库系统中，最大的数据库对象就是数据库本身。SQL提供了数据库对象的创建与维护语句，包括数据库创建、数据库属性修改、数据库删除等。 创建数据库语句格式： CREATE DATABASE <数据库名>  数据库表时数据库中最基础的操作对象。在SQL中，使用数据定义语言语句可完成数据表的创建、表结构修改、表删除等操作。 创建数据库表的基本语句格式为： CREATE TABLE <表名> （<列名1><数据类型>[列完整性约束],   <列名2><数据类型>[列完整性约束]， … ）； 修改数据库表：ALTER TABLE为数据库表修改语句的关键词；其基本语句格式为： ALTER TABLE <表名> <修改方式>; 主要修改方式有ADD（添加）、DROP（删除）、RENAME（重命名）、ALTER（修改数据类型） 删除数据库表，其基本语句格式为：DROP TABLE <表名>  在SQL中，数据操纵语言（DML）是一种对数据库表中数据进行操作的语言集。它以INSERT、UPDATE、DELETE三种语句为核心，分别完成数据的插入、更新与删除操作。数据操作语句是任何数据库应用必定会使用到的数据操作语句。 在SQL中，数据查询语言（DQL）是一种对数据库表进行数据查询访问的语句，该语句在数据库访问中使用最多。在SQL中，实现对数据库表进行数据查询处理的语句只有SELECT语句。虽然只有一种语句，但该类语句功能丰富、组合条件使用灵活。 在SQL中，数据控制语言（DCL）是一类可对用户数据访问权限进行控制的操作语言，它可以控制特定用户或角色对数据表、视图、存储过程、触发器等数据库对象的访问权限，主要由GRANT、REVOKE、DENY语言操作来实现。 存储过程是一种数据库的对象，由一组能完成特定功能的SQL语句集构成。它把经常会重复使用的SQL语句逻辑块封装起来，经编译后，存储过程在数据库服务器端，当再次调用时，不需要再次编译；当客户端连接到数据库时，用户通过制定存储过程的名称并给出参数，数据库就可以找到相应的存储过程并予以调用。 触发器是存储在数据库中的独立对象，它与存储过程不同，存储过程通过其他程序来启动运行或直接启动运行，而触发器由一个事件触发启动运行。也就是说，触发器是在某个事件发生时自动地隐式运行，所以启动触发器执行在某些文献里被称为触发或点火。数据库事件指对数据库的表进行INSERT、UPDATE或DELETE操作。大多数关系数据库支持触发器，但不同数据库在触发器的定义和应用方面可能略有不同。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1）图书销售管理系统数据库BookSale创建操作 2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  八、实验数据及结果分析 （1数据库BookSale的创建 使用powderDesigner完成数据库模型的创建，再使用相关功能生成对应SQL语言代码。  修正后生成代码：  \t（2创建库表、视图、索引： \t\t库表已经在第一步过程中创建，以下为视图、索引的创建。 \t  \t（3进行增、删、查、改操作 \t\t  \t（4编写函数  \t（5函数使用  \t（6编写触发器 \t  \t（7验证触发器 \t1）查看库存 \t2）添加销售内容 \t3）结果检查   九、总结及心得体会 说明：本节需学生编写内容。学生应对本实验的关键技术内容进行归纳总结，并给出心得体会。 在本次实验中，首次进行了存储过程函数，以及触发器的使用。存储过程函数具有很多优点，在实际实际数据库的过程中，存储过程能够给我们带来许多方便，而触发器也可以在我们完善数据库内容，实现一致性过程中提供帮助。总之，这两中功能对于将来数据库的使用都有很大的帮助，需要较好的掌握。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306\t\t\t\t\t          实验时间：2019-5-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 说明：本节需学生编写内容。学生应根据实验内容，给出完成该实验的具体实验原理。 用户要访问数据库，必须先在DBMS中创建其用户账号，并称为数据库的用户。此后，用户每次连接访问数据库时，都需要在DBMS中进行身份鉴别，只有合法用户才能进入数据库系统，访问操作数据库对象。如在PostgreSQL数据库系统中，用户访问数据库需要用户账号及密码。DBA在数据库中为该用户创建用户账号及初始密码，同时还为用户赋予特定角色及其操作权限。当该用户连接数据库后，便可以进行相应的角色权限的数据库访问操作。 当用户登陆数据库服务器和连接数据库后，它应有一定的数据库对象操作权限，这样才能操作访问数据库对象。用户的数据库对象访问权限由系统管理员进行授予。若系统管理员没由给数据库用户赋予一定的数据库对象操作权限，用户仅仅只能进行基本访问操作。 DBMS一般将用户权限定义为以下两类： （1数据库对象访问操作权限 \t数据库对象访问操作权限指用户在数据库中被赋予的塔顶数据库对象的数据访问操作权限，如对数据库表进行SLEECT\\INSERT\\UPDATE\\DELETE操作的权限。 （2数据库对象定义操作权限 \t数据库对象定义操作权限指用户在数据库中被赋予的数据库对象创建、删除和修改权限，如对数据库表、视图、存储过程、用户自定义函数、索引等对象的创建、删除和修改的操作权限。 在DBMS中，为了方便对众多用户及其权限进行管理，系统通常将一组具有相同权限的用户定义为角色（Role）。不同的角色就代表不同权限集合的用户集合。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 说明：本节需学生编写内容。学生应针对本实验，给出具体实验步骤内容。 （1针对图书销售管理系统，设计相关的数据存取权限模型。 （2在数据库中使用SQL语句创建客户（R_Customer）、商家（R_Seller）角色。 （3是数据库中使用GRANT语句为客户角色以及商家角色赋予相应的权限。 （4在数据库中使用SQL语句创建客户用户用户（U_Customer）、商家用户（U_Seller） （5在创建客户用户以及商家用户时，为其各自分配对应的角色。 （6分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理系统。 八、实验数据及结果分析 说明：本节为学生编写内容。学生应按照上述步骤分别给出各项实验内容的具体操作过程说明，并体现数据库管理的操作分析、操作原理、操作方法、操作结果说明等内涵文字描述。在报告内容中，需要有基本的操作界面和操作结果数据。 （1设计数据存器权限模型： \t （2在数据库中使用SQL语句创建客户（R_Customer）、商家（R_Seller）角色。  （3是数据库中使用GRANT语句为客户角色以及商家角色赋予相应的权限。  （4在数据库中使用SQL语句创建客户用户用户（U_Customer）、商家用户（U_Seller）  （5在创建客户用户以及商家用户时，为其各自分配对应的角色。  （6分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理系统。 1)以客户的身份登陆系统： 2）使用客户身份对数据库进行访问： 3）以商家用户身份登陆数据库： 4)使用商家用户进行添加、删除、查找、更新操作：   九、总结及心得体会 说明：本节为学生编写内容。学生应对本实验的关键技术内容进行归纳总结，并给出心得体会。 \t在本次实验中，主要使用的技术包括角色、用户的创建及其相关权限的授予，总体来说，该次实验内容较少，其中，实验要求的过程为先创建用户，再使其归类为某一种角色，这使得我需要掌握对ALTER ROLE <>相关语句的使用方式。从这次实验中，我实际使用了许多在课堂上学习的内容，也了解了更多的数据库功能，是一次有意义的实验。",
  "studentID": "2017221105002"
 },
 "14": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西306\t 实验时间：2019.5.20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 说明：本节需学生编写内容。学生应根据实验内容，给出完成该实验的具体实验原理。 数据库数据模型 概念数据模型 主要用来描述世界的概念化结构，它使数据库的设计人员在设计的初始阶段，摆脱计算机系统及 DBMS 的具体技术问题，集中精力分析数据以及数据之间的联系等，与具体的数据管理系统（Database Management System，简称 DBMS）无关。概念数据模型必须换成逻辑数据模型，才能在 DBMS 中实现。 逻辑数据模型 用户从数据库所看到的模型，是具体的 DBMS 所支持的数据模型，如网状数据模型 (Network Data Model)、 层次数据模型 (Hierarchical Data Model) 等等。 此模型既要面向用户，又要面向系统 ，主要用于 数据库管理系统 （DBMS）的实现。 物理数据模型 面向计算机物理表示的模型，描述了数据在储存介质上的组织结构，它不但与具体的 DBMS 有关，而且还与操作系统和硬件有关。每一种逻辑数据模型在实现时都有起对应的物理数据模型。DBMS 为了保证其独立性与可移植性，大部分物理数据模型的实现工作又系统自动完成，而设计者只设计索引、聚集等特殊结构。 存储过程 存储过程和用户自定义函数（UDF）是SQL和过程语句的集合，它存储于数据库服务器并能被SQL接口调用。  触发器 PostgreSQL触发器是一组动作或数据库回调函数，它们在指定的表上执行指定的数据库事件(即，INSERT，UPDATE，DELETE或TRUNCATE语句)时自动运行。 触发器用于验证输入数据，执行业务规则，保持审计跟踪等。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 说明：本节需学生编写内容。学生应针对本实验，给出具体实验步骤内容。 (1)在本次实验中，采用数据库管理软件pgAdmin运行postgreSQL命令，因此首先需要在实验机上运行数据库服务以及pgAdmin软件。  (2)利用powerDesigner，根据题目需要，对图书销售系统进行设计和建模，分别建立概念数据模型、逻辑数据模型以及物理数据模型。 (3)模型建立完成后，根据相关规则将模型转换为SQL语言，并在pgAdmin运行。 (4)编写实验报告。 八、实验数据及结果分析 说明：本节需学生编写内容。学生应按照上述步骤完整给出各个实验内容的具体实践操作展示及过程说明，并体现出解决问题思路、编程方法等设计内涵文字描述。在报告内容中，需要有基本的SQL程序代码、运行操作界面、操作数据等结果内容。 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （a）创建数据库表 （b）创建视图 （c）创建索引  （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作  （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  九、总结及心得体会 说明：本节需学生编写内容。学生应对本实验的关键技术内容进行归纳总结，并给出心得体会。 通过本次实验，掌握了数据库建模的基本步骤和方法，能够从概念模型开始，层层递进，建立起逻辑模型和物理模型，最后生成sql脚本，创建出实验要求的数据库，大大提升了对数据库建模的理解。 在实践中学习了Powerdesigner设计数据库模型的基本操作和使用技巧，例如实体和关系的连接、关系中一对多、多对多的情况，以及逐渐、外键的约束等，通过实际操作，加深了课堂理论知识的熟悉程度。 实验缺乏一定的数据，需要学生自己编写、插入一定数量的数据条目才能验证数据库能否正常工作，对实验效率造成了影响，希望以后的实验中，能够给出一定数量的数据。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西306  \t实验时间：2019.05.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 说明：本节需学生编写内容。学生应根据实验内容，给出完成该实验的具体实验原理。 角色 PostgreSQL使用角色的概念管理数据库访问权限。  根据角色自身的设置不同，一个角色可以看做是一个数据库用户，或者一组数据库用户。  角色可以拥有数据库对象(比如表)以及可以把这些对象上的权限赋予其它角色， 以控制谁拥有访问哪些对象的权限。  操作角色的语句： create role db_role1; /*--创建角色*/ drop role db_role1;  /*--删除角色*/   \\du  --在命令格式下查看所有角色的命令  角色的权限 一个数据库角色可以有很多权限，这些权限定义了角色和拥有角色的用户可以做的事情。  create role db_role1 LOGIN; --创建具有登录权限的角色db_role1 create role db_role2 SUPERUSER; --创建具有超级用户权限的角色 create role db_role3 CREATEDB; --创建具有创建数据库权限的角色 create role db_role4 CREATEROLE --创建具有创建角色权限的角色 alter role db_role1 nologin nocreatedb; --修改角色取消登录和创建数据库权限  用户 其实用户和角色都是角色，只是用户是具有登录权限的角色。 create user db_user1 password '123'; --创建用户 create role db_user1 password '123' LOGIN;  --同上一句等价 drop user db_user1;   --删除用户 alter user db_user1 password '123456'; --修改密码 alter user db_user1 createdb createrole; --对用户授权  赋予角色控制权限 我们可以使用GRANT 和REVOKE命令赋予用户角色，来控制权限。 create user db_user1; --创建用户1 create user db_user2; --创建用户2 create role db_role1 createdb createrole; --创建角色1 grant db_role1 to db_user1,db_user2; --给用户1,2赋予角色1,两个用户就拥有了创建数据库和创建角色的权限 revoke db_role1 from db_user1; --从用户1移除角色1，用户不在拥有角色1的权限 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 说明：本节需学生编写内容。学生应针对本实验，给出具体实验步骤内容。 编写SQL语句，在pgAdmin执行相关语句，创建实验所需的各种角色； 根据业务规则编写权限分配相关SQL语句，并在数据库中执行； 在创建角色的基础上，编写创建用户SQL语句，在数据库中执行； 以不同身份访问数据库，验证权限控制的正确性； 编写实验报告。 八、实验数据及结果分析 说明：本节为学生编写内容。学生应按照上述步骤分别给出各项实验内容的具体操作过程说明，并体现数据库管理的操作分析、操作原理、操作方法、操作结果说明等内涵文字描述。在报告内容中，需要有基本的操作界面和操作结果数据。 数据存取权限控制模型如下：  创建客户（R_Customer）、商家（R_Seller）角色SQL如下：  根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。SQL如下：  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。SQL如下：  分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。SQL如下：  分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 以客户(U_Customer)身份访问Books表，有权限，得到书本信息；尝试插入信息，没有权限，被拒绝插入信息。如图所示。  以商家(U_Sellrt)身份访问BookType表，有权限，得到书本类型信息，尝试插入信息，有权限，成功插入信息，如图所示。  九、总结及心得体会 说明：本节为学生编写内容。学生应对本实验的关键技术内容进行归纳总结，并给出心得体会。 通过本次实验，掌握了数据库权限控制的基本方法，在实验中创建了具有不同权限的角色，并将角色的权限通过继承分配给新建的用户，最后，通过不同的用户身份对数据库进行访问，验证了权限分配的正确性。 经过实践，对pgAdmin、psql的使用更为熟悉，能够同时掌握在GUI和命令行模式下进行数据库的设计和实现，大大提升了对postgre数据库的掌握。 认识到事先划分用户权限、建立起权限控制模型的重要性，有利于后续SQL语句编写的准确度，防止遗漏。 实验确实数据库备份和恢复环节，建议以后数据库实验中可加入这两个环节，丰富学生对数据库使用的知识。",
  "studentID": "2017221105003"
 },
 "15": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221105004      姓    名       邵安琦          （实验）\t课程名称   数据库原理及应用    理论教师       张凤荔          实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：邵安琦\t\t学号：2017221105004   指导教师：何中海 实验地点：信软楼西306                 实验时间：2019.05.20 实验名称：图书销售管理系统数据库SQL应用编程 实验学时：5 三、实验目的： 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理： 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过SQL编程执行来完成对数据库的实现操作。在本实验中，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建,并编写SQL语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容： \t使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: \t1.在数据库服务器中，执行SQL创建图书销售管理系统数据库BookSale。 \t2.在数据库BookSale中，执行SQL创建数据库表、视图、索引等对象。 3.在数据库BookSale中，执行SQL进行数据增、删、查、改访问操作。 4.在数据库BokSale中，采用PL/pgSQL语言编写存储过程函数Pro_CurentSale， 实现当日图书销售量及销售金额汇总统计。 \t5.在数据库BookSale中，采用PL/pgSQL语言编写过程语句块，实现对存储过程函数Pro_CurrentSale 的调用，并输出统计结果。 \t6.在数据库BookSale中，采用PL/pgSQL语言编写编写图书销售表Insert触发器Tri_InsertSale,实现图书库存数据同步修改处理。 \t7.在数据库BookSale中,对图书销售表Insert 触发器Tri_InsertSale 程序进行功能验证。 8.在数据库BookSale中，创建存储过程函数实现图书销售数量和金额统计。在实验计算机上，利用pgAdmin4数据库管理工具及SQL、PL/pgSQL 语言，完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： \t“数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，r pc计算机与服务器在同--局域网络。 \t操作系统: Windows7 / Windows XP \t管理工具: pgAdnin4 DBMS系统:  PostgreSQL 11 七、实验步骤： \t1.在数据库服务器中，采用SQL语句执行方式，创建图书销售管理系统数据库BookSale。 \t2.在BookSale数据库中，采用SQL语句执行方式，创建book (图书表)、auther (作者表)、publisher (出版社表)、stock (库存流水表)、customer (客户表)、sale (销售表)，以及各表主键外键的创建， 并为给表创建索引。 \t3.为book、 auther、 publisher、 customer 表准备样本数据，采用SQL语句执行方式，将样本数据插入到表中。采用SQL语句对book、auther、 publisher、customer 表进行数据修改、删除、查询、统计等访问操作。 \t4创建视图BOOK_ AUTHER PUBLISHER,该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图Book View进行数据查询访问操作。 \t5.编写触发器函数，实现在sale表数据插入时，级联操作stock表，将图书的库存流水进行记录，同时级联更新book表中对应图书的库存数据。 \t6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 \t7.测试触发器的功能，准备sale 表的样本数据，并将其插入sale表，插入之后查看stock表是否有对应的更新，并对比插入sale 数据前后book中对应数据:的修改情况。 8编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） \t1、创建BookSale数据库 \t实现思路与方法：使用SQL语句来进行数据库的创建 \tSQL语句：create database “BookSale” \t运行操作界面如图1-1所示。 图1-1创建数据库 \t数据库操作结果面如图1-2所示。 图1-2数据库创建完成 \t结果分析：成功创建数据库。 \t2.创建各数据库表以及表中外键和索引 \t实现思路与方法:首先明确图书销售管理系统的实体、实体属性以及各实体之间的联系，再通过SQL语句对表进行创 建，表对应实体，实体属性对应表中的列，通过主外键来将表联系起来。 \tSQL语句: create table Auther _2017221105004 (   \tAU_ID  \t\tCHAR(18) \t\tnot null,   \tAU_Name \t\tVARCHAR(20) \tnot null, \tAU_Gender  \tCHAR(2) \t\tnot null, \tAU_Phone \t\tVARCHAR(11) \tnot null, \tAU_Address \tVARCHAR(50) \tnot null, \tconstraint \t\tPK_AUTHER \tprimary key (AU_ID) ); create table Book_2017221105004 ( \tBook_ISBN \tCHAR(13) \t\tnot null, \tAU_ID \t\tCHAR(18) \t\tnull, \tPUB_ID \t\tCHAR(11) \t\tnull, \tBook_Name \tVARCHAR(50) \tnot null, \tBook_Pubdate\t DATE \t\tnot null, \tBook_Price \t\tMONEY \t\tnot null, \tBook_Category \tVARCHAR(20) \tnot null, \tBook_Stock \tINT4 \t\t\tnot null, \tBook_Notes \tVARCHAR(100) \tnull, \tBook_List \t\tVARCHAR(100) \tnull, \tconstraint \t\tPK_BOOK \t\tprimary key (Book_ISBN) ); create table CUSTOMER_2017221105004 ( \tCUST_ID \t\tCHAR(18) \t\tnot null, \tCUST_Name \tVARCHAR(20) \tnot null, \tCUST_Phone \tVARCHAR(15) \tnot null, \tCUST_Address \tVARCHAR(50) \tnot null, \tCUST_Email \tVARCHAR(50) \tnot null, \tconstraint \t\tPK_CUSTOMER \tprimary key (CUST_ID) ); create table Publisher_2017221105004 ( \tPUB_ID \t\tCHAR(11) \t\tnot null, \tPUB_Name \t\tVARCHAR(20) \tnot null, \tPUB_Phone \tVARCHAR(15) \tnot null, \tPUB_Address \tVARCHAR(50) \tnot null, \tconstraint \t\tPK_PUBLISHER \tprimary key (PUB_ID) ); create table Sale_2017221105004 ( \tSALE_ID \t\tVARCHAR(11) \tnot null, \tBook_ISBN \tCHAR(13) \t\tnull, \tCUST_ID \t\tCHAR(18) \t\tnull, \tSALE_Date \tDATE \t\tnot null, \tSALE_QTY \tINT4 \t\t\tnot null, \tSALE_Amount \tMONEY \t\tnot null, \tconstraint \t\tPK_SALE \t\tprimary key (SALE_ID) ); create table Stock_2017221105004 ( \tStock_ID \t\tVARCHAR(10) \tnot null, \tBook_ISBN \tCHAR(13) \t\tnull, \tStock_Change \tINT4 \t\t\tnot null, \tStock_Operation \tCHAR(4) \t\tnot null, \tStock_Datetime \tDATE \t\tnot null, \tconstraint \t\tPK_STOCK \t\tprimary key (Stock_ID) ); alter table Book_2017221105004 \tadd constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) \treferences Auther_2017221105004 (AU_ID) \ton delete restrict on update restrict; alter table Book_2017221105004 \tadd constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) \treferences Publisher_2017221105004 (PUB_ID) \ton delete restrict on update restrict; alter table Sale_2017221105004 \tadd constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) \treferences Book_2017221105004 (Book_ISBN) \ton delete restrict on update restrict; alter table Sale_2017221105004 \tadd constraint FK_SALE_CUSTOMER__CUSTOMER foreign key (CUST_ID) \treferences CUSTOMER_2017221105004 (CUST_ID) \ton delete restrict on update restrict; alter table Stock_2017221105004 \tadd constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) \treferences Book_2017221105004  (Book_ISBN) \ton delete restrict on update restrict; 将上面的SQL程序，提交到数据库服务器执行，其执行界面如图1-3所示。 图1-3 创建数据库表SQL程序执行结果 \t当SQL程序成功执行后，可以在数据库看到新添加的数据库表对象，如图 1-4所示。 图1-4 新添加的数据库表对象 \t结果分析：成功创建各数据库表。 \t3.插入样本数据并对publisher表进行增删查改操作 \t实现思路与方法：首先准备样本数据，尽可能使得数据符合实际应用并且要 能满足后续的数据处理操作。这里以 publisher 表为例，给出该表的数据增、删、 查、改 SQL 语句操作访问。  执行 SQL 语句，插入样本数据到图书销售数据库 Insert into Auther_2017221105004 values('330309198504150527','莫言','男','13554874593','四川省成都市成华区建设北路二段十号'); Insert into Auther_2017221105004 values('540135199103281548','刘慈欣','男','15812387538','浙江省杭州市天路区梅田路二十八号'); Insert into Auther_2017221105004 values('120857198811123587','路遥','女','18575615472','北京市朝阳区梅山路二巷八号'); Insert into PUBLISHER_2017221105004 values('PUB00000001','高等教育出版社','010-65321854','北京'); Insert into PUBLISHER_2017221105004 values('PUB00000002','电子工业出版社','010-65329857','北京'); Insert into PUBLISHER_2017221105004 values('PUB00000003','人民邮电出版社','010-65325987','北京'); Insert into BOOK_2017221105004 values('9787115502742','330309198504150527','PUB00000001','红高粱家族','2016-01-01', '59','文学','100'); Insert into BOOK_2017221105004 values('9875325415577','540135199103281548','PUB00000002','三体','2008-01-01', '52','文学','200'); Insert into BOOK_2017221105004 values('9865365975234','120857198811123587','PUB00000003','平凡的世界','2013-08-1','29','文学', '150'); Insert into customer_2017221105004 values('680554199207120325','蔡徐坤','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insert into customer_2017221105004 values('345021198608120258','吴亦凡','18636598574','浙江省杭州市天路区梅田路二十九号','657873215@qq.com'); Insert into customer_2017221105004 values('542244197812121687','杨超越','13615869875','北京市朝阳区梅山路二巷十六号','647864378@qq.com'); 图1-5插入样本数据SQL程序执行 \t查看publisher表数据的SQL语句如下： \t\tSelect * from publisher_2017221105004; \t运行该SQL语句，其执行结果如图1-6所示。 图 1-6 查询 publisher_2017221105004 表数据 结果分析：插入表数据成功无误。   增加一条数据到 publisher_2017221105004 表 SQL 语 句 ：  Insert into PUBLISHER_2017221105004  values('PUB00000004',' 清 华 大 学 出 版 社 ','010-65323169','北京');  运行操作界面如图 1-7 所示。 图 1-7 插入一条新数据到 publisher_2017221105004 表 \t执行结果如图 1-8 所示。 图 1-8 查询插入新数据之后的 publisher_2017221105004 表 结果分析：插入表数据成功。   3）删除一条 publisher 表数据 SQL 语句： delete from publisher_2017221105004 where pub_id = 'PUB00000004'; 运行操作界面如图 1-9 所示。 图 1-9 删除 publisher_2017221105004 表的一条数据 其执行结果如图 1-10 所示。 图 1-10 查询删除数据后的 publisher_2017221105004 表 结果分析：确实删除掉了对应的 pub_id 的数据，删除操作执行成功。   修改一条 publisher_2017221105004 表数据  SQL 语句：update publisher_2017221105004 set pub_address = '南京' where pub_id = 'PUB00000003';  该语句运行操作结果如图 1-11 所示。 图 1-11 更新 publisher_2017221105004 表的一条数据 再对 publisher_2017221105004 进行查询，其执行结果如图 1-12 所示。 图 1-12 查询更新数据后的 publisher_2017221105004 表 结果分析：对应 pub_id 的数据确实被成功修改。  4.创建视图  实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数 据查询。创建完视图之后可用select语句来查看视图，用法：select * from 视图名。例如，创建视图 BOOK_AUTHER_PUBLISHER_2017221105004 实现图书信息查询，其 SQL 语句如下：  create view BOOK_AUTHER_PUBLISHER_2017221105004 as  select B.book_name as \"图书\",AU.au_name as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\"  from book_2017221105004 as B join auther_2017221105004 as AU on B.au_id = AU.au_id  join publisher_2017221105004 as PU on B.pub_id = PU.pub_id 该 SQL 运行操作结果如图 1-13 所示： 图1-13创建视图 \t采用如下 SQL 语句实现视图数据查询：  select * from BOOK_AUTHER_PUBLISHER_2017221105004;  该 SQL 语句执行结果如图 1-14 所示。 图 1-14 查看视图 结果分析：视图展示数据对应正确且按需展示，视图创建成功。 5.创建触发器函数  实现思路与方法：创建触发器函数实现在有一条销售数据插入 sale 表时，同 时在库存表 stock 中插入图书的库存变化记录，并修改对应图书表 book 的库存 数，为后续的创建触发器提供函数方法。  创建触发器函数 SQL 语句：  CREATE OR REPLACE FUNCTION InsertSale_2017221105004() RETURNS TRIGGER AS $$  \tBEGIN  \t\tIF (TG_OP = 'INSERT') THEN  \t\t\tINSERT INTO stock_2017221105004 values(new.sale_id,new.book_isbn,new.sale_qty,'出库',new.sale_date); \t\t\tupdate book_2017221105004 set book_stock = book_stock - new.sale_qty where book_isbn = new.book_isbn;  \t\t\tRETURN NEW;  \t\tEND IF;  \t\tRETURN NULL;  \tEND; $$ LANGUAGE plpgsql; 运行操作界面如图 1-15 所示。 图1-15创建触发器函数 6. 创建触发器  实现思路与方法：创建触发器，关联销售表，在销售表插入一个新数据之后， 执行上一步编写的触发器函数。  创建触发器SQL语句： CREATE TRIGGER Tri_InsertSale_2017221105004 AFTER INSERT ON SALE_2017221105004 FOR EACH ROW EXECUTE PROCEDURE InsertSale_2017221105004();  运行操作界面如图 1-16 所示。 图 1-16 创建触发器  7. 测试触发器  实现思路与方法：在销售表中插入几个样本数据，之后再查看库存表和图书 表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插 入销售表的数据一致。  测试触发器 SQL 语句： Insert into sale_2017221105004 values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885');  Insert into sale_2017221105004 values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040');  Insert into sale_2017221105004 values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450');  运行操作界面如图 1-17 所示。 图 1-17 测试触发器 结果展示，查看 stock_2017221105004 表数据以及对比book_2017221105004表数据。 select * from public.stock_2017221105004;  表数据如图 1-18 所示。 图 1-18 查看测试触发器之后的 stock 表数据  Book 表之前的数据如图 1-19 所示。 图 1-19 查看 book 表在测试触发器之前的数据 触发器执行之后的 book 表数据如图 1-20 所示。 图 1-20 查看 book 表在测试触发器之后的数据 结果分析： Stock 表本来没有数据，在 sale 插入数据之后，将库存数据进行记录，记录数据 正确，同时更新了 book 表中各对应图书的库存量，更新数据正确，触发器功能 实现正确。  8. 创建存储过程  实现思路与方法：通过存储过程实现某日图书销售数量和金额统计。创建存储过程的 SQL 语句如下。 CREATE OR REPLACE FUNCTION countsale_2017221105004(OUT amount int,OUT allmoney money) as $count$  BEGIN   \tselect sum(sale_qty) into amount FROM sale_2017221105004 WHERE sale_date = '2019-05-20';  \tselect sum(sale_amount) into allmoney FROM sale_2017221105004 WHERE sale_date = '2019-05-20';  END;  $count$ LANGUAGE plpgsql; 该 SQL 语句运行操作界面如图 1-21 所示。 图 1-21 创建存储过程  9. 调用存储过程  实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况 一致，调用存储过程 SQL 语句如下：  Select * from countsale_2017221105004();  存储过程调用语句执行结果如图 1-22 所示。 图 1-22 调用存储过程 结果分析：调用存储过程输出的总销售量和总金额数据正确，存储过程功能正确。  九、总结及心得体会： \t在学习SQL编程的触发器编程和函数编程的过程中，我对书中的内容一知半解，并不能完全掌握其中的原理，但是通过此次实验，不光加深了我对与SQL编程的见解还让我触发器的编写和函数创建有了深刻理解。这过程让我不禁想起故人层云：纸上得来终觉浅，绝知此事要躬行。无论是学习还是工作，都不能仅仅停留于书本，还要有实践，尤其是工科，触发器和函数的并用，让数据能够实现级联更新、删除，方便了数据库管理员的操作。在学习和生活中，都应该要注重实践，当然前提是要掌握好书本知识。 十、对本实验过程及方法、手段的改进建议： \t暂无                                                  报告评分：                                          指导教师签字： \n 电 子 科 技 大 学 实   验   报   告 学生姓名：邵安琦\t\t学号：2017221105004   指导教师：何中海 实验地点：信软楼西306     实验时间：2019.05.27 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时： 三、实验目的： 了解DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库 数据的安全性。  2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派 角色。  3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作 的时候就会受到不同程度的制约。 五、实验内容： 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全 管理，具体实验内容如下:  1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。  3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色 赋予数据库对象权限。  4.在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。  5.分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、 商家（R_Seller）角色。  6.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理 数据库，验证所实现数据存取权限控制模型的正确性。  在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL 语句，完成图书销 售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等 数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以 及网络环境，pc 计算机与服务器在同一局域网络。  操作系统： Windows7 / Windows XP  管理工具： pgAdmin4  DBMS 系统： PostgreSQL 11 七、实验步骤： 1.针对图书销售管理系统，在设计数据存取权限控制模型。  2.在 pgAdmin4 中的BookSale数据库中使用SQL语句创建客户（R_Customer）角色、商家（R_Seller）角色。  3.在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。  4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 6. 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.针对图书销售管理系统，设计数据存取权限控制模型。  实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家， 客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水 信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有 查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有 所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以 对库存表只有查看权限。他们的数据库存取访问权限控制模型设计如图 2-1 与图 2-2 所示。  图2-1 客户角色安全模型 图2-2 商家角色安全模型  2.创建客户角色和商家角色  实现思路与方法：使用 SQL 语句进行角色创建，因为客户角色和商家角色 都是普通角色，因此除了登录的功能之外其他的高级权限都为 no。  创建客户角色的 SQL 语句： CREATE ROLE \"R_Customer\" WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1  创建客户角色的 SQL 运行界面如图 2-3 所示。 图2-3 创建客户角色 创建商家角色的 SQL 语句：  CREATE ROLE \"R_Seller\" WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1  创建商家角色的运行界面如图 2-4 所示。    图2-4 创建商家角色 创建两个角色的结果展示如图 2-5 所示。 图2-5 完成创建两个角色 结果分析：在角色用户表中看到 R_Customer,R_Seller，角色创建成功。  3.赋予客户、商家角色权限 实现思路与方法：使用 SQL 语句给两个角色赋予在步骤 1 定义的权限。  赋予客户角色 SQL 语句： GRANT SELECT ON book_2017221105004 TO \"R_Customer\"; GRANT SELECT ON auther_2017221105004 TO \"R_Customer\"; GRANT SELECT ON publisher_2017221105004 TO \"R_Customer\";  运行界面如图 2-6 所示。 图2-6 赋予客户角色权限 赋予商家角色 SQL 语句：  GRANT SELECT,INSERT,UPDATE,DELETE ON book_2017221105004 TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON auther_2017221105004 TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON publisher_2017221105004 TO \"R_Seller\";  GRANT SELECT ON stock_2017221105004 TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON sale_2017221105004 TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON customer_2017221105004 TO \"R_Seller\"; 运行界面如图 2-7 所示。 如图 2-7 赋予商家角色权限,结果分析：权限赋予成功。 4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们  实现思路与方法：使用 SQL 语句创建用户，并将对应的角色赋予他们。其 SQL 语句如下。  CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '123456'; CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456';  SQL 运行界面如图 2-8 所示。 图 2-8 创建两个用户 运行结果如图 2-9 所示。 图 2-9 完成创建两个用户 结果分析：在角色用户表中发现 U_Customer,U_Seller，创建用户成功。  5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限 成功。  实现思路与方法：用客户用户和商家用户进行登录，通过对各表进行增删查 改操作来观察操作结果来验证是否与赋予他们的权限一致。 首先我们来登录客户用户来进行测试。 登录客户用户如图 2-10 所示。 图 2-10 登录客户用户 测试一：查看 book_2017221105004 表  SQL 语句：select * from book_2017221105004; 运行界面和结果展示如图 2-11 所示。 图 2-11 客户用户查看 book_2017221105004 表数据 结果分析：客户用户可查看 book_2017221105004 表，权限正确。   测试二：删除 book_2017221105004 表中的数据 SQL 语句：delete from book_2017221105004 where book_isbn = '9787115502742'  运行界面和结果展示如图 2-12 所示： 图 2-12 客户用户删除 book_2017221105004 表数据 结果分析：删除失败，客户用户不具有删除 book 表中数据的权限，权限正确。   测试三：查看 auther_2017221105004 表  SQL 语句：select * from auther_2017221105004  运行界面和结果展示如图 2-13 所示。 图 2-13 客户用户查看 auther_2017221105004 表 结果分析：客户用户可查看 auther_2017221105004 表，权限正确。   测试四：插入一条数据到 auther 表中  SQL 语句：insert into auther_2017221105004 values('330304198802150325','李天','男','12365748953','北京 市产阳区李二路 18555 号')  运行界面如图 2-14 所示。 图 2-14 客户用户插入一条新数据到 auther_2017221105004 表 结果分析：客户用户无法在 auther 表中插入数据，权限正确。  测试五：查看 sale_2017221105004 表  SQL 语句：select * from sale_2017221105004 运行界面如图 2-15 所示。 图 2-15 客户用户查看 sale_2017221105004表 结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过， 测试客户用户的权限正确。  测试完客户用户之后，我们登录商家用户来进行下一步的测试。  登录商家用户如图 2-16 所示。 图 2-16 登录商家用户 测试一：查看 customer_2017221105004  SQL 语句：select * from customer_2017221105004    运行界面和结果展示如图 2-17 所示。 图 2-17 商家用户查看 customer_2017221105004 表 结果分析：商家用户具有查看客户表的权限，权限正确。   测试二：插入一条数据到 auther_2017221105004 中  SQL 语句：insert into auther_2017221105004 values('330304198802150324','李天','男','12365748953','北京 市产阳区李二路 18555 号')  运行界面如图 2-18 所示。 图 2-18 商家用户插入一条新数据到 auther_2017221105004 表 通过查看 auther_2017221105004 表进行结果展示如图 2-19 所示。 图 2-19 商家用户查询插入一条新数据后的 auther_2017221105004 表 结果分析：auther_2017221105004 表中新增了如上插入的数据，商家用户具有插入 auther_2017221105004 表数据的权限，权限正确。   测试三：从 stock_2017221105004 表中删除一条数据  SQL 语句：delete from stock_2017221105004 where stock_id = 'SA00001' 运行界面如图 2-20 所示。  图 2-20 商家用户删除一条 stock_2017221105004 表数据 结果分析：商家用户不具有删除 stock_2017221105004 表数据的权限，权限正确。   测试四：更新 sale_2017221105004 表的一条数据  SQL 语句：UPDATE sale_2017221105004 SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001'  运行界面如图 2-21 所示。 图 2-21 商家用户更新一条 sale 表数据 结果展示，通过查看 sale 来查看结果如图 2-22 所示。 图 2-22 商家用户查看 sale 表数据 结果分析：sale 表中对应的数据被修改正确，商家用户具有修改 sale 数据的 权限，权限正确。通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确。  九、总结及心得体会： \t在本次实验中，我熟练掌握了数据库的角色和用户创建，并且能够对所创建的角色、用户对于数据库的操作权限进行限制，通过此次实验，我对从书本上学到的知识进行熟练的运用，让我的SQL编程能力有了提升，不禁让我想起故人层云：纸上得来终觉浅，绝知此事要躬行。编程能力的提升不能仅局限于书本上的知识，还要多实践，俗话说，实践出真知，并不是没有道理，通过实验，将课本上的知识运用到工程中，是对自己能力的一种认证，实验操作让我们对数据库编程有了更深刻的体会。 十、对本实验过程及方法、手段的改进建议： \t暂无。                                                  报告评分：                                          指导教师签字： ",
  "studentID": "2017221105004"
 },
 "16": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t 实验时间：2019/5/20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 PgAdmin4的使用方法，SQL语言DDL、DML、DQL类型语句的使用方法，数据库语言的编程方法（存储过程，函数触发器等使用）。 该数据库对于给定的应用环境,利用计算机的基础知识、软件工程的原理和方法、程序设计的方法和技巧、数据库的基本知识、数据库设计技术、应用领域的知识等多学科综合知识与技术,对网上图书销售管理数据库做了需求分析,概念结构设计,逻辑结构设计,物理结构设计和Oracle数据库实施。最终设计出了一个简单的可对其进行用户管理、图书管理、进货管理,销售管理和售后管理的网上图书销售管理数据库,使之能够有效地管理和存储数据,满足一些简单的应用需求 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 （1）图书销售管理系统数据库BookSale创建操作    （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象    3、创建索引  创建索引  插入数据    （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 增加单个数据   删除数据   查找  改   （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。                  （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。     （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。                            （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 最开始的数据                         第七项数据改变     九、总结及心得体会 在本次数据库的课程设计中，我制作出了图书管理系统。我在图书管理系统的制作过程中，学到了很多数据库和用Pgadmin实现窗体的知识，提高了动手编程的能力。在此期间，我遇到了很多困难,但通过请教老师和同学把困难解决了。我意识到自己在编程方面还有不少缺陷，因此，我要再接再厉，努力学习编程的相关知识，进一步提高自己的能力，非常感谢帮助我的同学。 通过这次课程设计，我发现自己对SQL的学习还是非常不够的。我了解了PostgreSql数据库的一些使用方法和PgAdmin4的一些使用技巧。掌握SQl语言中一些基本的语句，如创建数据库，创建数据表，索引，视图；还有对数据库的一些增删改查的操作；还有存储过程和函数的定义，创建和编写和初步使用；触发器的创建和相应适应方式。 此次课程设计是对我们这--学期所学知识的一-次总结，也是一次检验，更是我们对自己的一次挑战。在以后的学习生活中，我一定牢记此次课程设计的经验，努力实践，绝不轻言放弃。不断的提高和完善自己，争取做得更好                               电 子 科 技 大 学 实   验   报   告 一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306  \t  实验时间：2019/5/20 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 PostgreSQl数据库角色管理、用户管理、权限管理的基本方法 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 说明：本节需学生编写内容。学生应针对本实验，给出具体实验步骤内容。 八、实验数据及结果分析 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。  （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。   （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。   （5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 U_Customer分别读取，插入，修改，删除    接下来验证没有任何权限的表  现在对R_Saler进行验证 无权更改author表  可以访问sale表并且进行插入修改删除    九、总结及心得体会 此次课程设计是对我们这--学期所学知识的一-次总结，也是一次检验，更是我们对自己的一次挑战。通过这次课程设计，我发现自己对SQL的学习还是非常不够的。但我通过自己的努力，独立完成了这次的设计。从构思到设计，虽然我做得不是很好，但我在自己摸索的过程中学到了很多东西。在系统设计中，我遇到了很多困难，特别是操作过程中遇到很多问题。从开始的无从下手，到慢慢入手，我一步一个脚印从无到有学会了很多。因此，我懂得了，只有不断的实践才是成功的关键。在以后的学习生活中，我一定牢记此次课程设计的经验，努力实践，绝不轻言放弃。不断的提高和完善自己，争取做得更好。     ",
  "studentID": "2017221105005"
 },
 "17": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西304、306     实验时间：2019.05.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1. 数据库模式定义语言DDL 数据库模式定义语言DDL(Data Definition Language)，是用于描述数据库中要存储的现实世界实体的语言。 CREATE DATABASE 创建数据库 CREATE TABLE 创建数据库表格 ALTER TABLE 修改数据库表格 DROP TABLE 删除数据库表格 CREATE VIEW 创建查询命令 ALTER VIEW 修改查询命令 DROP VIEW 删除查询命令 TRUNCATE TABLE 删除数据表内容 2. 数据操纵语言DML 数据操纵语言（Data Manipulation Language, DML）是SQL语言中，负责对数据库对象运行数据访问工作的指令集，以INSERT、UPDATE、DELETE三种指令为核心，分别代表插入、更新与删除，是开发以数据为中心的应用程序必定会使用到的指令，因此有很多开发人员都把加上SQL的SELECT语句的四大指令以“CRUD”来称呼。 DML 的主要功能即是访问数据，因此其语法都是以读取与写入数据库为主，除了INSERT以外，其他指令都可能需搭配WHERE指令来过滤数据范围，或是不加WHERE指令来访问全部的数据。 INSERT是将数据插入到数据库对象中的指令，可以插入数据的数据库对象有数据表以及可更新查看表两种。 UPDATE 指令是依给定条件，将匹配条件的数据表中的数据更新为新的数值。 DELETE 指令为自数据库对象中删除数据的指令。 \t3. 数据查询语言DQL \t\t标准语法： 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.图书销售管理系统数据库BookSale创建操作。 2.在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 \t\t(1). 设计概念数据模型设计 \t\t(2). 设计逻辑数据模型设计 \t\t(3). 设计物理数据模型设计 \t\t(4). PostgreSQL实现图书销售管理系统创建 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 1.图书销售管理系统数据库BookSale创建操作如图1-1所示。  图1-1 图书销售管理系统数据库BookSale的创建 2. 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 \t\t(1). 设计概念数据模型设计 \t\t\t抽取出数据需求对象，标识为如图2-1-1所示的实体。  图2-1-1 图书销售管理系统实体 通过分析上述实体对象之间在图书销售管理系统中的相关性，表示实体之间的关系，采用E-R模型的联系元素符号表示这些实体之间的联系，如图2-1-2所示。  图2-1-2 图书销售管理系统的实体联系 在以上概略的E-R模型图基础上进一步细化设计，确定各个实体的属性，如图2-1-3所示。  图2-1-3 图书销售管理系统实体细化 针对图2-1-3所示的图书销售管理系统E-R模型，我们可以分析出该模型存在实体及联系遗漏情况，如用户在数据库中无法了解某些商店有那些图书，也无法了解各商店中图书的库存。因此需要对该E-R模型进行完善，增加“库存”实体，并与“图书”和“商店”实体建立联系。此外，为了便于客户按图书类别进行商品信息浏览或查询，在原数据模型的基础上，增加了“图书类别”实体，并将它与“图书”实体建立联系。完善之后的系统E-R模型图如图2-4所示。  图2-1-4 完善之后的图书销售管理系统E-R模型 \t\t(2). 设计逻辑数据模型设计 将图2-1-4所示的图书馆销售管理系统概念数据模型转换设计为逻辑数据模型，如2-2-1所示。  图2-2-1 初步的图书销售管理系统逻辑数据模型 通过分析图2-2-1所示的图书销售管理系统逻辑数据模型，可以看到该模型的“作者”实体不符合关系数据库设计规范的3NF范式，其中的“省”和“城市”属性存在传递以来。此外，新引入的关联实体“编著”的名称不要确切，其属性仅仅只有所依赖实体的标识符，缺少自身属性。因此，需要对该逻辑数据模型进行规范化完善设计，其设计结果如图2-2-2所示。  图2-2-2 完善后的图书销售管理系统逻辑数据模型 (3). 设计物理数据模型设计 在图2-2-2所示的图书销售管理系统逻辑数据模型基础上，进行E-R模型到关系模型转换，从而给出图书销售管理系统的物理数据模型设计方案，其设计结果如图2-3-1所示。  图2-3-1 图书销售管理系统物理数据模型 所涉及的图书销售管理系统物理数据模型，只有两种模型符号――“关系表”符号和“参照完整性”符号，这些符号将数据库表对象的组成结构描述出来。该模型是数据库表对象的可视化展现。通过物理数据模型图可直观地了解数据库的表结构设计，以及表间关系。 (4). PostgreSQL实现图书销售管理系统创建 在psql中键入上面的SQL语句之后，打开pgAdmin 4，查看表创建情况，如图2-4-1所示。  图2-4-1 表创建结果 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 \t按照表3-1进行对地区的增添。 表1-1 地区信息表 \t在SQL Shell中键入如下代码： \t结果如图3-1所示：  图3-1 地区增添结果 \t按照表3-2对作者进行增添。 表3-2 作者信息表 \t在SQL Shell中键入如下代码： \t结果如图3-2所示：  图3-2 作者增添结果 \t按照表3-3对出版社进行增添。 表3-3 出版社信息表 \t在SQL Shell中键入如下代码： \t结果如图3-3所示：  图3-3 出版社增添结果 \t按照表3-4对图书类别进行增添： 表3-4 图书类别信息表 \t在SQL Shell中键入如下代码： \t结果如图3-4所示：  图3-4 图书类别增添结果 \t按照表3-5对图书进行增添。 表3-5 图书信息表 \t在SQL Shell中键入如下代码： \t结果如图3-5所示。  图3-5 图书增添结果 \t按照表3-6对编著排名表进行增添。 表3-6 编著排名信息表 \t在SQL Shell中键入如下代码： \t结果如图3-5所示。  图3-6 编著排名增添结果 \t按照表3-7对书店表进行增添。 表3-7 书店信息表 在SQL Shell中键入如下代码： \t结果如图3-7所示。  图3-7 书店表增添结果 \t按照表3-8对库存表进行增添。 表3-8 库存信息表 \t在SQL Shell中键入如下代码： \t结果如图3-8所示。  图3-8 库存增添结果 \t按照表3-9对销售记录进行增添并且同时对库存表进行修改。 表3-9 销售记录信息表 \t在SQL Shell中键入如下代码： \t结果如图3-9所示。  图3-9 销售记录增添和库存更新结果 \t查看对学海书店中的所有书籍库存，在SQL Shell中键入代码： \t运行结果如图3-10所示。  图3-10 学海书店书籍库存查询结果 \t在地区表中插入表3-10数据，再进行删除操作。 表3-10 地区信息表2 \t在SQL Shell中键入如下代码： \t运行结果如图3-11所示。  图3-11 插入删除操作结果 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 \t在SQL Shell中键入如下语句，创建函数： \t运行结果如图3-12所示。  图4-1 函数创建结果 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 \t在SQL中键入如下语句，实现对函数的调用，对2019年3月3日的销售进行统计： \t运行结果如图5-1所示。  图5-1 函数调用结果 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 \t在SQL中键入如下语句，实现触发器的创建： \t运行结果如图6-1所示。  图6-1 创建触发器运行结果 7.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 \t\t在SQL中键入如下代码，尝试触发Tri_InsertSale触发器： \t\t运行结果如图7-1所示。  图7-1 触发器运行结果 九、总结及心得体会 通过本次实验，我学会了在SQL Shell中操作时，最好将SQL代码先在文件中准备完成，这样可以尽可能的减少在编写中的错误，也可以方便的通过复制粘贴或者输入重定向向SQL Shell中键入代码；另外，在SQL Shell中，大小写不敏感，所以变量名要尽量区别，如sale和Sale实际上是一个变量名。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西304、306      实验时间：2017.05.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 创建： CREATE USER和CREATE ROLE的区别在于，CREATE USER指令创建的用户默认是有登录权限的，而CREATE ROLE没有。 创建用户时设定用户属性： 可以通过\\h CREATE ROLE指令查看全部可设置的管理权限。 修改用户属性： 设置访问权限： \\z或\\dp指令显示用户访问权限。 \\h GRANT显示所有可设置的访问权限。 撤销用户访问权限： 其中permission_type和table_name含义与GRANT指令中相同。 创建组示例： 切换ROLE： INHERIT权限： 该属性使组成员拥有组的所有权限。 删除用户和组： 删除用户和组很简单。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 \t数据存取权限控制如表1-1所示，且客户角色和商家角色都有继承、登录和连接权限： 表1-1 数据存取权限表 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 \t在SQL Shell键入如下语句： \t运行结果如图2-1所示。  图2-1 角色创建结果 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 \t在SQL Shell中键入如下语句： \t运行结果如图3-1所示。  图3-1 赋予数据库对象权限结果 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 \t在SQL Shell中键入如下语句： \t运行结果如图4-1所示。  图4-1 用户创建结果 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 分别登陆客户用户U_Customer、商家用户U_Seller，并且在SQL Shell中键入如下代码： \t登录客户用户访问结果如图6-1所示。  图6-1 客户用户访问结果 \t登录商家用户访问结果如图6-2所示。  图6-2 商家用户访问结果 从图6-1可以得知，当客户用户尝试对地区表进行插入、删除和更新操作时，均会返回没有权限的提示信息；当客户用户尝试对地区表进行查询时，结果正常返回。 从图6-2可以得知，当商家用户尝试对地区表进行插入、删除、更新和查询时，均能正常返回信息。 九、总结及心得体会 通过本次实验，我学会了通过合理地分配权限给不同角色，可以减轻数据库设计和编码人员的工作量，给予角色的权限仅能满足其需求即可，而不能给予多余的、对于该用户无用的权限，以此来保证数据库中信息的安全性。 另外，在赋予角色权限时，可以使用如下语句代替需要为用户分配每一个表的某一个权限： 可以使得SQL语句更加简洁明了、容易阅读，也在一定程度上防止了误操作引起的数据库安全问题。",
  "studentID": "2017221105007"
 },
 "18": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t\t\t\t  实验时间：2019-5-20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 在数据库系统中，最大的数据库对象就是数据库本身。SQL提供了数据库对象的创建与维护语句，包括数据库创建、数据库属性修改、数据库删除等。 创建数据库语句格式： CREATE DATABASE <数据库名>  数据库表时数据库中最基础的操作对象。在SQL中，使用数据定义语言语句可完成数据表的创建、表结构修改、表删除等操作。 创建数据库表的基本语句格式为： CREATE TABLE <表名> （<列名1><数据类型>[列完整性约束],   <列名2><数据类型>[列完整性约束]， … ）； 修改数据库表：ALTER TABLE为数据库表修改语句的关键词；其基本语句格式为： ALTER TABLE <表名> <修改方式>; 主要修改方式有ADD（添加）、DROP（删除）、RENAME（重命名）、ALTER（修改数据类型） 删除数据库表，其基本语句格式为：DROP TABLE <表名>  在SQL中，数据操纵语言（DML）是一种对数据库表中数据进行操作的语言集。它以INSERT、UPDATE、DELETE三种语句为核心，分别完成数据的插入、更新与删除操作。数据操作语句是任何数据库应用必定会使用到的数据操作语句。 在SQL中，数据查询语言（DQL）是一种对数据库表进行数据查询访问的语句，该语句在数据库访问中使用最多。在SQL中，实现对数据库表进行数据查询处理的语句只有SELECT语句。虽然只有一种语句，但该类语句功能丰富、组合条件使用灵活。 在SQL中，数据控制语言（DCL）是一类可对用户数据访问权限进行控制的操作语言，它可以控制特定用户或角色对数据表、视图、存储过程、触发器等数据库对象的访问权限，主要由GRANT、REVOKE、DENY语言操作来实现。 存储过程是一种数据库的对象，由一组能完成特定功能的SQL语句集构成。它把经常会重复使用的SQL语句逻辑块封装起来，经编译后，存储过程在数据库服务器端，当再次调用时，不需要再次编译；当客户端连接到数据库时，用户通过制定存储过程的名称并给出参数，数据库就可以找到相应的存储过程并予以调用。 触发器是存储在数据库中的独立对象，它与存储过程不同，存储过程通过其他程序来启动运行或直接启动运行，而触发器由一个事件触发启动运行。也就是说，触发器是在某个事件发生时自动地隐式运行，所以启动触发器执行在某些文献里被称为触发或点火。数据库事件指对数据库的表进行INSERT、UPDATE或DELETE操作。大多数关系数据库支持触发器，但不同数据库在触发器的定义和应用方面可能略有不同。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1）图书销售管理系统数据库BookSale创建操作 2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  八、实验数据及结果分析 （1数据库BookSale的创建 使用powderDesigner完成数据库模型的创建，再使用相关功能生成对应SQL语言代码。  修正后生成代码：  \t（2创建库表、视图、索引： \t\t库表已经在第一步过程中创建，以下为视图、索引的创建。 \t  \t（3进行增、删、查、改操作 \t\t  \t（4编写函数  \t（5函数使用  \t（6编写触发器 \t  \t（7验证触发器 \t1）查看库存 \t2）添加销售内容 \t3）结果检查   九、总结及心得体会 在本次实验中，首次进行了存储过程函数，以及触发器的使用。存储过程函数具有很多优点，在实际实际数据库的过程中，存储过程能够给我们带来许多方便，而触发器也可以在我们完善数据库内容，实现一致性过程中提供帮助。总之，这两中功能对于将来数据库的使用都有很大的帮助，需要较好的掌握。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306\t\t\t\t\t          实验时间：2019-5-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 说明：本节需学生编写内容。学生应根据实验内容，给出完成该实验的具体实验原理。 用户要访问数据库，必须先在DBMS中创建其用户账号，并称为数据库的用户。此后，用户每次连接访问数据库时，都需要在DBMS中进行身份鉴别，只有合法用户才能进入数据库系统，访问操作数据库对象。如在PostgreSQL数据库系统中，用户访问数据库需要用户账号及密码。DBA在数据库中为该用户创建用户账号及初始密码，同时还为用户赋予特定角色及其操作权限。当该用户连接数据库后，便可以进行相应的角色权限的数据库访问操作。 当用户登陆数据库服务器和连接数据库后，它应有一定的数据库对象操作权限，这样才能操作访问数据库对象。用户的数据库对象访问权限由系统管理员进行授予。若系统管理员没由给数据库用户赋予一定的数据库对象操作权限，用户仅仅只能进行基本访问操作。 DBMS一般将用户权限定义为以下两类： （1数据库对象访问操作权限 \t数据库对象访问操作权限指用户在数据库中被赋予的塔顶数据库对象的数据访问操作权限，如对数据库表进行SLEECT\\INSERT\\UPDATE\\DELETE操作的权限。 （2数据库对象定义操作权限 \t数据库对象定义操作权限指用户在数据库中被赋予的数据库对象创建、删除和修改权限，如对数据库表、视图、存储过程、用户自定义函数、索引等对象的创建、删除和修改的操作权限。 在DBMS中，为了方便对众多用户及其权限进行管理，系统通常将一组具有相同权限的用户定义为角色（Role）。不同的角色就代表不同权限集合的用户集合。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1针对图书销售管理系统，设计相关的数据存取权限模型。 （2在数据库中使用SQL语句创建客户（R_Customer）、商家（R_Seller）角色。 （3是数据库中使用GRANT语句为客户角色以及商家角色赋予相应的权限。 （4在数据库中使用SQL语句创建客户用户用户（U_Customer）、商家用户（U_Seller） （5在创建客户用户以及商家用户时，为其各自分配对应的角色。 （6分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理系统。 八、实验数据及结果分析 （1设计数据存器权限模型： \t （2在数据库中使用SQL语句创建客户（R_Customer）、商家（R_Seller）角色。  （3是数据库中使用GRANT语句为客户角色以及商家角色赋予相应的权限。  （4在数据库中使用SQL语句创建客户用户用户（U_Customer）、商家用户（U_Seller）  （5在创建客户用户以及商家用户时，为其各自分配对应的角色。  （6分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理系统。 1)以客户的身份登陆系统： 2）使用客户身份对数据库进行访问： 3）以商家用户身份登陆数据库： 4)使用商家用户进行添加、删除、查找、更新操作：   九、总结及心得体会 \t在本次实验中，主要使用的技术包括角色、用户的创建及其相关权限的授予，总体来说，该次实验内容较少，其中，实验要求的过程为先创建用户，再使其归类为某一种角色，这使得我需要掌握对ALTER ROLE <>相关语句的使用方式。从这次实验中，我实际使用了许多在课堂上学习的内容，也了解了更多的数据库功能，是一次有意义的实验。",
  "studentID": "2017221105010"
 },
 "19": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306           实验时间：     2019-5-20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 \tPgAdmin4是postgresql的配套软件，通过该软件不但可以实现用sql语句管理数据库，还可以用图形化方式管理数据库。 \t本实验用到的SQL有三类，分别是数据定义语言DDL，数据操纵语言DML，数据查询语言DQL，数据控制语言DCL，其中DDL类型语句用于创建数据库，在数据库中创建数据库表、视图、索引，DML语言对图书销售管理系统数据库表进行数据增、删、查、改SQL操作，DCL用于编写函数和触发器。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 1.创建数据库Bookstate \t打开pgadmin后，右键点击databases，create->database,输入Bookstate， 点击save，数据库创建完成。            2.根据物理数据模型创建数据库表 左键点击数据库Bookstate，在bookstate获得焦点之后点击右上角的闪电图标进入sql编写界面。 然后根据物理模型输入建表语句创建数据库。       进入sql编写界面  建表语句                                                                               输入建表语句之后，点击右上角闪电图标执行sql，等待一小会，建表成功，如图所示           建表成功 3.为数据库建立视图和索引 对于“作者编写图书”和“商店出售图书“这两个多对多关系，应该对其建立视图，以方便编程人员操作，而其他的一些视图，因为没有需求，暂时不建立。建立视图sql语句如下                               \t\t接下来是建立索引，因为主键都有聚集索引，所以非特殊情况没必要再在主键额外建立索引，对于这些外键而言，都是需要频繁连接操作的，所以需要建立索引，而那些明显需要查询的字段，比如图书表的书名，商店表的商店表名称，作者表的作者姓名，出版社表的出版社名称，地区表的地区名称。 \t           索引建立sql语句  3.对数据库进行增删查改操作 由于这些表太多了，一个个手动插入太麻烦，而且还要考虑参照完整性，测试也不可避免的需要大量测试数据，这无疑是一个巨大的工作量，于是我编写了一个python脚本用于插入数据（虽然也没节省多少时间，从构思到编写到测试总共花了我3个小时，但是很有趣，比手动插入有意思多了^_^）。 插入 使用python脚本总共向地区表插入120条，作者表插入100条，出版社20条，图书类别15条，书店7条，图书100条，编写排名200到400条，销售1000条， 库存7*100条，折扣100条。                                                                             2.删除 尝试删除图书表中类型码为’43467’的图书。删除成功。  3.修改 尝试修改作者表中作者编码等于’144717805419’的作者名字为“姚思义”      4.编写函数 这个函数要求非常简单，简单到只需要一条sql就可以完成要求，思路是，先根据postgre的内置函数current_date 得到当前日期，因为和销售量和销售额有关的数据都在sale一个表里，所以只需要查找sale表里所有销售日期与current_date相同的行，然后再对其中的销售数量和销售额取和即可并返回即可。  5.调用函数。   6.编写触发器 触发器函数编写思路是，通过触发器内置变量new得到插入的新行的record，然后，根据record里的图书编号和商店编号到库存表里查找到相等的库存记录，再将其修改为原来值减去record中的销售数量即可。 触发器触发时刻应该在插入以后，触发粒度应该是每插入一行就触发一次。   7.测试触发器是否有效 首先查看一下某个商店里的某本书的库存是多少，如图所示。 在’23’商店里图书号为’4346916631354812010792’的图书库存量为154本，现在尝试向销售表里添加一行销售量为20的销售记录。并再次查看该书在该商店的库存量。发现库存量变成了134本，说明，触发器有效，编写成功。 九、总结及心得体会 1.在建表时，一定要先建强实体表，否则一定会建表失败，因为弱实体依赖于强实体，弱实体中一定有强实体的外键，如果先建弱实体表，显然会出现表未定义错误。 2.同样在插入数据时，也一定要先插弱实体表，再插强实体表。 3.视图是一种虚拟表，建立视图可以提高开发人员的开发效率，但不能提高运行效率，视图实际上是一条封装好的sql语句，只不过是在调用的时候执行罢了。 4.建立索引大部分情况下可以提高查询性能，但是一定会减慢修改插入删除速度，也会带来额外磁盘开销，因为数据库除了维护关系表之外还要维护一张索引表；所以建立索引要适当建立，索引分为两种索引，一种是聚集索引，一种是非聚集索引，聚集索引所有表都存在，聚集索引默认情况下其实就是在主键上建立了一个索引，然后物理上以索引顺序储存，当然，以这种方式创建的聚集索引都是没有重复值的索引，在mysql里索引的实现是b+tree，非聚集索引就是我们通常所建的索引。聚集索引和非聚集索引最大的区别就是，聚集索引将数据直接储存在了索引上，索引的顺序也是物理数据的顺序，而非聚集索引是将数据的实际地址或逻辑指针储存在了索引上。因此，聚集索引只能建一个，非聚集索引可以建很多个。 5．这次实验函数的编写较为简单，没有使用各种控制语句，以后的学习中应该对此多加练习。 6.对于group by 语句，group by 语句为分好的每一组返回一行结果。为满足这个要求必须： 1）、在group by 后面出现的字段，在select 前必须出现，或者在聚合函数中。 2）、在select 后出现的字段，要么也在group by 从句中，要么在聚合函数中 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：  \t\t\t\t\t          实验时间：      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 本实验使用pgadmin作为实验工具，编写sql语句进行数据库安全管理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1．根据数据库需求和数据库表确定用户和角色 2. 创建储存控制安全模型 3．在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 4. 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 5. 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 6. 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 7. 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  八、实验数据及结果分析 1.确定用户和角色 这是一个图书销售系统，首先应该至少有客户和商家两个角色，之外，可以看出这不是一个集中式的图书销售系统，存在很多商家，分布在各处，一定要一个管理人员或小组负责管理数据库，因此应该还有一个图书销售系统管理员角色。因此暂时先提取出以下三个角色： 客户 图书销售系统的客户，购买商品的人。 售货员 图书销售系统的售货员，负责售卖商品，添加售货记录等。 系统管理员 负责向系统中添加新图书，修改地区表，增加出版社等。  2.设计储存安全控制模型  客户：    商家：    管理员  3．在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 在pgadmin 脚本执行界面输入角色创建命令，并点击执行即可。                  4. 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对 象权限。             5. 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。                      6. 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。     7. 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。   使用U_Customer 访问数据库：                                 符合要求  使用U_seller访问数据库                               九、总结及心得体会 1，这次实验进行最后一个步骤时，使用命令行登陆postgre总是出错，让我百思不得其解，我明明用户名和密码都输入正确，为什么还是会登陆失败，最后试了很多次，终于发现，只要我在创建角色或用户时名字不用引号包起来，不管你的名字是大写，小写，还是大小写混杂，最后都会被统一成小写，表名同样如此，而且，当你使用时，必须输入全小写的数据库表名或者用户名角色名。然而，对于数据库名却不是这样，你输入的是什么，最后就是什么，不会全转为小写。这是一个小细节，需要注意。  ",
  "studentID": "2017221105011"
 },
 "20": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t\t           实验时间：2019.5.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 所有关系数据库系统都支持结构化查询语言（Structured Query Language）。SQL是一种针对关系数据库操作的标准语言，他包括数据定义、数据操纵、数据查询、数据控制等操作类型语句。 SQL是一种针对关系数据库的通用操作语言，允许用户在关系模型上对数据库进行数据操作处理。在使用SQL炒作数据库时，不要求用户指定数据存储方式，用户仅仅使用简单的SQL语句即可完成数据库的操作访问。此外SQL语句还可以嵌套在许多程序设计编程语言中，实现应用程序对数据库的操作访问。此外，SQL语句还可以嵌套在许多程序设计编程语言中，实现应用程序对数据库访问功能，从而实现灵活、强大的数据处理功能。 数据定义语言（DDL）是一类用于创建与维护数据库对象（如数据库、数据库表、索引、视图、触发器、存储过程等）的SQL语句类型。DDL语句分为CREATE、ALTER与DROP这3类语句，它们分别完成数据库对象的创建、修改、删除等操作处理。 数据操纵语言（DML）是一类对数据库表中数据进行操作的语句集。它以INSERT、UPDATE、DELETE3种语句为核心，分别完成数据的插入、更新与删除处理。数据操纵语句是任何数据库应用必定会使用到的数据操作语句。 数据查询语言（DQL）是一种对数据库表进行数据查询访问的语句，该语句在数据库访问种使用最多。 数据控制语言（DCL）是一类可对用户数据访问权进行控制的操作语句，它可以控制特定用户或角色对数据表、视图、存储过程、触发器等数据库对象的访问权限，主要由GRANT、REVOKE、DENY语句操作来实现。 视图（View）是一种建立在SELETE查询结果集上的虚拟表。视图可以基于数据库表或其他视图来构建，它本身没有自己的数据，而是使用了存储在基础表中的数据。在基础表中的任何改变都可以在视图中看到，同样若在视图中对数据进行了修改，其基础表的数据也要发生变化。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 (1)在本次实验中，采用数据库管理软件pgAdmin运行postgreSQL命令，因此首先需要在实验机上运行数据库服务以及pgAdmin软件。  (2)利用powerDesigner，根据题目需要，对图书销售系统进行设计和建模，分别建立概念数据模型、逻辑数据模型以及物理数据模型。 (3)模型建立完成后，根据相关规则将模型转换为SQL语言，并在pgAdmin运行。 (4)编写实验报告。 八、实验数据及结果分析 （1）图书销售管理系统数据库BookSale创建操作  （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 \t创建地区表 \t 创建作者信息表 \t \t创建出版社信息表  \t创建读书类别表 \t \t创建图书信息表 \t \t创建商店信息表 \t \t创建折扣信息表  \t创建销售信息表 \t \t创建库存信息表 \t \t创建编著排名表 \t 创建视图    \t创建索引 \t \t （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 \t增加地区信息 \t \t增加作者信息  增加出版社信息  增加图书类别信息  增加图书信息  增加商店信息  增加折扣信息  增加销售信息  \t\t增加库存信息 \t\t增加编著排名信息  \t删除编著排名信息3  查询图书ISBN，书名，作者  更改信息  （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额\t。 \t\t创建函数 \t\t \t\t （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 \t调用函数得到结果 \t  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 \t   （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 \t验证功能 \t   九、总结及心得体会 在本实验中，通过对数据库的创建、表的创建、数据的增删查改等操作，初步学习了数据库的相关知识，对数据库体系有了更多了解。 在实验过程中，需注意细节，如在对数据的搜索上。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西306        实验时间：2019.05.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 角色 PostgreSQL使用角色的概念管理数据库访问权限。  根据角色自身的设置不同，一个角色可以看做是一个数据库用户，或者一组数据库用户。  角色可以拥有数据库对象(比如表)以及可以把这些对象上的权限赋予其它角色， 以控制谁拥有访问哪些对象的权限。 操作角色的语句： create role db_role1; /*--创建角色*/ drop role db_role1;  /*--删除角色*/ \\du  --在命令格式下查看所有角色的命令 角色的权限 一个数据库角色可以有很多权限，这些权限定义了角色和拥有角色的用户可以做的事情。 create role db_role1 LOGIN; --创建具有登录权限的角色db_role1 create role db_role2 SUPERUSER; --创建具有超级用户权限的角色 create role db_role3 CREATEDB; --创建具有创建数据库权限的角色 create role db_role4 CREATEROLE --创建具有创建角色权限的角色 alter role db_role1 nologin nocreatedb; --修改角色取消登录和创建数据库权限 用户 其实用户和角色都是角色，只是用户是具有登录权限的角色。 create user db_user1 password '123'; --创建用户 create role db_user1 password '123' LOGIN;  --同上一句等价 drop user db_user1;   --删除用户 alter user db_user1 password '123456'; --修改密码 alter user db_user1 createdb createrole; --对用户授权 赋予角色控制权限 我们可以使用GRANT 和REVOKE命令赋予用户角色，来控制权限。 create user db_user1; --创建用户1 create user db_user2; --创建用户2 create role db_role1 createdb createrole; --创建角色1 grant db_role1 to db_user1,db_user2; --给用户1,2赋予角色1,两个用户就拥有了创建数据库和创建角色的权限 revoke db_role1 from db_user1; --从用户1移除角色1，用户不在拥有角色1的权限 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 编写SQL语句，在pgAdmin执行相关语句，创建实验所需的各种角色； 根据业务规则编写权限分配相关SQL语句，并在数据库中执行； 在创建角色的基础上，编写创建用户SQL语句，在数据库中执行； 以不同身份访问数据库，验证权限控制的正确性； 编写实验报告。  八、实验数据及结果分析 1、数据存取权限控制模型如下： 2、创建客户（R_Customer）、商家（R_Seller）角色SQL如下： 3、根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。SQL如下： 4、在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。SQL如下：  5、分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。SQL如下：  九、总结及心得体会 在本实验中，学习了关于角色、用户、权限功能的编程，作为数据库系统中不可缺少的部分，在对权限的管理上需要尤为注意。 两次数据库实验后，可以基本了解数据库系统的功能及编程实现，对整个数据库系统体系有了较为基本的了解。",
  "studentID": "2017221105013"
 },
 "21": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t           实验时间：2019.5.20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 实验原理 即结构化查询语言(Structured Query Language)，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统；同时也是数据库脚本文件的扩展名。SQL语句无论是种类还是数量都是繁多的，很多语句也是经常要用到的，SQL查询语句就是一个典型的例子，无论是高级查询还是低级查询，SQL查询语句的需求是最频繁的。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1. 创建BookSale数据库 2. 在BookSale数据库中创建下列的表：图书表（book）、作者表（author）、出版社表（publisher）、销售（Sale）、库存（stock）和商店信息表（shop） 3. 对BookSale数据库进行增删查改等操作 4. 编写Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计 5. 编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果 6. 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理 7. 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证 八、实验数据及结果分析 创建数据库： 打开PostgreSQL，选择新建数据库，输入数据库名为BookSale                          创建各个表：                                成功创建各表：        向表中插入数据： 首先添加作者、出版社和商店：     根据外键约束增添图书信息、销售信息和库存信息：     执行删除操作示例：     查看表中的数据，发现编号为’00002’的图书已被删除。     查询操作示例：    查询的结果如图所示：     修改操作示例：     创建视图示例：     视图的结果如下图所示：                向表中再插入一些数据，如下：        运行函数，查询2019-06-02的销售总金额：         创建触发器： 首先编写一个updatestock函数:                  接下来创建触发器：    接下来验证触发器的效果，首先查询原本stock表中的信息：     向sale中插入一条数据：    再次查看stock中的值可以发现，num自动变为991：       九、总结及心得体会 在课堂上，我对数据库的增删查改，创建视图，自定义函数以及创建触发器有了初步的了解。经过这次实验，自己动手操作过后对这些操作有了更加深入的理解和认识，这对我以后的学习和工作非常有帮助。\n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：图书销售管理系统数据库安全管理 实验时间：      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 即结构化查询语言(Structured Query Language)，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统；同时也是数据库脚本文件的扩展名。SQL语句无论是种类还是数量都是繁多的，很多语句也是经常要用到的，SQL查询语句就是一个典型的例子，无论是高级查询还是低级查询，SQL查询语句的需求是最频繁的。 当几个用户需要在某个特定的数据库中执行类似的动作时(这里没有相应的Windows用户组)，就可以向该数据库中添加一个角色(role)。指定了可以访问相同数据库对象的一组数据库用户。 Server的安全体系结构中包括了几个含有特定隐含的角色。除了数据库拥有者创建的角色之外，还有两类预定义的角色。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 第一步：设计数据存取权限控制模型。 第二步：创建客户和商家角色。 第三步：为客户和商家赋予数据库对象权限。 第四步：创建客户用户和商家用户。 第五步：分别为客户用户和商家用户分派角色。 八、实验数据及结果分析 第一步：设计数据存取权限控制模型。 数据库中的用户分别为商家和客户。其中商家拥有对shop表（商店信息）和stock表进行增删查改的权限，对其余的表均只有查询的权限。用户对Sale表有增删查改的权限，但对其他表只有查询权限。 第二步：创建客户和商家角色。             第三步：为客户和商家赋予数据库对象权限。              第四步：创建客户用户和商家用户。          第五步：分别为客户用户和商家用户分派角色。     九、总结及心得体会 通过本次实验，我对数据库的用户权限控制有了新的理解。在以往的学习中我们往往是用单一的root账号来进行服务器的访问和控制，这在实际生产环境下是非常不安全的。划分用户组并对用户权限进行控制是非常有必要的。本次实验获益匪浅。",
  "studentID": "2017221105014"
 },
 "22": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t\t       实验时间：2019/5/20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 PgAdmin4的使用方法，SQL语言DDL、DML、DQL类型语句的使用方法，数据库语言的编程方法（存储过程，函数触发器等使用）。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 \t使用电脑打开pgAdmin4，连接到本地数据库服务器。 \t使用用户界面或SQL语句创建图书管理系统数据库BookSale \t针对图书馆理系统数据库创建合适的模型，导出数据库表SQL语句，创建数据库表。 \t为了简化查询操作，可以建立一些视图，实现存储查询语句。例如联结author，bookRank，book，publisher四个表创建包含图书的ISBN号，书名，作者名，出版社，出版时间的视图 \t创建表的索引，加快表中元组的查找效率。 \t充实数据库，按照关联顺序向数据库表中添加一些数据。 \t做一些修改，查找和删除的SQL操作。 \t编写Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 \t编写过程语句块，实现对函数Pro_CurrentSale的调用，记录结果，与实际结果比对。 \t编写图书销售表Insert触发器Tri_InsertSale，在销售表插入数据之前进行操作，判断若该商店的数据库存充足，则允许数据插入，并同时修改库存信息，否则拒绝信息插入，并返回提示信息。 \t尝试向Insert表插入数据，对触发器Tri_InsertSale进行验证。 八、实验数据及结果分析 1、打开pgAdmin4，在服务器PostgreSQL11创建数据库BookSale，如下图1所示。 \t点击保存，成功创建BookSale数据库，如下图2。 图 1 创建数据库BookSale  图 2 结果截图 \t2、根据物理数据模型设计数据库表，编写SQL语句，创建数据库表，如下图3代码片段以及运行返回结果。 \t 图 3 代码片段和运行返回结果 成功创建10个数据库表，如图4所示。完整代码见代码1。         \t\t\t\t\t\t\t\t代码 1创建数据表（未显示完全）  图 4 数据库表演示  图 5 书籍基本信息视图 为方便了解书籍的基本信息，创建视图，连接author，bookRank，book，publisher四个表的信息，拼接出图书的ISBN号，书名，作者名，出版社，出版时间。代码如上图5所示，结果展示见下图6。  图 6 视图展示 为了方便查询，创建索引，加快检索元组数据，创建book表中ISBN_book和name_book列的索引，和author表中name_author和id_author列的索引。如图7所示，结果展示如图8。  图 7 创建索引  图 8 创建索引结果展示 3、如图9为数据表填充数据。          图 9 添加数据 \t如图10删除表sale中id_sale=6的元组数据。         图 10 删除数据 \t\t如图11查找表sale的所有数据。  图 11 查找表sale的所有数据 \t\t如图12修改表sale中id_sale为5的元组数据，number_sale列值改为3，amount_saling列值改为360。  图 12 修改数据 4、创建Pro_CurrentSale函数，返回当日书店书籍销售量和销售金额的记录数据。  图 13 pro_currentSale函数 5、调用函数pro_currentSale函数，获得统计结果。  图 14 实验结果截图 6、编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。  图 15 触发器Tri_InsertSale 7、验证sale表的触发器Tri_InsertSale，结果如下图16和图17。 \t 图 16 库存不符合时拒绝插入数据  图 17 库存充足时插入数据 九、总结及心得体会 通过本次实验，了解了PostgreSql数据库的一些使用方法和PgAdmin4的一些使用技巧。掌握SQl语言中一些基本的语句，如创建数据库，创建数据表，索引，视图；还有对数据库的一些增删改查的操作；还有存储过程和函数的定义，创建和编写和初步使用；触发器的创建和相应适应方式。 SQL语言不分大小写，若需强制区分大小写可以让标识符加上双引号。 GROUP语句的使用应加强练习，深刻理解其操作原理。 触发器的使用还有很多值得注意的地方，一些内部定义的常量的使用应该多加练习，深刻了解new，old和null返回值的区别。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306\t\t\t          实验时间：2019/5/20      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 PostgreSQl数据库角色管理、用户管理、权限管理的基本方法 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1、针对图书销售管理系统数据库，设计数据存取权限控制模型，设置两类角色，客户和商家，客户仅能查询所有权限内的信息，不能做任何修改操做。商家可以查询所有的表，可以修改store，sale，stock表，删除和添加sale，stock表内容，但不能添加和删除store表内容。 2、在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3、在数据库中，根据步骤1所述为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 4、在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5、使用角色修改语句，分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色，即将对应用户添加到该角色中。 6、分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，进行一些操作来验证权限控制模型的正确性。  八、实验数据及结果分析 1、针对图书销售管理系统数据库，设计数据存取权限控制模型。如图18和19。   2、在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3、按业务规则为角色R_Seller和R_Customer赋予权限，如图21所示。  4、在数据库中，分别创建客户用户U_Customer、商家用户U_Seller，如下图22所示。  5、为用户U_Customer和U_Seller分配相应的角色，如图23。 6、测试数据存取权限控制模型的正确性。 \n  九、总结及心得体会 通过本次实验，了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法。在实验过程中，遇到了很多细节问题，下次应多加注意。为用户分配角色时，若不在创建中分配，而在修改中分配，则可以通过将该用户添加到特定角色的用户集中，若通过修改用户的角色属性，一致未能成功，语法存在问题，通过alter user “U_Customer” set role “R_Customer”  的方法运行成功，但用户并没有得到角色的权限。 ",
  "studentID": "2017221105015"
 },
 "23": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306201722\t\t\t\t\t  实验时间：2019-5-20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 在数据库系统中，最大的数据库对象就是数据库本身。SQL提供了数据库对象的创建与维护语句，包括数据库创建、数据库属性修改、数据库删除等。 创建数据库语句格式： CREATE DATABASE <数据库名>  数据库表时数据库中最基础的操作对象。在SQL中，使用数据定义语言语句可完成数据表的创建、表结构修改、表删除等操作。 创建数据库表的基本语句格式为： CREATE TABLE <表名> （<列名1><数据类型>[列完整性约束],   <列名2><数据类型>[列完整性约束]， … ）； 修改数据库表：ALTER TABLE为数据库表修改语句的关键词；其基本语句格式为： ALTER TABLE <表名> <修改方式>; 主要修改方式有ADD（添加）、DROP（删除）、RENAME（重命名）、ALTER（修改数据类型） 删除数据库表，其基本语句格式为：DROP TABLE <表名>  在SQL中，数据操纵语言（DML）是一种对数据库表中数据进行操作的语言集。它以INSERT、UPDATE、DELETE三种语句为核心，分别完成数据的插入、更新与删除操作。数据操作语句是任何数据库应用必定会使用到的数据操作语句。 在SQL中，数据查询语言（DQL）是一种对数据库表进行数据查询访问的语句，该语句在数据库访问中使用最多。在SQL中，实现对数据库表进行数据查询处理的语句只有SELECT语句。虽然只有一种语句，但该类语句功能丰富、组合条件使用灵活。 在SQL中，数据控制语言（DCL）是一类可对用户数据访问权限进行控制的操作语言，它可以控制特定用户或角色对数据表、视图、存储过程、触发器等数据库对象的访问权限，主要由GRANT、REVOKE、DENY语言操作来实现。 存储过程是一种数据库的对象，由一组能完成特定功能的SQL语句集构成。它把经常会重复使用的SQL语句逻辑块封装起来，经编译后，存储过程在数据库服务器端，当再次调用时，不需要再次编译；当客户端连接到数据库时，用户通过制定存储过程的名称并给出参数，数据库就可以找到相应的存储过程并予以调用。 触发器是存储在数据库中的独立对象，它与存储过程不同，存储过程通过其他程序来启动运行或直接启动运行，而触发器由一个事件触发启动运行。也就是说，触发器是在某个事件发生时自动地隐式运行，所以启动触发器执行在某些文献里被称为触发或点火。数据库事件指对数据库的表进行INSERT、UPDATE或DELETE操作。大多数关系数据库支持触发器，但不同数据库在触发器的定义和应用方面可能略有不同。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1）图书销售管理系统数据库BookSale创建操作 2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  八、实验数据及结果分析 （1数据库BookSale的创建 使用powderDesigner完成数据库模型的创建，再使用相关功能生成对应SQL语言代码。  修正后生成代码：  \t（2创建库表、视图、索引： \t\t库表已经在第一步过程中创建，以下为视图、索引的创建。 \t  \t（3进行增、删、查、改操作 \t\t  \t（4编写函数  \t（5函数使用  \t（6编写触发器 \t  \t（7验证触发器 \t1）查看库存 \t2）添加销售内容 \t3）结果检查   九、总结及心得体会 在本次实验中，首次进行了存储过程函数，以及触发器的使用。存储过程函数具有很多优点，在实际实际数据库的过程中，存储过程能够给我们带来许多方便，而触发器也可以在我们完善数据库内容，实现一致性过程中提供帮助。总之，这两中功能对于将来数据库的使用都有很大的帮助，需要较好的掌握。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306\t\t\t\t\t          实验时间：2019-5-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 用户要访问数据库，必须先在DBMS中创建其用户账号，并称为数据库的用户。此后，用户每次连接访问数据库时，都需要在DBMS中进行身份鉴别，只有合法用户才能进入数据库系统，访问操作数据库对象。如在PostgreSQL数据库系统中，用户访问数据库需要用户账号及密码。DBA在数据库中为该用户创建用户账号及初始密码，同时还为用户赋予特定角色及其操作权限。当该用户连接数据库后，便可以进行相应的角色权限的数据库访问操作。 当用户登陆数据库服务器和连接数据库后，它应有一定的数据库对象操作权限，这样才能操作访问数据库对象。用户的数据库对象访问权限由系统管理员进行授予。若系统管理员没由给数据库用户赋予一定的数据库对象操作权限，用户仅仅只能进行基本访问操作。 DBMS一般将用户权限定义为以下两类： （1数据库对象访问操作权限 \t数据库对象访问操作权限指用户在数据库中被赋予的塔顶数据库对象的数据访问操作权限，如对数据库表进行SLEECT\\INSERT\\UPDATE\\DELETE操作的权限。 （2数据库对象定义操作权限 \t数据库对象定义操作权限指用户在数据库中被赋予的数据库对象创建、删除和修改权限，如对数据库表、视图、存储过程、用户自定义函数、索引等对象的创建、删除和修改的操作权限。 在DBMS中，为了方便对众多用户及其权限进行管理，系统通常将一组具有相同权限的用户定义为角色（Role）。不同的角色就代表不同权限集合的用户集合。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1针对图书销售管理系统，设计相关的数据存取权限模型。 （2在数据库中使用SQL语句创建客户（R_Customer）、商家（R_Seller）角色。 （3是数据库中使用GRANT语句为客户角色以及商家角色赋予相应的权限。 （4在数据库中使用SQL语句创建客户用户用户（U_Customer）、商家用户（U_Seller） （5在创建客户用户以及商家用户时，为其各自分配对应的角色。 （6分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理系统。 八、实验数据及结果分析 （1设计数据存器权限模型： \t （2在数据库中使用SQL语句创建客户（R_Customer）、商家（R_Seller）角色。  （3是数据库中使用GRANT语句为客户角色以及商家角色赋予相应的权限。  （4在数据库中使用SQL语句创建客户用户用户（U_Customer）、商家用户（U_Seller）  （5在创建客户用户以及商家用户时，为其各自分配对应的角色。  （6分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理系统。 1)以客户的身份登陆系统： 2）使用客户身份对数据库进行访问： 3）以商家用户身份登陆数据库： 4)使用商家用户进行添加、删除、查找、更新操作：   九、总结及心得体会 \t在本次实验中，主要使用的技术包括角色、用户的创建及其相关权限的授予，总体来说，该次实验内容较少，其中，实验要求的过程为先创建用户，再使其归类为某一种角色，这使得我需要掌握对ALTER ROLE <>相关语句的使用方式。从这次实验中，我实际使用了许多在课堂上学习的内容，也了解了更多的数据库功能，是一次有意义的实验。",
  "studentID": "2017221105017"
 },
 "24": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t\t\t  实验时间：2019.5.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 分析图书销售管理系统的基本数据需求，使用PowerDesigner建模工具，建立图书销售管理系统的概念数据模型、逻辑数据模型、物理数据模型，并进行规范化处理。针对PostgreSQL数据库实现，在PowerDesigner建模工具中，将该模型转换为SQL脚本程序。在PostgreSQL数据库服务器中，执行该SQL脚本程序，实现图书借阅管理系统数据库对象的创建。 创建完成后，通过pgAdmin4数据库管理工具和SQL语句，完成图书销售管理系统数据库SQL应用编程。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.图书销售管理系统概念数据模型设计 2.图书销售管理系统逻辑数据模型设计 3.图书销售管理系统物理数据模型设计 4.将物理数据模型转换为SQL脚本程序 5.图书销售管理系统数据库BookSale创建操作 6.在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 7.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 8.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 9.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 10.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 11.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  八、实验数据及结果分析 1.图书销售管理系统概念数据模型设计 针对一个图书销售管理系统数据需求，我们可以抽取出“图书”“商店”“销售”“折扣”“作者”“出版社”实体。然后可以对各个实体进行实体属性定义并确定其标识符，最后进行完善得到概念数据模型。              2.图书销售管理系统逻辑模型设计 将图1所示的图书管理销售系统概念数据模型转化设计为逻辑数据模型，如图2所示。                按照概念数据模型与逻辑数据模型转换规则得到的系统逻辑数据模型，可能存在一些不规范的问题，如新导出的关联实体属性不完整、实体对应的关系表不符合数据库设计标准范式等。通过分析图2所示的图书销售管理系统数据模型，可以到看到该模型的“作者”实体不符合关系数据库设计的3NF范式。此外，新引入的关联实体“编著”的名称不太确切。因此对其进行规范化完善设计。设计结果如图3所示。              3.图书销售管理系统物理数据模型设计  4.将物理数据模型转换为SQL脚本程序       图 5 5.创建BookSale数据库 在DMBMS中，执行该SQL脚本程序，实现对数据库对象的创建。       图 7     6. 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象       图 8  7.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作   当数据库对象创建完毕就可以对其进行访问操作 （1）数据插入操作： 对地区表和作者 两个表进行插入数据操作  对出版社进行插入数据操作  INSERT INTO 商店 VALUES ('0123456','新华书店','325200','四川省成都市金牛区人民北路图书大厦F3'); INSERT INTO 图书类别 VALUES ('12345','计算机类'); INSERT INTO 图书 VALUES ('123123123','0123456','12345','计算机操作系统','2014-05-04','54'); INSERT INTO 图书 VALUES ('1231232345','0123457','12345','需求分析与系统设计','2018-04-12','59'); INSERT INTO 库存  VALUES  ('0123456','123123123',100); INSERT INTO 库存  VALUES  ('0123456','1231232345',50); INSERT INTO 编著排名 VALUES ('123123123','123456789000',1); INSERT INTO 编著排名 VALUES ('123123123','123456789001',2); INSERT INTO 作者 VALUES ('123123235','327500','哲风屏'); INSERT INTO 销售 VALUES ('1234','123123123','0123456','2019-5-21',3,54); INSERT INTO 销售 VALUES ('1235','1231232345','0123456','2019-5-21',7,59); （2）数据删除操作 ：    比如说要删除作者姓名为哲风屏的作者信息。 DELETE FROM 作者 WHERE 作者姓名 = '哲风屏'           （3）查询操作：         可以看到刚才删除的作者确实从表中删除了，说明删除操作成功  （4）修改操作： 比如说要修改汤小丹的联系电话 UPDATE 作者 SET 联系电话 = '137********' WHERE 作者姓名 = '汤小丹'; 可以看到修改成功   8. 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 为了实现当日图书销售量及销售金额汇总统计，通过执行图书销售系统数据库的村纯国产，以实现数据库后端数据处理。因此，该过程有一个输入参数：日期，输出结果为该日期的总销售量和总销售金额。其存储过程SQL程序定义如下： CREATE OR REPLACE PROCEDURE Pro_CurrentSale (Date IN DATE) AS $$    DECLARE       SUM1 INT; \t  SUM2 MONEY;     BEGIN       SELECT SUM(销售数量) INTO SUM1 FROM 销售 \t  WHERE 销售日期 = DATE; \t  SELECT SUM(销售数量*销售金额) INTO SUM2 FROM 销售 \t  WHERE 销售日期 = DATE; \t  RAISE NOTICE '销售数量%',SUM1; \t  RAISE NOTICE '销售金额%',SUM2;    END; $$ LANGUAGE plpgsql;   9. 编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 执行后，为了验证该存储过程是否能正确工作，可进行如下验证： 1）查询日期为’2019-05-21’的图书销售情况，其SQL语句执行结果如图.  2）假设现在需要统计2019-05-21的销售量及销售金额，可以调用存储过程Pro_CurrentSale(Date IN DATE)进行处理，其SQL程序如下： CALL PUBLIC.pro_currentsale('2019-05-21') 执行结果如图：  10. 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。    通过创建数据库触发器可以实现特定业务规则。为了实现图书库存数据同步修改处理，，在库存表上创建一个INSERT触发器Tri_InsertSale，在该触发器程序中完成对库存表中的库存量进行修改处理。实现该功能的触发器函数的SQL程序如下： CREATE FUNCTION InsertSale() RETURNS TRIGGER AS $$ BEGIN     UPDATE 库存 SET 库存量 = 库存量 - NEW.销售数量    WHERE 商店编号 = NEW.商店编号 AND 图书编号 = NEW.图书编号;    RETURN NEW; END; $$ LANGUAGE plpgsql;     然后创建触发器Tri_InsertSale调用触发器函数InsertSale()。其SQL程序如下： CREATE TRIGGER Tri_InsertSale    AFTER INSERT    ON 销售 FOR EACH ROW    EXECUTE PROCEDURE InsertSale();   创建后如图所示：  11. 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。   为了验证该触发器是否能正确工作，可进行如下测试： 查询当前库存，其SQL语句执行结果如图  假定现在商店编号为0123456的商店又销售了图书编号为’123123123’的图书10本，其SQL语句执行结果如图：  重新查询当前库存，如图所示    比之前少了10本，即表明触发器程序已经正确执行。  九、总结及心 得体会 本次实验的关键技术在于使用DDL、DML、DQL等类型的SQL语句，对数据库对象进行各类操作以及存储过程编程和触发器编程。通过这次实验，初步掌握了数据库SQL编程的方法。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306  \t\t\t实验时间： 2019-05-22     三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 对图书管理销售系统数据库进行系统安全管理。了解Postgresql系统对数据库管理的内容与方法，使用pgadmin4图形化界面对数据库角色管理、用户管理、权限管理进行基本的操作，并在图书销售管理系统数据库中，创建必要的角色和用户，实现上述管理的基本操作。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 1.客户（R_Customer）对各个表只具有查询操作权限。 2.商家（R_Seller）具有对库存、销售、折扣的数据进行插入、更新、删除和查询操作权限。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 1）基于pgadmin4的GUI方式创建客户（R_Customer）和商家(R_Seller)角色    2）图表 1创建完成后可以在登录/组角色中查看：   （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 1）客户（R_Customer）对各个表只具有查询操作权限。    2）商家（R_Seller）具有对库存、销售、折扣的数据进行插入、更新、删除和查询操作权限。    （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 1）创建角色后在权限中选择可以登录  就表明是用户   2）创建完成后可见  （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 1）将U _Customer分配为R_Customer的成员  2）将U _Seller分配为R_Seller的成员  （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  1）1.以客户用户U_Customer身份访问图书销售管理数据库，在Server服务器中创建新连接，输入用户名和密码。  2.验证所实现数据存取权限模型的正确性，尝试向图书表中插入信息  可以看到权限不允许插入。 2）1.以客户用户U_Seller身份访问图书销售管理数据库，在Server服务器中创建新连接，输入用户名和密码。  2. 验证所实现数据存取权限模型的正确性，尝试向销售表中插入信息  可见插入出错是由于重复而不是权限限制，可见有对销售表的插入权限。 九、总结及心得体会 本实验的关键难点在于pgadmin4创建角色和用户时的区别，如何为用户赋予角色的权限，以及使用所创建的用户登录并访问数据库。通过这次实验，我对数据库安全管理有了一定的了解。",
  "studentID": "2017221105018"
 },
 "25": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t\t\t\t     实验时间：2019/5/20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 创建数据库表是通过CDM，LDM，PDM转换的SQL实现的。创建视图需要使用到JOIN…ON语句。创建索引仅对每个表的主键创建。对数据库表进行增删查改等操作需要使用SQL语句。存储过程和触发器需要特别的语法格式。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作。 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作。 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 首先进入pgAdmin4，然后创建数据库BookSale，由于pgAdmin4只能通过GUI进行数据库创建，所以这里没有给出相应的SQL语句。操作界面如图1所示。 图1 根据需求规格说明书，我们可以抽取出“图书”“商店”“销售”“折扣”“作者”“出版社”实体。然后我们可以分析出“图书”实体与“出版社”“作者”“销售”实体均有联系。同样，“商店”实体与“销售”“折扣”实体也有联系。进一步，我们还可以分析出这些实体间联系的多重性、参与性、继承性等约束。然后我们可以定义实体属性和标识符。然后在检查与完善CDM的过程中，我们增加了“库存”实体和“图书类别”实体。最后使用PowerDesigner画出CDM，如图2所示。 图2 将CDM自动转换为LDM后，如图3所示。 图3 通过分析该LDM，可以看到该模型的“作者”实体不符合关系数据库设计规范的3NF范式，其中的“省”“城市”属性存在传递依赖。此外，新引入的关联实体“编著”的名称不太确切，其属性仅仅只有所依赖实体的标识符，缺少自身属性。因此，我们需要对该逻辑数据模型进行规范化完善设计，其设计结果如图4所示。 图4 修改后的LDM，增加“地区表”实体，并将它与“作者”实体建立联系，同时删除“作者”实体中的“省”“城市”属性，从而在“作者”关系表中可通过地区编码方式实现一致的地区名称输入。此外，修订关联实体“编著”名称为“编著排名”，并增加“排位顺序”属性，从而使该实体数据具有实际意义。 将LDM自动转换为PDM后，如图5所示。 图5  将物理模型转换为SQL语句后如下。     同时我也自己编写了创建表的SQL语句。    为各表主键创建索引的SQL语句如下。 创建三个视图的SQL语句如下。 由于插入的SQL语句过多，这里只给出一部分。 Author表的数据信息如图6所示。 图6 Book表的数据信息如图7所示。 图7 BookCategory表的数据信息如图8所示。 图8 CompileRanking表的数据信息如图9所示。 图9 Discount表的数据信息如图10所示。 图10 Inventory表的数据信息如图11所示。 图11 LocalTable表的数据信息如图12所示。 图12 Press表的数据信息如图13所示。 图13 Sale表的数据信息如图14所示。 图14 Shop表的数据信息如图15所示。 图15 现在对图书表中BookName为“眠”的某一行进行删操作，我们知道由于参照完整性，会导致其他表的变化。操作之后受影响的各表如下图所示。 图16(Book表) 图17(CompileRanking表) 图18(AuthorInfo视图) 现在将图书表BookName为“活着”的ISBN改成“2017110501020171105010”，根据参照完整性，会导致其他表的变化。操作之后的受影响的表如下图所示。 图19(Book表) 图20(Sale表) 图21(CompileRanking表)  图22(Inventory表) 现在编写存储过程Pro_CurrentSale,SQL语句如下。 在编写调用该存储过程的存储过程，SQL语句如下。 执行结果如图23所示。 图23 通过查询语句验证该存储过程的正确性，SQL语句如下。 执行结果如图24所示。 图24 可见，存储过程没有问题。 现在编写触发器函数BookSale，SQL语句如下。 然后编写触发器Tri_InsertSale调用触发器函数，SQl语句如下。 然后检测触发器能否正确工作，先查询ISBN为“2017110500920171105009”以及ShopNumber为“020171105003”图书的库存。如图25所示。 图25 假定现在卖了100本该种类图书，SQL语句如下。 再次查询库存，如图26所示。 图26 重新查询图书的当前库存，该种类图书减少100本，即表明触发器程序已经正确执行。 九、总结及心得体会 通过这次数据库实验，我首先学会了根据需求画出数据库的概念数据模型，并通过概念数据模型画出逻辑数据模型进而转换为物理模型，最后通过物理模型生成SQL来创建数据库表的方法。另外，我对SQL语句的使用有了更深的理解，虽然之前写作业时用到过SQL，这次实验让我更加熟练了。最后，我还对存储过程和触发器有了基本的认识。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306  \t\t\t\t\t    实验时间：2019/5/22 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 创建客户角色和商家角色的SQL代码如下。 创建结果如图27所示。 图27 角色权限表如表1所示。 表1 为客户和商家赋予数据库对象权限的SQL语句如下。 执行成功后，再创建客户用户和商家用户并赋予他们相应的角色，SQL语句如下。 创建结果如图28所示。 图28 然后再创建两个用户访问数据库对象的服务器，如图29所示。 图29 现在先以客户身份访问数据库，先尝试对作者表进行插入操作，如下。 执行结果如图30所示。 图30 同理，对其它表进行增删改操作时也会包同样的错误，可见客户用户权限是正确的。 然后再以商家身份访问数据库，尝试对作者表进行插入操作，如下。 执行结果如图31所示。 图31 然后尝试对商店表进行插入操作，如下。 执行成功了，再对商店表进行查询，结果如图32。 图32 同理，经过了大量的验证，我发现商家用户的权限也是正确的。 九、总结及心得体会 通过这次实验，我知道了如何创建角色，然后为角色赋予权限，再创建相应的用户并为用户分配角色。最后再以不同的用户访问数据库对象。",
  "studentID": "2017221105019"
 },
 "26": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西304、306     实验时间：2019.05.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1. 数据库模式定义语言DDL 数据库模式定义语言DDL(Data Definition Language)，是用于描述数据库中要存储的现实世界实体的语言。 CREATE DATABASE 创建数据库 CREATE TABLE 创建数据库表格 ALTER TABLE 修改数据库表格 DROP TABLE 删除数据库表格 CREATE VIEW 创建查询命令 ALTER VIEW 修改查询命令 DROP VIEW 删除查询命令 TRUNCATE TABLE 删除数据表内容 2. 数据操纵语言DML 数据操纵语言（Data Manipulation Language, DML）是SQL语言中，负责对数据库对象运行数据访问工作的指令集，以INSERT、UPDATE、DELETE三种指令为核心，分别代表插入、更新与删除，是开发以数据为中心的应用程序必定会使用到的指令，因此有很多开发人员都把加上SQL的SELECT语句的四大指令以“CRUD”来称呼。 DML 的主要功能即是访问数据，因此其语法都是以读取与写入数据库为主，除了INSERT以外，其他指令都可能需搭配WHERE指令来过滤数据范围，或是不加WHERE指令来访问全部的数据。 INSERT是将数据插入到数据库对象中的指令，可以插入数据的数据库对象有数据表以及可更新查看表两种。 UPDATE 指令是依给定条件，将匹配条件的数据表中的数据更新为新的数值。 DELETE 指令为自数据库对象中删除数据的指令。 \t3. 数据查询语言DQL \t\t标准语法： 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.图书销售管理系统数据库BookSale创建操作。 2.在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 \t\t(1). 设计概念数据模型设计 \t\t(2). 设计逻辑数据模型设计 \t\t(3). 设计物理数据模型设计 \t\t(4). PostgreSQL实现图书销售管理系统创建 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 1.图书销售管理系统数据库BookSale创建操作如图1-1所示。  图1-1 图书销售管理系统数据库BookSale的创建 2. 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 \t\t(1). 设计概念数据模型设计 \t\t\t抽取出数据需求对象，标识为如图2-1-1所示的实体。  图2-1-1 图书销售管理系统实体 通过分析上述实体对象之间在图书销售管理系统中的相关性，表示实体之间的关系，采用E-R模型的联系元素符号表示这些实体之间的联系，如图2-1-2所示。  图2-1-2 图书销售管理系统的实体联系 在以上概略的E-R模型图基础上进一步细化设计，确定各个实体的属性，如图2-1-3所示。  图2-1-3 图书销售管理系统实体细化 针对图2-1-3所示的图书销售管理系统E-R模型，我们可以分析出该模型存在实体及联系遗漏情况，如用户在数据库中无法了解某些商店有那些图书，也无法了解各商店中图书的库存。因此需要对该E-R模型进行完善，增加“库存”实体，并与“图书”和“商店”实体建立联系。此外，为了便于客户按图书类别进行商品信息浏览或查询，在原数据模型的基础上，增加了“图书类别”实体，并将它与“图书”实体建立联系。完善之后的系统E-R模型图如图2-4所示。  图2-1-4 完善之后的图书销售管理系统E-R模型 \t\t(2). 设计逻辑数据模型设计 将图2-1-4所示的图书馆销售管理系统概念数据模型转换设计为逻辑数据模型，如2-2-1所示。  图2-2-1 初步的图书销售管理系统逻辑数据模型 通过分析图2-2-1所示的图书销售管理系统逻辑数据模型，可以看到该模型的“作者”实体不符合关系数据库设计规范的3NF范式，其中的“省”和“城市”属性存在传递以来。此外，新引入的关联实体“编著”的名称不要确切，其属性仅仅只有所依赖实体的标识符，缺少自身属性。因此，需要对该逻辑数据模型进行规范化完善设计，其设计结果如图2-2-2所示。  图2-2-2 完善后的图书销售管理系统逻辑数据模型 (3). 设计物理数据模型设计 在图2-2-2所示的图书销售管理系统逻辑数据模型基础上，进行E-R模型到关系模型转换，从而给出图书销售管理系统的物理数据模型设计方案，其设计结果如图2-3-1所示。  图2-3-1 图书销售管理系统物理数据模型 所涉及的图书销售管理系统物理数据模型，只有两种模型符号――“关系表”符号和“参照完整性”符号，这些符号将数据库表对象的组成结构描述出来。该模型是数据库表对象的可视化展现。通过物理数据模型图可直观地了解数据库的表结构设计，以及表间关系。 (4). PostgreSQL实现图书销售管理系统创建 在psql中键入上面的SQL语句之后，打开pgAdmin 4，查看表创建情况，如图2-4-1所示。  图2-4-1 表创建结果 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 \t按照表3-1进行对地区的增添。 表1-1 地区信息表 \t在SQL Shell中键入如下代码： \t结果如图3-1所示：  图3-1 地区增添结果 \t按照表3-2对作者进行增添。 表3-2 作者信息表 \t在SQL Shell中键入如下代码： \t结果如图3-2所示：  图3-2 作者增添结果 \t按照表3-3对出版社进行增添。 表3-3 出版社信息表 \t在SQL Shell中键入如下代码： \t结果如图3-3所示：  图3-3 出版社增添结果 \t按照表3-4对图书类别进行增添： 表3-4 图书类别信息表 \t在SQL Shell中键入如下代码： \t结果如图3-4所示：  图3-4 图书类别增添结果 \t按照表3-5对图书进行增添。 表3-5 图书信息表 \t在SQL Shell中键入如下代码： \t结果如图3-5所示。  图3-5 图书增添结果 \t按照表3-6对编著排名表进行增添。 表3-6 编著排名信息表 \t在SQL Shell中键入如下代码： \t结果如图3-5所示。  图3-6 编著排名增添结果 \t按照表3-7对书店表进行增添。 表3-7 书店信息表 在SQL Shell中键入如下代码： \t结果如图3-7所示。  图3-7 书店表增添结果 \t按照表3-8对库存表进行增添。 表3-8 库存信息表 \t在SQL Shell中键入如下代码： \t结果如图3-8所示。  图3-8 库存增添结果 \t按照表3-9对销售记录进行增添并且同时对库存表进行修改。 表3-9 销售记录信息表 \t在SQL Shell中键入如下代码： \t结果如图3-9所示。  图3-9 销售记录增添和库存更新结果 \t查看对学海书店中的所有书籍库存，在SQL Shell中键入代码： \t运行结果如图3-10所示。  图3-10 学海书店书籍库存查询结果 \t在地区表中插入表3-10数据，再进行删除操作。 表3-10 地区信息表2 \t在SQL Shell中键入如下代码： \t运行结果如图3-11所示。  图3-11 插入删除操作结果 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 \t在SQL Shell中键入如下语句，创建函数： \t运行结果如图3-12所示。  图4-1 函数创建结果 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 \t在SQL中键入如下语句，实现对函数的调用，对2019年3月3日的销售进行统计： \t运行结果如图5-1所示。  图5-1 函数调用结果 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 \t在SQL中键入如下语句，实现触发器的创建： \t运行结果如图6-1所示。  图6-1 创建触发器运行结果 7.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 \t\t在SQL中键入如下代码，尝试触发Tri_InsertSale触发器： \t\t运行结果如图7-1所示。  图7-1 触发器运行结果 九、总结及心得体会 在SQL Shell中操作时，最好将SQL代码先在文件中准备完成，这样可以尽可能的减少在编写中的错误，也可以方便的通过复制粘贴或者输入重定向向SQL Shell中键入代码；另外，在SQL Shell中，大小写不敏感，所以变量名要尽量区别，如sale和Sale实际上是一个变量名。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西304、306      实验时间：2017.05.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 创建： CREATE USER和CREATE ROLE的区别在于，CREATE USER指令创建的用户默认是有登录权限的，而CREATE ROLE没有。 创建用户时设定用户属性： 可以通过\\h CREATE ROLE指令查看全部可设置的管理权限。 修改用户属性： 设置访问权限： \\z或\\dp指令显示用户访问权限。 \\h GRANT显示所有可设置的访问权限。 撤销用户访问权限： 其中permission_type和table_name含义与GRANT指令中相同。 创建组示例： 切换ROLE： INHERIT权限： 该属性使组成员拥有组的所有权限。 删除用户和组： 删除用户和组很简单。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 \t数据存取权限控制如表1-1所示，且客户角色和商家角色都有继承、登录和连接权限： 表1-1 数据存取权限表 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 \t在SQL Shell键入如下语句： \t运行结果如图2-1所示。  图2-1 角色创建结果 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 \t在SQL Shell中键入如下语句： \t运行结果如图3-1所示。  图3-1 赋予数据库对象权限结果 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 \t在SQL Shell中键入如下语句： \t运行结果如图4-1所示。  图4-1 用户创建结果 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 分别登陆客户用户U_Customer、商家用户U_Seller，并且在SQL Shell中键入如下代码： \t登录客户用户访问结果如图6-1所示。  图6-1 客户用户访问结果 \t登录商家用户访问结果如图6-2所示。  图6-2 商家用户访问结果 从图6-1可以得知，当客户用户尝试对地区表进行插入、删除和更新操作时，均会返回没有权限的提示信息；当客户用户尝试对地区表进行查询时，结果正常返回。 从图6-2可以得知，当商家用户尝试对地区表进行插入、删除、更新和查询时，均能正常返回信息。 九、总结及心得体会 通过合理地分配权限给不同角色，可以减轻数据库设计和编码人员的工作量，给予角色的权限仅能满足其需求即可，而不能给予多余的、对于该用户无用的权限，以此来保证数据库中信息的安全性。 另外，在赋予角色权限时，可以使用如下语句代替需要为用户分配每一个表的某一个权限： 可以使得SQL语句更加简洁明了、容易阅读，也在一定程度上防止了误操作引起的数据库安全问题。",
  "studentID": "2017221105021"
 },
 "27": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西304、306     实验时间：2019.05.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1. 数据库模式定义语言DDL 数据库模式定义语言DDL(Data Definition Language)，是用于描述数据库中要存储的现实世界实体的语言。 CREATE DATABASE 创建数据库 CREATE TABLE 创建数据库表格 ALTER TABLE 修改数据库表格 DROP TABLE 删除数据库表格 CREATE VIEW 创建查询命令 ALTER VIEW 修改查询命令 DROP VIEW 删除查询命令 TRUNCATE TABLE 删除数据表内容 2. 数据操纵语言DML 数据操纵语言（Data Manipulation Language, DML）是SQL语言中，负责对数据库对象运行数据访问工作的指令集，以INSERT、UPDATE、DELETE三种指令为核心，分别代表插入、更新与删除，是开发以数据为中心的应用程序必定会使用到的指令，因此有很多开发人员都把加上SQL的SELECT语句的四大指令以“CRUD”来称呼。 DML 的主要功能即是访问数据，因此其语法都是以读取与写入数据库为主，除了INSERT以外，其他指令都可能需搭配WHERE指令来过滤数据范围，或是不加WHERE指令来访问全部的数据。 INSERT是将数据插入到数据库对象中的指令，可以插入数据的数据库对象有数据表以及可更新查看表两种。 UPDATE 指令是依给定条件，将匹配条件的数据表中的数据更新为新的数值。 DELETE 指令为自数据库对象中删除数据的指令。 \t3. 数据查询语言DQL \t\t标准语法： 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.图书销售管理系统数据库BookSale创建操作。 2.在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 \t\t(1). 设计概念数据模型设计 \t\t(2). 设计逻辑数据模型设计 \t\t(3). 设计物理数据模型设计 \t\t(4). PostgreSQL实现图书销售管理系统创建 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 1.图书销售管理系统数据库BookSale创建操作如图1-1所示。  图1-1 图书销售管理系统数据库BookSale的创建 2. 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 \t\t(1). 设计概念数据模型设计 \t\t\t抽取出数据需求对象，标识为如图2-1-1所示的实体。  图2-1-1 图书销售管理系统实体 通过分析上述实体对象之间在图书销售管理系统中的相关性，表示实体之间的关系，采用E-R模型的联系元素符号表示这些实体之间的联系，如图2-1-2所示。  图2-1-2 图书销售管理系统的实体联系 在以上概略的E-R模型图基础上进一步细化设计，确定各个实体的属性，如图2-1-3所示。  图2-1-3 图书销售管理系统实体细化 针对图2-1-3所示的图书销售管理系统E-R模型，我们可以分析出该模型存在实体及联系遗漏情况，如用户在数据库中无法了解某些商店有那些图书，也无法了解各商店中图书的库存。因此需要对该E-R模型进行完善，增加“库存”实体，并与“图书”和“商店”实体建立联系。此外，为了便于客户按图书类别进行商品信息浏览或查询，在原数据模型的基础上，增加了“图书类别”实体，并将它与“图书”实体建立联系。完善之后的系统E-R模型图如图2-4所示。  图2-1-4 完善之后的图书销售管理系统E-R模型 \t\t(2). 设计逻辑数据模型设计 将图2-1-4所示的图书馆销售管理系统概念数据模型转换设计为逻辑数据模型，如2-2-1所示。  图2-2-1 初步的图书销售管理系统逻辑数据模型 通过分析图2-2-1所示的图书销售管理系统逻辑数据模型，可以看到该模型的“作者”实体不符合关系数据库设计规范的3NF范式，其中的“省”和“城市”属性存在传递以来。此外，新引入的关联实体“编著”的名称不要确切，其属性仅仅只有所依赖实体的标识符，缺少自身属性。因此，需要对该逻辑数据模型进行规范化完善设计，其设计结果如图2-2-2所示。  图2-2-2 完善后的图书销售管理系统逻辑数据模型 (3). 设计物理数据模型设计 在图2-2-2所示的图书销售管理系统逻辑数据模型基础上，进行E-R模型到关系模型转换，从而给出图书销售管理系统的物理数据模型设计方案，其设计结果如图2-3-1所示。  图2-3-1 图书销售管理系统物理数据模型 所涉及的图书销售管理系统物理数据模型，只有两种模型符号――“关系表”符号和“参照完整性”符号，这些符号将数据库表对象的组成结构描述出来。该模型是数据库表对象的可视化展现。通过物理数据模型图可直观地了解数据库的表结构设计，以及表间关系。 (4). PostgreSQL实现图书销售管理系统创建 在psql中键入上面的SQL语句之后，打开pgAdmin 4，查看表创建情况，如图2-4-1所示。  图2-4-1 表创建结果 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 \t按照表3-1进行对地区的增添。 表1-1 地区信息表 \t在SQL Shell中键入如下代码： \t结果如图3-1所示：  图3-1 地区增添结果 \t按照表3-2对作者进行增添。 表3-2 作者信息表 \t在SQL Shell中键入如下代码： \t结果如图3-2所示：  图3-2 作者增添结果 \t按照表3-3对出版社进行增添。 表3-3 出版社信息表 \t在SQL Shell中键入如下代码： \t结果如图3-3所示：  图3-3 出版社增添结果 \t按照表3-4对图书类别进行增添： 表3-4 图书类别信息表 \t在SQL Shell中键入如下代码： \t结果如图3-4所示：  图3-4 图书类别增添结果 \t按照表3-5对图书进行增添。 表3-5 图书信息表 \t在SQL Shell中键入如下代码： \t结果如图3-5所示。  图3-5 图书增添结果 \t按照表3-6对编著排名表进行增添。 表3-6 编著排名信息表 \t在SQL Shell中键入如下代码： \t结果如图3-5所示。  图3-6 编著排名增添结果 \t按照表3-7对书店表进行增添。 表3-7 书店信息表 在SQL Shell中键入如下代码： \t结果如图3-7所示。  图3-7 书店表增添结果 \t按照表3-8对库存表进行增添。 表3-8 库存信息表 \t在SQL Shell中键入如下代码： \t结果如图3-8所示。  图3-8 库存增添结果 \t按照表3-9对销售记录进行增添并且同时对库存表进行修改。 表3-9 销售记录信息表 \t在SQL Shell中键入如下代码： \t结果如图3-9所示。  图3-9 销售记录增添和库存更新结果 \t查看对学海书店中的所有书籍库存，在SQL Shell中键入代码： \t运行结果如图3-10所示。  图3-10 学海书店书籍库存查询结果 \t在地区表中插入表3-10数据，再进行删除操作。 表3-10 地区信息表2 \t在SQL Shell中键入如下代码： \t运行结果如图3-11所示。  图3-11 插入删除操作结果 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 \t在SQL Shell中键入如下语句，创建函数： \t运行结果如图3-12所示。  图4-1 函数创建结果 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 \t在SQL中键入如下语句，实现对函数的调用，对2019年3月3日的销售进行统计： \t运行结果如图5-1所示。  图5-1 函数调用结果 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 \t在SQL中键入如下语句，实现触发器的创建： \t运行结果如图6-1所示。  图6-1 创建触发器运行结果 7.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 \t\t在SQL中键入如下代码，尝试触发Tri_InsertSale触发器： \t\t运行结果如图7-1所示。  图7-1 触发器运行结果 九、总结及心得体会 在SQL Shell中操作时，最好将SQL代码先在文件中准备完成，这样可以尽可能的减少在编写中的错误，也可以方便的通过复制粘贴或者输入重定向向SQL Shell中键入代码；另外，在SQL Shell中，大小写不敏感，所以变量名要尽量区别，如sale和Sale实际上是一个变量名。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西304、306      实验时间：2017.05.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 创建： CREATE USER和CREATE ROLE的区别在于，CREATE USER指令创建的用户默认是有登录权限的，而CREATE ROLE没有。 创建用户时设定用户属性： 可以通过\\h CREATE ROLE指令查看全部可设置的管理权限。 修改用户属性： 设置访问权限： \\z或\\dp指令显示用户访问权限。 \\h GRANT显示所有可设置的访问权限。 撤销用户访问权限： 其中permission_type和table_name含义与GRANT指令中相同。 创建组示例： 切换ROLE： INHERIT权限： 该属性使组成员拥有组的所有权限。 删除用户和组： 删除用户和组很简单。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 \t数据存取权限控制如表1-1所示，且客户角色和商家角色都有继承、登录和连接权限： 表1-1 数据存取权限表 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 \t在SQL Shell键入如下语句： \t运行结果如图2-1所示。  图2-1 角色创建结果 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 \t在SQL Shell中键入如下语句： \t运行结果如图3-1所示。  图3-1 赋予数据库对象权限结果 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 \t在SQL Shell中键入如下语句： \t运行结果如图4-1所示。  图4-1 用户创建结果 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 分别登陆客户用户U_Customer、商家用户U_Seller，并且在SQL Shell中键入如下代码： \t登录客户用户访问结果如图6-1所示。  图6-1 客户用户访问结果 \t登录商家用户访问结果如图6-2所示。  图6-2 商家用户访问结果 从图6-1可以得知，当客户用户尝试对地区表进行插入、删除和更新操作时，均会返回没有权限的提示信息；当客户用户尝试对地区表进行查询时，结果正常返回。 从图6-2可以得知，当商家用户尝试对地区表进行插入、删除、更新和查询时，均能正常返回信息。 九、总结及心得体会 通过合理地分配权限给不同角色，可以减轻数据库设计和编码人员的工作量，给予角色的权限仅能满足其需求即可，而不能给予多余的、对于该用户无用的权限，以此来保证数据库中信息的安全性。 另外，在赋予角色权限时，可以使用如下语句代替需要为用户分配每一个表的某一个权限： 可以使得SQL语句更加简洁明了、容易阅读，也在一定程度上防止了误操作引起的数据库安全问题。",
  "studentID": "2017221105022"
 },
 "28": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：\t\t信软楼306\t\t\t     实验时间：    2019/5/20  三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 \t利用DDL,DML,DQL等实现对数据库表，视图，索引的创建和操作。利用insert等语句对数据库进行增删改查sql操作。利用函数，对销量和金额进行汇总统计；利用过程语句块，实现对函数调用，输出统计结果；利用触发器，实现对数据的同步修改和功能验证。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 图书销售管理系统数据库BookSale创建操作 创建数据库：   在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 按照对BookSale数据库的建模设计，并且对最终得到的物理模型在powerdesigner中导出sql文件，可以方便的创建数据库表如下： 物理数据模型：           利用powerdesigner工具导出sql文件（为了缩短代码长度，下面的sql代码去掉了最开始的一堆drop语句，问题不大）：BookSaleDB.sql /*==============================================================*/ /*DBMSname:PostgreSQL9.x*/ /*Createdon:2019/5/2018:48:36*/ /*==============================================================*/   /*==============================================================*/ /*Table:writer*/ /*==============================================================*/ createtablewriter( writernumCHAR(12)notnull, areanumCHAR(6)null, writernameVARCHAR(40)null, writeraddrVARCHAR(80)null, writerphoneCHAR(11)null, constraintPK_writerprimarykey(writernum) );  /*==============================================================*/ /*Table:publisher*/ /*==============================================================*/ createtablepublisher( publishernumCHAR(12)notnull, publishernameVARCHAR(40)null, publisherphoneVARCHAR(20)null, publisheraddrVARCHAR(60)null, constraintPK_publisherprimarykey(publishernum) );  /*==============================================================*/ /*Table:store*/ /*==============================================================*/ createtablestore( storenumCHAR(12)notnull, storenameVARCHAR(40)null, zipcodeCHAR(6)null, storeaddrVARCHAR(80)null, constraintPK_storeprimarykey(storenum) );  /*==============================================================*/ /*Table:book*/ /*==============================================================*/ createtablebook( bookisbnCHAR(22)notnull, publishernumCHAR(12)null, typenumCHAR(5)null, booknameVARCHAR(80)null, publishdateDATEnull, priceMONEYnull, mainideaVARCHAR(2000)null, tableofcontentsVARCHAR(1)null, constraintPK_bookprimarykey(bookisbn) );  /*==============================================================*/ /*Table:booktype*/ /*==============================================================*/ createtablebooktype( typenumCHAR(5)notnull, typenameVARCHAR(20)null, constraintPK_booktypeprimarykey(typenum) );  /*==============================================================*/ /*Table:areatable*/ /*==============================================================*/ createtableareatable( areanumCHAR(6)notnull, areanameVARCHAR(30)null, constraintPK_areatableprimarykey(areanum) );  /*==============================================================*/ /*Table:inventory*/ /*==============================================================*/ createtableinventory( storenumCHAR(12)notnull, bookisbnCHAR(22)notnull, inventoryamountINT4null, constraintPK_inventoryprimarykey(storenum,bookisbn) );  /*==============================================================*/ /*Table:discount*/ /*==============================================================*/ createtablediscount( discountnumINT4notnull, storenumCHAR(12)null, discountrateINT4null, discounttypeVARCHAR(20)null, constraintPK_discountprimarykey(discountnum) );  /*==============================================================*/ /*Table:bookranknum*/ /*==============================================================*/ createtablebookrank( writernumCHAR(12)notnull, bookisbnCHAR(22)notnull, bookranknumINT4null, constraintPK_bookrankprimarykey(writernum,bookisbn) );  /*==============================================================*/ /*Table:sale*/ /*==============================================================*/ createtablesale( saletmpnumserialnotnull, bookisbnCHAR(22)null, storenumCHAR(12)null, saledateDATEnull, salenumNUMERICnull, salemoneyMONEYnull, constraintPK_saleprimarykey(saletmpnum) );  altertablewriter addconstraintFK_writer_REFERENCE_areatableforeignkey(areanum) referencesareatable(areanum) ondeleterestrictonupdaterestrict;  altertablebook addconstraintFK_book_REFERENCE_publisherforeignkey(publishernum) referencespublisher(publishernum) ondeleterestrictonupdaterestrict;  altertablebook addconstraintFK_book_REFERENCE_booktypeforeignkey(typenum) referencesbooktype(typenum) ondeleterestrictonupdaterestrict;  altertableinventory addconstraintFK_inventory_REFERENCE_bookforeignkey(bookisbn) referencesbook(bookisbn) ondeleterestrictonupdaterestrict;  altertableinventory addconstraintFK_inventory_REFERENCE_storeforeignkey(storenum) referencesstore(storenum) ondeleterestrictonupdaterestrict;  altertablediscount addconstraintFK_discount_REFERENCE_storeforeignkey(storenum) referencesstore(storenum) ondeleterestrictonupdaterestrict;  altertablebookrank addconstraintFK_bookrank_REFERENCE_writerforeignkey(writernum) referenceswriter(writernum) ondeleterestrictonupdaterestrict;  altertablebookrank addconstraintFK_bookrank_REFERENCE_bookforeignkey(bookisbn) referencesbook(bookisbn) ondeleterestrictonupdaterestrict;  altertablesale addconstraintFK_sale_REFERENCE_storeforeignkey(storenum) referencesstore(storenum) ondeleterestrictonupdaterestrict;  altertablesale addconstraintFK_sale_REFERENCE_bookforeignkey(bookisbn) referencesbook(bookisbn) ondeleterestrictonupdaterestrict; 在sql shell中执行：            创建索引的操作：createindex.sql begin; createindexwriter_idxonwriter(writernum); createindexpublisher_idxonpublisher(publishernum); createindexstore_idxonstore(storenum); createindexbook_idxonbook(bookisbn); createindexbooktype_idxonbooktype(typenum); createindexareatable_idxonareatable(areanum); createindexinventory_idxoninventory(storenum,bookisbn); createindexdiscount_idxondiscount(discountnum); createindexbookrank_idxonbookrank(writernum,bookisbn); createindexsale_idxonsale(saletmpnum); commit; 运行结果：         创建视图:createview.sql begin; createviewwriterbookstatisticsas selectbook.bookisbn, book.bookname, temp.writername FROMbook JOIN( SELECT*FROMwriter JOINbookrank ONwriter.writernum=bookrank.writernum )AStemp ONbook.bookisbn=temp.bookisbn; SELECT*FROMwriterbookstatistics; commit; \t运行结果： \t\t      对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 增和改操作(用了insert update)：insert.sql --下面命名基本按照书上p128示例的PDM中出现名称进行命名 begin;  --地区表 insertintoareatablevalues ('000001','四川成都'); --作者 insertintowritervalues ('000000000001','000001','陆鑫','电子科技大学沙河校区','13000000001'), ('000000000002','000001','张凤荔','电子科技大学沙河校区','13000000002'), ('000000000003','000001','陈安龙','电子科技大学沙河校区','13000000003'); --出版社 insertintopublishervalues ('000000000001','人民邮电出版社','010-81055256','北京市丰台区成寿寺路11号'); --图书类别 insertintobooktypevalues('00001','软件工程系列规划教材'); --图书 insertintobookvalues ('978-7-155-50274-2','000000000001','00001','《数据库系统原理、设计与编程》','2019-03-01','59.8','本书以先进的开源对象――关系数据库PostgreSQL和典型的分布式非关系数据库NoSQL为背景，介绍数据库系统的原理、设计与编程技术。全书共7章，内容包括数据库系统基础、数据库关系模型、数据库操作语言SQL、数据库设计与实现、数据库管理、数据库应用编程、NoSQL数据库技术。针对关系数据库系统，本书重点介绍关系数据模型原理、数据库操作语言SQL、数据库服务器端编程、数据库管理技术；针对非结构化数据管理，本书介绍NoSQL数据库原理及其基本技术，如列存储数据库、键值对数据库、文档数据库、图形数据库等。同时，本书还针对数据库应用系统开发，介绍数据库设计方法、数据库应用Java编程方法。','');  --编著排名 insertintobookrankvalues ('000000000001','978-7-155-50274-2',1), ('000000000002','978-7-155-50274-2',2), ('000000000003','978-7-155-50274-2',3); --商店 insertintostorevalues('000000000001','学海书店','621000','四川省绵阳市跃进路北段'); --库存 insertintoinventoryvalues('000000000001','978-7-155-50274-2',100); --销售 insertintosale(bookisbn,storenum,saledate,salenum,salemoney)values('978-7-155-50274-2','000000000001','2019-03-02',1,'59.8');  UPDATEinventorySETinventoryamount=99WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-02',1,'59.8'); UPDATEinventorySETinventoryamount=98WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-02',1,'59.8'); UPDATEinventorySETinventoryamount=97WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-03',1,'59.8'); UPDATEinventorySETinventoryamount=96WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-03',2,'119.6'); UPDATEinventorySETinventoryamount=94WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-03',1,'59.8'); UPDATEinventorySETinventoryamount=93WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-03',1,'59.8'); UPDATEinventorySETinventoryamount=92WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-04',1,'59.8'); UPDATEinventorySETinventoryamount=91WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-04',1,'59.8'); UPDATEinventorySETinventoryamount=90WHEREstorenum='000000000001';  INSERTINTOsale(bookisbn,storenum,saledate,salenum,salemoney)VALUES('978-7-155-50274-2','000000000001','2019-03-04',1,'59.8'); UPDATEinventorySETinventoryamount=89WHEREstorenum='000000000001';  SELECTstore.storeNameAS商店名称,book.bookNameAS书名,inventory.inventoryamountAs库存 FROMbook,inventory,store WHEREbook.bookisbn=inventory.bookisbnANDinventory.storenum=store.storenumANDstorename='学海书店';  INSERTINTOareatableVALUES('000002','四川绵阳'); DELETEFROMareatable WHEREareanum='000002';  commit; 运行结果：                       \t  查和删的操作：test.sql begin; select*frombook; insertintobookvalues('888-6-155-50274-6','000000000001','00001','《这是测试》','2019-03-01','59.8','这是一条用来测试查询和删除的数据',''); select*frombook; deletefrombookwherebookisbn='888-6-155-50274-6'; select*frombook; commit; 运行结果：  编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 createProcedure.sql createorreplacefunctionPro_CurrentSale(tmp_saledatedate) returnstable( salenumnumeric, salemoneymoney )as$$ begin returnquery select sum(sale.salenum)as日销量, sum(sale.salemoney)as日销售金额 fromsale wheresale.saledate=tmp_saledate; end; $$languageplpgsql; 编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 CREATEORREPLACEFUNCTIONTri_InsertSale_FUNCTION()--createTrigger.sql RETURNSTRIGGERAS$$ BEGIN update\"inventory\"setinventoryamount=inventoryamount-new.salenum whereinventory.bookisbn=new.bookisbnandinventory.storenum=new.storenum; returnnull; END; $$ LANGUAGEplpgsql;  CREATETRIGGERTri_InsertSale AFTERINSERT ON\"sale\"FOREACHROW EXECUTEPROCEDURETri_InsertSale_FUNCTION(); 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。              八、实验数据及结果分析 \t本次实验重点在函数和触发器两个地方： \t函数部分： createProcedure.sql createorreplacefunctionPro_CurrentSale(tmp_saledatedate) returnstable( salenumnumeric, salemoneymoney )as$$ begin returnquery select sum(sale.salenum)as日销量, sum(sale.salemoney)as日销售金额 fromsale wheresale.saledate=tmp_saledate; end; $$languageplpgsql; 函数传入一个日期作为参数（需要查询的日期），通过where判断sale表的saledate和传入的参数相等，返回这个日期对应的销量的和以及这个日期对应的日销量金额的和 CREATEORREPLACEFUNCTIONTri_InsertSale_FUNCTION()--createTrigger.sql RETURNSTRIGGERAS$$ BEGIN update\"inventory\"setinventoryamount=inventoryamount-new.salenum whereinventory.bookisbn=new.bookisbnandinventory.storenum=new.storenum; returnnull; END; $$ LANGUAGEplpgsql;  CREATETRIGGERTri_InsertSale AFTERINSERT ON\"sale\"FOREACHROW EXECUTEPROCEDURETri_InsertSale_FUNCTION(); 触发器目前只考虑了卖的情况，即只针对sale表的insert操作同步修改了inventory表的相关属性。 对应的函数：在sale表中插入新的销量消息的时候，更新inventory表的数量（判断inventory和sale的bookisbn以及inventory对应的书店的编号和sale对应的书店编号） 九、总结及心得体会 \t通过本次实验，我复习了数据库的相关知识，并且熟悉了sql shell的使用，我逐渐感受到纯命令行界面的优势。相比之前大多在pgadmin4的界面，sql shell虽然少了图形操作，也需要熟悉一些指令，才可以实现对库和表的查看，切换等操作，但通过一步一步存档sql文件以及使用\\i 文件.sql命令执行.sql文件，可以更加方便的在不同机器上建立数据库（本次实验由于对sql shell命令不熟悉多次删改数据库，以及在寝室机器和笔记本机器上转移数据库的需求，我使用sql文件备份每一步操作，在不同机器之间通过多个sql文件同步实验进度），我学习并熟悉了纯命令行环境下的部分常用的命令，也体会到了纯命令行下几乎可以抛弃鼠标操作的便利。只需熟悉指令便可以实现对数据库的各种操作。 \t通过使用函数和触发器，我体会到了触发器带来同步修改的便利。之前最开始对一个表进行插入一条数据需要同时考虑多个表的更改并手动为每一个编写sql，而引入触发器对于大量更改要求以及对一个修改涉及多个表的有着大大简化工作量的作用。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称： 信软306 \t\t\t    实验时间：2019-5-22      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 说明：本节需学生编写内容。学生应根据实验内容，给出完成该实验的具体实验原理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 \t图形表示： \t图一：客户的存取权限控制安全模型  图二：商家的存取权限控制安全模型            （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 Sql语句：test.sql --q2 CREATEROLE\"R_Customer\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT NOREPLICATION CONNECTIONLIMIT-1 PASSWORD'123456';  CREATEROLE\"R_Seller\"WITH LOGIN SUPERUSER CREATEDB NOCREATEROLE INHERIT NOREPLICATION CONNECTIONLIMIT-1 PASSWORD'123456';  运行结果:  （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 --q3 GRANTSELECT ONwriter,publisher,store,book,booktype,areatable,inventory,discount,bookrank,sale TO\"R_Customer\"; GRANTINSERT,DELETE,UPDATE,SELECT ONwriter,publisher,store,book,booktype,areatable,inventory,discount,bookrank,sale TO\"R_Seller\";  运行结果：  （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 dropuser\"U_Customer\"; createuser\"U_Customer\"with password'123456';  dropuser\"U_Seller\"; createuser\"U_Seller\"with password'123456'; 运行结果：  （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 grant\"R_Customer\"to\"U_Customer\"; grant\"R_Seller\"to\"U_Seller\"; 运行结果：  （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 以U_Customer登录：  只能进行select 操作，其他的操作无法进行：\n   以U_Seller身份登录：  可以进行各项操作：  在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  八、实验数据及结果分析 实验二主要考察了我们创建角色和用户，权限管理等知识，角色和用户的创建过程十分相似。同时在创建用户时可以通过in role指定特定的角色或者在创建后用grant语句指定角色。通过利用为用户指定角色，可以对用户进行权限上的“分组”。 九、总结及心得体会 通过本次实验，我对数据库的角色和用户权限管理有了更加深刻的理解，以及对命令行下操作psql数据库更加熟练。",
  "studentID": "2017221105023"
 },
 "29": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t           实验时间：2019/05/20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 PgAdmin4的使用方法，SQL语言DDL、DML、DQL类型语句的使用方法，数据库语言的编程方法（存储过程，函数触发器等使用）。 该数据库对于给定的应用环境,利用计算机的基础知识、软件工程的原理和方法、程序设计的方法和技巧、数据库的基本知识、数据库设计技术、应用领域的知识等多学科综合知识与技术,对网上图书销售管理数据库做了需求分析,概念结构设计,逻辑结构设计,物理结构设计和Oracle数据库实施。最终设计出了一个简单的可对其进行用户管理、图书管理、进货管理,销售管理和售后管理的网上图书销售管理数据库,使之能够有效地管理和存储数据,满足一些简单的应用需求 pgAdmin4 提供了数据库操作方便的管理。既可以利用图形化工具进行创建、插入、删除等操作，同时可以利用SQL语句，进行创建的过程。 SQL语句基本格式： 创建数据库：create database <数据库名>; 创建表：CREATE TABLE  <表名>  \t\t（ <列名1>  <数据类型>  [列完整性约束]， \t\t\t<列名2>  <数据类型>   [列完整性约束]，\t     \t\t<列名3>  <数据类型>  [列完整性约束]，     \t\t…    \t)； 索引：CREATE INDEX  <索引名>  ON <表名><（列名）>； 视图：CREATE  VIEW  <视图名>[(列名1)，(列名2)，…]  AS  <SELECT查询>； 增：ALTER TABLE <表名> ADD <新列名称><数据类型>|[完整性约束]； \tINSERT  INTO  <表名|视图名>[<列名表>]  VALUES （列值表）; 删：ALTER TABLE<表名> DROP  COLUMN <列名>； 查：SELECT  [ALL|DISTINCT]  <目标列>[，<目标列>…] [ INTO <新表> ] FROM  <表名|视图名>[，<表名|视图名>…] [ WHERE  <条件表达式> ] [ GROUP BY  <列名> [HAVING <条件表达式> ]] [ ORDER BY  <列名> [ ASC | DESC ] ]; 改：UPDATE  <表名|视图名> SET  <列名1>=<表达式1> [，<列名2>=<表达式2>...] [WHERE   <条件表达式>]； 函数：CREATE [ OR REPLACE ] FUNCTION  name     \t( [ [ argmode ] [ argname ] argtype [ { DEFAULT | = } default_expr ] [, ...] ] )     \t[ RETURNS retype | RETURNS TABLE ( column_name column_type [, ...] ) ] AS $$         //$$用于声明存储过程的实际代码的开始 DECLARE         \t-- 声明段 BEGIN         \t--函数体语句 END; $$ LANGUAGE lang_name;  触发器：CREATE  TRIGGER  触发器名        { BEFORE | AFTER | INSTEAD OF }      ON 表名      [ FOR [ EACH ] { ROW | STATEMENT } ]      EXECUTE PROCEDURE 存储过程名 ( 参数列表 ) 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 建立BookSale数据库。 根据实验题目要求对BookSale使用PowerDesigner进行设计建模。 根据模型生成SQL代码在BookSale中建立各个表。 在BookSale中创建视图，索引。 对BookSale进行增删改查操作。 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计，并进行调用测试。 编写Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理，并进行调用测试。 八、实验数据及结果分析 首先，建立BookSale数据库，建立结果如图8-1，8-2。   根据实验题目要求对BookSale使用PowerDesigner进行设计建模，所得到的物理模型图如图8-3。     利用Power Designer软件根据模型直接生成SQL代码，整理生成的SQL代码结果如下，使用SQL代码在BookSale中建立各个表。  建立表的结果如图8-4所示：  按照要求在BookSale中创建视图，索引。 下面是创建视图的代码： 创建视图运行的结果，如图8-5： 下面是创建索引的代码：  对BookSale进行增删改查操作。 向表中添加数据的代码以及运行结果如下：  bookhouse的数据插入情况未及时截图。故此处不进行配图。 删除的实例代码以及运行结果如下：   更新的实例代码以及运行结果如下：  查找的实例代码以及运行结果如下： 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计，并进行调用测试。 \t调用函数 \t调用函数结果图图8-12  编写Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理，并进行调用测试。 编写的触发器函数如下： 根据函数创建触发器的代码如下： 然后对Salecase表执行添加，删除，更新等操作。 首先执行添加： 然后执行删除操作： 在图8-14中，左图为执行前的库存图，右图为执行后的库存图。 图8-15为删除后的Salecase表。  然后执行更新操作，运行结果图8-16：    可以看到，触发器的运行结果与预期相同。  九、总结及心得体会 本次实验难度并不大，前面的实验内容都是比较基础的内容，相对来说，难点主要在于存储过程的编写和实现以及触发器的编写和事先。其中，存储过程的掌握是编写触发器函数的基础，在编写函数时，要注意语句的格式要求，因为对于SQL语句不熟练，在刚开始尝试编写的时候总是出很多错。在存储过程函数的基础上，触发器函数的编写要考虑条件的对比，这里要注意：条件必须全部大写，在一般的SQL编程过程中，小写的代码也能正常执行，但是判断部分进行的是字符串的比较，所以必须大写。总之熟记相关的SQL语句，熟练掌握SQL语句，才能更好更快的实现触发器和存储过程的功能。 通过这次实验，我加深了对于创建数据库，插入数据，定义约束和主键等数据库基本操作的理解，学习了存储过程和触发器的编写方法使我的SQL编程能力得到了一定的锻炼。。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：  \t\t\t\t\t          实验时间：      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 数据库权限管理包括了一下三种权限控制模型： 1)\t数据库系统权限 2)\t数据库对象访问操作权限 3)\t数据库对象定义操作权限 权限管理SQL语句： \tGRANT  <权限名> ON  <对象名>  TO {数据库用户名|用户角色名}； REVOKE  <权限名> ON  <对象名>  FROM {数据库用户名|用户角色名}； DENY  <权限名> ON  <对象名> TO {数据库用户名|用户角色名}； \t角色管理SQL语句： \t\tCREATE  ROLE  <角色名> [ [ WITH ] option [ ... ] ]; \t --创建角色 ALTER  ROLE  <角色名>  [ [ WITH ] option [ ... ] ]; \t --修改角色属性 ALTER  ROLE  <角色名>  RENAME TO <新角色名>; \t\t --修改角色名称  ALTER  ROLE  <角色名>  SET <参数项> { TO | = } { value | DEFAULT };  \t\t\t\t\t\t\t --修改角色参数值 ALTER  ROLE  <角色名>  RESET <参数项>;\t\t --复位角色参数值 DROP  ROLE  <角色名>;\t\t\t\t\t\t --删除指定角色 \t用户创建SQL语句： \t\tCREATE USER  <用户账号名> [ [WITH]  option […]]; \t用户修改SQL语句： \t\tALTER USER  <用户名>  [ [ WITH ] option [ ... ] ];  \t--修改用户的属性 ALTER USER  <用户名>  RENAME TO <新用户名>;  \t\t--修改用户的名称 ALTER USER  <用户名>  SET <参数项> { TO | = } { value | DEFAULT }; \t\t\t\t\t\t\t--修改用户的参数值   ALTER USER  <用户名>  RESET <参数项>;\t\t--重置用户参数值 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.首先，根据系统的实际要求设计数据存取权限的模型。 2.编写创建这两类角色的代码，并允许。 3.通过代码为这两类角色赋予权限。 4.创建两个用户。 5.为这两个用户分别分配角色。 6.通过命令行分别以两个用户的身份访问数据库，并验证权限的正确性。 八、实验数据及结果分析 首先，根据用户的需求为其分配其应有的权限。 客户应当可以查看书籍的信息，同时可以查看当前的库存情况，但是他不能修改任何东西，也不能查看销售记录。 商机对书籍信息，库存，销售情况均有增删改查的权限。 2.创建这两类角色。 3.编写赋予权限的代码 4.创建两个用户 5.为这两个用户分配角色 6.  首先，登录客户用户，然后检查他的搜索权限，如下图： 然后登录商家用户，首先，检查其搜索权限，然后检查其删除权限。 下图为删除与其结果展示界面： 九、总结及心得体会 本次实验内容前五道题相对基础，主要是编写SQL代码运行，属于基础问题，难度不大。第六问要求通过不同用户登录，因为在Pgadmin4页面内未找到不同用户登录的方法，所以这里通过PSQL来进行不同用户的登录，这就要求我们对于PSQL的各个参数有基本的了解。在这里，我们需要了解的东西是要输入特定的数据库名称与特定的用户名，并且大小写必须和初始时一样，不能全小写。 通过本次实验，我深入了解了数据库权限管理的机制和方法，掌握了数据库权限设计模型的设计和实现技巧，学会了用户权限控制模型图的绘制方法。 同时我还学习了数据库角色管理、用户管理的SQL语句和相关方法，以及不同用户登录数据库的方法，提高了我对于数据库管理方面的知识水平和能力。 ",
  "studentID": "2017221105024"
 },
 "30": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西304、306     实验时间：2019.05.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1. 数据库模式定义语言DDL 数据库模式定义语言DDL(Data Definition Language)，是用于描述数据库中要存储的现实世界实体的语言。 CREATE DATABASE 创建数据库 CREATE TABLE 创建数据库表格 ALTER TABLE 修改数据库表格 DROP TABLE 删除数据库表格 CREATE VIEW 创建查询命令 ALTER VIEW 修改查询命令 DROP VIEW 删除查询命令 TRUNCATE TABLE 删除数据表内容 2. 数据操纵语言DML 数据操纵语言（Data Manipulation Language, DML）是SQL语言中，负责对数据库对象运行数据访问工作的指令集，以INSERT、UPDATE、DELETE三种指令为核心，分别代表插入、更新与删除，是开发以数据为中心的应用程序必定会使用到的指令，因此有很多开发人员都把加上SQL的SELECT语句的四大指令以“CRUD”来称呼。 DML 的主要功能即是访问数据，因此其语法都是以读取与写入数据库为主，除了INSERT以外，其他指令都可能需搭配WHERE指令来过滤数据范围，或是不加WHERE指令来访问全部的数据。 INSERT是将数据插入到数据库对象中的指令，可以插入数据的数据库对象有数据表以及可更新查看表两种。 UPDATE 指令是依给定条件，将匹配条件的数据表中的数据更新为新的数值。 DELETE 指令为自数据库对象中删除数据的指令。 \t3. 数据查询语言DQL \t\t标准语法： 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.图书销售管理系统数据库BookSale创建操作。 2.在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 \t\t(1). 设计概念数据模型设计 \t\t(2). 设计逻辑数据模型设计 \t\t(3). 设计物理数据模型设计 \t\t(4). PostgreSQL实现图书销售管理系统创建 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 1.图书销售管理系统数据库BookSale创建操作如图1-1所示。  图1-1 图书销售管理系统数据库BookSale的创建 2. 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 \t\t(1). 设计概念数据模型设计 \t\t\t抽取出数据需求对象，标识为如图2-1-1所示的实体。  图2-1-1 图书销售管理系统实体 通过分析上述实体对象之间在图书销售管理系统中的相关性，表示实体之间的关系，采用E-R模型的联系元素符号表示这些实体之间的联系，如图2-1-2所示。  图2-1-2 图书销售管理系统的实体联系 在以上概略的E-R模型图基础上进一步细化设计，确定各个实体的属性，如图2-1-3所示。  图2-1-3 图书销售管理系统实体细化 针对图2-1-3所示的图书销售管理系统E-R模型，我们可以分析出该模型存在实体及联系遗漏情况，如用户在数据库中无法了解某些商店有那些图书，也无法了解各商店中图书的库存。因此需要对该E-R模型进行完善，增加“库存”实体，并与“图书”和“商店”实体建立联系。此外，为了便于客户按图书类别进行商品信息浏览或查询，在原数据模型的基础上，增加了“图书类别”实体，并将它与“图书”实体建立联系。完善之后的系统E-R模型图如图2-4所示。  图2-1-4 完善之后的图书销售管理系统E-R模型 \t\t(2). 设计逻辑数据模型设计 将图2-1-4所示的图书馆销售管理系统概念数据模型转换设计为逻辑数据模型，如2-2-1所示。  图2-2-1 初步的图书销售管理系统逻辑数据模型 通过分析图2-2-1所示的图书销售管理系统逻辑数据模型，可以看到该模型的“作者”实体不符合关系数据库设计规范的3NF范式，其中的“省”和“城市”属性存在传递以来。此外，新引入的关联实体“编著”的名称不要确切，其属性仅仅只有所依赖实体的标识符，缺少自身属性。因此，需要对该逻辑数据模型进行规范化完善设计，其设计结果如图2-2-2所示。  图2-2-2 完善后的图书销售管理系统逻辑数据模型 (3). 设计物理数据模型设计 在图2-2-2所示的图书销售管理系统逻辑数据模型基础上，进行E-R模型到关系模型转换，从而给出图书销售管理系统的物理数据模型设计方案，其设计结果如图2-3-1所示。  图2-3-1 图书销售管理系统物理数据模型 所涉及的图书销售管理系统物理数据模型，只有两种模型符号――“关系表”符号和“参照完整性”符号，这些符号将数据库表对象的组成结构描述出来。该模型是数据库表对象的可视化展现。通过物理数据模型图可直观地了解数据库的表结构设计，以及表间关系。 (4). PostgreSQL实现图书销售管理系统创建 在psql中键入上面的SQL语句之后，打开pgAdmin 4，查看表创建情况，如图2-4-1所示。  图2-4-1 表创建结果 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 \t按照表3-1进行对地区的增添。 表1-1 地区信息表 \t在SQL Shell中键入如下代码： \t结果如图3-1所示：  图3-1 地区增添结果 \t按照表3-2对作者进行增添。 表3-2 作者信息表 \t在SQL Shell中键入如下代码： \t结果如图3-2所示：  图3-2 作者增添结果 \t按照表3-3对出版社进行增添。 表3-3 出版社信息表 \t在SQL Shell中键入如下代码： \t结果如图3-3所示：  图3-3 出版社增添结果 \t按照表3-4对图书类别进行增添： 表3-4 图书类别信息表 \t在SQL Shell中键入如下代码： \t结果如图3-4所示：  图3-4 图书类别增添结果 \t按照表3-5对图书进行增添。 表3-5 图书信息表 \t在SQL Shell中键入如下代码： \t结果如图3-5所示。  图3-5 图书增添结果 \t按照表3-6对编著排名表进行增添。 表3-6 编著排名信息表 \t在SQL Shell中键入如下代码： \t结果如图3-5所示。  图3-6 编著排名增添结果 \t按照表3-7对书店表进行增添。 表3-7 书店信息表 在SQL Shell中键入如下代码： \t结果如图3-7所示。  图3-7 书店表增添结果 \t按照表3-8对库存表进行增添。 表3-8 库存信息表 \t在SQL Shell中键入如下代码： \t结果如图3-8所示。  图3-8 库存增添结果 \t按照表3-9对销售记录进行增添并且同时对库存表进行修改。 表3-9 销售记录信息表 \t在SQL Shell中键入如下代码： \t结果如图3-9所示。  图3-9 销售记录增添和库存更新结果 \t查看对学海书店中的所有书籍库存，在SQL Shell中键入代码： \t运行结果如图3-10所示。  图3-10 学海书店书籍库存查询结果 \t在地区表中插入表3-10数据，再进行删除操作。 表3-10 地区信息表2 \t在SQL Shell中键入如下代码： \t运行结果如图3-11所示。  图3-11 插入删除操作结果 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 \t在SQL Shell中键入如下语句，创建函数： \t运行结果如图3-12所示。  图4-1 函数创建结果 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 \t在SQL中键入如下语句，实现对函数的调用，对2019年3月3日的销售进行统计： \t运行结果如图5-1所示。  图5-1 函数调用结果 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 \t在SQL中键入如下语句，实现触发器的创建： \t运行结果如图6-1所示。  图6-1 创建触发器运行结果 7.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 \t\t在SQL中键入如下代码，尝试触发Tri_InsertSale触发器： \t\t运行结果如图7-1所示。  图7-1 触发器运行结果 九、总结及心得体会 在SQL Shell中操作时，最好将SQL代码先在文件中准备完成，这样可以尽可能的减少在编写中的错误，也可以方便的通过复制粘贴或者输入重定向向SQL Shell中键入代码. \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西304、306      实验时间：2017.05.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 创建： CREATE USER和CREATE ROLE的区别在于，CREATE USER指令创建的用户默认是有登录权限的，而CREATE ROLE没有。 创建用户时设定用户属性： 可以通过\\h CREATE ROLE指令查看全部可设置的管理权限。 修改用户属性： 设置访问权限： \\z或\\dp指令显示用户访问权限。 \\h GRANT显示所有可设置的访问权限。 撤销用户访问权限： 其中permission_type和table_name含义与GRANT指令中相同。 创建组示例： 切换ROLE： INHERIT权限： 该属性使组成员拥有组的所有权限。 删除用户和组： 删除用户和组很简单。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 \t数据存取权限控制如表1-1所示，且客户角色和商家角色都有继承、登录和连接权限： 表1-1 数据存取权限表 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 \t在SQL Shell键入如下语句： \t运行结果如图2-1所示。  图2-1 角色创建结果 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 \t在SQL Shell中键入如下语句： \t运行结果如图3-1所示。  图3-1 赋予数据库对象权限结果 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 \t在SQL Shell中键入如下语句： \t运行结果如图4-1所示。  图4-1 用户创建结果 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 分别登陆客户用户U_Customer、商家用户U_Seller，并且在SQL Shell中键入如下代码： \t登录客户用户访问结果如图6-1所示。  图6-1 客户用户访问结果 \t登录商家用户访问结果如图6-2所示。  图6-2 商家用户访问结果 从图6-1可以得知，当客户用户尝试对地区表进行插入、删除和更新操作时，均会返回没有权限的提示信息；当客户用户尝试对地区表进行查询时，结果正常返回。 从图6-2可以得知，当商家用户尝试对地区表进行插入、删除、更新和查询时，均能正常返回信息。 九、总结及心得体会 通过合理地分配权限给不同角色，可以减轻数据库设计和编码人员的工作量，给予角色的权限仅能满足其需求即可，而不能给予多余的、对于该用户无用的权限，以此来保证数据库中信息的安全性。",
  "studentID": "2017221105025"
 },
 "31": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：\t信软楼\t\t\t\t           实验时间：2019-6-16 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实 体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设 计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。  2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在 本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过 程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、 存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.在数据库服务器中，采用SQL语句执行方式，创建图书销售管理系统数据库BookSale。2.在BookSale数据库中，采用SQL语句执行方式，创建book（图书表）、auther（作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为book、auther、publisher、customer表准备样本数据，采用SQL语句执行方式，将样本数据插入到表中。采用SQL语句对book、auther、publisher、customer表进行数据修改、删除、查询、统计等访问操作。 4.创建视图BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图Book_View进行数据查询访问操作。 5.编写触发器函数，实现在sale表数据插入时，级联操作stock表，将图书的库存流水进行记录，同时级联更新book表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备sale表的样本数据，并将其插入sale表，插入之后查看stock表是否有对应的更新，并对比插入sale数据前后book中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验数据及结果分析 1. 创建 BookSale 数据库 create database BookSale 2. 创建各数据库表以及表中主外键和索引 create table Auther ( AU_ID CHAR(18) not null, AU_Name VARCHAR(20) not null, AU_Gender CHAR(2) not null, AU_Phone VARCHAR(11) not null, AU_Address VARCHAR(50) not null, constraint PK_AUTHER primary key (AU_ID) ); create table Book ( Book_ISBN CHAR(13) not null, AU_ID CHAR(18) null, PUB_ID CHAR(11) null, Book_Name VARCHAR(50) not null, Book_Pubdate DATE not null, Book_Price MONEY not null, Book_Category VARCHAR(20) not null, Book_Stock INT4 not null, Book_Notes VARCHAR(100) null, Book_List VARCHAR(100) null, constraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER ( CUST_ID CHAR(18) not null, CUST_Name VARCHAR(20) not null, CUST_Phone VARCHAR(15) not null, CUST_Address VARCHAR(50) not null, CUST_Email VARCHAR(50) not null, constraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher ( PUB_ID CHAR(11) not null, PUB_Name VARCHAR(20) not null, PUB_Phone VARCHAR(15) not null, PUB_Address VARCHAR(50) not null, constraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale ( SALE_ID VARCHAR(11) not null, Book_ISBN CHAR(13) null, CUST_ID CHAR(18) null, SALE_Date DATE not null, SALE_QTY INT4 not null, SALE_Amount MONEY not null, constraint PK_SALE primary key (SALE_ID) ); create table Stock ( Stock_ID VARCHAR(10) not null, Book_ISBN CHAR(13) null, Stock_Change INT4 not null, Stock_Operation CHAR(4) not null, Stock_Datetime DATE not null, constraint PK_STOCK primary key (Stock_ID) ); alter table Book add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) references Auther (AU_ID) on delete restrict on update restrict; alter table Book add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) references Publisher (PUB_ID) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_CUSTOMER__CUSTOMER foreign key (CUST_ID) references CUSTOMER (CUST_ID) on delete restrict on update restrict; alter table Stock add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; 3. 插入样本数据并对 publisher 表进行增删查改操作 Insert intoAuther values('330309198504150527','王天','男','13554874593','四川省成都市成华区建设北路 二段十号');  Insert intoAuther values('540135199103281548','叶无双','男','15812387538','浙江省杭州市天路区梅田路 二十八号'); Insert intoAuther values('120857198811123587','李婷','女','18575615472','北京市朝阳区梅山路二巷八号 '); InsertintoPUBLISHERvalues('PUB00000001','高等教育出版社','010-65321854','北京'); InsertintoPUBLISHERvalues('PUB00000002','电子工业出版社','010-65329857','北京'); InsertintoPUBLISHERvalues('PUB00000003','人民邮电出版社','010-65325987','北京'); InsertintoBOOK values('9787115502742','330309198504150527','PUB00000001','Web 前端开发最佳实践 ','2016-01-01','59','IT 技术','100'); Insert into BOOK values('9875325415577','540135199103281548','PUB00000002','Java EE Web 编 程 ','2008-01-01','52','IT 技术','200');  Insert into BOOK values('9865365975234','120857198811123587','PUB00000003',' 数 据 库 实 验 指 导 ','2013-08-1','29','IT 技术','150');  Insertintocustomer values('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二 段十一号','450448745@qq.com');  Insertintocustomer values('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十 九号','657873215@qq.com');  Insertintocustomer values('542244197812121687','鲁丽','13615869875','北京市朝阳区梅山路二巷十六号 ','647864378@qq.com'); 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计 CREATEORREPLACEFUNCTIONcountsale(OUTamountint,OUTallmoneymoney) as$count$  BEGIN select sum(sale_qty) into amount FROM sale WHERE sale_date= '2019-05-20';  select sum(sale_amount) into allmoney FROM sale WHERE sale_date='2019-05-20';  END;  $count$LANGUAGEplpgsql; 5.编写过程语句块，实现对函数Pro_CurrentSale的调用 Select * from Pro_CurrentSale () 6. 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 CREATE OR REPLAC EFUNCTION InsertSale() RETURNS TRIGGER AS $$ \tBEGIN \t\tIF(TG_OP='INSERT')THEN \t\t\tINSERT INTO stockvalues(new.sale_id,new.book_isbn,new.sale_qty,'出库',new.sale_date);  \t\t\tupdate book set book.book_stock = book.book_stock - new.sale_qty where book.book_isbn = new.book_isbn;  \t\t\tRETURN NEW;  \t\tENDIF;  \t\tRETURN NULL;  \tEND;  $$LANGUAGEplpgsql; 7. 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 测试触发器 SQL 语句： Insertintosalevalues('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885'); Insertintosalevalues('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040'); Insertintosalevalues('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450'); stock表：    book表：  九、总结及心得体会 成功完成实验，完成所有题目。以后应该多多注重基础知识的练习。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼\t\t\t          实验时间：2019-6-16 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2.在pgAdmin4中的BookSale数据库中，使用SQL语句创建客户（R_Customer）角色、商家（R_Seller）角色。 3.在pgAdmin4中，根据第一步设计的数据存取权限控制模型对客户（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在pgAdmin4中，分别创建客户用户U_Customer、商家用户U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。 八、实验数据及结果分析 1. 针对图书销售管理系统数据库，设计数据存取权限控制模型。 2. 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 CREATE ROLE \"R_Customer\"  WITH  LOGIN  NOSUPERUSER  NOCREATEDB  NOCREATEROLE  NOINHERIT  NOREPLICATION  CONNECTIONLIMIT-1 ------------------------------------------------------------------------------------------------------------ CREATE ROLE \"R_Seller\" WITH  LOGIN  NOSUPERUSER  NOCREATEDB  NOCREATEROLE  NOINHERIT  NOREPLICATION  CONNECTIONLIMIT-1 3. 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限 GRANT SELECT ON book TO \"R_Customer\";  GRANT SELECT ON auther TO \"R_Customer\";  GRANT SELECT ON publisher TO \"R_Customer\"; 4 and 5. 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT-1 IN ROLE \"R_Customer\" PASSWORD '123456'; CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT-1 IN ROLE \"R_Seller\" PASSWORD '123456'; 6. 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。           全部达到预期效果！ 九、总结及心得体会 成功完成实验，完成所有题目，以后应多加夯实基础",
  "studentID": "2017221201023"
 },
 "32": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t        实验时间：2019.5.20   三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 创建数据库与创建表： 在数据库系统中，最大的对象就是数据库本身，SQL为我们提供了数据库对象的创建和维护语句。创建数据库语句为: CREATE DATABASE <数据库名称> 在创建完数据库后，我们就需要创建数据库中的关系表。因为在关系数据库中，数据是以数据库表的形式组织存在的。在创建数据库表的同时，我们也需要指定表中的列具有的属性，包括列名、数据类型、完整性约束等。这些属性决定了一个列是否为主键、是否为外键、是否非空、数据类型，默认值、取值范围等。其一般格式为： CREATE TABLE <数据库表名> (<列名1>  <数据类型>  <列完整性约束>, <列名2>  <数据类型>  <列完整性约束>, <列名3>  <数据类型>  <列完整性约束>, ……             );  数据操作SQL语句 数据操作语言是一类以表中数据为操作对象的语句集，主要包括了INSERT、UPDATE、DELETE三大类语句。INSERT用于数据插入，UPDATE用于数据更新，DELETE用于数据删除，其格式依次为： INSERT INTO  <基本表> [<列名表>]  VALUES(列值表);  UPDATE <基本表> SET <列名1>=<表达式1> [<列名2>=<表达式2>……] [WHERE <条件表达式>];  DELETE FROM <表名> [WHERE  <条件表达式>];  数据查询SQL语句 在SQL中，实现对数据库表进行数据查询处理的语句只有SELECT语句一种，其功能丰富，组合条件使用灵活，其基本语句格式为： SELECT  [ALL|DISTINCT]  <目标列>[,<目标列>…] [  INTO <新表>] FROM  <表名>[,<表名>…] [WHERE  <条件表达式>] [GROUP BY <列名> [HAVING<条件表达式>] [ORDER BY <列名> [ASC | DESC]]; 我们可以通过WHERE语句的嵌套或JOIN…ON…语句的连接来查询多表。  索引与视图 在数据库中，通常一些表包含大量的数据，此时如果我们采用逐个搜索的方式去查询，效率就会很低。这时，我们可以在数据库中创建一个索引来帮助我们查询，加快查询的速度。索引具有类似图书目录的索引结构，并将索引列的值以及索引指针数据保存在索引结构中。当然，索引本身也会给数据库系统带来开销，包括创建和维护索引的开销、索引本身需要占用的物理空间等，因此我们一般只在需要快速查询或数据量较大的表中建立索引，其他表中则没有这个必要。创建索引的SQL语句格式为：     CREATE INDEX <表名> ON < (<列名>[,….])>; 视图是由一个或几个基础表或其他视图的SELECT查询结果创建生成，它的所有数据来源于基表或其他视图。使用视图我们可以简化SELECT查询操作，提高数据访问安全性，提供一定程度的数据逻辑独立性以及集中展示用户所感兴趣的数据集。创建视图的SQL语句格式为： CREATE  VIEW  <视图名> [(列名1),(列名2),…] AS <SELECT查询>;  函数 在SQL中，我们可以用函数对SELECT查询的结果集进行处理，这些函数可以是DBMS内置的函数，也可以是用户自己编写的函数。内置函数大概分为聚合函数、算术函数、字符串函数、日期时间函数、数据类型转换函数等五大类。 sql函数的优点有： 允许标准组件式编程，提高了SQL语句的重用性、共享性和可移植性。 可以减少重复编写程序段的工作量，提高程序可读性。 提高程序编译和运行效率，产生质量较高的目标代码，满足算法设计的“正确性、可读性、健壮性、效率与低存储量需求”的基本要求。 能够实现较快的执行速度，能够减少网络流量 sql函数的缺点有： sql本身是一种结构化查询语言，而存储过程则是过程性的，其业务处理过程较为复杂，特别是在大型系统中效率较低。 如果存储过程的参数或返回数据发生变化，一般需要修改存储过程的代码，较为麻烦。 开发调试较为复杂 可移植性差。由于不同sql数据库的操作语句存在差异，一般存储过程是无法在不同的sql系统中通用的。  触发器 触发器（trigger）是SQL server 提供给程序员和数据分析员来保证数据完整性的一种方法，它是与表事件相关的特殊的存储过程，它的执行不是由程序调用，也不是手工启动，而是由事件来触发，当对一个表进行操作（ insert，delete， update）时就会激活它执行。触发器经常用于加强数据的完整性约束和业务规则等。 触发器可以从 DBA_TRIGGERS ，USER_TRIGGERS 数据字典中查到。 触发器与存储过程最大的区别是运行方式的不同，触发器不能执行EXECUTE语句调用，而是在用户执行Transact-SQL语句时自动触发执行而存储过程需要用户，应用程序或者触发器来显示地调用并执行。因此，触发器可以实现某些更为复杂的约束。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 步骤1：创建数据库 步骤2：建立数据库表 步骤3：插入测试数据 步骤4：在表上建立索引 步骤5：在表上建立视图 步骤6：对表中数据进行增删改查操作，进行测试 步骤7：编写函数Pro_CurrentSale并验证 步骤8：编写图书销售表Insert触发器Tri_InsertSale并验证 八、实验数据及结果分析  步骤1中，创建数据库结果如下: 步骤2：建立数据库表结果如下： 步骤3：插入测试数据： 步骤4：在表上建立索引  步骤5：在表上建立视图  步骤6：对表中数据进行增删改查操作，进行测试  步骤7：编写函数Pro_CurrentSale并验证  步骤8：编写图书销售表Insert触发器Tri_InsertSale并验证   九、总结及心得体会 在本次实验中，我们主要实现了一个图书销售管理系统的设计、编写库表、性能优化以及编写函数、触发器等。这使得我们对于SQL数据库编程的各项内容有了深入的理解，并使得我们能够在日常工作中轻松地设计出一个可以应用的SQL数据库以及数据库中的表、函数、索引、视图、触发器等各类实体。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306        实验时间：2019-05-27  三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 数据库安全管理 SQL Server的安全模型分为三层结构，分别为服务器安全管理、数据库安全管理和数据库对象的访问权限管理。用户访问数据库时需要经历的三个阶段及相应的安全认证过程： 第一阶段：用户首先登陆到SQL Server实例。在登陆时，系统要对其进行身份验证，被认为是合法时才能登录到SQL Server实例。 第二阶段：用户在每个要访问的数据库里必须获得一个用户账号。SQL Server实例将SQL Server登陆映射到数据库用户账号上，在这个数据库的用户账号上定义数据库的管理和数据对象的访问安全策略。 第三个阶段：用户访问数据库。用户访问数据对象时，系统要检查用户是否具有访问数据库对象、执行动作的权限，经过语句许可权限的验证，才能实现对数据的操作。  角色与用户 用户是数据库的使用者和管理者，数据库通过设置用户及安全属性来控制用户对数据库的访问。数据库的用户分两类，一类是创建数据库时系统预定义的用户，一类是根据应用由DBA创建的用户。 假如我们直接给每一个用户赋予权限，这将是一个巨大又麻烦的工作，同时也不方便DBA进行管理。通过采用角色，使得： 权限管理更方便。将角色赋予多个用户，实现不同用户相同的授权。如果要修改这些用户的权限，只需修改角色即可。 角色的权限可以激活和关闭。使得DBA可以方便的选择是否赋予用户某个角色。 提高性能，使用角色减少了数据字典中授权记录的数量，通过关闭角色使得在语句执行过程中减少了权限的确认。 在postgreSQL中，数据库角色和用户的区别在于是否能够登陆数据库。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 步骤1：创建客户（R_Customer）、商家（R_Seller）角色。 步骤2：为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 步骤3：创建客户用户U_Customer、商家用户U_Seller。 步骤4：以用户U_Customer身份访问图书销售管理数据库，进行数据存储验证权限。 步骤5：以用户U_Seller身份访问图书销售管理数据库，进行数据存储验证权限。  八、实验数据及结果分析 步骤1：创建客户（R_Customer）、商家（R_Seller）角色。  步骤2：为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  步骤3：创建客户用户U_Customer、商家用户U_Seller。  步骤4：以用户U_Customer身份访问图书销售管理数据库，进行数据存储验证权限。  步骤5：以用户U_Seller身份访问图书销售管理数据库，进行数据存储验证权限。  九、总结及心得体会 在本次实验中，我们主要进行了创建数据库角色和用户并登陆验证其数据存储权限的工作，这使得我们对数据库安全管理有了更为深刻的理解，并使得我们能够在日常工作中轻松地设计出一个可以应用的SQL数据库以及数据库中角色、用户等各数据库项安全管理的相关实体。 ",
  "studentID": "2017221301002"
 },
 "33": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西306\t\t\t\t           实验时间：2019.5.20 2019.5.22      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 （1）基本SQL语句：  数据库创建SQL语句   基本格式：CREATE  DATABASE  <数据库名>;   数据库表创建SQL语句 CREATE TABLE  <表名>   （ <列名1>  <数据类型>  [列完整性约束]， \t <列名2>  <数据类型>   [列完整性约束]，\t      <列名3>  <数据类型>  [列完整性约束]，      …     )；   表约束定义外键 CREATE TABLE  <表名>  （ <列名1>  <数据类型>  [列完整性约束]， \t<列名2>  <数据类型>   [列完整性约束]，\t     <列名3>  <数据类型>  [列完整性约束]，     …     CONSTRAINT  <约束名>  FOREIGN Key(外键列)    )；  数据插入SQL语句 基本格式：INSERT  INTO  <表名|视图名>[<列名表>]  VALUES （列值表）;  （2）创建存储过程的语法 CREATE [ OR REPLACE ] FUNCTION  name     ( [ [ argmode ] [ argname ] argtype [ { DEFAULT | = } default_expr ] [, ...] ] )     [ RETURNS retype | RETURNS TABLE ( column_name column_type [, ...] ) ] AS $$         //$$用于声明存储过程的实际代码的开始 DECLARE         -- 声明段 BEGIN         --函数体语句 END; $$ LANGUAGE lang_name;  //$$ 表明代码的结束, LANGUAGE后面指明所用的编程语言  （1）name：要创建的存储过程名； （2）OR REPLACE ：覆盖同名的存储过程； （3）argmode：存储过程参数的模式可以为IN、OUT或INOUT，缺省值是IN。 （4）argname：形式参数的名字。 （5）RETURNS：返回值；RETURNS TABLE：返回二维表        （3）执行存储过程         select 存储过程名（参数）； 或者： select  * from 存储过程名（参数）； 例如： select  countRecords ( ); 或者：select  * from countRecords ( );  （4） PostgreSQL创建触发器的基本语法 CREATE  TRIGGER  触发器名        { BEFORE | AFTER | INSTEAD OF }      ON 表名      [ FOR [ EACH ] { ROW | STATEMENT } ]      EXECUTE PROCEDURE 存储过程名 ( 参数列表 )  （1）指明所定义的触发器名    （2） BEFORE | AFTER | INSTEAD OF  指明触发器被触发的时间 （3） ON 表名 指明触发器所依附的表 （4） FOR  EACH  { ROW | STATEMENT }  指明触发器被触发的次数 （5） EXECUTE PROCEDURE 存储过程名 ( 参数列表 )  指明触发时所执行的存储过程  （1）检查数据库中将要创建的触发器所依附的表或视图是否存在，如果不存在，必须首先创建该表或视图。 （2）创建触发器被触发时所要执行的触发器函数，该函数的类型必须是TRINGER型，是触发器的执行函数。但要注意，有些数据库不需要独立定义触发器函数，而是在创建触发器时，定义触发器的过程体。 （3）创建触发器，一般需要指明触发器依附的表，触发器被触发执行的时间，触发器是行级触发器还是语句级触发器，触发器执行需要满足的条件。   五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 实验的基本步骤如下： 建立图书销售数据库 在图书销售数据库之上按照书P128创建表，共有10个表 设置好数据内容，并在数据库表之中插入数据内容 编写函数Pro_CurrentSale，实现对于图书销量以及图书销售金额的统计功能 验证函数Pro_CurrentSale的功能，能够正确的调用该函数 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 对于实验数据和结果的分析，我们按照实验步骤来进行，主要是图片配合文字来对实验的来进行一些分析。  1.建立图书销售数据库  SQL语句如下：Create DATABASE BookSale;  当然SQL语句是一种创建方法，我们也可以采用在图形界面直接进行创建，两种方法都是可以达成一致的目的的，本处采用的是直接在图形界面创建BookSale数据库，结果截图如下。      图1 创建数据库BookSale  在图书销售数据库之上按照书P128创建表，共有10个表 这部分的内容主要是用SQL语句进行的创建，而没有用图形界面进行创建，下面是对应的十个表的建立表语句：  创建地区表Area SQL语句如下： CREATE TABLE Area(  AreaNumber  char(6) PRIMARY KEY,  AreaName    varchar(30) NULL );  创建作者表Author SQL语句如下： CREATE TABLE Author (  AuthorId   char(12) PRIMARY KEY,  AreaNumber char(6)  NOT NULL,  CONSTRAINT AreaNumber_FK  FOREIGN KEY(AreaNumber)  REFERENCES  Area(AreaNumber)   ON DELETE CASCADE ,  AuthorName    varchar(40) NOT NULL,  AuthorAddress varchar(80) NOT NULL,  Telphone      char(11) NOT NULL );  创建出版社表Publish SQL语句如下： CREATE TABLE Publish (  PublishId  char(12) PRIMARY KEY,  PublishName   varchar(40) NOT NULL,  PublishTelphone varchar(20) NOT NULL,  PublishAddress varchar(60) NOT NULL );  创建商店表store SQL语句如下： CREATE TABLE store (  StoreId    char(12) PRIMARY KEY,  StoreName  varchar(40) NOT NULL,  Postalcode char(5)  NOT NULL,  StoreAddress varchar(80) NOT NULL );  创建图书类别表booktype SQL语句如下： CREATE TABLE booktype (  typeId    char(5) PRIMARY KEY,  typeName  varchar(20) NOT NULL );  创建折扣表Discount SQL语句如下： CREATE TABLE Discount (  DiscountId  INT2 PRIMARY KEY,  StoreId     char(12)  NOT NULL,  CONSTRAINT StoreId_FK  FOREIGN KEY(StoreId)  REFERENCES  Store(StoreId)   ON DELETE CASCADE ,  DiscountRate  INT2 NOT NULL,  DiscountType  varchar(20) NOT NULL );  创建图书表Book SQL语句如下： CREATE TABLE Book (  BookISBN    char(22) PRIMARY KEY,  PublishId   char(12)  NOT NULL,  typeId      char(5)   NOT NULL,  CONSTRAINT  FK1  FOREIGN KEY(PublishId)  REFERENCES  Publish(PublishId)   ON DELETE CASCADE ,  CONSTRAINT  FK2  FOREIGN KEY(typeId)  REFERENCES  BookType(typeId)   ON DELETE CASCADE ,  BookName     varchar(80) NOT NULL,  publishDate  Date        NOT NULL,  BookPrice    MONEY       NOT NULL,  BriefIntroduce  varchar(2000) NULL,  BookDirectory  TEXT      NOT NULL );  创建销售表Sale SQL语句如下： CREATE TABLE Sale (                       SaleNumber  SERIAL    PRIMARY KEY,  BookISBN    char(22)  NOT NULL,  StoreId     char(12)  NOT NULL,  CONSTRAINT  Sale_FK1  FOREIGN KEY(BookISBN)  REFERENCES  Book(BookISBN)   ON DELETE CASCADE ,  CONSTRAINT  Sale_FK2  FOREIGN KEY(StoreId)  REFERENCES  Store(StoreId)   ON DELETE CASCADE ,  SaleDate     Date         NOT NULL,  SaleAmount   NUMERIC      NOT NULL,  SaleMoney    MONEY       NOT NULL );  创建库存表Stock SQL语句如下： CREATE TABLE Stock (                       BookISBN    char(22)  NOT NULL,  StoreId     char(12)  NOT NULL,  CONSTRAINT  Stock_PK  PRIMARY KEY(BookISBN,StoreId),\t  CONSTRAINT  Stock_FK1  FOREIGN KEY(BookISBN)  REFERENCES  Book(BookISBN)   ON DELETE CASCADE ,  CONSTRAINT  Stock_FK2  FOREIGN KEY(StoreId)  REFERENCES  Store(StoreId)   ON DELETE CASCADE ,  StockAmount   INT2      NOT NULL );  创建编著排名表 SQL语句如下： CREATE TABLE EditOrder (                       BookISBN    char(22)  NOT NULL,  AuthorId    char(12)  NOT NULL,  CONSTRAINT  EditOrder_PK  PRIMARY KEY(BookISBN,AuthorId),\t  CONSTRAINT  EditOrder_FK1  FOREIGN KEY(BookISBN)  REFERENCES  Book(BookISBN)   ON DELETE CASCADE ,  CONSTRAINT  EditOrder_FK2  FOREIGN KEY(AuthorId)  REFERENCES  Author(AuthorId)   ON DELETE CASCADE ,  RanKOrder   INT2      NOT NULL );  对于用SQL语句建立表做一个小结，定义主键来说还是比较容易的，复合主键上面来说可能就比单属性的主键要困难一些，如果是定义外键的话，其实它的语句和定义复合主键是比较类似的。当然，如果语句之中出现了一些错误的话，其实数据库是不会允许创建这样的一个表的。  下面部分是我们创建表之后的结果，其中的属性列我们在插入数据之后一并来进行验证。下图就是我们创建的结果，我们确实可以看到是有10个表的。  图2 利用SQL语句在数据库BookSale中创建十张表  设置好数据内容，并在数据库表之中插入数据内容    下面是我们对于各个表格进行数据的插入，数据是我们根据一些现实世界之中存在的数据进行的一些修改之后得到的，总之，其中的数据仅仅限于本次实验的使用而已。  往地区表area表之中插入数据 SQL语句如下： INSERT INTO area  VALUES('000001','四川省成都市成华区'); INSERT INTO area  VALUES('000002','四川省成都市温江区'); INSERT INTO area  VALUES('000003','四川省自贡市大安区'); INSERT INTO area  VALUES('000004','四川省成都市郫都区'); INSERT INTO area  VALUES('000005','四川省成都市高新区'); INSERT INTO area  VALUES('000006','福建省福州市晋安区'); INSERT INTO area  VALUES('000007','福建省福州市仓山区'); INSERT INTO area  VALUES('000008','福建省福州市鼓楼区'); INSERT INTO area  VALUES('000009','福建省福州市马尾区');  我们可以使用SELECT语句来查看插入之后的结果。  图3 利用SQL语句插入之后area表的内容  同时我们也可以利用这个表的内容来验证我们在第二个步骤之中建表语句的正确性。后续的内容就是对于其他的一些表的内容进行验证，此处就不再赘述了。只展示SQL语句与截图了。   往作者表author之中插入数据 SQL语句如下： INSERT INTO author VALUES('201301010001','000001','赵东','四川省成都市成华区建设路街道3号','13675063883'); INSERT INTO author VALUES('201203050012','000005','李静','四川省成都市高新区石油苑小区3栋502','13450099116'); INSERT INTO author VALUES('200807050033','000007','裴风','福建省福州市仓山区碧水芳州4栋302','13963528567'); INSERT INTO author VALUES('201003150215','000003','冯孜','四川省自贡市大安区新兴小区6栋102','13348773282'); INSERT INTO author VALUES('201411210037','000002','柳荫','四川省成都市温江区金祥花园9栋602','13648771318'); INSERT INTO author VALUES('200904210026','000008','谢云','福建省福州市鼓楼区樱花小区8栋104','13505752749'); INSERT INTO author VALUES('201208060014','000009','刘亚','福建省福州市马尾区万隆花园20栋404','18948500506');   图4 利用SQL语句插入之后author表的内容  往商店表store插入数据 SQL语句如下： INSERT INTO store VALUES('201108010121','智博书店','12301','四川省成都市成华区建设路街道5号'); INSERT INTO store VALUES('201206250312','新华书店','12304','四川省成都市高新区杨桥中路6号'); INSERT INTO store VALUES('201707150623','新华书城','35011','福建省福州市仓山区湖东路20号'); INSERT INTO store VALUES('201004141512','越洋图书城','12201','四川省自贡市大安区五四路102号'); INSERT INTO store VALUES('201210180056','海博书店','12305','四川省成都市温江区秀峰路12号'); INSERT INTO store VALUES('200904020142','求智书店','35015','福建省福州市鼓楼区洪湾南路61号'); INSERT INTO store VALUES('201305220312','骄阳书店','35013','福建省福州市马尾区乌龙江大道48号');  图5 利用SQL语句插入之后store表的内容    往图书类别booktype之中插入数据 SQL语句如下： INSERT INTO booktype VALUES('00001','社会科学'); INSERT INTO booktype VALUES('00002','自然科学'); INSERT INTO booktype VALUES('00003','语言文字类'); INSERT INTO booktype VALUES('00004','文学类'); INSERT INTO booktype VALUES('00005','艺术类'); INSERT INTO booktype VALUES('00006','历史类'); INSERT INTO booktype VALUES('00007','政治法律类');  图6 利用SQL语句插入之后booktype表的内容   往出版社表publish之中插入数据 SQL语句如下： INSERT INTO publish VALUES('199908210121','人民邮电出版社','010-81055256',' 北京市丰台区成寿寺路11号'); INSERT INTO publish VALUES('199803110522','清华大学出版社','010-62781733',' 北京市清华大学学研大厦A座'); INSERT INTO publish VALUES('199908060121','中华书局有限公司','010-63458219','北京市大兴区黄村芦求路临15号(立长彩钢院内)'); INSERT INTO publish VALUES('200304160121','北京联合出版公司','010-82065168','北京市西城区德外大街83号德胜国际中心9层901室');   图7 利用SQL语句插入之后publish表的内容   往折扣表discount之中插入数据 SQL语句如下： INSERT INTO discount VALUES('1000','201108010121','9','回馈老客户'); INSERT INTO discount VALUES('1002','201206250312','8','购书两本以上'); INSERT INTO discount VALUES('1041','201707150623','8','会员卡折扣'); INSERT INTO discount VALUES('1037','201004141512','7','清仓回馈客户'); INSERT INTO discount VALUES('1055','201210180056','7','新书上架');  图8 利用SQL语句插入之后discount表的内容   往图书表book表之中插入数据 SQL语句如下： \"978-7-115-50274-200003\"\t\"199908210121\"\t\"00002\"\t\"数据库系统及原理\"\t\"2018-01-10\"\t\"￥59.80\"\t\"关于数据库的原理和基本语法\"\t\"第一章节 数据库系统基础......\"  \"978-7-101-07940-100012\"\t\"199908060121\"\t\"00004\"\t\"世说新语注解\"\t\"2019-03-04\"\t\"￥66.00\"\t\"我国最早的笔记体小说集     《世说新语》是我国古代志人笔记的代表作，作者为刘宋临川王刘义庆。全书共36篇1130则，主要记载了东汉末年至刘宋初年近三百年间的人物故事，内容涉及政治、经济、文学、思想、习俗、民生等各个方面。文笔简洁明快，语言含蓄隽永，只言片语即可刻画出鲜活的人物形象，是我国古典文学名著之一。\"\t\"第一章 德行第一......\"  \"978-7-101-05449-102655\"\t\"199908060121\"\t\"00006\"\t\"万历十五年（增订版）\"\t\"2018-11-29\"\t\"￥25.00\"\t\"首次以“大历史观”分析明代社会之症结，观察现代中国之来路，发人深思。\"\t\"第一章万历皇帝第二章 首辅申时行第三章 世间已无张居正第四章 活着的祖宗第五章海瑞――古怪的模范官僚第六章戚继光――孤独的将领第七章李贽――自相冲突的哲学家附录一附录二《万历十五年》和我的“大”历史观 [2] \"  \"978-7-550-24465-803206\"\t\"200304160121\"\t\"00002\"\t\"无言的宇宙\"\t\"2017-06-15\"\t\"￥49.80\"\t\"跨越四千年的文明，用诗意的文字展示数学之美\"\t\"第一部分 古代的定理......\"  \"978-7-302-49785-188687\"\t\"199803110522\"\t\"00005\"\t\"艺术鉴赏（第2版）\"\t\"2018-05-01\"\t\"￥46.00\"\t\"从中西艺术发展历程、思维方式、鉴赏方法等方面分别讲述：儒家的浩然成就中国艺术修己正心的理想情操，道家的超然成就中国艺术崇尚自然适意的艺术\"\t\"第一章 引论 第二章 境生象外 伏延千里――文学艺术.....\"  \"978-7-302-49844-501204\"\t\"199803110522\"\t\"00007\"\t\"食品安全法律法规\"\t\"2018-04-01\"\t\"￥89.80\"\t\"本书根据国家食品药品安全立法与监督管理政策制度改革的最新精神，结合实际案例具体介绍了食品安全法、食品安全监督与管理法律制度、食品安全风险监测和评估法律制度、食品安全标准法、食品生产经营者法律制度、食品进出口法、食品安全事故处理、食品安全法律责任、食品安全民事责任、食品安全行政责任、食品安全刑事责任等其他有关法律律法规，并通过实证案例分析讲解，以提高读者的应用能力。\"\t\"第一章节 视频安全基本制度......\"  \"978-7-302-27054-601259\"\t\"199803110522\"\t\"00001\"\t\"老清华的社会科学\"\t\"2016-03-28\"\t\"￥49.00\"\t\"2011年不仅是清华的百年校庆，同时也是老清华社会科学的四个学科――经济学、政治学、社会学和心理学建系85周年志庆之时。这四个系都是清华兴办本科教育后在1926年成立的第一批学系。\"\t\"序言Ⅰ 老清华的经济学 一、 概述..........................\"   图9 利用SQL语句插入之后book表的内容   往编著排名editorder的插入数据 SQL语句如下： INSERT INTO editorder VALUES('978-7-115-50274-200003','201301010001','1'); INSERT INTO editorder VALUES('978-7-101-07940-100012','201203050012','2'); INSERT INTO editorder VALUES('978-7-101-05449-102655','200807050033','3'); INSERT INTO editorder VALUES('978-7-550-24465-803206','201003150215','4'); INSERT INTO editorder VALUES('978-7-302-49785-188687','201411210037','5'); INSERT INTO editorder VALUES('978-7-302-49844-501204','200904210026','6'); INSERT INTO editorder VALUES('978-7-302-27054-601259','201208060014','7');  图10 利用SQL语句插入之后editorder表的内容   往销售表sale之中插入数据 SQL语句如下： INSERT INTO sale VALUES('1','978-7-115-50274-200003','201108010121','2019-02-06','200','11960'); INSERT INTO sale VALUES('2','978-7-101-07940-100012','201206250312','2019-04-21','100','6600'); INSERT INTO sale VALUES('3','978-7-101-05449-102655','201707150623','2018-12-16','150','3750'); INSERT INTO sale VALUES('4','978-7-550-24465-803206','201004141512','2018-06-20','210','10458'); INSERT INTO sale VALUES('5','978-7-302-49785-188687','201210180056','2019-01-10','310','14260'); INSERT INTO sale VALUES('6','978-7-302-49844-501204','200904020142','2019-02-08','220','19756'); INSERT INTO sale VALUES('7','978-7-302-27054-601259','201305220312','2017-12-25','120','5880');  图11 利用SQL语句插入之后sale表的内容   往库存表stock之中插入数据 SQL语句如下： INSERT INTO stock VALUES('978-7-115-50274-200003','201108010121','800'); INSERT INTO stock VALUES('978-7-101-07940-100012','201206250312','432'); INSERT INTO stock VALUES('978-7-101-05449-102655','201707150623','135'); INSERT INTO stock VALUES('978-7-550-24465-803206','201004141512','183'); INSERT INTO stock VALUES('978-7-302-49785-188687','201210180056','175'); INSERT INTO stock VALUES('978-7-302-49844-501204','200904020142','269'); INSERT INTO stock VALUES('978-7-302-27054-601259','201305220312','352');  图12 利用SQL语句插入之后stock表的内容   编写函数Pro_CurrentSale，实现对于图书销量以及图书销售金额的统计功能 函数编写的SQL语句如下所示： CREATE OR REPLACE FUNCTION Pro_CurrentSale(in saletime DATE,out salemoney MONEY,out saleamount NUMERIC)  RETURNS record AS $$   DECLARE    BEGIN    SELECT COALESCE(SUM(sale.salemoney),MONEY '0.00')  INTO salemoney FROM sale WHERE sale.saledate=saletime ;    SELECT COALESCE(SUM(sale.saleamount),0) INTO saleamount FROM sale WHERE sale.saledate=saletime ;   END    $$ LANGUAGE plpgsql   分析：函数有一个输入参数是时间，就是查询对应的某天的销售数量与销售金额，所以输出的参数是MONEY和NUMERIC，而且输出的方式是以record类型也就是记录类型的变量的形式输出的。  创建完成触发器之后，我们可以看到如下的触发器。  图13 利用SQL语句创建函数Pro_CurrentSale  下面的是正确的创建的结果。   验证函数Pro_CurrentSale的功能，能够正确的调用该函数 对函数的功能进行验证，我们可以以如下的方式来使用改函数： select * From  Pro_CurrentSale('2019-04-21');  这个语句就是查看2019年4月21日那天的图书的销售金额和图书的数量。   图14 利用SQL语句验证函数的结果 当然我们可以回到sale表进行一下验证，我们会发现2019年4月21日那天结果确实如此,下面我们可以去试着查询sale表之中没有的日期，来查看一下结果。 比如我们选择的是2018年6月22日. select * From Pro_CurrentSale('2018-06-22'); 在表中没有对应的内容，所以可以很好的解释查询出来的结果应该都是0，函数验证的结果是创建的函数应该是正确的。   编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理    首先是编写触发器的函数，与创建函数的语句基本相似： CREATE OR REPLACE FUNCTION sale_synchronous() RETURNS TRIGGER AS $$ BEGIN     IF (TG_OP = 'UPDATE') THEN        UPDATE stock set stockamount = stockamount - (new.saleamount-old.saleamount) WHERE bookisbn = old.bookisbn; \t  RETURN NEW;      ELSIF (TG_OP = 'INSERT') THEN \t   UPDATE stock set stockamount = stockamount - new.saleamount WHERE bookisbn = new.bookisbn; \t RETURN NEW;       ELSIF (TG_OP = 'DELETE') THEN \t   UPDATE stock set stockamount = stockamount + old.saleamount WHERE bookisbn = old.bookisbn; \t RETURN OLD;   END IF;   RETURN NULL; END; $$ LANGUAGE plpgsql;    这里是对于三种操作都创建了触发器，更新的时候，库存需要减去更新前后的差值，用后减去前，即使更新后的数值更小了，这个值减出来会是一个负数，结果也还是正确的，当然此处需要我们验证的是INSERT触发器。   CREATE TRIGGER Tri_InsertSale AFTER INSERT OR UPDATE OR DELETE ON sale FOR EACH ROW EXECUTE PROCEDURE sale_synchronous();   这个语句是在表sale上创建触发器，可以查看一下创建的结果。  图15 触发器的创建结果  对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 下面我们销售表之中插入一条数据 INSERT INTO sale VALUES('8','978-7-115-50274-200003','201108010121','2019-03-28','100','5980'); 这本书籍在尚未插入之前的库存量是800。  图16 尚未进行插入操作时库存量   可以看到如下的结果  图17 进行插入操作之后库存量发生了改变  九、总结及心得体会 总结：实验的内容与课程的讲解内容还是比较相近的，总体而言难度一般，除了触发器和函数那边可能有一点小小的困难之外，其余的部分来看，还是比较简单的。本次实验之中主要的内容就是增删改查，函数与触发器，当然，增删改查这个部分，除了插入是专门的一个模块来进行操作之外，其余的部分的验证其实更多的是渗透在不同的步骤里面的，没有单独的提出来进行验证。实验报告之中的截图，都可以很好的证明我们的实验步骤。 体会：实验的内容是对于课堂教学的很好的补充，因此的我们也可以很好的从这种实际的操作过程之中的一些语句的书写上面，反过来来验证我们在学习过程之中是否存在什么问题。   \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西306  \t\t\t\t\t          实验时间：2019.05.27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.创建角色的语法 在DBMS中，为了方便对众多用户及其权限进行管理，通常将一组具有相同权限的用户定义为角色(Role)。 角色管理内容： （1）创建角色 （2）修改角色 （3）删除角色 角色管理实现方式： （1）执行SQL语句管理角色 （2）通过GUI操作管理角色  角色管理SQL语句如下： CREATE  ROLE  <角色名> [ [ WITH ] option [ ... ] ]; \t --创建角色 ALTER  ROLE  <角色名>  [ [ WITH ] option [ ... ] ]; \t --修改角色属性 ALTER  ROLE  <角色名>  RENAME TO <新角色名>; \t\t --修改角色名称  ALTER  ROLE  <角色名>  SET <参数项> { TO | = } { value | DEFAULT };  \t\t\t\t\t\t\t\t\t --修改角色参数值 ALTER  ROLE  <角色名>  RESET <参数项>;\t\t\t --复位角色参数值 DROP  ROLE  <角色名>;\t\t\t\t\t\t --删除指定角色  例子如下： CREATE  ROLE  \"Role_Manager\"  WITH  LOGIN  NOSUPERUSER  NOCREATEDB  NOCREATEROLE  INHERIT  NOREPLICATION  CONNECTION LIMIT -1;   2.为角色赋予权限 在创建好经理角色后，还需要赋予该角色对数据库表插入、修改、删除、查询权限。 例子如下： GRANT  SELECT,INSERT,UPDATE,DELETE  ON  Department  TO  \"Role_Manager\"; GRANT  SELECT,INSERT,UPDATE,DELETE  ON  Employee  TO  \"Role_Manager\"; GRANT  SELECT,INSERT,UPDATE,DELETE  ON  Project  TO  \"Role_Manager\"; GRANT  SELECT,INSERT,UPDATE,DELETE  ON  Assignment  TO  \"Role_Manager\";  基本的语句格式 GRANT 操作权限  ON  表名  TO  \"角色名\";  3.创建用户 CREATE USER  <用户账号名> [ [WITH]  option […]];    和创建角色比较类似，例子如下： CREATE USER  \"userA\"  WITH     LOGIN NOSUPERUSER     NOCREATEDB     NOCREATEROLE     INHERIT     NOREPLICATION     CONNECTION LIMIT -1     PASSWORD '123456';  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 实验步骤如下所示： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。并且在创建的同时为他们赋予角色，使得这些用户可以继承角色的权限 （5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。   八、实验数据及结果分析 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。  表1 用户权限表  此处的表格就是用户设计好的用户权限表。  主要的问题可能出现在sale和stock上边，用户对于商店的库存究竟是否应该具有查询的权限，此次比较简单的来考虑该问题，因为实际情况是，不同的书店实际上是只能够访问自己的销量和库存量的，也并不能对其他的商店的行进行访问。因此在设置这个用户权限表的时候做出了如上所示的设置，当然，其实这个权限表的设置在实际情况之下会经过比较细致的考量，也不会是直接进行设置的，所以其实我们只需要明白如何根据用户权限表进行设置即可。  在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。    创建客户（R_Customer），不具有登陆选项的才是角色，具有了就应该是用户了 SQL语句如下所示： CREATE ROLE \"R_Customer\" WITH    NOLOGIN    NOSUPERUSER    NOCREATEDB    NOCREATEROLE    INHERIT    NOREPLICATION    CONNECTION LIMIT -1;   创建商家（R_Seller） SQL语句如下所示： CREATE ROLE \"R_Seller\" WITH    NoLOGIN    NOSUPERUSER    NOCREATEDB    NOCREATEROLE    INHERIT    NOREPLICATION    CONNECTION LIMIT -1; 下面我们可以查看我们创建的角色：    图1 创建的两个角色   图2 角色R_Customer的权限  32 角色R_Seller的权限   在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  为客户和商家角色赋予权限（根据权限控制表） GRANT SELECT ON area TO \"R_Customer\"; GRANT SELECT ON area TO \"R_Seller\";  GRANT SELECT ON author TO \"R_Customer\"; GRANT SELECT ON author TO \"R_Seller\";  GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\";  GRANT SELECT ON booktype TO \"R_Customer\"; GRANT SELECT ON booktype TO \"R_Seller\";  GRANT SELECT ON discount TO \"R_Customer\"; GRANT SELECT,INSERT,UPDATE,DELETE ON discount TO \"R_Seller\";  GRANT SELECT ON editorder TO \"R_Customer\"; GRANT SELECT ON editorder TO \"R_Seller\";  GRANT SELECT ON publish TO \"R_Customer\"; GRANT SELECT ON publish TO \"R_Seller\";  GRANT SELECT ON sale TO \"R_Customer\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\";  GRANT SELECT ON stock TO \"R_Customer\"; GRANT SELECT,INSERT,UPDATE,DELETE ON stock TO \"R_Seller\";  GRANT SELECT ON store TO \"R_Customer\"; GRANT SELECT,INSERT,UPDATE,DELETE ON store TO \"R_Seller\";  在操作完成之后，我们任意选取了一张表进行验证：  图4 角色R_Seller和R_Customer对于表Area的权限 可以看到我们之前仅仅为这个表格赋予了SELECT权限，所以最后我们可以看到的是这里只有一个r权限，是一致的。   在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。并且在创建的同时为他们赋予角色，使得这些用户可以继承角色的权限  创建用户并且为他们分配权限 CREATE USER \"U_Seller\" WITH    LOGIN    NOSUPERUSER    NOCREATEDB    NOCREATEROLE    INHERIT    NOREPLICATION    CONNECTION LIMIT -1    IN ROLE \"R_Seller\"    PASSWORD '123456';        CREATE USER \"U_Customer\" WITH    LOGIN    NOSUPERUSER    NOCREATEDB    NOCREATEROLE    INHERIT    NOREPLICATION    CONNECTION LIMIT -1    IN ROLE \"R_Customer\"    PASSWORD '123456';  此处使用了SQL语句创建的两个用户并且为他们分配了对应的权限，我们可以查看到这两个用户。  图5 创建的两个用户 在此处我们可以发现，似乎与角色略有不同，实际上，在Postgresql之中，用户和角色的区别仅仅在于用户是可以登陆的，而角色是并不具有登陆的功能的。而其中的角色实际上也就是用户组，所以图标是不一样的。   分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  此处，我们以U_Seller用户进行登陆   图6 以用户U_Seller身份访问数据库  我们试着对area表进行插入的操作，实际上我们可以从权限表里面得知，U_Seller是没有权限往area表之中插入数据的，现在我们来观察实际的结果。  图7 由于权限不够，无法进行插入操作 其他的用户权限部分也进行了验证，因为结果是符合用户权限表的，所以在实验报告之中就不再放置更多的截图了。  九、总结及心得体会 总结：第二次的实验内容主要是围绕着用户权限来展开的，所用到的SQL语句其实是要比第一次的要少一些，实验内容也容易一些。 体会：对于创建用户和角色的权限，其实个人感觉知道的并不是非常的清楚每个参数的函数，在后续的学习之中应该加强这块的学习",
  "studentID": "2017221301003"
 },
 "34": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t实验时间：2019-05-20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 说明：本节需学生编写内容。学生应根据实验内容，给出完成该实验的具体实验原理。 1.数据库创建： create database <数据库名>; 2.数据库表创建： create table <表名> { <列名1> <数据类型> {列完整性约束},   <列名1> <数据类型> {列完整性约束},   <列名1> <数据类型> {列完整性约束},   … }; 3.列约束关键词： primary key主键，not null非空，unique列取值唯一性，check列取值范围，default列默认值。 4.表约束关键词： 使用列约束关键词primary key定义表的主键列只能定义单列主键，若要定义由多个列构成的复合主键，需要使用表约束方式。这个方式可通过在创建表的SQL语句中，加入constraint关键词来标识表约束。 5.表约束定义外键： 通过表约束constraint定义表中的外键。建立表与其关联表的参照完整性约束，即约束本表中的外键列取值参照关联表的主键列值。 6.创建索引： create index <索引名> on <表名><(列名[,..,])>; 7.插入行数据： insert into <表> values (值); 8.更新指定数据： update <表> set <列>=<值> [where <条件表达式>] 9.删除指定数据： delete from <表> [where <条件表达式>] 10.创建函数： create function name―函数名 as $$ declare --声明段 begin --函数体语句 end; $$ language  plpgsql 11.PL/SQL函数基本语法 条件语句： IF-THEN IF Boolean-expression THEN    Statements END IF; IF-THEN-ELSE IF Boolean-expression THEN Statements ELSE IF-THEN-ELSIF-ELSE IF Boolean-expression THEN Statements ELSIF Boolean-expression THEN    Statements ELSE    Statements END IF; 循环语句： LOOP Statements END LOOP; EXIT CONTINUE 11.触发器 触发器是特殊类型的存储过程，主要由操作事件(INSERT,UPDATE,DELETE)触发而被自动执行。 触发器可以实现比约束更复杂的数据完整性，经常用于加强数据的完整性约束和业务规则。 触发器本身是一个特殊的事务单位。 11.1触发器的特点： 与表相关联：必须定义在表或视图上。 自动触发：由执行insert，delete，update操作时触发 不能直接调用，也不能传递或接受参数 是事务的一部分：触发器和触发语句作为可在触发器内回滚的单个事务 11.2触发器按次数分类 1）语句级触发器 由关键字for each statement声明，在触发器作用的表上执行一条SQL语句时，该触发器只执行一次，即使是修改了零行数据的SQL，也会导致相应的触发器执行。如果都没有指定，for each statement会是默认值。 2）行级触发器 由关键字for each row标记的触发器，当触发器作用的表的数据发生变化时，每变化一行就会执行一次触发器。例如，假设学生成绩表有delete触发器，当在该表执行delete语句删除记录时，如果删除了20条记录，则将导致delete触发器被执行20次。 11.3触发器按触发时间分类 1）before触发器 在触发事件之前执行触发器 2）after触发器 在触发事件之后执行触发器 3）instead of触发器 当触发事件发生后，执行触发器中指定的函数，而不是执行产生触发事件的SQL语句，从而替代产生触发事件的SQL操作。在表或视图上，对于insert，update或delete三种触发事件，每种最多可以定义一个instead of触发器 11.4触发器相关的特殊变量 1）new 数据类型是record。对于行级触发器，它存有insert，update操作产生的新的数据行。对于语句级触发器，它的值是null 2）old 数据类型是record。对于行级触发器，它存有被update或delete操作修改或删除的旧的数据行。对于语句级触发器，它的值是null 3）TG_OP 数据类型是text；是值为insert，update，delete的一个字符串，它说明触发器是为哪个操作引发 11.5PostgreSQL创建触发器的基本步骤 1）检查数据库中将要创建的触发器所依附的表或视图是否存在，如果不存在，必须首先创建该表或视图。 2）创建触发器被触发时所要执行的触发器函数，该函数的类型必须是trigger型，是触发器的执行函数。但要注意，有些数据库不需要独立定义触发器函数，而是在创建触发器时，定义触发器过程体。 3）创建触发器，一般需要指明触发器依附的表，触发器被触发执行的时间，触发器时行级触发器还是语句级触发器，触发器执行需要满足的条件。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 创建BookSale数据库。 创建rank，author，book，publisher，area，inventory，sale，shop，book_type，discount这10个数据表并依据表间的关系定义好完整性约束。然后创建索引与视图。 使用SQL语句对10个表分别进行数据的增删查改 使用SQL语句编写Pro_CurrentSale函数；函数输入指定日期，依照sale表输出当天的销售总量以及销售总金额 调用Pro_CurrentSale函数，输出统计结果 编写sale表Insert触发器Tri_InsertSale，当新增一行销售记录，inventory表中相应的图书库存量要减少 对sale表进行insert操作，验证触发器。 八、实验数据及结果分析 创建数据库  创建数据表  插入，查询 插入publisher表     插入图书类别表                编写函数Pro_CurrentSale  （5）验证函数Pro_CurrentSale     （6）编写触发器Tri_InsertSale         （7）验证触发器 验证：      九、总结及心得体会 通过这次实验，我把课堂上学到的知识，通过实践运用到真正的PostgreSQL数据库，初步建立了图书销售管理系统。在这次实验中，我学会了如何去配置PostgreSQL数据库，解决诸如忘记密码等实际应用问题，加深了对各项操作的SQL语句的理解与记忆，弥补了很多理论课上的自己没有发现的数据库知识漏洞。这次实验的最大收获是学会了如何编写PostgreSQL的自定义函数以及触发器。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306  \t\t\t实验时间：2019-05-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 数据库系统安全模型 身份验证：从应用系统层面确认登录用户是否是合法使用者 权限控制：从DBMS系统层面通过存取权限机制控制用户对数据的访问 系统防护：从操作系统层面提供的安全机制防范非法系统访问 加密存储：从数据存储层面通过加密算法对数据库中数据进行加密存储 用户管理 在数据库安全管理中，DBMS需要对每个用户进行管理，如用户创建，用户修改，用户删除管理等。 用户创建SQL语句 create user <用户账户名> [[with] option […]]; login：登录权限；inherit角色继承权限；superuser超级用户；createDB创建数据库权限；createRole创建角色权限；replication数据库复制权限；connection limit数据库连接数； 权限管理 数据库权限管理是指DBA管理员或数据库对象拥有者对其所拥有对象进行权限控制设置。 权限管理基本操作有：授予权限；收回权限；拒绝权限； 权限类别有：数据库系统权限；数据库对象访问操作权限；数据库对象定义操作权限； 权限管理SQL语句 grant <权限名> on <对象名> to {数据库用户名|用户角色名}; revoke <权限名> on <对象名> to {数据库用户名|用户角色名}; deny <权限名> on <对象名> to {数据库用户名|用户角色名}; 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 设计客户和商家在图书销售管理系统中对各个数据库表的访问权限 在数据库中创建客户R_Customer、商家R_Seller角色 为这两个角色赋予数据库对象权限 在数据库中创建客户U_Customer、商家U_Seller用户 U_Customer分派R_Customer，R_Seller分派U_Seller 分别以U_Customer、U_Seller登录数据库，验证访问权限是否设置正确 八、实验数据及结果分析 访问权限设计 创建角色  赋予权限    （4）创建用户   （5）赋予权限   （6）验证       九、总结及心得体会 通过这次实验，我在postgreSQL数据库的实际操作中把数据库权限设计，角色创建和为不同用户分配不同的角色权限这些常用的安全机制内容实践了一遍，加深了我对数据库安全设计的理解及运用。   ",
  "studentID": "2017221301004"
 },
 "35": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t           实验时间：2019/05/20 三、实验目的  针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。  四、实验原理  1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。  五、实验内容  使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验设备及环境  “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11  七、实验步骤  1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建各表，以及各表主键外键的创建，并为给表创建视图、索引。 3.准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对表进行数据修改、删除、查询等访问操作。 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，测试函数功能。 6.编写触发器Tri_InsertSale，实现在 Market表数据插入时，级联操作 Stock 表，将图书的库存流水进行记录。 7.测试触发器的功能，准备Market表的样本数据，并将其插入Market表，插入之后查看Stock表是否有对应的更新，并对比插入Market数据前后Stock中对应数据的修改情况。  八、实验数据及结果分析  创建 BookSale 数据库 CREATEDATABASE “BookSale” 运行结果如下： 图8-1 数据库创建结果 创建各数据库表以及视图和索引 创建数据库表SQL语句如下 CREATETABLEPublish( pIDcharacter(12)NOTNULL, pnamecharactervarying(40), pphonecharactervarying(20), paddresscharactervarying(60), CONSTRAINTPublish_PKPRIMARYKEY(pID) );  CREATETABLEBook( bISBNcharacter(22) NOTNULL, pIDcharacter(12)\tNOTNULL, bnamecharactervarying(80), bpricemoney, CONSTRAINTBook_PKPRIMARYKEY(bISBN), CONSTRAINTBook_Publish_FKFOREIGNKEY(pID) REFERENCESPublish(pID) ONUPDATECASCADE ); CREATETABLEStock( bISBNcharacter(22)NOTNULL, samountnumeric, CONSTRAINTStore_PKPRIMARYKEY(bISBN), CONSTRAINTStore_Book_FKFOREIGNKEY(bISBN) REFERENCESBook(bISBN) ONUPDATECASCADE ); CREATETABLEMarket( mIDcharacter(12)NOTNULL, bISBNcharacter(22)NOTNULL, mdatedate, mamountnumeric, mmoneymoney, CONSTRAINTMarket_PKPRIMARYKEY(mID), CONSTRAINTMarket_Book_FKFOREIGNKEY(bISBN) REFERENCESBook(bISBN) ONUPDATECASCADE ); 数据库表创建结果如下：  图8-2数据库表创建结果 2）视图创建SQL语句如下： CREATEVIEWstock_viewAS SELECTbISBN,samount FROMstore;  CREATEVIEWbook_viewAS SELECTbISBN,pID,bname,bprice FROMbook;  CREATEVIEWmarket_viewAS SELECTmID,bISBN,mdate,mamount,mmoney FROMmarket;  CREATEVIEWpublish_viewAS SELECTpID,pname,pphone,paddress FROMpublish; 视图创建结果如下： 图8-3数据库视图创建结果 3）索引创建SQL语句如下 CREATEINDEXStock_IndexONStock(bISBN); CREATEINDEXBook_IndexONBook(bname); CREATEINDEXMarket_IndexONMarket(mID); CREATEINDEXPublish_IndexONPublish(pname); 索引创建结果如下  图8-4数据库索引创建结果 数据库操作：增删改查 INSERTINTOpublishVALUES('p001','Chushude','4008823823','aplaceyoucanfind'); INSERTINTOpublishVALUES('p002','Banshude','4008823856','aplaceyoucannotfind');  INSERTINTObookVALUES('565-1-366-14619-1','p001','Shu',5); INSERTINTObookVALUES('565-1-366-14619-2','p001','Book',6); INSERTINTObookVALUES('565-1-366-14619-3','p002','zhi',5); INSERTINTObookVALUES('565-1-366-14619-4','p002','Paper',6);  INSERTINTOstockVALUES('565-1-366-14619-1',50); INSERTINTOstockVALUES('565-1-366-14619-4',20);  DELETEFROMbookWHEREbISBN='565-1-366-14619-2';  UPDATEbookSETbname='Baozhi'WHEREbISBN='565-1-366-14619-3';  SELECT*FROMbook; 运行结果如下  图8-5数据库操作结果 5.创建函数Pro_CurrentSale createorreplacefunctionPro_CurrentSale(OUTamountint,OUTamoneymoney,INddate) AS$$ BEGIN SELECTSUM(mamount)INTOamountFROMmarketWHEREmdate=d; SELECTSUM(mmoney)INTOamoneyFROMmarketWHEREmdate=d; END $$LANGUAGEplpgsql; 编译结果如下：  图8-6 函数Pro_CurrentSale编译结果 测试数据与调用SQL语句 INSERTINTOmarketVALUES('m001','565-1-366-14619-1','2019-01-03',5,25); INSERTINTOmarketVALUES('m002','565-1-366-14619-4','2019-01-03',3,18); INSERTINTOmarketVALUES('m003','565-1-366-14619-1','2019-01-04',2,10);  SELECT*FROMPro_CurrentSale('2019-01-04'); 函数调用结果如下  图8-7 函数Pro_CurrentSale运行结果 5.创建触发器Tri_InsertSale CREATEORREPLACEFUNCTIONInsertSale() RETURNSTRIGGERAS$$ BEGIN IF(TG_OP='INSERT')THEN UPDATEstockSETsamount=samount-new.mamountWHEREbISBN=new.bISBN; RETURNNEW; ENDIF; RETURNNULL; END; $$LANGUAGEplpgsql;  CREATETRIGGERTri_InsertSale AFTERINSERTONmarket FOREACHROWEXECUTEPROCEDUREInsertSale(); 创建结果如下  图8-8 触发器Tri_InsertSale创建结果 测试数据与查询SQL语句 INSERTINTOmarktVALUES('m004','565-1-366-14619-1','2019-01-01',4,20); SELECT*FROMstock; 触发器运行结果如下  图8-9 触发器Tri_InsertSale触发结果 九、总结及心得体会 触发器的熟练使用真的很重要。 通过实践加深了对创建表、编辑数据、构造触发器的理解和熟练使用。 结合GUI判断命令的执行有利于及时检查错误。 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306\t          实验时间：2019/05/27      三、实验目的  了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理  1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。  五、实验内容  使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验设备及环境  “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11  七、实验步骤  1.针对图书销售管理系统，设计数据存取权限表。 2. 在 pgAdmin4中 的BookSale数 据 库 中 ， 使 用 SQL语 句 创 建 客 户（R_Customer）角色、商家（R_Seller）角色。 3. 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析  针对图书销售管理系统，设计角色权限表 创建客户角色和商家角色 CREATEUSER\"U_Customer\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT REPLICATION NOBYPASSRLS CONNECTIONLIMIT-1; INROLE\"R_Customer\" PASSWORD'123456'; CREATEUSER\"U_Seller\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT REPLICATION NOBYPASSRLS CONNECTIONLIMIT-1; INROLE\"R_Seller\" PASSWORD'123456'; 创建结果如下  图8-1 角色创建结果 赋予客户、商家角色权限 GRANTSELECTONStockTO\"R_Customer\"; GRANTSELECTONBookTO\"R_Customer\"; GRANTSELECTONPublishTO\"R_Customer\"; GRANTSELECTONMarketTO\"R_Customer\";  GRANTSELECT,INSERT,UPDATE,DELETEONStockTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONBookTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONPublishTO\"R_Seller\"; GRANTSELECT,INSERT,UPDATE,DELETEONMarketTO\"R_Seller\"; 创建客户用户和商家用户，并将客户角色和商家角色赋予他们 CREATEUSER\"U_Customer\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT REPLICATION NOBYPASSRLS CONNECTIONLIMIT-1; INROLE\"R_Customer\" PASSWORD'123456'; CREATEUSER\"U_Seller\"WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT REPLICATION NOBYPASSRLS CONNECTIONLIMIT-1; INROLE\"R_Seller\" PASSWORD'123456'; 用户创建结果如下  图8-2 用户创建结果 分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功 测试客户用户  图8-3 用客户用户登录  图8-4 用客户用户插入数据  图8-5 用客户用户修改数据  图8-6 用客户用户删除数据  图8-7 用客户用户查询数据 由结果可知客户用户只有查询数据的权限。 测试商家用户  图8-8 用商家用户登录  图8-9 用商家用户插入数据  图8-10 用商家用户修改数据  图8-11 用商家用户删除数据  图8-11 用商家用户查询数据 由结果可知商家用户有添加、修改、删除、查询数据的权限。 九、总结及心得体会 通过实践再一步加深了对建表的理解。 在建表之初透彻的想清楚外键的链接关系太重要了，外键的链接搞错了，到后期会很难修正，容易导致bug。 通过实践加深了对权限控制的理解。",
  "studentID": "2017221301010"
 },
 "36": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号      2017221301011    姓    名      刘忠奇           （实验）\t课程名称     数据库原理及应用  理论教师       张凤荔          实验教师       何中海                      电子科技大学教务处制表      电 子 科 技 大 学 实   验   报   告 学生姓名：刘忠奇\t\t学号：2017221301011   指导教师：何中海   实验地点：信软楼西306   实验时间：2019.5.22 一、实验名称：图书销售管理系统数据库 SQL 应用编程 二、实验学时：4学时 三、实验目的： 针对图书销售管理数据库开发，了解 SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的 SQL 数据操作访问和后端数据处理功能。 四、实验原理： 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。  五、实验内容： 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行 SQL 编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行 SQL 创建图书销售管理系统数据库 BookSale。 2.在数据库 BookSale 中，执行 SQL 创建数据库表、视图、索引等对象。 3.在数据库 BookSale 中，执行 SQL 进行数据增、删、查、改访问操作。 4. 在 数 据 库 BookSale 中 ， 采 用 PL/pgSQL 语 言 编 写 存 储 过 程 函 数 Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库 BookSale 中，采用 PL/pgSQL 语言编写过程语句块，实现对存储过程函数 Pro_CurrentSale 的调用，并输出统计结果。 6.在数据库 BookSale 中，采用 PL/pgSQL 语言编写编写图书销售表 Insert 触  发器 Tri_InsertSale，实现图书库存数据同步修改处理。 7.在数据库 BookSale 中，对图书销售表 Insert 触发器 Tri_InsertSale 程序进行功能验证。 8.在数据库 BookSale 中，创建存储过程函数实现图书销售数量和金额统计。在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL、PL/pgSQL 语言， 完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验器材（设备、元器件）： 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11  七、实验步骤： 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。  八、实验数据及结果分析 创建 BookSale 数据库 实现思路与方法：使用 SQL 语句来进行数据库的创建。 SQL 语句：create database \"BookSale\"    创建各数据库表以及表中主外键和索引 实现思路与方法：首先明确图书销售管理系统的实体、实体属性以及各实体之间的联系，再通过 SQL 语句对表进行创建，表对应实体，实体属性对应表中的列，通过主外键来将表联系起来。  create table Auther2017221301011 ( AU_ID\tCHAR(18)\tnot null, AU_Name\tVARCHAR(20)\tnot null,  AU_Gender\tCHAR(2)\tnot null, AU_Phone\tVARCHAR(11)\tnot null, AU_Address\tVARCHAR(50)\tnot null, constraint PK_AUTHER primary key (AU_ID) ); create table Book2017221301011 ( Book_ISBN AU_ID\tCHAR(13) CHAR(18)\tnot null, null, PUB_ID\tCHAR(11)\tnull, Book_Name\tVARCHAR(50)\tnot null, Book_Pubdate\tDATE\tnot null, Book_Price\tMONEY\tnot null, Book_Category\tVARCHAR(20)\tnot null, Book_Stock\tINT4\tnot null, Book_Notes\tVARCHAR(100)\tnull, Book_List\tVARCHAR(100)\tnull, constraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER2017221301011 ( CUST_ID\tCHAR(18)\tnot null, CUST_Name\tVARCHAR(20)\tnot null, CUST_Phone\tVARCHAR(15) not null, CUST_Address    VARCHAR(50)     not null, CUST_Email\tVARCHAR(50) not null, constraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher2017221301011 ( PUB_ID\tCHAR(11)\tnot null, PUB_Name\tVARCHAR(20)          not null, PUB_Phone\tVARCHAR(15) not null, PUB_Address     VARCHAR(50)     not null, constraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale2017221301011 ( SALE_ID\tVARCHAR(11)\tnot null, Book_ISBN\tCHAR(13)\tnull, CUST_ID\tCHAR(18)\tnull, SALE_Date\tDATE\tnot null, SALE_QTY\tINT4\tnot null, SALE_Amount\tMONEY\tnot null, constraint PK_SALE primary key (SALE_ID) ); create table Stock2017221301011 ( Stock_ID\tVARCHAR(10)\tnot null,  Book_ISBN\tCHAR(13)\tnull, Stock_Change\tINT4\tnot null, Stock_Operation\tCHAR(4)\tnot null, Stock_Datetime\tDATE\tnot null, constraint PK_STOCK primary key (Stock_ID) ); alter table Book2017221301011 add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) references Auther (AU_ID) on delete restrict on update restrict;  alter table Book2017221301011 add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) references Publisher (PUB_ID) on delete restrict on update restrict;  alter table Sale2017221301011 add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict;  alter table Sale2017221301011 add constraint FK_SALE_CUSTOMER CUSTOMER foreign key (CUST_ID) references CUSTOMER (CUST_ID) on delete restrict on update restrict;  alter table Stock2017221301011 add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict;                                               插入样本数据并对 publisher 表进行增删查改操作 实现思路与方法：首先准备样本数据，尽可能使得数据符合实际应用并且要能满足后续的数据处理操作。这里以 publisher 表为例，给出该表的数据增、删、查、改 SQL 语句操作访问。 Insert into Auther2017221301011 values('330309198504150527','王天','男','13554874593','四川省成都市成华区建设北路二段十号'); Insert into  Auther2017221301011 values('540135199103281548','叶无双','男','15812387538','浙江省杭州市天路区梅田路二十八号'); Insert into  Auther2017221301011 values('120857198811123587','李婷','女','18575615472','北京市朝阳区梅山路二巷八号 '); Insert into PUBLISHER2017221301011 values('PUB00000001','高等教育出版社','010-65321854','北京');  Insert into PUBLISHER2017221301011 values('PUB00000002','电子工业出版社','010-65329857','北京');  Insert intoPUBLISHER2017221301011 values('PUB00000003','人民邮电出版社','010-65325987','北京'); Insert into BOOK2017221301011 values('9787115502742','330309198504150527','PUB00000001','Web 前端开发最佳实践 ','2016-01-01', '59','IT 技术','100'); Insert into BOOK2017221301011 values('9875325415577','540135199103281548','PUB00000002','Java EE Web 编 程  ','2008-01-01', '52','IT 技术','200'); Insert into BOOK2017221301011 values('9865365975234','120857198811123587','PUB00000003',' 数 据 库 实 验 指 导 ','2013-08-1','29','IT 技术', '150'); Insert into customer2017221301011 values('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insert into customer2017221301011 values('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十九号','657873215@qq.com'); Insert into customer2017221301011       查看 publisher 表数据的 SQL 语句如下： select * from publiser2017221301011;        增加一条数据到 publisher 表 SQL 语 句 ： Insert into PUBLISHER2017221301011 values('PUB00000004',' 清 华 大 学 出 版 社','010-65323169','北京');          插入成功     删 除 一 条publisher表 数 据 SQL 语句： delete from publisher2017221301011 where pub_id = 'PUB00000004';               修改一条 publisher 表数据 SQL 语句：update publisher2017221301011 set pub_address = '南京' where pub_id = 'PUB00000003';               创建视图 实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数据查询。创建完视图之后可用 select 语句来查看视图，用法：select * from 视图名。例如，创建视图 BOOK_AUTHER_PUBLISHER 实现图书信息查询，其 SQL 语句如下： create view BOOK_AUTHER_PUBLISHER as select B.book_name as \"图书\",AU.au_name as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\" from book2017221301011 as B join auther2017221301011 as AU on B.au_id = AU.au_id join publisher2017221301011 as PU on B.pub_id = PU.pub_id         采用如下 SQL 语句实现视图数据查询： select * from BOOK_AUTHER_PUBLISHER;        创建触发器函数 实现思路与方法：创建触发器函数实现在有一条销售数据插入 sale 表时，同时在库存表 stock 中插入图书的库存变化记录，并修改对应图书表 book 的库存数，为后续的创建触发器提供函数方法。 创建触发器函数 SQL 语句： CREATE OR REPLACE FUNCTION InsertSale() RETURNS TRIGGER AS $$ BEGIN IF (TG_OP = 'INSERT') THEN INSERT INTO stock values(new.sale_id,new.book_isbn,new.sale_qty,' 出 库 ',new.sale_date); update book set book.book_stock = book.book_stock - new.sale_qty where book.book_isbn = new.book_isbn; RETURN NEW; END;  END IF; RETURN NULL;  $$ LANGUAGE plpgsql;                   创建触发器 实现思路与方法：创建触发器，关联销售表，在销售表插入一个新数据之后， 执行上一步编写的触发器函数。 创建触发器 SQL 语句：    测试触发器 实现思路与方法：在销售表中插入几个样本数据，之后再查看库存表和图书 表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插入销售表的数据一致。 测试触发器 SQL 语句：    查询查看 stock2017221301011 表数据以及对比 book2017221301011 表数据   Book2017221301011表数据  Stock 表本来没有数据，在 sale 插入数据之后，将库存数据进行记录，记录数据正确，同时更新了 book 表中各对应图书的库存量，更新数据正确，触发器功能实现正确。  创建存储过程 实现思路与方法：通过存储过程实现某日图书销售数量和金额统计。创建存储过程的 SQL 语句如下。     9.调用存储过程 实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况一致，调用存储过程 SQL 语句如下：   九、总结及心得体会： 通过本次实验对数据库sql语言编程有了很大的进步，能够独立的完成实验，加深自己对于数据库表的创建，和一些触发器，存储过程函数的编写来实现对失去了数据的处理。 逐步实现一个dba所能够完成的任务，我相信这对我们自己的工程处理能力是一种很好的培养。 十、对本实验过程及方法、手段的改进建议：    无                                    报告评分：                                          指导教师签字：         电 子 科 技 大 学 实   验   报   告 学生姓名：刘忠奇\t\t学号：2017221301011   指导教师：何中海   实验地点：信软楼西306   实验时间：2019.5.22 实验名称：图书销售管理系统数据库安全管理 二、实验学时：4学时 三、实验目的： 了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  4.在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。 5.分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL 语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。 3. 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析 1.针对图书销售管理系统，设计数据存取权限控制模型。 实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家， 客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水  信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以对库存表只有查看权限。他们的数据库存取访问权限控制模型设计            2.创建客户角色和商家角色       创建商家角色的 SQL 语句： CREATE ROLE \"R_Seller\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1                 结果分析：在角色用户表中看到 R_Customer,R_Seller，角色创建成功。  3.赋予客户、商家角色权限 实现思路与方法：使用 SQL 语句给两个角色赋予在步骤 1 定义的权限。赋予客户角色 SQL 语句：       赋予商家角色 SQL 语句：   4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 实现思路与方法：使用 SQL 语句创建用户，并将对应的角色赋予他们。其 SQL 语句如下。 CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '123456'; CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456';          结果分析：在角色用户表中发现 U_Customer,U_Seller，创建用户成功。  5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功。      测试一：查看 book 表 SQL 语句：select * from book2017221301011              测试二：删除 book 表中的数据 SQL 语句：delete from book2017221301011 where book_isbn = '9787115502742'                测试三：查看 auther 表 SQL 语句：select * from auther2017221301011     测试四：插入一条数据到 auther 表中 SQL 语句：insert into auther2017221301011 values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号')    测试五：查看 sale 表 SQL 语句：select * from sale2017221301011           测试完客户用户之后，我们登录商家用户来进行下一步的测试。    测试一：查看 customer \nSQL 语句：select * from customer2017221301011 运行界面和结果展示如图 2-17 所示。    测试二：插入一条数据到 auther 中 SQL 语句：insert into auther2017221301011 values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号')    Selce以后的结果    测试三：从 stock 表中删除一条数据 SQL 语句：delete from stock where stock_id = 'SA00001'     测试四：更新 sale 表的一条数据 SQL 语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001'                  九、总结及心得体会 通过这次实验掌握了对数据库安全访问的学习，加深了自己对于数据库学习的认识，更为工程上做为合格dba打下编程基础，让我们对这一方面的学习有进步 十、对本实验过程及方法、手段的改进建议：    无                                    报告评分：                                          指导教师签字：      ",
  "studentID": "2017221301011"
 },
 "37": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号 2017221301017          姓    名  肖凌志                （实验）\t课程名称   数据库原理及应用     理论教师   张凤荔               实验教师   何中海                   电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：肖凌志\t\t学号：2017221301017 指导教师：何中海  实验地点：信软学院楼西306  实验时间：2019.5.27 一、实验名称：数据库实验 二、实验学时：8 三、实验目的： 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  实验原理： 首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实 体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设 计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。  基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在 本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过 程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图存储过程、触发器实现业务数据处理。 设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库 数据的安全性。  使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派 角色。  使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作 的时候就会受到不同程度的制约。  五、实验内容： 1、使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  2、使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。\t （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Customer）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。   六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11    七、实验步骤： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 （8）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （9）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （10）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。\t （11）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Customer）、商家（R_Seller）角色。 （12）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 图书销售管理系统数据库BookSale创建操作 CREATE DATABASE \"BookSale\"     WITH      OWNER = postgres     ENCODING = 'UTF8'     LC_COLLATE = 'Chinese (Simplified)_China.936'     LC_CTYPE = 'Chinese (Simplified)_China.936'     TABLESPACE = pg_default     CONNECTION LIMIT = -1;  在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 CREATE TABLE Area (\tareanumber\tchar(6)\tPRIMARY KEY,  \tAreaName varchar(30) ); /////////////////////////////////////////////////////// CREATE TABLE Author (  AuthorId   char(12) PRIMARY KEY,  AreaNumber char(6)  NOT NULL,  CONSTRAINT AreaNumber_FK  FOREIGN KEY(AreaNumber)  REFERENCES  Area(AreaNumber)   ON DELETE CASCADE ,  AuthorName    varchar(40) NOT NULL,  AuthorAddress varchar(80) NOT NULL,  Telphone      char(11) NOT NULL ); ////////////////////////////////////////////////////////// CREATE TABLE Stock (\tStoreId char(12) NOT NULL,  \tbookISBN char(22) NOT NULL,  \tinventory int2,  \tCONSTRAINT\tStock_PK PRIMARY KEY(StoreID,bookISBN),  \tCONSTRAINT\tStoreID_FK FOREIGN KEY(StoreID) REFERENCES store(storeid) ON DELETE CASCADE,  \tCONSTRAINT\tbookISBN_FK FOREIGN KEY(bookISBN) REFERENCES book(bookISBN) ON DELETE CASCADE ); /////////////////////////////////////////////////////// CREATE TABLE Store (\tStoreId char(12) PRIMARY KEY,  \tstorename varchar(40) NOT NULL,  \tPostalcode\tchar(5)\tNOT NULL,  \tstoreadress\tvarchar(80)\tNOT NULL ); /////////////////////////////////////////////////////// CREATE TABLE discount (\tdiscountId int2 PRIMARY KEY,  \tstoreid char(12) NOT NULL,  \tdiscountRate\tint2,  \tdiscountcategory\tvarchar(20)\tNOT NULL,  \tCONSTRAINT\tstoreid_FK\tFOREIGN KEY(storeid) REFERENCES store(storeid) ON DELETE CASCADE ); /////////////////////////////////////////////////////// CREATE TABLE book (\tbookISBN char(22) PRIMARY KEY,  \tpublishid varchar(40) NOT NULL,  \tcategoryid\tchar(5)\tNOT NULL,  \tbookname\tvarchar(80)\tNOT NULL,  \tpublishdate\tdate,  \tbookprice\tmoney,  \tIntroduction\tvarchar(2000)\tNOT NULL,  \tlist\ttext,  \tCONSTRAINT\tpublishid_FK\tFOREIGN KEY(publishid) REFERENCES publish(publishid) ON DELETE CASCADE,  \tCONSTRAINT\tcategoryid_FK\tFOREIGN KEY(categoryid) REFERENCES bookcategory(categoryid) ON DELETE CASCADE ); /////////////////////////////////////////////////////// CREATE TABLE Editedranking (\tauthorId char(12) NOT NULL,  \tbookISBN char(22) NOT NULL,  \trankorder int2,  \tCONSTRAINT\tEditedranking_PK PRIMARY KEY(authorId,bookISBN),  \tCONSTRAINT\tauthorId_FK FOREIGN KEY(authorId) REFERENCES author(authorId) ON DELETE CASCADE,  \tCONSTRAINT\tbookISBN_FK FOREIGN KEY(bookISBN) REFERENCES book(bookISBN) ON DELETE CASCADE ); /////////////////////////////////////////////////////// CREATE TABLE sell (\tsellId serial PRIMARY KEY,  \tbookISBN char(22) NOT NULL,  \tstoreid\tchar(12)\tNOT NULL,  \tselldate\tdate,  \tsellnumber\tnumeric,  \tsellamount\tmoney,  \tCONSTRAINT\tstoreid_FK FOREIGN KEY(storeid) REFERENCES store(storeid) ON DELETE CASCADE,  \tCONSTRAINT\tbookISBN_FK FOREIGN KEY(bookISBN) REFERENCES book(bookISBN) ON DELETE CASCADE ); /////////////////////////////////////////////////////// //创建索引 CREATE INDEX bookISBN_Idx ON book(bookISBN) CREATE INDEX sellid_Idx ON sell(sellid); CREATE INDEX authorid_Idx ON author(authorid); 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 //增加数据实例 //单行插入 INSERT INTO area VALUES('610000','成都'); //多行插入 INSERT INTO area VALUES('621000','绵阳'); INSERT INTO area VALUES('100000','北京'); INSERT INTO area VALUES('200000','上海'); INSERT INTO area VALUES('210000','南京'); //删除数据 DELETE FROM area WHERE areanumber='621000'; //查询 SELECT * FROM area WHERE areanumber='100000' //修改数据 UPDATE area SET areanumber='300000' WHERE areaname='北京'; UPDATE area SET areanumber='100000' WHERE areaname='北京';  //创建视图 CREATE VIEW areaView AS SELECT areanumber,areaname FROM area WHERE areanumber='100000' //查看视图 SELECT * FROM areaView ORDER BY areanumber;         编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 创建Pro_CurrentSale函数    （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。        （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。     在销售表上创建触发器            （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。   原来的库存表  执行的语句 INSERT INTO sell VALUES('3','000000000000000000001','000000000001','2019-6-18','10','900') 执行后的销售表  执行后的库存表     （8）针对图书销售管理系统数据库，设计数据存取权限控制模型。  （9）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 创建R_Customer角色和R_Seller角色      （10）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。\t         （11）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Customer）、商家（R_Seller）角色。         （12）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。   总结及心得体会： 对于知识的掌握仅仅通过书本是不够的，需要多加练习，尤其是数据库这类对实际操作能力有较高要求的学科，更加需要我们通过实践来加深对理论知识的掌握。 对本实验过程及方法、手段的改进建议： 结合课程内的例子，以具体上机实现的方式来增加对学科的理解，这种安排是极合理的。                                                      报告评分：                                          指导教师签字：",
  "studentID": "2017221301017"
 },
 "38": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t\t实验时间： 2019-05-20     三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.数据库定义语句 用于建立、修改、删除数据库对象，包括创建语句(CREATE)、修改语句(ALTER)、删除语句(DROP)，比如使用CREATE TABLE创建表，使用ALTER TABLE修改表，使用DROPTABLE删除表等动作。这类语言不需要事务的参与，自动提交。 2.数据库操纵语句 一、增： 1.使用insert插入单行数据：  语法：insert [into]<表名> [列名] values <列值> 2.使用insert,select语句将现有表中的 数据添加到已有的新表中 语法：insert into <已有的新表> <列名> select <原表列名> from <原表名> 二、删： 使用delete删除数据某些数据  语法：delete from <表名> [where <删除条件>]  三、改　 使用update更新修改数据 四、查 1.普通查询 查询所有数据行和列 查询部分行列--条件查询 在查询中使用ＡＳ更改列名 查询空行 在查询中使用常量 查询返回限制行数(关键字：top ) 查询排序（关键字：order by , asc , desc） ２.模糊查询 使用like进行模糊查询 使用between在某个范围内进行查询 使用in在列举数值内进行查询(in后是多个的数据) ３.分组查询 使用group by进行分组查询 使用having子句进行分组筛选 ４.多表联接查询  3.数据库函数  4.数据库触发器\n触发器是一种特殊类型的存储过程，不由用户直接调用。创建触发器时会对其进行定义，以便在对特定表或列作特定类型的数据修改时执行。\n触发器可以查询其他表，而且可以包含复杂的 SQL 语句。 它们主要用于强制服从复杂的业务规则或要求。 例如，您可以根据客户当前的帐户状态，控制是否允许插入新订单。\n触发器也可用于强制引用完整性，以便在多个表中添加、更新或删除行时，保留在这些表之间所定义的关系。\n作用\n1）触发器可通过数据库中的相关表实现级联更改；通过级联引用完整性约束可以更有效地执行这些更改。\n2）触发器可以强制比用 CHECK 约束定义的约束更为复杂的约束。与 CHECK 约束不同，触发器可以引用其它表中的列。例如，触发器可以使用另一个表中的 SELECT 比较插入或更新的数据，以及执行其它操作，如修改数据或显示用户定义错误信息。\n3）触发器还可以强制执行业务规则\n4）触发器也可以评估数据修改前后的表状态，并根据其差异采取对策。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 1. 图书销售管理系统数据库BookSale创建操作  2. 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 1)地区表  2)作者表  3)出版社表  4)图书类别表  5)书表  6)商店表  7)折扣  8)库存  9)销售表  10)图书排名表  3对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 1）增 地区表   作者表   图书类别    出版社     图书   编著排名    商店    折扣    销售     库存  2)删除  删除前   删除  删除后  3）更新  更新前  更新  更新后・    4，5 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计  6编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。   九、总结及心得体会  \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称： 信软楼306\t\t\t\t  实验时间：2019-05-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 实验原理 1.数据库角色  数据库角色：被命名的一组与数据库操作相关的权限 角色是权限的集合  可以为一组具有相同权限的用户创建一个角色  简化授权的过程  角色的创建 CREATE ROLE <角色名> 给角色授权 GRANT <权限>［，<权限>］… ON <对象类型>对象名 TO <角色>［，<角色>］… 将一个角色授予其他的角色或用户 GRANT <角色1>［，<角色2>］… TO <角色3>［，<用户1>］… ［WITH ADMIN OPTION］ 角色权限的收回 REVOKE <权限>［，<权限>］… ON <对象类型> <对象名> FROM <角色>［，<角色>］… 2. 数据的完整性和安全性是两个不同概念 数据的完整性 防止数据库中存在不符合语义的数据，也就是防止数据库中存在不正确的数据  防范对象：不合语义的、不正确的数据  数据的安全性 保护数据库防止恶意的破坏和非法的存取  防范对象：非法用户和非法操作  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 1．在数据库中，创建客户（R_Customer）、商家（R_Seller）角色 。  2. 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限  3，4 .在数据库中，分别创建客户用户U_Customer、商家用户U_Seller 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。  5. （分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性  U_Customer       2) U_Seller \t\t    九、总结及心得体会 ",
  "studentID": "2017221301025"
 },
 "39": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t\t  实验时间：2019.5.20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 PgAdmin4的使用方法，SQL语言DDL、DML、DQL类型语句的使用方法，数据库语言的编程方法（存储过程，函数触发器等使用）。 该数据库对于给定的应用环境,利用计算机的基础知识、软件工程的原理和方法、程序设计的方法和技巧、数据库的基本知识、数据库设计技术、应用领域的知识等多学科综合知识与技术,对网上图书销售管理数据库做了需求分析,概念结构设计,逻辑结构设计,物理结构设计和Oracle数据库实施。最终设计出了一个简单的可对其进行用户管理、图书管理、进货管理,销售管理和售后管理的网上图书销售管理数据库,使之能够有效地管理和存储数据,满足一些简单的应用需求 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 实验数据及结果分析 1、创建数据库   数据库表、视图、索引等对象   （1）、数据库表       （2）、创建视图：   （3）、创建索引：   数据库表进行数据增、删、查、改SQL操作 （1）插入      （2）、查找：   （3）、更新   （4）、删除   4、编写函数Pro_CurrentSale        5、编写图书销售表Insert触发器Tri_InsertSale    6、  总结及心得体会 通过这次课程设计，我了解了PostgreSql数据库的一些使用方法和PgAdmin4的一些使用技巧。掌握SQl语言中一些基本的语句，如创建数据库，创建数据表，索引，视图；还有对数据库的一些增删改查的操作；              但是对存储过程和函数的定义，创建和编写和初步使用以及触发器的创建等方面并不是很熟练和了解。主要是因为我在课程学习时对这一块的内容掌握和理解的就不是很好。 在这次实验之中，我发现我对SQL语言掌握的并不是很好，我会继续努力，补上之前没有学好的知识。       \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306  \t\t实验时间：2019.5.20      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 PostgreSQl数据库角色管理、用户管理、权限管理的基本方法 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  八、实验数据及结果分析 1、设计数据存取权限控制模型   2、创建角色：   3、赋予权限   4、创建用户：    九、总结及心得体会 此次课程设计是对我们这学期所学知识的一次总结。在实验的过程中遇到了很多困难。 可能时觉得自己掌握了知识实践起来就没有问题，但是在真正进行实验的时候会遇到很多书本上不会提及的问题。通过这次试验，我也深刻的体会到了在学习过程中实践和知识相结合的重要性。      ",
  "studentID": "2017221301027"
 },
 "40": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t\t\t\t实验时间：2019.5.20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 SQL主要操作功能有数据库对象创建、修改、删除；数据库表的数据插入、修改、删除、查询、统计；存储过程、触发器、函数等程序执行；数据库权限、角色、用户等管理等。 SQL主要有以下语言语句类型： 1.数据定义语言（Data Definition Language，DDL）是SQL语言中用于创建、修改或删除数据库对象的语句。 CREATE DATABASE - 创建新数据库 DROP DATABASE C 删除数据库 ALTER DATABASE - 修改数据库属性  CREATE TABLE - 创建新表  ALTER TABLE C 修改数据库表结构 DROP TABLE - 删除表 CREATE INDEX - 创建索引 DROP INDEX - 删除索引 2. 数据操纵语言（Data Manipulation Language，DML）是SQL语言中用于增添、修改、删除数据的语句。 INSERT - 向数据库表中插入数据  UPDATE - 更新数据库表中的数据 DELETE - 从数据库表中删除数据 3. 数据查询语言（Data Query Language，DQL）是SQL语言中用于对数据库进行数据查询的语句。 4. 数据控制语言（Data Control Language，DCL）是用于对数据库对象访问权进行控制的SQL语句。 GRANT C 授予用户对数据库对象的权限 DENY C 拒绝授予用户对数据库对象的权限 REVOKE C 撤消用户对数据库对象的权限 5. 事务处理语言（Transaction Process Language，TPL）是SQL语言中用于数据库内部事务处理的语句。 BEGIN TRANSACTION C 开始事务 COMMIT C 提交事务 ROLLBACK C 回滚事务 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 7.1创建图书销售管理系统数据库BookSale。 7.2在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 创建以下数据库表并添加数据：用户信息表（Users）、图书信息表（Book）、图书销售表（Sale）。各数据表的字段结构定义见表7-1到表7-3所示。 表7-1 用户信息表（Users） 表7-2 图书信息表（Book） 表7-3 图书销售表（Sale） 7.3创建用户信息表（Users），并添加数据。     7.4创建图书信息表（Book），并添加数据。 \t7.5创建图书销售表（Sale），并添加数据。 7.6对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 7.7编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 7.8编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 7.9编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。    7.10对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 8.1 创建图书销售管理系统数据库BookSale，如图8-1所示：  图8-1 创建数据库BookSale 8.2在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 创建book、users与sale表：    图8-2 创建数据库表book、users和sale  创建引索：  创建SQL视图，通过视图查询出版日期在2019/6/30之前的图书编号、名称及作者：                       图8-3 创建视图selectview  8.3对图书销售管理系统数据库表进行数据增、删、查、改SQL操作  向数据表中插入数据：                          图8-4 对三张表进行数据插入操作  对数据表进行查询操作：                         图8-5 查询图书表在插入数据后的结果  对用户表（users）进行数据删除操作：      对用户表（users）进行数据更新操作：           图8-13 对图书信息表（BookInfo）进行数据删除操作       图8-6 查询用户表在删除和更新后的结果   8.4编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。存储过程创建过程                             图8-7 创建存储过程Pro_CurrentSale  8.5编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。由图8-8可见2019年6月30日的销售量为4、销售金额为239.20$。                                   图8-8 验证存储过程Pro_CurrentSale的功能  8.6编写图书表Insert触发器Tri_InsertSale，实现记录新更新的图书数据。 8.7对图书表Insert触发器Tri_InsertSale程序进行功能验证。触发器触发结果如图8-9所示。  首先建立autotable表，记录在对book表插入时的数据，autotable表由触发器更新：        创建触发器函数：    创建触发器：   触发器功能验证：                         图8-9 触发器Tri_InsertSale验证成功 九、总结及心得体会 1、通过本次实验，让我对数据库操作语言SQL有了更加深刻的认识。从创建数据库、创建数据库表对象、创建数据库索引对象等数据定义SQL语句，到数据的插入、更新、删除、查看等数据操纵SQL语句，再到视图的创建、删除等视图SQL语句，最后到存储过程、触发器等涉及到的数据库应用编程语句。 2、学习数据库感觉和我们平时学习的其他科目知识一样永无止境。平时只是单纯学习书本上的知识，可能对其中的操作没有很深刻的认识，通过这次数据库实验，自己一点一点将学到的代码通过键盘敲击在屏幕上，每一次运行成功的时候，都会很有成就感。 3、这次实验对我来说受益匪浅，希望老师以后可以多多安排类似的上机实验，给我们更多动手操作的机会。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306\t\t\t\t\t实验时间：2019.5.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 本次实验主要涉及到数据库的安全管理。由于数据库系统随规模增大，系统会变得异常复杂、多用户数据库应用带来数据库访问复杂性等等，为了保障数据库系统正常稳定运行、充分发挥数据库系统的软硬件处理能力，我们必须要进行数据库安全管理。 4.1 数据库系统安全模型如图4-1所示：  图4-1 数据库系统安全模型 身份验证：从应用系统层面确认登录用户是否是合法使用者。 权限控制：从DBMS系统层面通过存取权限机制控制用户对数据的访问。 系统防护：从操作系统层面提供的安全机制防范非法系统访问。 加密存储：从数据存储层面通过加密算法对数据库中数据进行加密存储。 4.2 数据库存取权限控制安全模型如图4-2所示：   图4-2 数据库系统存取权限控制安全模型 \t4.3 用户管理 \t用户要访问数据库，必须先在DBMS中创建其账号，并成为数据库的用户。此后，用户每次访问数据库，都需要在DBMS进行身份验证，只有合法用户才能进入系统，访问操作数据库对象。实现用户管理方式为数据库服务器执行SQL语句管理用户。 \t4.4 权限管理 \t数据库权限管理是指DBA管理员或数据库对象拥有者对其所拥有对象进行权限控制设置。权限管理基本操作分为授予权限、收回权限、拒绝权限。权限类别分为数据库对象访问操作权限、数据库对象定义操作权限。 4.5角色管理 在DBMS中，为了方便对众多用户及其权限进行管理，通常将一组具有相同权限的用户定义为角色(Role)。角色管理内容包括创建角色、修改角色、删除角色。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤      为实验二建立新表： 用户信息表（Users） 图书信息表（BookInfo） 图书销售表（BookSale） 7.1针对图书销售管理系统数据库，设计数据存取权限控制模型。 7.2在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 客户角色具有登录权限和角色继承权限，但是它不具有超级用户权限、创建数据库权限、创建角色权限和数据库复制权限。商家角色具有具有超级用户权限、登录权限、角色继承权限，创建数据库权限、创建角色权限和数据库复制权限。 7.3在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。给各角色分配访问数据库表的权限，见表7-1。 表7-1 角色创建表 实现客户角色（R_Customer）、商家角色（R_Seller）赋予表7-1所定义的对象访问权限。客户角色(R-Client)可以读取用户信息表(Users)、图书信息表(BookInfo)、图书销售表(BookSale)中数据，还可以对用户信息表(Users)的数据进行插入、修改和删除操作。商家角色(R-Seller)可以读取用户信息表(Users)、图书信息表(BookInfo)、图书销售表(BookSale)中数据，还可以对其中的数据数据进行插入、修改和删除操作。 7.4在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 7.5分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 7.6分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 为创建的用户设置登陆密码，然后断开服务器的连接，右键点击服务器，选择属性更改服务器连接用户， 保存后点击连接服务器输入用户密码连接数据库，并根据对应的权限，对相关数据库表进行查看、插入、修改、删除等操作。 八、实验数据及结果分析 8.1针对图书销售管理系统数据库，设计数据存取权限控制模型。 客户用户U_Customer可以读取用户信息表(Users)、图书信息表(BookInfo)、图书销售表(BookSale)中数据，还可以对用户信息表(Users)的数据进行插入、修改和删除操作。数据库存储权限模型如图8-1所示。  图8-1 用户“U_Customer”数据库存储权限控制模型 商家用户(U_Seller)可以读取用户信息表(Users)、图书信息表(BookInfo)、图书销售表(BookSale)中数据，还可以对其中的数据数据进行插入、修改和删除操作。数据库存储权限模型如图8-2所示。  图8-2 用户“U_Seller”数据库存储权限控制模型 8.2在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 客户角色具有登录权限和角色继承权限，但是它不具有超级用户权限、创建数据库权限、创建角色权限和数据库复制权限。该角色创建过程如图8-3所示，创建的SQL语句如下： CREATE ROLE \"R_Customer\" WITH  --创建客户角色 \tLOGIN \tNOSUPERUSER \tNOCREATEDB \tNOCREATEROLE \tINHERIT \tNOREPLICATION \tCONNECTION LIMIT -1;  图8-3 创建客户角色 商家角色具有具有超级用户权限、登录权限、角色继承权限，创建数据库权限、创建角色权限和数据库复制权限。该角色创建过程如图8-4所示，创建的SQL语句如下： CREATE ROLE \"R_Seller \" WITH  --创建商家角色 \tLOGIN \tSUPERUSER \tCREATEDB \tCREATEROLE \tINHERIT \tREPLICATION \tCONNECTION LIMIT -1;  图8-4 创建商家角色 8.3在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。给各角色分配访问数据库表的权限，见表7-1。实现客户角色（R_Customer）、商家角色（R_Seller）赋予表7-1所定义的对象访问权限，创建的SQL语句和操作过程如下。 客户角色(R-Client)可以读取用户信息表(Users)、图书信息表(BookInfo)、图书销售表(BookSale)中数据，还可以对用户信息表(Users)的数据进行插入、修改和删除操作。操作过程如图8-5所示，创建的SQL语句如下： GRANT SELECT,INSERT,UPDATE,DELETE ON Users TO \"R_Customer\"; GRANT SELECT ON BookInfo TO \"R_Customer\"; GRANT SELECT ON BookSale TO \"R_Customer\";  图8-5 赋予角色“R_Customer”数据库表访问权限 商家角色(R-Seller)可以读取用户信息表(Users)、图书信息表(BookInfo)、图书销售表(BookSale)中数据，还可以对其中的数据数据进行插入、修改和删除操作。操作过程如图8-6所示，创建的SQL语句如下： GRANT SELECT,INSERT,UPDATE,DELETE ON Users TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON BookInfo TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON BookSale TO \"R_Seller\";  图8-6 赋予角色“R_Seller”数据库表访问权限 8.4在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。操作过程如图8-7所示，创建的SQL语句如下： CREATE USER \"U_Customer\"; CREATE USER \"U_Seller\";  图8-7 创建用户“U_Customer”和“U_Seller”  8.5分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。操作过程如图8-8所示，创建的SQL语句如下： GRANT \"R_Customer\" TO \"U_Customer\"; GRANT \"R_Seller\" TO \"U_Seller\";  图8-8 为用户“U_Customer”和“U_Seller”分派角色 8.6分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 为创建的用户设置登陆密码，操作过程如图8-9所示，创建的SQL语句如下： alter user \"U_Customer\" with password '123456'; alter user \"U_Seller\" with password '123456';  图8-9 为用户“U_Customer”和“U_Seller”设置登录密码 断开服务器的连接，右键点击服务器，选择属性更改服务器连接用户，如图8-10所示：  图8-10 更改服务器连接用户 保存后点击连接服务器输入用户密码连接数据库，如图8-11所示：  图8-11 连接数据库     如图8-12所示，当前连接数据库的用户是“U_Customer”：  图8-12 用户“U_Customer”连接数据库 用户“U_Customer”对表Users具有查看、插入、修改、删除的访问权限。 插入数据，操作过程如图8-13所示，SQL语句如下： INSERT INTO Users VALUES('006','陈七','666666','66666666666','成都市高新西区'); INSERT INTO Users VALUES('007','吴八','777777','77777777777','成都市郫都区');  图8-13 以用户“U_Customer”身份在表Users中插入数据 修改数据，操作过程如图8-14所示，SQL语句如下： UPDATE Users SET UserName='小九' WHERE UserID='007';  图8-14 以用户“U_Customer”身份在表Users中修改数据 删除数据，操作过程如图8-15所示，SQL语句如下： DELETE FROM Users WHERE Tel='66666666666';  图8-15 以用户“U_Customer”身份在表Users中删除数据 查看数据，操作过程如图8-16所示，SQL语句如下： SELECT * FROM Users;  图8-16 以用户“U_Customer”身份在表Users中查看数据 如图8-17所示，当前连接数据库的用户是“U_Seller”：  图8-17 用户“U_Seller”连接数据库 用户“U_Seller”对表BookInfo具有查看、插入、修改、删除的访问权限。 插入数据，操作过程如图8-18所示，SQL语句如下： INSERT INTO BookInfo VALUES('121','计算机网络','詹姆斯','机械工业出版社','89', '100'); INSERT INTO BookInfo VALUES('122','女人这东西','渡边淳一','九州出版社','40', '50');  图8-18 以用户“U_Seller”身份在表BookInfo中插入数据 修改数据，操作过程如图8-19所示，SQL语句如下： UPDATE BookInfo SET Price='100' WHERE BookID='121';  图8-19 以用户“U_Seller”身份在表BookInfo中修改数据 删除数据，操作过程如图8-20所示，SQL语句如下： DELETE FROM BookInfo WHERE BookName='月亮与六便士';  图8-20 以用户“U_Seller”身份在表BookInfo删除数据 查看数据，操作过程如图8-21所示，SQL语句如下： SELECT * FROM BookInfo;  图8-21 以用户“U_Seller”身份在表BookInfo中查看数据 九、总结及心得体会 1、通过本次数据库实验，我对数据库的安全管理有了更加深刻的认识。由于数据库系统随规模增大，系统会变得异常复杂、多用户数据库应用带来数据库访问复杂性等等，为了保障数据库系统正常稳定运行、充分发挥数据库系统的软硬件处理能力，我们必须要进行数据库安全管理。 2、从设计数据存取权限控制模型。到创建角色，并根据业务规则为角色赋予数据库对象权限。再到创建用户，并分别为用户分派角色，分别以用户身份访问图书销售管理数据库，通过上机操作，根据每一种用户具有的权限，依次登陆并进行相关操作，充分验证所实现数据存取权限控制模型的正确性。 3、这次实验对我来说受益匪浅，希望老师以后可以多多安排类似的上机实验，给我们更多动手操作的机会，拥有更多的实战经验。 ",
  "studentID": "2017221302002"
 },
 "41": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t           实验时间： 5.20/5.22 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 4.1 数据库创建语句 语句基本格式 CREATE  DATABASE  <数据库名>; 4.2数据库修改SQL语句 ALTER  DATABASE  <数据库名> <修改内容>; 4.3 数据库删除SQL语句 DROP  DATABASE  <数据库名>; 4.4数据库表创建SQL语句 CREATE TABLE  <表名>  （ <列名1>  <数据类型>  [列完整性约束]， \t<列名2>  <数据类型>   [列完整性约束]，\t     <列名3>  <数据类型>  [列完整性约束]，     …    )； 列完整性约束关键词  PRIMARY KEY――主键 NOT NULL――非空值 NULL――空值 UNIQUE――值唯一 CHECK――有效性检查 DEFAULT――缺省值 表约束定义主键 CREATE TABLE  <表名>  （ <列名1>  <数据类型>  [列完整性约束]， \t<列名2>  <数据类型>   [列完整性约束]，\t     <列名3>  <数据类型>  [列完整性约束]，     …     CONSTRAINT  <约束名>  PRIMARY Key(主键列)    )； 表约束定义代理主键 在一些关系表中，为了方便数据处理，可以使用代理键去替代复合主键。在SQL语句中，关系表的代理键采用表约束方式来定义。 CREATE TABLE  <表名>  （ <代理键列名>  <Serial数据类型>  NOT NULL， \t<列名2>  <数据类型>  [列完整性约束]，\t     <列名3>  <数据类型>  [列完整性约束]，     …     CONSTRAINT  <约束名>  PRIMARY Key(代理键列名)    )； 表约束定义外键 在数据库中，一些关系表之间存在关联。在一个表中作为主键的列，在另外的关联表中则作为外键。 CREATE TABLE  <表名>  （ <列名1>  <数据类型>  [列完整性约束]， \t<列名2>  <数据类型>   [列完整性约束]，\t     <列名3>  <数据类型>  [列完整性约束]，     …     CONSTRAINT  <约束名>  FOREIGN Key(外键列)    )； 4.5修改表结构SQL语句 ALTER TABLE <表名> <修改方式>; 1）ADD修改方式，用于增加新列或列完整性约束 ALTER TABLE <表名> ADD <新列名称><数据类型>|[完整性约束] 2）DROP修改方式，用于删除指定列或列的完整性约束条件 ALTER TABLE<表名> DROP  COLUMN <列名>； ALTER TABLE<表名> DROP  CONSTRAINT<完整性约束名>； 3）RENAME修改方式，用于修改表名称、列名称 ALTER TABLE <表名> RENAME TO <新表名>； ALTER TABLE <表名> RENAME <原列名> TO <新列名>； 4）ALTER修改方式，用于修改列的数据类型 ALTER TABLE <表名> ALTER  COLUMN <列名> TYPE<新的数据类型>； 4.6删除表结构SQL语句 DROP TABLE <表名>; 4.7索引 索引（Index）是一种按照关系表中指定列的取值顺序组织元组数据存储的数据结构，使用它可以加快表中数据的查询访问。 CREATE INDEX  <索引名>  ON <表名><（列名）>； 4.8数据插入SQL语句 INSERT  INTO  <表名|视图名>[<列名表>]  VALUES （列值表）; 4.9数据更新SQL语句 UPDATE  <表名|视图名> SET  <列名1>=<表达式1> [，<列名2>=<表达式2>...] [WHERE   <条件表达式>]； 4.10数据删除SQL语句 DELETE  FROM  <表名|视图名> [WHERE   <条件表达式>]； 4.11数据查询SQL语句格式 SELECT  [ALL|DISTINCT]  <目标列>[，<目标列>…] [ INTO <新表> ] FROM  <表名|视图名>[，<表名|视图名>…] [ WHERE  <条件表达式> ] [ GROUP BY  <列名> [HAVING <条件表达式> ]] [ ORDER BY  <列名> [ ASC | DESC ] ]; 4.12创建存储过程的语法 CREATE [ OR REPLACE ] FUNCTION  name     ( [ [ argmode ] [ argname ] argtype [ { DEFAULT | = } default_expr ] [, ...] ] )     [ RETURNS retype | RETURNS TABLE ( column_name column_type [, ...] ) ] AS $$         //$$用于声明存储过程的实际代码的开始 DECLARE         -- 声明段 BEGIN         --函数体语句 END; $$ LANGUAGE lang_name;  //$$ 表明代码的结束, LANGUAGE后面指明所用的编程语言 4.13执行存储过程 select 存储过程名（参数）； 或者： select  * from 存储过程名（参数）； 例如： select  countRecords ( ); 或者：select  * from countRecords ( ); 4.14PostgreSQL创建触发器的基本语法 CREATE  TRIGGER  触发器名        { BEFORE | AFTER | INSTEAD OF }      ON 表名      [ FOR [ EACH ] { ROW | STATEMENT } ]      EXECUTE PROCEDURE 存储过程名 ( 参数列表 ) 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）数据库对象（方案、表、索引、视图等）DDL编程应用解决数据库实现及性能优化； （2）数据库数据增、删、查、改DML编程应用解决数据操作访问； （3）数据库触发器、数据库函数编程应用解决业务规则及后端功能实现。 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 八、实验数据及结果分析 (1)图书销售管理系统数据库BookSale创建操作  （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 数据库表创建：         创建视图：  创建索引：  （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作   （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 执行函数编写：insertSale()  创建触发器：  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证 九、总结及心得体会 创建表等工作简单但相对繁琐，需要耐心解决，要注意数值长度和类型。如果在sql窗口中输入错误，可以在可视化窗口中更改。存储过程和触发器有一些难度，但通过练习可以很好掌握。\n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306          实验时间：5.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 4.1用户管理 用户要访问数据库，必须现在DBMS中创建其用户账号，并成为数据库的用户。此后，用户每次连接访问数据库时，都需要在DMBS中进行身份鉴别，只有合法用户才能进入数据库系统，访问操作数据库对象。当该用户连接数据库后，便可进行相应角色权限的数据库操作访问。在数据库安全管理中，DBMS需要对每个数据库系统的用户进行身份属性管理，入，用户创建、用户修改、用户删除等。 实现用户管理方式有两种： （1）数据库服务器执行SQL语句管理用户 （2）通过管理工具GUI操作管理用户 1、SQL命令创建用户 CREATE USER  <用户账号名> [  [WITH]  option […]  ]; 2、用户修改 在数据库系统中，我们还可以对数据库已有用户进行属性修改，如修改用户密码、账户期限、连接数限制，以及用户的角色与权限等。 SQL语句基本格式如下： ALTER USER  <用户名>  [ [ WITH ] option [ ... ] ];  \t--修改用户的属性 ALTER USER  <用户名>  RENAME TO <新用户名>;  \t\t--修改用户的名称 ALTER USER  <用户名>  SET <参数项> { TO | = } { value | DEFAULT }; \t\t\t\t\t\t\t\t\t--修改用户的参数值   ALTER USER  <用户名>  RESET <参数项>;\t\t\t--重置用户参数值 3、用户删除 在数据库用户管理中，除了可以新建用户、修改用户外，还可以对不再需要对用户进行删除处理。同样删除用户有两种方式，即执行SQL命令删除用户账号和基于管理工具GUI操作删除用户账号，。 删除用户的SQL语句执行为： DROP  USER  <用户名>;  4.2权限管理 数据库权限管理是指DBA管理员或数据库对象拥有者对其所拥有对象进行权限控制设置。权限管理基本操作有授予权限收回权限拒绝权限 权限类别： 数据库系统权限 数据库对象访问操作权限 数据库对象定义操作权限 权限管理SQL语句 GRANT  <权限名> ON  <对象名>  TO {数据库用户名|用户角色名}； REVOKE  <权限名> ON  <对象名>  FROM {数据库用户名|用户角色名}； DENY  <权限名> ON  <对象名> TO {数据库用户名|用户角色名}； 4.3 角色管理 在DBMS中，为了方便对众多用户及其权限进行管理，通常将一组具有相同权限的用户定义为角色(Role)。 角色管理内容： 创建角色 修改角色 删除角色 角色管理实现方式： 执行SQL语句管理角色 通过GUI操作管理角色  CREATE  ROLE  <角色名> [ [ WITH ] option [ ... ] ]; \t --创建角色 ALTER  ROLE  <角色名>  [ [ WITH ] option [ ... ] ]; \t --修改角色属性 ALTER  ROLE  <角色名>  RENAME TO <新角色名>; \t\t --修改角色名称  ALTER  ROLE  <角色名>  SET <参数项> { TO | = } { value | DEFAULT };  \t\t\t\t\t\t\t\t\t --修改角色参数值 ALTER  ROLE  <角色名>  RESET <参数项>;\t\t\t --复位角色参数值 DROP  ROLE  <角色名>;\t\t\t\t\t\t --删除指定角色 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 在上次实验已经创建好的数据库BookSale中进行操作，创建对象，创建用户，并对用户授予角色，授予权限。 八、实验数据及结果分析 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。  （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。  （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。  （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。  （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  九、总结及心得体会 安全性是任何系统都必须解决的关键技术，特别是数据库系统存储了最重要的数据信息。数据库系统安全是指为数据库系统采取安全措施，防止数据库系统及其数据遭到破坏篡改和泄露。当用户进行数据库访问操作时，系统会进行身份鉴别，只有相应身份的权限才能对数据库进行操作。 ",
  "studentID": "2017221302024"
 },
 "42": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号 2017221302028                     姓    名 潘衍伶                      （实验）\t课程名称 数据库原理及应用                      理论教师 张凤荔                      实验教师 何中海                          电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：潘衍伶 学号：2017221302028       指导教师：何中海  实验地点：信软学院楼西306     实验时间：2019/5/20 一、实验名称：数据库实验 二、实验学时：8学时 三、实验目的： 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： SQL包括了所有对数据库的操作，主要是由4个部分组成： 1.数据定义：这一部分又称为“SQL DDL”，定义数据库的逻辑结构，包括定义数据库、基本表、视图和索引4部分。 2.数据操纵：这一部分又称为“SQL DML”，其中包括数据查询和数据更新两大类操作，其中数据更新又包括插入、删除和更新三种操作。 3.数据控制：对用户访问数据的控制有基本表和视图的授权、完整性规则的描述，事务控制语句等。 4.嵌入式SQL语言的使用规定：规定SQL语句在宿主语言的程序中使用的规则。 下面我们将分别介绍： 数据定义 SQL数据定义功能包括定义数据库、基本表、索引和视图。 首先，让我们了解一下SQL所提供的基本数据类型：(如^00100009b^) 1.数据库的建立与删除 (1)建立数据库：数据库是一个包括了多个基本表的数据集，其语句格式为： CREATE DATABASE <数据库名> 〔其它参数〕 其中，<数据库名>在系统中必须是唯一的，不能重复，不然将导致数据存取失误。〔其它参数〕因具体数据库实现系统不同而异。 例：要建立项目管理数据库(xmmanage)，其语句应为： CREATE DATABASE xmmanage (2)数据库的删除：将数据库及其全部内容从系统中删除。 其语句格式为：DROP DATABASE <数据库名> 例：删除项目管理数据库(xmmanage)，其语句应为： DROP DATABASE xmmanage 2.基本表的定义及变更 本身独立存在的表称为基本表，在SQL语言中一个关系唯一对应一个基本表。基本表的定义指建立基本关系模式，而变更则是指对数据库中已存在的基本表进行删除与修改。 数据查询 SQL是一种查询功能很强的语言，只要是数据库存在的数据，总能通过适当的方法将它从数据库中查找出来。SQL中的查询语句只有一个：SELECT，它可与其它语句配合完成所有的查询功能。SELECT语句的完整语法，可以有6个子句。完整的语法如下： 　　SELECT 目标表的列名或列表达式集合 　　FROM 基本表或(和)视图集合 　　〔WHERE条件表达式〕 　　〔GROUP BY列名集合 　　〔HAVING组条件表达式〕〕 　　〔ORDER BY列名〔集合〕…〕 简单查询,使用TOP子句 查询结果排序order by 带条件的查询where,使用算术表达式，使用逻辑表达式，使用between关键字，使用in关键字， 模糊查询like [4]  整个语句的语义如下：从FROM子句中列出的表中，选择满足WHERE子句中给出的条件表达式的元组，然后按GROUPBY子句(分组子句)中指定列的值分组，再提取满足HAVING子句中组条件表达式的那些组，按SELECT子句给出的列名或列表达式求值输出。ORDER子句(排序子句)是对输出的目标表进行重新排序，并可附加说明ASC(升序)或DESC(降序)排列。 　　在WHERE子句中的条件表达式F中可出现下列操作符和运算函数： 　　算术比较运算符：<，<=，>，>=，=，<>。 　　逻辑运算符：AND，OR，NOT。 　　集合运算符：UNION(并)，INTERSECT(交)，EXCEPT(差)。 　　集合成员资格运算符：IN，NOT IN 　　谓词：EXISTS(存在量词)，ALL，SOME，UNIQUE。 　　聚合函数：AVG(平均值)，MIN(最小值)，MAX(最大值)，SUM(和)，COUNT(计数)。 　　F中运算对象还可以是另一个SELECT语句，即SELECT语句可以嵌套。 　　上面只是列出了WHERE子句中可出现的几种主要操作，由于WHERE子句中的条件表达式可以很复杂，因此SELECT句型能表达的语义远比其数学原形要复杂得多。 　　下面，我们以上面所建立的三个基本表为例，演示一下SELECT的应用： 　　1.无条件查询 　　例：找出所有学生的的选课情况 　　SELECT st_no，su_no 　　FROM score 　　例：找出所有学生的情况 　　SELECT* 　　FROM student 　　“*”为通配符，表示查找FROM中所指出关系的所有属性的值。 　　2.条件查询 　　条件查询即带有WHERE子句的查询，所要查询的对象必须满足WHERE子句给出的条件。 　　例：找出任何一门课成绩在70以上的学生情况、课号及分数 　　SELECT UNIQUE student.st_class，student.st_no，student.st_name，student.st_sex，student.st_age，score.su_no，score.score 　　FROM student，score 　　WHERE score.score>=70 AND score.stno=student,st_no 　　这里使用UNIQUE是不从查询结果集中去掉重复行，如果使用DISTINCT则会去掉重复行。另外逻辑运算符的优先顺序为NOT→AND→OR。 　　例：找出课程号为c02的，考试成绩不及格的学生 　　SELECT st_no 　　FROM score 　　WHERE su_no=‘c02’AND score<60 　　3.排序查询 　　排序查询是指将查询结果按指定属性的升序(ASC)或降序(DESC)排列，由ORDER BY子句指明。 　　例：查找不及格的课程，并将结果按课程号从大到小排列 　　SELECT UNIQUE su_no 　　FROM score 　　WHERE score<60 　　ORDER BY su_no DESC 　　4.嵌套查询 　　嵌套查询是指WHERE子句中又包含SELECT子句，它用于较复杂的跨多个基本表查询的情况。 　　例：查找课程编号为c03且课程成绩在80分以上的学生的学号、姓名 　　SELECT st_no，st_name 　　FROM student 　　WHERE stno IN (SELECT st_no 　　FROM score 　　WHERE su_no=‘c03’ AND score>80 ) 　　这里需要明确的是：当查询涉及多个基本表时用嵌套查询逐次求解层次分明，具有结构程序设计特点。在嵌套查询中，IN是常用到的谓词。若用户能确切知道内层查询返回的是单值，那么也可用算术比较运算符表示用户的要求。 　　5.计算查询 　　计算查询是指通过系统提供的特定函数(聚合函数)在语句中的直接使用而获得某些只有经过计算才能得到的结果。常用的函数有： 　　COUNT(*) 计算元组的个数 　　COUNT(列名) 对某一列中的值计算个数 　　SUM(列名) 求某一列值的总和(此列值是数值型) 　　AVG(列名) 求某一列值的平均值(此列值是数值型) 　　MAX(列名) 求某一列值中的最大值 　　MIN(列名) 求某一列值中的最小值 　　例：求男学生的总人数和平均年龄 　　SELECT COUNT(*)，AVG(st_age) 　　FROM student 　　WHERE st_sex=‘男’ 　　例：统计选修了课程的学生的人数 　　SELECT COUNT(DISTINCT st_no) 　　FROM score 　　注意：这里一定要加入DISTINCT，因为有的学生可能选修了多门课程，但统计时只能按1人统计，所以要使用DISTINCT进行过滤。 数据更新 数据更新包括数据插入、删除和修改操作。它们分别由INSERT语句，DELETE语句及UPDATE语句完成。这些操作都可在任何基本表上进行，但在视图上有所限制。其中，当视图是由单个基本表导出时，可进行插入和修改操作，但不能进行删除操作；当视图是从多个基本表中导出时，上述三种操作都不能进行。 　　1.数据插入 　　将数据插入SQL的基本表有两种方式：一种是单元组的插入，另一种是多元组的插入。 　　单元组的插入：向基本表score中插入一个成绩元组(100002，c02，95)，可使用以下语句： 　　INSERT INTO score(st_no，su_no，score) VALUES(‘100002’，‘c02’，95) 　　由此，可以给出单元组的插入语句格式： 　　INSERT INTO表名(列名1〔，列名2〕…) VALUES(列值1〔，列值2〕…) 　　其中，列名序列为要插入值的列名集合，列值序列为要插入的对应值。若插入的是一个表的全部列值，则列名可以省略不写如上面的(st_no，su_no，score)可以省去；若插入的是表的部分列值，则必须列出相应列名，此时，该关系中未列出的列名取空值。 　　多元组的插入：这是一种把SELECT语句查询结果插入到某个已知的基本表中的方法。 　　例如：需要在表score中求出每个学生的平均成绩，并保留在某个表中。此时可以先创建一个新的基本表stu_avggrade，再用INSERT语句把表score中求得的每一个学生的平均成绩(用SELECT求得)插入至stu_avggrade中。 　　CREATE TABLE stu_avggrade 　　(st_no CHAR(10) NOT NULL，//定义列st_no学号，类型为10位定长字符串，非空 　　age_grade SMALLINT NOT NULL )// 定义列age_grade平均分，类型为短整形，非空 　　INSERT INTO stu_avggrade(st_no，age_grade) 　　SELECT st_no，AVG(score) 　　FROM score 　　GROUP BY st_no //因为要求每一个学生所有课程的平均成绩，必须按学号分组进行计算。 　　2.数据删除 　　SQL的删除操作是指从基本表中删除满足WHERE<条件表达式>的记录。如果没有WHERE子句，则删除表中全部记录，但表结构依然存在。其语句格式为： 　　DELETE FROM表名〔WHERE 条件表达式〕 　　下面举例说明： 　　单元组的删除：把学号为100002的学生从表student中删除，可用以下语句： 　　DELETE FROM student 　　WHERE st_no=‘100002’//因为学号为100002的学生在表student中只有一个，所以为单元组的删除 　　多元组的删除：学号为100002的成绩从表score中删除，可用以下语句： 　　DELETE FROM score 　　WHERE st_no=‘100002’//由于学号为100002的元组在表score中可能有多个，所以为多元组删除 　　带有子查询的删除操作：删除所有不及格的学生记录，可用以下语句 　　DELETE FROM student 　　WHERE st_no IN 　　(SELETE st_no 　　FROM score 　　WHERE score<60) 　　3.数据修改 　　修改语句是按SET子句中的表达式，在指定表中修改满足条件表达式的记录的相应列值。其语句格式如下： 　　UPDATE 表名 SET 列名=列改变值〔WHERE 条件表达式〕 　　例：把c02的课程名改为英语，可以用下列语句： 　　UPDATE subject 　　SET su_subject=‘英语’ 　　WHERE su_no=‘c02’ 　　例：将课程成绩达到70分的学生成绩，再提高10% 　　UPDATE score 　　SET score=1.1*score 　　WHERE score>=70 　　SQL的删除语句和修改语句中的WHERE子句用法与SELECT中WHERE子句用法相同。数据的删除和修改操作，实际上要先做SELECT查询操作，然后再把找到的元组删除或修改。 数据控制 由于数据库管理系统是一个多用户系统，为了控制用户对数据的存取权利，保持数据的共享及完全性，SQL语言提供了一系列的数据控制功能。其中，主要包括安全性控制、完整性控制、事务控制和并发控制。 　　1.安全性控制 　　数据的安全性是指保护数据库，以防非法使用造成数据泄露和破坏。保证数据安全性的主要方法是通过对数据库存取权力的控制来防止非法使用数据库中的数据。即限定不同用户操作不同的数据对象的权限。 　　存取权控制包括权力的授予、检查和撤消。权力授予和撤消命令由数据库管理员或特定应用人员使用。系统在对数据库操作前，先核实相应用户是否有权在相应数据上进行所要求的操作。 　　(1)权力授予：权力授有数据库管理员专用的授权和用户可用的授权两种形式。数据库管理员专用授权命令格式如下： 　　|CONNECT | 　　GRANT|RESOURCE|TO 用户名〔IDENTIFED BY 口令〕 　　|DBA | 　　其中，CONNECT表示数据库管理员允许指定的用户具有连接到数据库的权力，这种授权是针对新用户；RESOURCE表示允许用户建立自己的新关系模式，用户获得CONNECT权力后，必须获得RESOURCE权力才能创建自己的新表；DBA表示数据库管理员将自己的特权授予指定的用户。若要同时授予某用户上述三种授权中的多种权力，则必须通过三个相应的GRANT命令指定。 　　另外，具有CONNECT和RESOURCE授权的用户可以建立自己的表，并在自己建立的表和视图上具有查询、插入、修改和删除的权力。但通常不能使用其他用户的关系，除非能获得其他用户转授给他的相应权力。 　　例：若允许用户SSE连接到数据库并可以建立他自己的关系，则可通过如下命令授予权力： 　　GRANT CONNECT TO SSE IDENTIFIED BY BD1928 　　GRANT RESOURCE TO SSE 　　用户可用的授权是指用户将自己拥有的部分或全部权力转授给其他用户的命令形式，其命令格式如下： 　　|SELECT | 　　|INSERT | 　　|DELETE | 　　GRANT|UPDATE(列名1[，列名2]…)|ON|表名 |TO|用户名|〔WITH GRANT OPTION〕 　　|ALTER | |视图名| |PUBLIC| 　　|NDEX | 　　|ALL | 　　若对某一用户同时授予多种操作权力，则操作命令符号可用“，”相隔。 　　PUBLIC 表示将权力授予数据库的所有用户，使用时要注意： 　　任选项WITH GRANT OPTION表示接到授权的用户，具有将其所得到的同时权力再转授给其他用户权力。 　　例：如果将表student的查询权授予所有用户，可使用以下命令： 　　GRANT SELECT ON student TO PUBLIC 　　例：若将表subject的插入及修改权力授予用户SSE并使得他具有将这种权力转授他人的权力，则可使用以下命令： 　　GRANT INSERT，UPDATE(su_subject) ON subject TO SSE WITH GRANT OPTION 　　这里，UPDATE后面跟su_subject是指出其所能修改的列。 　　(2)权力回收：权力回收是指回收指定用户原已授予的某些权力。与权力授予命令相匹配，权力回收也有数据库管理员专用和用户可用的两种形式。 　　DBA专用的权力回收命令格式为： 　　|CONNECT | 　　REVOKE|RESOURCE|FROM用户名 　　|DBA | 　　用户可用的权力回收命令格式为： 　　|SELECT | 　　|INSERT | 　　|DELETE | 　　REVOKE|UPDATE(列名1〔，列名2〕…) |ON|表名 |FROM |用户名| 　　|ALTER | |视图名| |PUBLIC| 　　|INDEX | 　　|ALL | 　　例：回收用户SSE的DBA权力： 　　REVOKE DBA FROM SSE 　　2.完整性控制 　　数据库的完整性是指数据的正确性和相容性，这是数据库理论中的重要概念。完整性控制的主要目的是防止语义上不正确的数据进入数据库。关系系统中的完整性约束条件包括实体完整性、参照完整性和用户定义完整性。而完整性约束条件的定义主要是通过CREATE TABLE语句中的〔CHECK〕子句来完成。另外，还有一些辅助命令可以进行数据完整性保护。如UNIQUE和NOT NULL，前者用于防止重复值进入数据库，后者用于防止空值。 　　3.事务控制 　　事务是并发控制的基本单位，也是恢复的基本单位。在SQL中支持事务的概念。所谓事务，是用户定义的一个操作序列(集合)，这些操作要么都做，要么一个都不做，是一个不可分割的整体。一个事务通常以BEGIN TRANSACTION开始，以COMMIT或ROLLBACK结束。 　　SQL提供了事务提交和事务撤消两种命令： 　　(1)事务提交：事务提交的命令为： 　　COMMIT 〔WORK〕 　　事务提交标志着对数据库的某种应用操作成功地完成，所有对数据库的操作都必须作为事务提交给系统时才有效。事务一经提交就不能撤消。 　　(2)事务撤消：事务撤消的命令是： 　　ROLLBACK 〔WORK〕 　　事务撤消标志着相应事务对数据库操作失败，因而要撤消对数据库的改变，即要“回滚”到相应事务开始时的状态。 　　当系统非正常结束时(如掉电、系统死机)，将自动执行ROLLBACK命令。 五、实验内容： 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤： 1.建表 2.增加 地区表   作者表   图书类别    出版社     图书      编著排名    商店    折扣    销售     库存   删  删除前   删除  删除后   改 更新前  更新  更新后  查 Area    Author   Book    Bookkind   函数Pro_CurrentSale      触发器Tri_InsertSale       数据存取权限控制模型    权限   用户   验证    U_Seller验证权限成功  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 本次实验成功地建立了booksale的数据库，并且实现了实验报告中的各种要求。 九、总结及心得体会： 我在本次实验遇到了一些问题，要我掌握了更多的知识，主要遇到的问题如下。 我对本书前面几章掌握比较好，可是做到后面几章关于函数和数据库编程的时候，还是问了同学才做了出来，可以看出我对知识的掌握还是不够熟练。我以后再做实验之前，应该要把书本上的相关概念仔细看过一遍后再开始做实验。 我将在以后继续努力，争取在以后的学习中做得更好。 对本实验过程及方法、手段的改进建议： 无。                                                      报告评分：                                          指导教师签字：",
  "studentID": "2017221302028"
 },
 "43": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西306\t\t     实验时间： 2019-05-20 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 SQL语句 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 1. 图书销售管理系统数据库BookSale创建操作 2. 3. 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 核心代码： Begin  Set new.operationFront=old.operationonUnder; End  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 同步成功！ 九、总结及心得体会 了解了SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，掌握了数据库SQL编程访问能力。同时也掌握了基本的数据库触发器、存储过程SQL编程方法，掌握了数据库后端编程能力。\n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西306\t   实验时间：2019-05-27  三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 SQL语句 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。   （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。  （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  九、总结及心得体会 了解了该DBMS系统对数据库管理的内容与方法，特别是理解了数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，掌握了数据库管理能力。",
  "studentID": "2017221303010"
 },
 "44": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221303016      姓    名        胡远杭           （实验）\t课程名称  数据库原理及应用     理论教师        陆鑫           实验教师        陆鑫               电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：胡远杭\t\t学号：2017221303016   指导教师：陆鑫   实验地点：信软学院楼西303  实验时间：2019.01.12 一、实验一：图书销售管理系统数据库SQL应用编程 二、实验学时：4 三、实验目的： 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。  四、实验原理： \t1.首先对图书销售管理系统进行需求分析，定义实体、实体属性和实体之间的关系。通过建模设计工具，进一步对图书销售管理数据库进行物理模型设计。 \t2.基于数据库设计方案，通过SQL编程执行完成对数据库的操作，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，最后利用视图、存储过程、触发器实现业务数据处理。  五、实验内容： 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行SQL创建图书销售管理系统数据库BookSale。 2.在数据库BookSale中，执行SQL创建数据库表、视图、索引等对象。 3.在数据库BookSale中，执行SQL进行数据增、删、查、改访问操作。 4.在数据库BookSale中，采用PL/pgSQL语言编写存储过程函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库BookSale中，采用PL/pgSQL语言编写过程语句块，实现对存储过程函数Pro_CurrentSale的调用，并输出统计结果。 6.在数据库BookSale中，采用PL/pgSQL语言编写编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.在数据库BookSale中，对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 8.在数据库BookSale中，创建存储过程函数实现图书销售数量和金额统计。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL、PL/pgSQL语言，完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11  七、实验步骤： 1.在数据库服务器中，创建数据库BookSale_2017221303016. 2.在数据库中采用SQL语句创建图书表、作者表、出版社表、库存流水表、客户表、销售表、以及各表主键外间的创建，并创建索引。 3.为各个准备数据数据并进行插入操作。 4.创建视图BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。 5.编写触发器函数，实现在sale_005表插入时，级联操作stock_005表。 6.创建完触发器函数之后，创建对应的触发器。 7.测试触发器功能。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建BookSale_2017221303016数据库： SQL语句：create database \"BookSale_2017221303016\" 执行结果如下：  数据库操作界面如下：   2.创建各数据库表以及表中主外键和索引： 首先明确实体及其之间的关系，然后进行创建。 SQL语句： 执行结果如下：   3.插入数据并对publisher005进行增删改查操作： SQL语句如下： 执行结果如下：  使用select *from publisher005; 结果如下：  4.创建视图： SQL语句如下： 执行结果：  使用select * from BOOK_AUTHER_PUBLISHER005;查询结果如下：  5.创建触发器函数： 创建触发器函数实现有一条销售数据插入sale005时，同时在stock005中修改图书的库存。 SQL语句： 执行结果：  6.创建触发器： SQL语句： 执行结果：  7.测试触发器： 测试所用SQL语句： 执行结果：  测试触发器之后的stock005如下：  Book005表之前的数据如下：  Book005表之后的数据如下：  可以看到，book005表的数据发生了正确改变，说明触发器执行成功。 8.创建存储过程： SQL语句如下： 执行结果：  9.调用存储过程： 使用SQL语句：select * from countsale() 执行结果：  金额正确，说明存储过程运行成功。  九、总结及心得体会： 通过此次实验，我学会了更多关于数据库基础操作的使用方法，而且也打深了自己的基础，对于许多基础操作有了更好的掌握。 十、对本实验过程及方法、手段的改进建议： 在实验中，可以添加更多具有挑战性的实验内容，这样有助于学生加深对于数据库的操作理解                                                      电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库SQL应用编程 二、实验学时：4    三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用SQL语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登陆时，就拥有了该用户的权限，在对数据库表进行操作时就会受到不同程度的约束。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer005）、商家（R_Seller005）角色。 3.在数据库中，根据业务规则为客户（R_Customer005）、商家（R_Seller005）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer005、商家用户U_Seller005。 5.分别为客户用户U_Customer005、商家用户U_Seller005分派客户（R_Client005）、商家（R_Seller005）角色。 6.分别以客户用户U_Customer005、商家用户U_Seller005身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2.在pgAdmin4中的BookSale_2017221303016数据库中，使用SQL语句创建客户（R_Customer005）角色、商家（R_Seller005）角色。 3.在pgAdmin4中，根据第一步设计的数据存取权限控制模型对客户（R_Customer005）角色、商家（R_Seller005）角色赋予所定义的数据库对象权限 4.在pgAdmin4中，分别创建客户用户U_Customer005、商家用户U_Seller005，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户U_Customer005、商家用户U_Seller005身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析 1.创建客户角色和商家角色： SQL语句： 执行结果：  2.赋予客户、商家角色权限： SQL语句： 运行结果：  3.创建客户用户和商家用户，将客户角色和商家角色赋予给他们： SQL语句： 执行结果：  4.分别用客户用户和商家用户验证是否赋予权限成功： 首先登陆客户用户：  测试时分别对book005，auther005，sale005进行测试：  查询book005功能可以运行。  从book005中删除数据由于权限不够所以无法进行。  查看auther005表可以正常运行。  往auther005中插入数据由于权限不足所以无法进行。  查看sale005由于权限不足无法进行 2.\t登陆商家用户：  查看customer005操作如下：  插入一条数据到auther中：   数据插入成功。 测试从stock中删除数据：  权限不足。 更新sale005中的数据：   结论：通过以上对与角色权限的测试，可以看到，各个角色权限都符合之前的设计。 九、总结及心得体会 通过这次实验，我更好的体会到了多角色，多用户的好处，相信在实际的应用中也可以得到更多的好处。       报告评分：                                          指导教师签字：",
  "studentID": "2017221303016"
 },
 "45": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验地点：信软楼西306             实验时间：2019-05-20,2019-05-22      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 实验原理 SQL语句，pgAdmin4使用，数据库的管理和编程 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 实验步骤 在pgAdmin4中创建图书销售数据库 建立数据库表，包含图书，库存，商店等10个数据库表 创建视图和索引 编写函数和过程语句块，输出统计结果 编写触发器 实现功能验证 实验数据及结果分析                           Package BookSaleDB mport java.sql.Connrction; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement;  public class JDBCDemoDB{    public static void main(String argd[]){      connection sale=null; statement stmt=null; string URL=”jdbc:postgresql://localhost:5432/BookDB”; string userName=”myuser”; string passWord=”aa”;  Try{    Class.forName(“org.postgresql.Driver”);   sale=DriverManager.getConnection(URL,userName,password);   System.out.println(“Opened database successfully”);   stmt=sale.createStatement();   string sql=”select*from student”;   stmt=(Statement)sale.createStatement();      ResultSet rs=stmt.executeQuery(sql);   System.out.println(“最后的查询结果为：”);   while(rs.next()){      System.out.println(rs.getString(“图书名：”);      System.out.println(rs.getString(“a”);       System.out.println(rs.getString(“money”)）；   }   stmt.close();   sale.close(); }catch(Exception e){  System.errprintln(e.getBook()+”:”+getA()+getMoneey());  System.exit(0);}   } }  CREARE TRIGGER Tri_InsertSale  ON Insert CREATE OR REPLACE FUNCTION Insert() RETURNS TRIGGER AS $Insert$    BEGIN        IF (TG_OP='DELETE') THEN            INSERT INTO insert_book SELECT user,old.a,old.money,now(),old.a,old.money;            RETURN OLD;       ELSIF(TG_OP='UPDATE') THEN            INSERT INTO insert_book            SELECT user,old.a,old.money,now(),new.a,new.money            where old.a=new.a and old.a=new.a;            RETURN NEW;       ELSIF(TG_OP='INSERT') THEN            INSERT INTO insert_book            SELECT user,old.a,old.money,now(),new.a,new.money,null;            RETURN NEW;       END IF;       RETURN NULL; END; $Insert$ LANGUAGE plpgsql;  总结及心得体会 完整完成实验要求，得出正确实验结果 本次实验内容非常全面，对自己熟悉这方面的知识有很大的作用。   \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验地点：信软楼西306  \t\t\t\t\t   实验时间：2019-05-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 数据库中用户，角色的创建，赋予权限，权限控制模型，pgAdmin4的使用，SQL语句的使用。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 实验步骤 （1）0设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。       八、实验数据及结果分析      九、总结及心得体会 完整完成本次实验，得出正确实验结论。 ",
  "studentID": "2017221303024"
 },
 "46": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书借阅管理系统数据库SQL应用编程 二、实验室名称：信软大楼306\t           实验时间：2019.5.22    三、实验目的 针对图书借阅管理数据库开发，了解ORACLE SQL语言DDL、DML、DQL、DCL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书借阅管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 通过各种SQL语言，例如insert ,create 之类的语言，创建出表，然后通过外键来连接两个表，并对两个表进行增删查改的操作。之后再通过触发器编程和存储过程编程对表进行操作。 五、实验内容 使用SQL Developer数据库开发工具对图书借阅管理系统数据库进行数据操作访问，并完成触发器、存储过程后端编程，具体实验内容如下: 图书借阅管理系统数据库方案(Schema)创建及配置。 图书借阅管理系统数据库方案中，编写SQL程序创建数据库对象（表、视图、索引、序列等）。 对图书借阅管理系统数据库表进行数据增、删、查、改SQL操作。 进行图书借阅管理系统数据库的触发器编程，以实现业务规则数据处理。 进行图书借阅管理系统数据库的存储过程编程，以实现数据库后端数据处理。 在实验计算机上，利用SQL Developer数据库系统工具，完成图书借阅管理系统数据库SQL编程操作访问，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： SQL Developer4.1 DBMS系统： Oracle Database 11g/12c 七、实验步骤 \t1.创建新用户，新连接 \t2.创建关于书的属性的表 \t3.创建关于借阅者的属性的表    4.创建视图，索引，序列 \t5.向表中插入数据 \t6.查询表中的数据 \t7.创建Book表中的索引 \t8.对Book表进行增删查改的操作 \t9. 进行图书借阅管理系统数据库的触发器编程，以实现业务规则数据处理 10. 进行图书借阅管理系统数据库的存储过程编程，以实现数据库后端数据处理。  八、实验数据及结果分析 1.创建新用户，新连接  2.创建关于书的属性的表    3.创建关于借阅者者属性的表    4.创建视图\n   5.向表中插入数据   6.查询表中数据     7.创建Book表中的索引   8.对Book表进行增删查改的操作 \t（1）增        \t （2）删    \t （3）查，并将查询结果放入新的表中    \t (4)改    9. 进行图书借阅管理系统数据库的触发器编程，以实现业务规则数据处理  向表BOOK中添加一条字段        10. 进行图书借阅管理系统数据库的存储过程编程，以实现数据库后端数据处理。   九、总结及心得体会 熟练掌握在oracle中SQL语句的具体用法，融会贯通 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：306  \t\t\t\t\t      实验时间：2019.5.27     三、实验目的 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 通过create user user_name创建用户 用SQL Developer给创建的用户分配角色和权限 用给定权限和角色的用户测试对数据库的访问 五、实验内容 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： SQL Developer4.1 DBMS系统： Oracle Database 11g/12c 七、实验步骤 图书借阅管理系统数据库角色管理 图书借阅管理系统数据库权限管理 图书借阅管理系统数据库用户管理 验证特定用户下对数据库对象访问的安全管理  八、实验数据及结果分析 通过create role创建角色   给角色赋予权限 把角色赋予指定用户  给新用户赋连接权限并连接新用户  在新的连接中测试是否能查询BOOKLIST和BOOK  九、总结及心得体会 熟练掌握在oracle中SQL语句的具体用法，融会贯通 ",
  "studentID": "2017221303028"
 },
 "47": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西306\t\t\t\t   实验时间：2019-05-27      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 （1）数据库对象（方案、表、索引、视图等）DDL编程应用解决数据库实现及性能优化； （2）数据库数据增、删、查、改DML编程应用解决数据操作访问； （3）数据库触发器、数据库函数编程应用解决业务规则及后端功能实现。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11  七、实验步骤 （1）首先创建数据库并插入数据  （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象  （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作  （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  （5）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。    八、实验数据及结果分析 1、数据库表的创建与数据插入截图 \t从以下两图的输出结果可知，成功地创建了数据库并插入了数据。 2、为数据创建索引、视图 \t从以下两图可知，成功地创建了Bookview视图，并将视图中的数据输出在了输出栏。图二则是为数据创建了索引，在右侧栏中可以看到选中部分即为创建成功的索引项目。 3、对数据进行增删改查操作 \t如下方三图所示，第一图对Books表进行了查询，查询该表全部信息。 第二图分别对Book表插入一条数据，删除了Press表中的一条数据，并将Books表更名为BookInfo。第三图则是在Sales表中添加了一列表示剩余图书数目地BookSurplus数据。 4、编写过程函数统计销售数目与销售金额 \t如下图所示，我们通过新建了一个用户自定义数据结构numNmoney（代表统计销售数目与销售金额），该数据包含两列，第一列为数目，第二列为金额。 通过存储过程，将numNmoney作为返回值，返回。调用存储过程函数后，发现，函数正确运行，并统计了销售数目与金额。  5、触发器 \t在触发器函数中，触发逻辑为，当用户对Sales表进行INSERT操作时，将操作的内容（图书存量等信息）同步写入到AUDIT表中。如图二所示，我们尝试插入了三条数据后查看AUDIT表，发现数据有同步写入。  九、总结及心得体会 个人认为本次实验难度较大。主要难点在于：1、对于数据库编程部分的内容掌握不够深刻（之前没有做过什么练习）；2、实验报告中给出的说明较为概括。在第一次实验的过程中，因为没有给出测试数据，所以所有的测试数据均为自己编写的。后期的时候，发现这些测试数据有些不能够满足实验的要求（比如统计书籍库存等）。因此，在编写数据这一步其实耗费了大量的时间。 但总体上，通过这次实验，我对数据库的编程部分（包括存储过程和触发器）都有了更深刻的理解。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西306\t\t\t\t   实验时间：2019-05-27        三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 （1）数据库角色、用户及权限管理； （2）图书销售管理系统数据库管理实现。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。  （2）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  （3）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 八、实验数据及结果分析 1、创建角色 2、为角色赋予权限 \t考虑到Seller相对于Customer，拥有更多地对数据进行操作的权限，尤其是对于Sales表进行的操作权限。而Customer则不应该拥有过多的权限，因此在赋予权限的时候，我们仅赋予了Customer查看的权限，以及添加销售记录的权限。 如下图所示。 3、创建USER，并将之添加进相应的角色组 4、使用不同的角色登录数据库并进行操作 \t我们使用了sql命令行界面进行用户的登录操作。结果如下图。  九、总结及心得体会 本次的实验相较于第一次的实验，简单了很多。尤其是本次实验不需要过多的编写函数，这使得本次实验的难度大大降低。当然，这并不意味着本次实验的知识的重要性不如第一次实验，事实上，无论是第一次实验还是第二次实验，设计到的知识点都是现实生活中我们在设计实现一个数据库的时候会遇到的。 当然，无论如何，还是要好好地掌握好这两次实验地重点知识。更好地理解一个数据库地设计流程、实现地流程，才能更好地将之运用于真正地工程实践当中去。",
  "studentID": "2017221304002"
 },
 "48": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号        2017221304005               姓    名        吕志伟               （实验）\t课程名称        数据库原理及应用               理论教师        张凤荔               实验教师        何中海                   电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：吕志伟\t\t学号：2017221304005         指导教师：何中海 实验地点：信软学院306         实验时间：2019年5月20日 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：5学时 三、实验目的： 针对图书销售管理系统数据库开发，掌握DDL、DML、DQL类型SQL语句在BookSale数据库开发中的应用方法，完成图书销售管理数据库SQL编程操作。 四、实验原理： pgAdmin4 提供了数据库操作方便的管理。既可以利用图形化工具进行创建、插入、删除等操作，同时可以利用SQL语句，进行创建的过程。 SQL语句基本格式： 创建数据库：create database <数据库名>; 创建表：CREATE TABLE  <表名>  \t\t（ <列名1>  <数据类型>  [列完整性约束]， \t\t\t<列名2>  <数据类型>   [列完整性约束]，\t     \t\t<列名3>  <数据类型>  [列完整性约束]，     \t\t…    \t)； 索引：CREATE INDEX  <索引名>  ON <表名><（列名）>； 视图：CREATE  VIEW  <视图名>[(列名1)，(列名2)，…]  AS  <SELECT查询>； 增：ALTER TABLE <表名> ADD <新列名称><数据类型>|[完整性约束]； \tINSERT  INTO  <表名|视图名>[<列名表>]  VALUES （列值表）; 删：ALTER TABLE<表名> DROP  COLUMN <列名>； 查：SELECT  [ALL|DISTINCT]  <目标列>[，<目标列>…] [ INTO <新表> ] FROM  <表名|视图名>[，<表名|视图名>…] [ WHERE  <条件表达式> ] [ GROUP BY  <列名> [HAVING <条件表达式> ]] [ ORDER BY  <列名> [ ASC | DESC ] ]; 改：UPDATE  <表名|视图名> SET  <列名1>=<表达式1> [，<列名2>=<表达式2>...] [WHERE   <条件表达式>]； 函数：CREATE [ OR REPLACE ] FUNCTION  name     \t( [ [ argmode ] [ argname ] argtype [ { DEFAULT | = } default_expr ] [, ...] ] )     \t[ RETURNS retype | RETURNS TABLE ( column_name column_type [, ...] ) ] AS $$         //$$用于声明存储过程的实际代码的开始 DECLARE         \t-- 声明段 BEGIN         \t--函数体语句 END; $$ LANGUAGE lang_name;  触发器：CREATE  TRIGGER  触发器名        { BEFORE | AFTER | INSTEAD OF }      ON 表名      [ FOR [ EACH ] { ROW | STATEMENT } ]      EXECUTE PROCEDURE 存储过程名 ( 参数列表 ) 五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）： 一台PC、postgreSQL实用程序。 七、实验步骤： （1）初始化postgreSQL数据库，打开控制台窗口； （2）使用查询命令窗口编写SQL语句，检查后执行； （3）检查实验结果。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 图书销售管理系统数据库BookSale创建操作： Create database library; \t （2）. 在建模工具PowerDesigner中创建实体，并选择SQL语句输出： #创建表 create table AREA( area_id     \tchar(6)     primary key, area_name   \tvarchar(30) not null );  create table AUTHOR( author_id   \tchar(12)    not null, area_id    \t \tchar(6)     not null, author_name \tvarchar(40) not null, author_addr \tvarchar(80) not null, author_tel  \tchar(11)    not null, constraint PK_AUTHOR primary key (author_id), constraint FK_AUTHOR foreign key (area_id) references AREA(area_id) on delete cascade );  create table publisher( publisher_id \t\tchar(12) \t\tprimary key,  publisher_name \t\tvarchar(40) \tnot null,  publisher_phone \tvarchar(20)\t\tnot null,  publisher_address \tvarchar(60) \tnot null );   create table bookclass( class_id \t\tchar(5) \t\tprimary key,  class_name \t\tvarchar(20) \tnot null );  create table book( ISBN \t\t\tchar(22) \tnot null,  publisher_id \tchar(12) \tnot null,  class_id \t\tchar(5)\t\tnot null,  book_name\t\tvarchar(80)\tnot null,  publish_date\tdate \t\tnot null,  price\t\t\tmoney\t\tnot null,  brief_introduction varchar(200) not null,  catalogue\t\ttext\t\tnot null,  constraint PK_BOOK primary key (ISBN), constraint FK_BOOK1 foreign key (publisher_id) references publisher(publisher_id) on delete cascade, constraint FK_BOOK2 foreign key (class_id) references bookclass(class_id) on delete cascade );  create table bookstore( bookstore_id \tchar(12) \tprimary key, bookstore_name \tvarchar(40)\tnot null, postcode\t\tchar(5)\t\tnot null, bookstore_address varchar(80) not null );  create table discount( discount_id INT2 \t\tprimary key, bookstore_id char(12)   not null, discount_rate INT2 \t\tnot null, discount_class varchar(20) not null, constraint FK_DISCOUNT foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade );  create table sale( sale_id\t\tserial primary key, ISBN \t\tchar(22) not null, bookstore_id \tchar(12)\tnot null, sale_date   date \t\tnot null, sale_amount\tnumeric\t\tnot null, sale_money\tmoney \t\tnot null, constraint FK_SALE1\tforeign key (ISBN) references book(ISBN) on delete cascade, constraint FK_SAL2 foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade );  create table inventory( bookstore_id char(12) not null, ISBN char(22) \t\tnot null, inventory_amount INT2 not null, constraint PK_INVENTORY primary key (bookstore_id,ISBN), constraint FK_INVENTORY1 foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade, constraint FK_INVENTORY2 foreign key (ISBN) references book(ISBN) on delete cascade );  create table rank( author_id char(12) not null, ISBN char(22) not null, rank_order INT2 not null, constraint PK_RANK primary key (author_id,ISBN), constraint FK_RANK1 foreign key (author_id) references author(author_id) on delete cascade, constraint FK_RANK2 foreign key (ISBN) references book(ISBN) on delete cascade ); \t表格创建结果：  \t创建成功。 创建索引：  视图创建：  create view basicbookview as select ISBN, book_name, price from book where class_id = '10010';  （3）. 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作： \t首先，准备好测试代码，之后检查数据库的运行结果： \t增： insert into AREA values('123456','chengdu'); insert into author values('1000000', '123456', '王三', '广东省深圳市', '12345678910'); insert into publisher values('1234', '人民邮电出版社', '1234567', 'Beijing'); insert into bookclass values('12345', 'Science'); insert into book values('100023456789876543', '3204','10001', 'Alibaba', '2018/2/23', '45', 'qwerty','abc.txt'); insert into bookstore values('000666612222','rghsrtg','54321','dherthgtwgserf'); insert into discount values(2,'000011112222',30,'sdgrsg'); insert into sale values('103467767','100023456789876543','000011112222','2019/6/8',120,'54634'); insert into inventory values('000011112222','100023456789876543',345); insert into rank values('1000000','100023456789876543',2);   删： delete from rank where rank_order = 6;   改： update rank set rank_order = 3 where author_id = '1000000'; 查： select ISBN, publisher_id,book_name from book; （4）. 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 \tcreate function Pro_CurrentSale() \treturns void as $$ \tdeclare \t\tsale_quantity numeric; \t\tsale_money_total money; \tbegin \t\tselect sum(sale_amount) into sale_quantity from sale; \t\tselect sum(sale_money) into sale_money_total from sale; \t\traise notice '图书销售量:%,销售金额%',sale_quantity,sale_money_total; \tend; $$ language plpgsql 运行脚本输出结果： （5）. 编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 \tselect Pro_CurrentSale(); \t（6）. 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 create or replace function Tri_InsertSale() \treturns trigger as $Tri_InsertSale$ \tbegin  \t\tinsert into inventory \t\t\tselect new.bookstore_id, new.ISBN, new.sale_amount; \t\treturn new; \tend; $Tri_InsertSale$ language plpgsql;  create trigger Tri_InsertSale_trigger after insert on sale for each row execute procedure Tri_InsertSale();  （7）. 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 \tselect * from inventory;  insert into sale values ('254235252','100434554359876543','000011112222','2019/4/11',234,'120'); select * from inventory; \t输出的结果与预期一致。 九、总结及心得体会： \t经过对结果的验证，确认图书管理系统创建完毕，未出现明显错误。 十、对本实验过程及方法、手段的改进建议： \t创建的表格数量太多了，实验时经常忘记定义，可以适当减少关系数量。                                                      报告评分：                                          指导教师签字： \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院306\t\t  实验时间：2019年6月4日   三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 数据库权限管理包括了一下三种权限控制模型： 数据库系统权限 数据库对象访问操作权限 数据库对象定义操作权限 权限管理SQL语句： \tGRANT  <权限名> ON  <对象名>  TO {数据库用户名|用户角色名}； REVOKE  <权限名> ON  <对象名>  FROM {数据库用户名|用户角色名}； DENY  <权限名> ON  <对象名> TO {数据库用户名|用户角色名}； \t角色管理SQL语句： \t\tCREATE  ROLE  <角色名> [ [ WITH ] option [ ... ] ]; \t --创建角色 ALTER  ROLE  <角色名>  [ [ WITH ] option [ ... ] ]; \t --修改角色属性 ALTER  ROLE  <角色名>  RENAME TO <新角色名>; \t\t --修改角色名称  ALTER  ROLE  <角色名>  SET <参数项> { TO | = } { value | DEFAULT };  \t\t\t\t\t\t\t\t\t --修改角色参数值 ALTER  ROLE  <角色名>  RESET <参数项>;\t\t\t --复位角色参数值 DROP  ROLE  <角色名>;\t\t\t\t\t\t --删除指定角色 \t用户创建SQL语句： \t\tCREATE USER  <用户账号名> [ [WITH]  option […]]; \t用户修改SQL语句： \t\tALTER USER  <用户名>  [ [ WITH ] option [ ... ] ];  \t--修改用户的属性 ALTER USER  <用户名>  RENAME TO <新用户名>;  \t\t--修改用户的名称 ALTER USER  <用户名>  SET <参数项> { TO | = } { value | DEFAULT }; \t\t\t\t\t\t\t\t\t--修改用户的参数值   ALTER USER  <用户名>  RESET <参数项>;\t\t\t--重置用户参数值 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 了解数据存取权限控制模型，并确定合适的模型； 执行角色创建，角色权限赋予等语句； 执行用户创建等语句； 利用sql shell进行用户的登录访问 八、实验数据及结果分析 \t有以下两种方式进行权限管理： 执行SQL控制语句进行权限管理 运行数据库管理工具进行权限管理 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 create role \"R_Customer\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1; create role \"R_Seller\" with  \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1;  在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 grant select,insert,update,delete on sale to \"R_Customer\"; grant select,insert,update,delete on sale to \"R_Seller\"; grant select,insert,update,delete on inventory to \"R_Seller\"; grant select,insert,update,delete on discount to \"R_Seller\"; grant select,insert,update,delete on bookstore to \"R_Seller\";  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 create user \"U_Customer\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1 \tpassword '123456'; create user \"U_Seller\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1 \tpassword '123456';    分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 GRANT \"R_Customer\" TO \"U_Customer\"; GRANT \"R_Seller\" TO \"U_Seller\"; 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 对相应的用户操作的结果显示，成功完成了数据库安全系统的设计。 九、总结及心得体会 \t该实验的关键在于数据库系统的设计与分析。",
  "studentID": "2017221304005"
 },
 "49": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：\t\t信软楼西306\t\t\t           实验时间： 19.5.20     三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 建模： 概念数据模型：从用户角度所建模的系统数据对象及其关系，它帮助用户分析信息系统的数据结构关系。 逻辑数据模型：从系统分析员角度所建模的系统数据对象逻辑结构关系，它帮助开发人员分析信息系统的逻辑数据结构。 物理数据模型：从系统设计人员角度所建模的系统数据物理存储及结构关系，它针对设计者具体定义信息系统的数据库表结构。    五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  八、实验数据及结果分析 8.1创建数据库 User master Go Create database booksale ON ( NAME=librarysystem, MAXSIZE=30, SIZE=10, FILEGROWTH=5) LOG ON ( NAME=‘library’,  MAXSIZE=30MB, SIZE=10MB, FILEGROWTH=5MB) Go   8.2创建表格 Create table book_style ( Bookstyleno varchar(30) primary key, Bookstyle varchar(30) )  Create table system_books ( Bookid varcjar(20) primary key, Book name var char(30) Not null, Bookstyleno varchar(30) Not null )  Create table borrw_record ( Bookid varchar(20) primary key, Readerid varchar(9), Borrowdate datetime )  Create table return_record ( Bookid varchar(20) primary key, Readerid varchar(9), Returndate datetime )                   8.3数据增删查改SQL操作 Insert into book_style(bookstyleno,bookstyle)values(‘1’科幻) Insert into book_style(bookstyleno,bookstyle)values(‘2’言情) Insert into book_style(bookstyleno,bookstyle)values(‘3’悬疑) Insert into book_style(bookstyleno,bookstyle)values(‘4’科学) Insert into book_style(bookstyleno,bookstyle)values(‘5’教育) Insert into book_style(bookstyleno,bookstyle)values(‘6’健康) Insert into book_style(bookstyleno,bookstyle)values(‘7’健康a)  DELETE from book_style  WHERE ‘bookstyleno’ =‘7’  Select * from book_style Select readertype from system_readers Select bookid from borrow_record  Update book_style set bookstyle=不健康 where ‘bookstyleno’=‘6’   8.4 create function Pro_CurrentSale() \treturns void as $$ \tdeclare \t\tsale_quantity numeric; \t\tsale_money_total money; \tbegin \t\tselect sum(sale_amount) into sale_quantity from sale; \t\tselect sum(sale_money) into sale_money_total from sale; \t\traise notice '图书销售量:%,销售金额%',sale_quantity,sale_money_total; \tend; $$ language plpgsql 运行脚本输出结果： 8.5 select Pro_CurrentSale();        8.6 create or replace function Tri_InsertSale() \treturns trigger as $Tri_InsertSale$ \tbegin  \t\tinsert into inventory \t\t\tselect new.bookstore_id, new.ISBN, new.sale_amount; \t\treturn new; \tend; $Tri_InsertSale$ language plpgsql;  create trigger Tri_InsertSale_trigger after insert on sale for each row execute procedure Tri_InsertSale();    8.7 select * from inventory;  insert into sale values ('254235252','100434554359876543','000011112222','2019/4/11',234,'120'); select * from inventory;         九、总结及心得体会    创建表格之间的共有列必须使用外键相连。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：  \t信软楼西306\t\t\t\t       实验时间：19.05.27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 安全模型： 身份验证 权限控制 系统防护 加密存储  安全访问： 用户身份认证 存取控制 数据库加密 推理控制 审计追踪  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  八、实验数据及结果分析 8.2创建角色 Create role “R_Customer” Create role “R_Seller”     8.3赋予权限 Grant SELECT,UPDATE ,LOGIN, LOGIN,INHERIT ON STUDENT_2017221304013 TO R_Customer; Grant SELECT,UPDATE ,LOGIN, LOGIN,INHERIT, SUPERUSER,CREATEROLE to R_Seller;         8.4创建用户 Create user “U_Customer” Creat user “U_Seller”        8.5分派角色 Grant R_Customer To U_Customer; Grant R_Seller To U_Seller;       8.6验证所实现数据存取权限控制模型的正确性。           九、总结及心得体会 在进行权限赋予时，应对角色所具有的功能进行对应，不能少也不能多。当出现很多用户时，最好进行角色赋予，若为每个学生创建一个用户，太复杂繁琐，会占用较大空间。更好的办法是：创建一个角色名为学生即可。 ",
  "studentID": "2017221304013"
 },
 "50": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306\t\t\t     实验时间：2019-05-20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 创建新表 CREATE TABLE user_tbl(name VARCHAR(20), signup_date DATE); 插入数据 INSERT INTO user_tbl(name, signup_date) VALUES(';张三';, ';2013-12-22';); 选择记录 SELECT * FROM user_tbl; 更新数据 UPDATE user_tbl set name = ';李四'; WHERE name = ';张三';; 删除记录 DELETE FROM user_tbl WHERE name = ';李四'; ; 添加栏位 ALTER TABLE user_tbl ADD email VARCHAR(40); 更新结构 ALTER TABLE user_tbl ALTER COLUMN signup_date SET NOT NULL; 更名栏位 ALTER TABLE user_tbl RENAME COLUMN signup_date TO signup; 删除栏位 ALTER TABLE user_tbl DROP COLUMN email; 表格更名 ALTER TABLE user_tbl RENAME TO backup_tbl; 删除表格 DROP TABLE IF EXISTS backup_tbl; 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 图书销售管理系统数据库BookSale创建操作 Create database library; 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 #创建表 create table AREA( area_id     \tchar(6)     primary key, area_name   \tvarchar(30) not null );  create table AUTHOR( author_id   \tchar(12)    not null, area_id    \t \tchar(6)     not null, author_name \tvarchar(40) not null, author_addr \tvarchar(80) not null, author_tel  \tchar(11)    not null, constraint PK_AUTHOR primary key (author_id), constraint FK_AUTHOR foreign key (area_id) references AREA(area_id) on delete cascade );  create table publisher( publisher_id \t\tchar(12) \t\tprimary key,  publisher_name \t\tvarchar(40) \tnot null,  publisher_phone \tvarchar(20)\t\tnot null,  publisher_address \tvarchar(60) \tnot null );   create table bookclass( class_id \t\tchar(5) \t\tprimary key,  class_name \t\tvarchar(20) \tnot null );  create table book( ISBN \t\t\tchar(22) \tnot null,  publisher_id \tchar(12) \tnot null,  class_id \t\tchar(5)\t\tnot null,  book_name\t\tvarchar(80)\tnot null,  publish_date\tdate \t\tnot null,  price\t\t\tmoney\t\tnot null,  brief_introduction varchar(200) not null,  catalogue\t\ttext\t\tnot null,  constraint PK_BOOK primary key (ISBN), constraint FK_BOOK1 foreign key (publisher_id) references publisher(publisher_id) on delete cascade, constraint FK_BOOK2 foreign key (class_id) references bookclass(class_id) on delete cascade );  create table bookstore( bookstore_id \tchar(12) \tprimary key, bookstore_name \tvarchar(40)\tnot null, postcode\t\tchar(5)\t\tnot null, bookstore_address varchar(80) not null );  create table discount( discount_id INT2 \t\tprimary key, bookstore_id char(12)   not null, discount_rate INT2 \t\tnot null, discount_class varchar(20) not null, constraint FK_DISCOUNT foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade );  create table sale( sale_id\t\tserial primary key, ISBN \t\tchar(22) not null, bookstore_id \tchar(12)\tnot null, sale_date   date \t\tnot null, sale_amount\tnumeric\t\tnot null, sale_money\tmoney \t\tnot null, constraint FK_SALE1\tforeign key (ISBN) references book(ISBN) on delete cascade, constraint FK_SAL2 foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade );  create table inventory( bookstore_id char(12) not null, ISBN char(22) \t\tnot null, inventory_amount INT2 not null, constraint PK_INVENTORY primary key (bookstore_id,ISBN), constraint FK_INVENTORY1 foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade, constraint FK_INVENTORY2 foreign key (ISBN) references book(ISBN) on delete cascade );  create table rank( author_id char(12) not null, ISBN char(22) not null, rank_order INT2 not null, constraint PK_RANK primary key (author_id,ISBN), constraint FK_RANK1 foreign key (author_id) references author(author_id) on delete cascade, constraint FK_RANK2 foreign key (ISBN) references book(ISBN) on delete cascade );  #创建索引 create index PRICE_Index on book (price);  #视图创建 create view basicbookview as select ISBN, book_name, price from book where class_id = '10010';  对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 增： insert into AREA values('122233','NewYork'); insert into AREA values('123344','Los Angeles'); insert into author values('10086', '122233', 'wby', 'dongbei', '18880282508'); insert into author values('10087', '122233', 'lyx', 'handan', '17345678965'); insert into author values('10088', '123344', 'zzt', 'baoji', '12345678901'); insert into publisher values('3204', '人民邮电出版社', '1456700', 'Beijing'); insert into publisher values('3205', '机械工业出版社', '1000011', 'Beijing'); insert into bookclass values('10001', 'Science'); insert into bookclass values('10002', 'Literature'); insert into book values('100023456789876543', '3204','10001', 'Alibaba', '2018/2/23', '45', 'qwerty','abc.txt'); insert into book values('100023456765445664', '3205','10001','Blibaba', '2017/6/3', '145', 'regfgd','def.txt'); insert into book values('100434554359876543', '3205', '10002','Fox', '2000/8/8', '70', 'sdggsdf','efgh.txt'); insert into bookstore values('000011112222','sdfewfr','12345','rwgerwfar'); insert into bookstore values('000666612222','rghsrtg','54321','dherthgtwgserf'); insert into discount values(2,'000011112222',30,'sdgrsg'); insert into sale values('103467767','100023456789876543','000011112222','2019/6/8',120,'54634'); insert into sale values('346456536','100023456765445664','000666612222','2019/6/7',400,'98764'); insert into inventory values('000011112222','100023456789876543',345); insert into inventory values('000666612222','100434554359876543',800); insert into rank values('10086','100023456789876543',2); insert into rank values('10087','100434554359876543',6);  删： delete from rank where rank_order = 6;  改： update rank set rank_order = 3 where author_id = '10086';   查： select ISBN, publisher_id,book_name from book;  编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 create function Pro_CurrentSale() \treturns void as $$ \tdeclare \t\tsale_quantity numeric; \t\tsale_money_total money; \tbegin \t\tselect sum(sale_amount) into sale_quantity from sale; \t\tselect sum(sale_money) into sale_money_total from sale; \t\traise notice '图书销售量:%,销售金额%',sale_quantity,sale_money_total; \tend; $$ language plpgsql  编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 select Pro_CurrentSale();   编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 create or replace function Tri_InsertSale() \treturns trigger as $Tri_InsertSale$ \tbegin  \t\tinsert into inventory \t\t\tselect new.bookstore_id, new.ISBN, new.sale_amount; \t\treturn new; \tend; $Tri_InsertSale$ language plpgsql;  create trigger Tri_InsertSale_trigger after insert on sale for each row execute procedure Tri_InsertSale();   对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 select * from inventory;  insert into sale values ('254235252','100434554359876543','000011112222','2019/4/11',234,'120'); select * from inventory;  实验结论：实验成功，结果符合预期  九、总结及心得体会 \t本次实验难度不高，主要是基本知识的运用掌握，但还是有细节的地方需要注意。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称： 信软楼西306 \t\t\t\t\t    实验时间：2019-05-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 PostgreSQL是一个多用户数据库，可以为不同用户指定允许的权限。 角色\nPostgreSQL使用角色的概念管理数据库访问权限。 根据角色自身的设置不同，一个角色可以看做是一个数据库用户，或者一组数据库用户。 角色可以拥有数据库对象(比如表)以及可以把这些对象上的权限赋予其它角色， 以控制谁拥有访问哪些对象的权限。\n操作角色的语句：\ncreate role db_role1; /--创建角色/\ndrop role db_role1; /--删除角色/\nselect rolename from pg_roles; /--查看所有角色/\n/du --在命令格式下查看所有角色的命令 角色的权限\n一个数据库角色可以有很多权限，这些权限定义了角色和拥有角色的用户可以做的事情。\ncreate role db_role1 LOGIN; --创建具有登录权限的角色db_role1\ncreate role db_role2 SUPERUSER; --创建具有超级用户权限的角色\ncreate role db_role3 CREATEDB; --创建具有创建数据库权限的角色\ncreate role db_role4 CREATEROLE --创建具有创建角色权限的角色\nalter role db_role1 nologin nocreatedb; --修改角色取消登录和创建数据库权限 用户\n其实用户和角色都是角色，只是用户是具有登录权限的角色。\ncreate user db_user1 password '123'; --创建用户\ncreate role db_user1 password '123' LOGIN; --同上一句等价\ndrop user db_user1; --删除用户\nalter user db_user1 password '123456'; --修改密码\nalter user db_user1 createdb createrole; --对用户授权 赋予角色控制权限\n我们可以使用GRANT 和REVOKE命令赋予用户角色，来控制权限。\ncreate user db_user1; --创建用户1\ncreate user db_user2; --创建用户2\ncreate role db_role1 createdb createrole; --创建角色1\ngrant db_role1 to db_user1,db_user2; --给用户1,2赋予角色1,两个用户就拥有了创建数据库和创建角色的权限\nrevoke db_role1 from db_user1; --从用户1移除角色1，用户不在拥有角色1的权限 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 针对图书销售管理系统数据库，设计数据存取权限控制模型。 数据库系统权限 数据库对象访问操作权限 数据库对象定义操作权限 有以下两种方式进行权限管理： 执行SQL控制语句进行权限管理 运行数据库管理工具进行权限管理 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 create role \"R_Customer\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1; create role \"R_Seller\" with  \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1;  在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 grant select,insert,update,delete on sale to \"R_Customer\"; grant select,insert,update,delete on sale to \"R_Seller\"; grant select,insert,update,delete on inventory to \"R_Seller\"; grant select,insert,update,delete on discount to \"R_Seller\"; grant select,insert,update,delete on bookstore to \"R_Seller\";  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 create user \"U_Customer\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1 \tpassword '123456'; create user \"U_Seller\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1 \tpassword '123456';    分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 GRANT \"R_Customer\" TO \"U_Customer\"; GRANT \"R_Seller\" TO \"U_Seller\"; 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  实验结论：实验成功，结果符合预期。  九、总结及心得体会 PostgreSQL是通过角色来管理数据库访问权限的，我们可以将一个角色看成是一个数据库用户，或者一组数据库用户。角色可以拥有数据库对象，如表、索引，也可以把这些对象上的权限赋予其它角色，以控制哪些用户对哪些对象拥有哪些权限。",
  "studentID": "2017221304014"
 },
 "51": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软大厦303\t\t\t   实验时间：2019-05-20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计,给出数据库设计方案。  2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 图书销售管理系统数据库BookSale创建操作 Create database library; 创建数据库表、视图、索引等对象 #创建表 create table AREA( area_id     \tchar(6)     primary key, area_name   \tvarchar(30) not null );  create table publisher( publisher_id \t\tchar(12) \t\tprimary key,  publisher_name \t\tvarchar(40) \tnot null,  publisher_phone \tvarchar(20)\t\tnot null,  publisher_address \tvarchar(60) \tnot null );   create table AUTHOR( author_id   \tchar(12)    not null, area_id    \t \tchar(6)     not null, author_name \tvarchar(40) not null, author_addr \tvarchar(80) not null, author_tel  \tchar(11)    not null, constraint PK_AUTHOR primary key (author_id), constraint FK_AUTHOR foreign key (area_id) references AREA(area_id) on delete cascade );   create table bookclass( class_id \t\tchar(5) \t\tprimary key,  class_name \t\tvarchar(20) \tnot null );  create table book( ISBN \t\t\tchar(22) \tnot null,  publisher_id \tchar(12) \tnot null,  class_id \t\tchar(5)\t\tnot null,  book_name\t\tvarchar(80)\tnot null,  publish_date\tdate \t\tnot null,  price\t\t\tmoney\t\tnot null,  brief_introduction varchar(200) not null,  catalogue\t\ttext\t\tnot null,  constraint PK_BOOK primary key (ISBN), constraint FK_BOOK1 foreign key (publisher_id) references publisher(publisher_id) on delete cascade, constraint FK_BOOK2 foreign key (class_id) references bookclass(class_id) on delete cascade );  create table bookstore( bookstore_id \tchar(12) \tprimary key, bookstore_name \tvarchar(40)\tnot null, postcode\t\tchar(5)\t\tnot null, bookstore_address varchar(80) not null );  create table discount( discount_id INT2 \t\tprimary key, bookstore_id char(12)   not null, discount_rate INT2 \t\tnot null, discount_class varchar(20) not null, constraint FK_DISCOUNT foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade );  create table sale( sale_id\t\tserial primary key, ISBN \t\tchar(22) not null, bookstore_id \tchar(12)\tnot null, sale_date   date \t\tnot null, sale_amount\tnumeric\t\tnot null, sale_money\tmoney \t\tnot null, constraint FK_SALE1\tforeign key (ISBN) references book(ISBN) on delete cascade, constraint FK_SAL2 foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade );  create table inventory( bookstore_id char(12) not null, ISBN char(22) \t\tnot null, inventory_amount INT2 not null, constraint PK_INVENTORY primary key (bookstore_id,ISBN), constraint FK_INVENTORY1 foreign key (bookstore_id) references bookstore(bookstore_id) on delete cascade, constraint FK_INVENTORY2 foreign key (ISBN) references book(ISBN) on delete cascade );  create table rank( author_id char(12) not null, ISBN char(22) not null, rank_order INT2 not null, constraint PK_RANK primary key (author_id,ISBN), constraint FK_RANK1 foreign key (author_id) references author(author_id) on delete cascade, constraint FK_RANK2 foreign key (ISBN) references book(ISBN) on delete cascade );  #创建索引 create index PRICE_Index on book (price);  #视图创建 create view basicbookview as select ISBN, book_name, price from book where class_id = '10010';  对数据库表进行数据增、删、查、改灯SQL操作 增： insert into AREA values('122233','NewYork'); insert into AREA values('123344','Los Angeles'); insert into author values('10010', '218379', 'wby', 'dongbei', '12525682508'); insert into author values('10011', '341523', 'lyx', 'handan', '1735262665'); insert into author values('10012', '432551', 'zzt', 'baoji', '12345678900'); insert into publisher values('3204', '人民邮电出版社', '2146700', 'Beijing'); insert into publisher values('3205', '机械工业出版社', '1535011', 'Beijing'); insert into bookclass values('10001', 'Science'); insert into bookclass values('10002', 'Literature'); insert into book values('100023456789876543', '3204','10001', 'Alibaba', '2018/2/23', '45', 'qwerty','abc.txt'); insert into book values('100023456765445664', '3205','10001','Blibaba', '2017/6/3', '145', 'regfgd','def.txt'); insert into book values('100434554359876543', '3205', '10002','Fox', '2000/8/8', '70', 'sdggsdf','efgh.txt'); insert into bookstore values('000011112222','sdfewfr','12345','rwgerwfar'); insert into bookstore values('000666612222','rghsrtg','54321','dherthgtwgserf'); insert into discount values(2,'000011112222',30,'sdgrsg'); insert into sale values('103467767','100023456789876543','000011112222','2019/6/8',120,'54634'); insert into sale values('346456536','100023456765445664','000666612222','2019/6/7',400,'98764'); insert into inventory values('000011112222','100023456789876543',345); insert into inventory values('000666612222','100434554359876543',800); insert into rank values('10086','100023456789876543',2); insert into rank values('10087','100434554359876543',6);  删： delete from rank where rank_order = 6;  改： update rank set rank_order = 3 where author_id = '10086';   查： select ISBN, publisher_id,book_name from book;  编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 create function Pro_CurrentSale() \treturns void as $$ \tdeclare \t\tsale_quantity numeric; \t\tsale_money_total money; \tbegin \t\tselect sum(sale_amount) into sale_quantity from sale; \t\tselect sum(sale_money) into sale_money_total from sale; \t\traise notice '图书销售量:%,销售金额%',sale_quantity,sale_money_total; \tend; $$ language plpgsql  编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 select Pro_CurrentSale();   编写Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 create or replace function Tri_InsertSale() \treturns trigger as $Tri_InsertSale$ \tbegin  \t\tinsert into inventory \t\t\tselect new.bookstore_id, new.ISBN, new.sale_amount; \t\treturn new; \tend; $Tri_InsertSale$ language plpgsql;  create trigger Tri_InsertSale_trigger after insert on sale for each row execute procedure Tri_InsertSale();   对Insert触发器Tri_InsertSale程序进行功能验证。 select * from inventory;  insert into sale values ('254235252','100434554359876543','000011112222','2019/4/11',234,'120'); select * from inventory;  实验结论：实验成功，结果正确，符合实验要求。 九、总结及心得体会 本次实验需要熟练掌握书本上的基本知识，并灵活运用，一些细节处需要仔细。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称： 信软大厦303\t\t\t\t\t  实验时间：2019-05-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 PostgreSQL是一个多用户数据库，可以为不同用户指定允许的权限。 角色\nPostgreSQL使用角色的概念管理数据库访问权限。 根据角色自身的设置不同，一个角色可以看做是一个数据库用户，或者一组数据库用户。 角色可以拥有数据库对象(比如表)以及可以把这些对象上的权限赋予其它角色， 以控制谁拥有访问哪些对象的权限。\n操作角色的语句：\ncreate role db_role1; /--创建角色/\ndrop role db_role1; /--删除角色/\nselect rolename from pg_roles; /--查看所有角色/\n/du --在命令格式下查看所有角色的命令 角色的权限\n一个数据库角色可以有很多权限，这些权限定义了角色和拥有角色的用户可以做的事情。\ncreate role db_role1 LOGIN; --创建具有登录权限的角色db_role1\ncreate role db_role2 SUPERUSER; --创建具有超级用户权限的角色\ncreate role db_role3 CREATEDB; --创建具有创建数据库权限的角色\ncreate role db_role4 CREATEROLE --创建具有创建角色权限的角色\nalter role db_role1 nologin nocreatedb; --修改角色取消登录和创建数据库权限 用户\n其实用户和角色都是角色，只是用户是具有登录权限的角色。\ncreate user db_user1 password '123'; --创建用户\ncreate role db_user1 password '123' LOGIN; --同上一句等价\ndrop user db_user1; --删除用户\nalter user db_user1 password '123456'; --修改密码\nalter user db_user1 createdb createrole; --对用户授权 赋予角色控制权限\n我们可以使用GRANT 和REVOKE命令赋予用户角色，来控制权限。\ncreate user db_user1; --创建用户1\ncreate user db_user2; --创建用户2\ncreate role db_role1 createdb createrole; --创建角色1\ngrant db_role1 to db_user1,db_user2; --给用户1,2赋予角色1,两个用户就拥有了创建数据库和创建角色的权限\nrevoke db_role1 from db_user1; --从用户1移除角色1，用户不在拥有角色1的权限 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）设计数据存取权限控制模型。 （2）创建客户（R_Customer）、商家（R_Seller）角色。 （3）根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 针对图书销售管理系统数据库，设计数据存取权限控制模型。 数据库系统权限 数据库对象访问操作权限 数据库对象定义操作权限 有以下两种方式进行权限管理： 执行SQL控制语句进行权限管理 运行数据库管理工具进行权限管理 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 create role \"R_Customer\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1;  create role \"R_Seller\" with  \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1;  在数据库中为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 客户只对sale拥有查询、插入、更新、删除权限，商家对其他也表拥有查询、插入、更新、删除权限 grant select,insert,update,delete on inventory to \"R_Seller\"; grant select,insert,update,delete on discount to \"R_Seller\"; grant select,insert,update,delete on sale to \"R_Seller\"; grant select,insert,update,delete on bookstore to \"R_Seller\"; grant select,insert,update,delete on sale to \"R_Customer\";  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。密码设为6个0，连接不受限制。 create user \"U_Seller\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1 \tpassword '000000';  create user \"U_Customer\" with \tlogin \tnosuperuser \tnocreatedb \tnocreaterole \tinherit \tnoreplication \tconnection limit -1 \tpassword '000000';    分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证控制模型的正确性。 图示为以U_Customer身份访问数据库，验证成功  图示为以U_Seller身份访问数据库，验证成功  实验结论：实验成功，结果符合预期。  九、总结及心得体会 此次实验综合性比较强，需要熟练使用数据库创建、授权等知识，在本次实验过程中出现了一个小问题，创建用户的时候控制台显示返回成功，但是并未达到预期效果显示，后来通过手动刷新页面的方法解决了问题。  ",
  "studentID": "2017221304015"
 },
 "52": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306        实验时间：2019.05.20  三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 PgAdmin4的使用方法，SQL语言DDL、DML、DQL类型语句的使用方法，数据库语言的编程方法（存储过程，函数触发器等使用）。 该数据库对于给定的应用环境,利用计算机的基础知识、软件工程的原理和方法、程序设计的方法和技巧、数据库的基本知识、数据库设计技术、应用领域的知识等多学科综合知识与技术,对网上图书销售管理数据库做了需求分析,概念结构设计,逻辑结构设计,物理结构设计和Oracle数据库实施。最终设计出了一个简单的可对其进行用户管理、图书管理、进货管理,销售管理和售后管理的网上图书销售管理数据库,使之能够有效地管理和存储数据,满足一些简单的应用需求。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 （1）图书销售管理系统数据库BookSale创建操作 \t\t \n \t \t \t \t \t \t \t \t \t （2）在图书销售管理系统数据库BookSale中创建数据库表 \t \t \t \t \t \t \t \t \t \t \t \t \t \t \t \t \t \t \t\t\t \n\n \n\n\n\n（3）在图书销售管理系统数据库BookSale中创建数据库视图            （4）在图书销售管理系统数据库BookSale中创建数据库索引 \n（5）插入数据 \n              （6）对图书销售管理系统数据库表进行数据增SQL操作 \t \t \t \t \t \t \t \t （7）对图书销售管理系统数据库表进行数据删SQL操作 \t \t \t \t \t \t \t \t \t \t （8）对图书销售管理系统数据库表进行数据查SQL操作 \t \t \t \t \t \t \t \t \t \t \t \t \t  （9）对图书销售管理系统数据库表进行数据改SQL操作 \t \t \t \t \t \t \t \t \t  \n（10）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t （11）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 \t \t \t \t \t \t \t\t \t\t \t\t \n（12）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 \t \t \t \t \t \t \t \t \t \t \t \t \t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t \t \t \t \n（13）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 \t \t \t \t \t \t \t \t \t \t \t \t \t \t \t \t  九、总结及心得体会 在图书管理系统的制作过程中，我学到了很多数据库和用Pgadmin实现窗体的知识，提高了自己动手编程的能力。在此期间，虽然也遇到了不少问题,但通过查找资料和向同学求助，我把它们也都解决掉了并且又弥补了自己之前学习的漏斗与不足。 在这次实验中，我意识到自己对pgsql的学习还是十分欠缺的。我了解了PostgreSq和PgAdmin4的基本使用方法。学习使用了SQl语言中一些基本的语句，如创建数据、创建数据表、索引、视图；对数据库进行增删改查的操作；存储过程和函数的定义、创建、编写和简单使用；触发器的创建和相应适应方式。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306        实验时间：2019.05.22 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 PostgreSQl数据库角色管理、用户管理、权限管理的基本方法。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 U_Customer分别读取，插入，修改，删除。 八、实验数据及结果分析 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。  （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 \n（3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t \t\t\t \t\t \t\t \t\t \t\t \t\t\t\t \t\t \t\t \t\t \t\t  \n（4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 \n（5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 U_Customer分别读取，插入，修改，删除。 \t \t\t  九、总结及心得体会 通过这次实验，我对数据库的知识有了更深入的了解，在经过自己实践后，对数据库的创建与管理操作更加熟悉，但是我也意识到自己目前所学习的知识还远远不够，需要进一步的深入学习并多加练习，才能熟练地应用学到的知识。 ",
  "studentID": "2017221304025"
 },
 "53": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软大楼实验室\t         实验时间： 2019-05-20     三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过SQL编程执行来完成对数据库的实现操作。在本实验中，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写SQL语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验数据及结果分析 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 物理数据模型：  转换后的逻辑数据模型：  完善后的逻辑数据模型：  转换且修改后的物理数据模型：   转换成sql脚本后在数据库执行该脚本   使用sql语言插入数据 INSERT INTO public.sale(      bookisbn, shop_id, sale_date, sale_quantity, sale_amount)     VALUES ('9787111555018', '0001', '2015-12-06', '10', '700');          INSERT INTO public.sale(      bookisbn, shop_id, sale_date, sale_quantity, sale_amount)     VALUES ('9787560633503', '0001', '2015-12-06', '10','400' );          INSERT INTO public.sale(      bookisbn, shop_id, sale_date, sale_quantity, sale_amount)     VALUES ('9787115502742', '0001', '2015-12-06', '10', '600');          INSERT INTO public.sale(      bookisbn, shop_id, sale_date, sale_quantity, sale_amount)     VALUES ('9787111599715', '0001', '2015-12-06', '10','500' );          INSERT INTO public.ranking( \tbookisbn, author_id, ranking) \tVALUES ('9787111555018', '001', null); \t \tINSERT INTO public.ranking( \tbookisbn, author_id, ranking) \tVALUES ('9787560633503', '002', null); \t \tINSERT INTO public.ranking( \tbookisbn, author_id, ranking) \tVALUES ('9787111599715', '003', null); \t \tINSERT INTO public.ranking( \tbookisbn, author_id, ranking) \tVALUES ('9787115502742', '004', null);    INSERT INTO public.press(     press_id, pressname, press_tel, press_addr)     VALUES ('111111111111', '清华大学出版社', '15122222222', '北京');  INSERT INTO public.press(     press_id, pressname, press_tel, press_addr)     VALUES ('222222222222', '电子科技大学出版社', '15122222222', '成都');  INSERT INTO public.press(     press_id, pressname, press_tel, press_addr)     VALUES ('333333333333', '机械工业出版社', '15122222222', '北京'); INSERT INTO public.press(     press_id, pressname, press_tel, press_addr) VALUES ('444444444444', '高等教育出版社', '15122222222', '北京');  INSERT INTO public.discount( \tdiscount_id, shop_id, discount_rate, discount_category) \tVALUES ('12345', '0001', '0.9', null);  INSERT INTO public.book_category( \tcategory_code, category_name) \tVALUES ('11111', '文学'); \t \tINSERT INTO public.book_category( \tcategory_code, category_name) \tVALUES ('22222', '艺术'); \t \tINSERT INTO public.book_category( \tcategory_code, category_name) \tVALUES ('33333', '科学'); \t \tINSERT INTO public.book_category( \tcategory_code, category_name) \tVALUES ('44444', '数学'); INSERT INTO book( \tbookisbn, press_number, category_cade, book_name, press_date, price, content_intro, catalog) \tVALUES ('9787111555018', '444444444444', '44444', '软件工程', '2014-7-4', 70, null, '略'); \t \tINSERT INTO book( \tbookisbn, press_number, category_cade, book_name, press_date, price, content_intro, catalog) \tVALUES ('9787560633503', '111111111111', '11111', '计算机操作系统','2014-7-1', 40, null, '略'); \t \tINSERT INTO book( \tbookisbn, press_number, category_cade, book_name, press_date, price, content_intro, catalog) \tVALUES ('9787560633502', '222222222222', '22222', '计算机网络', '2014-7-2', 50, null, '略'); \t \tINSERT INTO book( \tbookisbn, press_number, category_cade, book_name, press_date, price, content_intro, catalog) \tVALUES ('9787115502742', '333333333333', '33333', '数据库系统', '2014-7-3', 60, null, '略'); INSERT INTO public.author( \tauthor_id, area_code, author_name, author_addr, tel) \tVALUES ('001', '11111', '鲁迅', '浙江', 15111111111); \t \tINSERT INTO public.author( \tauthor_id, area_code, author_name, author_addr, tel) \tVALUES ('002', '22222', '高尔基', '丹麦', 15111111111); \t\t  \tINSERT INTO public.author( \tauthor_id, area_code, author_name, author_addr, tel) \tVALUES ('003', '33333', '毛泽东', '湖南', 15111111111); \t\t \tINSERT INTO public.author( \tauthor_id, area_code, author_name, author_addr, tel) \tVALUES ('004', '44444', '龙应台', '台湾', 15111111111); INSERT INTO public.area( \tarea_code, area_name) \tVALUES ('11111', '绵阳'); \tINSERT INTO public.area( \tarea_code, area_name) \tVALUES ('22222', '成都'); \t\tINSERT INTO public.area( \tarea_code, area_name) \tVALUES ('33333', '达州'); \t\tINSERT INTO public.area( \tarea_code, area_name) \tVALUES ('44444', '宜宾');  地区：  类别：  图书：  作者：  等级：  出版社：  销售：  折扣：  商店：  创建视图：   创建索引：   （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。    输入日期参数 ，可返回销售量和销售金额汇总   （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。   编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 第一步：创建触发器函数UpdateInventory  第二步：在销售表sale上创建触发器Tri_InsertSale  对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  在sale中插入一条数据，销售出20本：  验证查看库存表inventory：  第四个由原来的库存100本变成80本。说明功能验证成功。   总结及心得体会 通过本次实验我进一步熟悉了数据库的编程。包括触发器、函数、power designer的使用、sql脚本生成等等。  \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软大楼实验室  \t\t\t\t\t实验时间：2019-5-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 实验数据及结果分析 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。   模型可由以下sql语句表示出：        GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON author TO \"R_Customer\"; GRANT SELECT ON press TO \"R_Customer\"; GRANT SELECT ON ranking TO \"R_Customer\"; GRANT SELECT ON discount TO \"R_Customer\"; GRANT SELECT ON book_category TO \"R_Customer\"; GRANT SELECT ON shop TO \"R_Customer\"; GRANT SELECT ON area TO \"R_Customer\"; GRANT SELECT ON sale TO \"R_Customer\"; GRANT SELECT ON inventory TO \"R_Customer\";   （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。    在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON author TO \"R_Customer\"; GRANT SELECT ON press TO \"R_Customer\"; GRANT SELECT ON ranking TO \"R_Customer\"; GRANT SELECT ON discount TO \"R_Customer\"; GRANT SELECT ON book_category TO \"R_Customer\"; GRANT SELECT ON shop TO \"R_Customer\"; GRANT SELECT ON area TO \"R_Customer\"; GRANT SELECT ON sale TO \"R_Customer\"; GRANT SELECT ON inventory TO \"R_Customer\";    在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。   分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  以客户用户U_Customer登陆： 尝试查看书籍信息：成功    尝试往sale表插入数据：失败，没有权限  以商家用户U_Seller访问数据库： 尝试插入sale表。成功   尝试插入area表。失败  九、总结及心得体会 通过本次实验，我掌握了权限控制的各种方法，深入了解，收获很多。 比如用户和角色的联系和区别。系统管理员的权限。为什么需要权限的管理等等，这些都是需要我们去思考的！",
  "studentID": "2017221305003"
 },
 "54": {
  "content": "\n 电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西306          实验时间：2019-05-20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 （1）数据库数据模型的建立：              数据库SQL语句操作：CREATE TABLE, ALTER TABLE, INSERT, DELETE, UPDATE, SELECT等； 数据库表间的连接：JOIN ... ON ... 数据库视图的创建：CREATE VIEW AS ... 创建数据库存储过程：CREATE FUNCTION ... 创建数据库触发器：CREATE TRIGGER ... 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）在Postgre数据库网页的GUI界面创建数据库BookSale； （2）在数据库BookSale中创建如下表格并定义索引（部分略）：  CREATE TABLE 出版社( 出版社编号 CHAR(12) PRIMARY KEY, 出版社名称 VARCHAR(40), 出版社电话 VARCHAR(20), 出版社地址 VARCHAR(60) ); CREATE INDEX 出版社编号_IDX ON 出版社(出版社编号);  CREATE TABLE 图书类别( 类别编码 CHAR(5) PRIMARY KEY, 类别名称 VARCHAR(20) ); CREATE INDEX 类别编码_IDX ON 图书类别(类别编码);  CREATE TABLE 图书 ( 图书ISBN CHAR(22) PRIMARY KEY, 出版社编号 CHAR(12), 类别编码 CHAR(5), 书名 VARCHAR(80), 出版日期 DATE, 价格 MONEY, 内容简介 VARCHAR(200), 目录 TEXT, CONSTRAINT 出版社编号_FK FOREIGN KEY(出版社编号) REFERENCES 出版社(出版社编号) ON DELETE CASCADE, CONSTRAINT 类别编码_FK FOREIGN KEY(类别编码) REFERENCES 图书类别(类别编码) ON DELETE CASCADE ); CREATE INDEX 图书ISBN_IDX ON 图书(图书ISBN);  CREATE TABLE 商店 ( 商店编号 CHAR(12) PRIMARY KEY, 商店名称 VARCHAR(40), 邮编 CHAR(5), 商店地址 VARCHAR(80) ); CREATE INDEX 商店编号_IDX ON 商店(商店编号);  ON DELETE CASCADE, CONSTRAINT 图书ISBN_FK FOREIGN KEY(图书ISBN) REFERENCES 图书(图书ISBN) ON DELETE CASCADE ); CREATE INDEX 库存_IDX ON 库存(商店编号,图书ISBN );  CREATE TABLE 编著排名 ( 作者编号 CHAR(12), 图书ISBN CHAR(22), 排位顺序 INT2, CONSTRAINT 编著排名_PK PRIMARY KEY(作者编号,图书ISBN), CONSTRAINT 作者编号_FK FOREIGN KEY(作者编号) REFERENCES 作者(作者编号) ON DELETE CASCADE, CONSTRAINT 图书ISBN_FK FOREIGN KEY(图书ISBN) REFERENCES 图书(图书ISBN) ON DELETE CASCADE ); CREATE INDEX 编著排名_IDX ON 编著排名(作者编号,图书ISBN);  编写增删查改操作SQL语句（部分略）： INSERT INTO 地区表 VALUES('000001','北京'); INSERT INTO 地区表 VALUES('000002','上海'); INSERT INTO 地区表 VALUES('000003','成都'); INSERT INTO 地区表 VALUES('000004','乌鲁木齐'); DELETE FROM 图书 WHERE 书名='《珐码斯教学》'; SELECT 图书.书名,作者.作者姓名,图书.价格,图书.内容简介 FROM 图书 JOIN 编著排名 ON 图书.图书ISBN=编著排名.图书ISBN JOIN 作者 ON 作者.作者编号=编著排名.作者编号 WHERE 作者姓名='及第'; UPDATE 折扣 SET 折扣率=15 WHERE 折扣编号=1; 编写创建视图语句： CREATE VIEW 图书基本信息 AS SELECT 图书.书名,作者.作者姓名,图书类别.类别名称,图书.价格,图书.内容简介 FROM 图书 JOIN 编著排名 ON 图书.图书ISBN=编著排名.图书ISBN JOIN 作者 ON 作者.作者编号=编著排名.作者编号 JOIN 图书类别 ON 图书.类别编码=图书类别.类别编码 编写储存过程语句： CREATE FUNCTION Pro_CurrentSale(thedate date,OUT salesquantity numeric,OUT salesvalue money) AS $$ BEGIN SELECT SUM(销售数量) FROM 销售 INTO salesquantity WHERE 销售日期=thedate; SELECT SUM(销售金额) FROM 销售 INTO salesvalue WHERE 销售日期=thedate; END; $$ LANGUAGE plpgsql; 调用储存过程： SELECT salesquantity AS 当日销量,salesvalue AS 当日销售额 FROM pro_currentsale('2019-05-18'); 编写触发器语句： CREATE OR REPLACE FUNCTION insertsale() RETURNS TRIGGER AS $insertsale$ BEGIN IF(TG_OP = 'INSERT') THEN UPDATE 库存 SET 库存量 = 库存量-new.销售数量 WHERE 库存.商店编号=new.商店编号 AND 库存.图书isbn=new.图书isbn; RETURN NEW; END IF; RETURN NULL; END; $insertsale$ LANGUAGE plpgsql;  CREATE TRIGGER tri_insertsale AFTER INSERT ON 销售 FOR EACH ROW EXECUTE PROCEDURE insertsale(); 在销售表中使用INSERT操作触发触发器： INSERT INTO 销售 VALUES(25,'0000010101018989890001','000001110110','2019-5-27',300,8000.00); INSERT INTO 销售 VALUES(27,'0000048866993311220017','000001110110','2019-5-27',120,4750.00); INSERT INTO 销售 VALUES(28,'0000038866993311220025','000001110110','2019-5-27',20,3500.00); INSERT INTO 销售 VALUES(29,'0000031145141919810078','000001110110','2019-5-27',30,1000.00); INSERT INTO 销售 VALUES(30,'0000021145141919810166','000001110110','2019-5-27',200,8000.00); INSERT INTO 销售 VALUES(31,'0000010101018989890001','000002171282','2019-5-27',30,800.00); INSERT INTO 销售 VALUES(33,'0000048866993311220017','000002171282','2019-5-27',12,475.00); INSERT INTO 销售 VALUES(34,'0000038866993311220025','000002171282','2019-5-27',2,350.00); INSERT INTO 销售 VALUES(35,'0000031145141919810078','000002171282','2019-5-27',3,100.00); INSERT INTO 销售 VALUES(36,'0000021145141919810166','000002171282','2019-5-27',20,800.00); INSERT INTO 销售 VALUES(37,'0000010101018989890001','000003899565','2019-5-27',30,800.00); INSERT INTO 销售 VALUES(39,'0000048866993311220017','000003899565','2019-5-27',12,475.00); INSERT INTO 销售 VALUES(40,'0000038866993311220025','000003899565','2019-5-27',2,350.00); INSERT INTO 销售 VALUES(41,'0000031145141919810078','000003899565','2019-5-27',3,100.00); INSERT INTO 销售 VALUES(42,'0000021145141919810166','000003899565','2019-5-27',20,800.00); INSERT INTO 销售 VALUES(43,'0000010101018989890001','000004191919','2019-5-27',150,4000.00); INSERT INTO 销售 VALUES(45,'0000048866993311220017','000004191919','2019-5-27',60,2700.00); INSERT INTO 销售 VALUES(46,'0000038866993311220025','000004191919','2019-5-27',10,1800.00); INSERT INTO 销售 VALUES(47,'0000031145141919810078','000004191919','2019-5-27',15,500.00); INSERT INTO 销售 VALUES(48,'0000021145141919810166','000004191919','2019-5-27',100,4000.00); 实验数据及结果分析 创建数据库：  创建表格：  数据增删查改操作： 增： 改： 删：   查：  查看视图：  (5)储存过程的使用：  (6)触发器的调用： 触发前的库存表内容：  触发后的表格内容：  可以看到，表格中库存量已经减去销售表中的销售量，触发器触发成功。 总结及心得体会 数据库的创建过程可以通过PRIMARY KEY来定义主键，用CONSTRAINT语句来定义外键和复合主键。要注意的是，外键所依赖的表格必须要在该表格之前创建，否则创建失败。同理，在插入一个对象时，如果有依赖在其他表的外键约束，也要先在对应表中插入这个被依赖的对象。如图书表中无法插入在CSDN表中不存在的图书CSDN对应的对象。可以和数据物理模型联系起来，先插入对应关系箭头出发的表中的对象，再插入指向的表中的对象。视图的应用可以让表格内容更直观、易于理解，比如图书表中用视图把类别编号行替换为类别名称，更方便读者查找。 储存过程和触发器可以使数据库具有更多功能如统计、实时更新等。储存过程可以定义若干个输入，也可以定义若干个输出。触发器的参数为old和new，当插入和更新数据时，新的数据在new中；当删除和更新数据时，被删除/被更新的数据在old中，然后就可以通过列名访问其中的数据。\n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西306          实验时间：2019-05-27      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 在SQL语言中，可以通过CREATE ROLE语句创建一组角色，通过LOGIN/NOLOGIN，CREATEDB/NOCREATEDB等修饰符为其赋予数据库登录、创建、权限继承、连接限制等基本权限，然后可以通过GRANT语句为角色或用户赋予特定表的增删查改权限。 通过CREATE USER语句可以创建用户，同样可以用修饰符赋予其基础权限，但是可以用IN ROLE修饰符定义其所属的角色，这样的话该用户就可以继承该角色的所有权限。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）权限控制模型： （2）创建角色语句：  CREATE ROLE \"R_Costomer\" WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOBYPASSRLS NOREPLICATION CONNECTION LIMIT -1;  CREATE ROLE \"R_Seller\" WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOBYPASSRLS NOREPLICATION CONNECTION LIMIT -1;  都拥有登录权限、非超级用户、不能创建数据库、不能创建角色、无连接次数限制。 （3）赋予数据库对象权限：  GRANT SELECT ON 作者 TO \"R_Customer\"; GRANT SELECT ON 出版社 TO \"R_Customer\"; GRANT SELECT ON 商店 TO \"R_Customer\"; GRANT SELECT ON 图书 TO \"R_Customer\"; GRANT SELECT ON 图书类别 TO \"R_Customer\"; GRANT SELECT ON 地区表 TO \"R_Customer\"; GRANT SELECT ON 库存 TO \"R_Customer\"; GRANT SELECT ON 折扣 TO \"R_Customer\"; GRANT SELECT ON 编著排名 TO \"R_Customer\"; GRANT SELECT ON 销售 TO \"R_Customer\";  GRANT SELECT ON 作者 TO \"R_Seller\"; GRANT SELECT ON 出版社 TO \"R_Seller\"; GRANT SELECT ON 商店 TO \"R_Seller\"; GRANT SELECT ON 图书 TO \"R_Seller\"; GRANT SELECT ON 图书类别 TO \"R_Seller\"; GRANT SELECT ON 地区表 TO \"R_Seller\"; GRANT SELECT ON 库存 TO \"R_Seller\"; GRANT SELECT ON 折扣 TO \"R_Seller\"; GRANT SELECT ON 编著排名 TO \"R_Seller\"; GRANT SELECT ON 销售 TO \"R_Seller\";  GRANT INSERT ON 商店 TO \"R_Seller\"; GRANT INSERT ON 图书 TO \"R_Seller\"; GRANT INSERT ON 图书类别 TO \"R_Seller\"; GRANT INSERT ON 库存 TO \"R_Seller\"; GRANT INSERT ON 折扣 TO \"R_Seller\"; GRANT INSERT ON 销售 TO \"R_Seller\";  GRANT UPDATE ON 商店 TO \"R_Seller\"; GRANT UPDATE ON 图书 TO \"R_Seller\"; GRANT UPDATE ON 图书类别 TO \"R_Seller\"; GRANT UPDATE ON 库存 TO \"R_Seller\"; GRANT UPDATE ON 折扣 TO \"R_Seller\"; GRANT UPDATE ON 销售 TO \"R_Seller\";  GRANT DELETE ON 商店 TO \"R_Seller\"; GRANT DELETE ON 图书 TO \"R_Seller\"; GRANT DELETE ON 图书类别 TO \"R_Seller\"; GRANT DELETE ON 库存 TO \"R_Seller\"; GRANT DELETE ON 折扣 TO \"R_Seller\"; GRANT DELETE ON 销售 TO \"R_Seller\";  （4）（5）创建商家和客户用户：  CREATE USER \"U_Customer\" WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT NOREPLICATION CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '123456';   CREATE USER \"U_Seller\" WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT NOREPLICATION CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456' （6）先后使用客户和商家的用户，在各表中执行增删查改操作，验证权限分配是否成功。 八、实验数据及结果分析 （1）使用客户用户 在图书表中查看所有图书，成功       在图书表中修改图书价格，由于权限不足而失败  在图书表中删除图书，由于权限不足而失败  在图书类别表中增加一个类别，由于权限不足而失败   （2）使用商家用户 查看图书类别表，成功  在折扣表中更新折扣率，成功  在出版社表中删除出版社，由于权限不足而失败  在商店表中注册新商店，成功  综上，可以得出权限控制模型已生效。 九、总结及心得体会 权限分配时可以通过创建一个角色为其赋予权限，然后在该角色（即用户群）下创建用户，则该角色下的用户拥有相同的权限，更便于权限的分配和收回。在创建用户时，通过添加IN ROLE修饰符来定义其所属的角色。GRANT语句既可以为角色赋予权限，也可以为用户赋予权限。在初次使用数据库时，我们所用的是系统超级用户postgres，拥有所有权限。",
  "studentID": "2017221305017"
 },
 "55": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306         实验时间：2019/5/20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 SQL（ Structured Query Language,结构化查询语言 ）是一种对关系数据库进行访问的数据操作语言。 1.数据定义语言 数据定义语言（Data Definition Language，DDL）是SQL语言中用于创建、修改或删除数据库对象的语句。 ・CREATE DATABASE - 创建新数据库 ・DROP DATABASE C 删除数据库 ・ALTER DATABASE - 修改数据库属性  ・CREATE TABLE - 创建新表  ・ALTER TABLE C 修改数据库表结构 ・DROP TABLE - 删除表 ・CREATE INDEX - 创建索引 ・DROP INDEX - 删除索引 2.数据操控语言 数据操纵语言（Data Manipulation Language，DML）是SQL语言中用于增添、修改、删除数据的语句。 ・INSERT - 向数据库表中插入数据  ・UPDATE - 更新数据库表中的数据 ・DELETE - 从数据库表中删除数据 3.数据查询语言 数据查询语言（Data Query Language，DQL）是SQL语言中用于对数据库进行数据查询的语句。 4.数据控制语言 数据控制语言（Data Control Language，DCL）是用于对数据库对象访问权进行控制的SQL语句。 ・GRANT C 授予用户对数据库对象的权限 ・DENY C 拒绝授予用户对数据库对象的权限 ・REVOKE C 撤消用户对数据库对象的权限 5.  数据库创建SQL语句 ：CREATE  DATABASE  <数据库名>; 数据库修改SQL语句 ：ALTER  DATABASE  <数据库名> <修改内容>; 数据库删除SQL语句 ：DROP  DATABASE  <数据库名>； 数据库表创建SQL语句 ： CREATE TABLE  <表名>  （ <列名1>  <数据类型>  [列完整性约束]， \t<列名2>  <数据类型>   [列完整性约束]，\t     <列名3>  <数据类型>  [列完整性约束]，     …    )； 修改表结构SQL语句 ：ALTER TABLE <表名> <修改方式>; ALTER TABLE <表名> ADD <新列名称><数据类型>|[完整性约束] ALTER TABLE<表名> DROP  COLUMN <列名>； ALTER TABLE<表名> DROP  CONSTRAINT<完整性约束名>； ALTER TABLE <表名> RENAME TO <新表名>； ALTER TABLE <表名> RENAME <原列名> TO <新列名>； ALTER TABLE <表名> ALTER  COLUMN <列名> TYPE<新的数据类型>； 删除表结构SQL语句 ：DROP TABLE <表名>; 索引创建SQL语句 ：CREATE INDEX  <索引名>  ON <表名><（列名）>； 索引修改SQL语句 ：ALTER  INDEX  <索引名> <修改项>； 索引删除SQL语句 ：DROP  INDEX  <索引名> ； 数据插入SQL语句 ：INSERT  INTO  <表名|视图名>[<列名表>]  VALUES （列值表）; 数据更新SQL语句 ： UPDATE  <表名|视图名> SET  <列名1>=<表达式1> [，<列名2>=<表达式2>...] [WHERE   <条件表达式>]； 数据删除SQL语句 ： DELETE  FROM  <表名|视图名> [WHERE   <条件表达式>]； 数据查询SQL语句格式 ： SELECT  [ALL|DISTINCT]  <目标列>[，<目标列>…] [ INTO <新表> ] FROM  <表名|视图名>[，<表名|视图名>…] [ WHERE  <条件表达式> ] [ GROUP BY  <列名> [HAVING <条件表达式> ]] [ ORDER BY  <列名> [ ASC | DESC ] ]; JOIN …ON连接查询SQL语句 SELECT  <目标列>[，<目标列>…] FROM  <表名1>  JOIN  <表名2>  ON <连接条件>; 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）创建图书销售管理系统数据库BookSale，采用GUI的方式创建了数据库 （2）分别在图书销售管理系统数据库BookSale中创建数据库表author,book,bookstore,publisher ,sale,stock,write、视图view_sale、索引等对象. （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计,实现了输入日期，返回销售量和销售金额。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证，插入一条销售记录，库存对应的减少。 八、实验数据及结果分析 （1）图书销售管理系统数据库BookSale创建操作  （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象  （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作       （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  九、总结及心得体会 通过本次实验我对数据库SQL语句有了更深入的理解，更熟练的操作，会建立视图与索引，会写SQL函数与触发器。能够更灵活，能够方便的使用数据库。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306\t          实验时间： 2019/5/27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.数据库权限管理是指DBA管理员或数据库对象拥有者对其所拥有对象进行权限控制设置。 权限管理基本操作： ・授予权限 ・收回权限 ・拒绝权限 权限类别： ・数据库系统权限 ・数据库对象访问操作权限 ・数据库对象定义操作权限 （1）在SQL语言中，数据控制SQL语句是一种可对用户数据访问权进行控制的操作语句，它可以控制特定用户或角色对数据表、视图、存储过程、触发器等数据库对象的访问权限。 主要有如下语句：  ・GRANT授权语句  ・REVOKE收权语句  ・DENY拒绝权限语句  （2）.GRANT语句是一种由数据库对象创建者或管理员执行的权限授予语句，它可以把访问数据库对象权限授予给其他用户或角色。 GRANT  <权限列表>  ON  <数据库对象>  TO  <用户或角色> [ WITH GRANT OPTION ]； （3）.REVOKE语句是一种由数据库对象创建者或管理员将赋予其它用户或角色的权限进行收回语句，它可以收回原授予给其他用户或角色的权限。 REVOKE  <权限列表>  ON  <数据库对象>  FROM  <用户或角色> ; （4）.DENY语句用于拒绝给当前数据库内的用户或者角色授予权限，并防止用户或角色通过其组或角色成员继承权限。 DENY  <权限列表>  ON  <数据库对象>  TO  <用户或角色> ; 2.在DBMS中，为了方便对众多用户及其权限进行管理，通常将一组具有相同权限的用户定义为角色(Role)。 角色管理内容： ・创建角色 ・修改角色 ・删除角色 角色管理实现方式： ・执行SQL语句管理角色 ・通过GUI操作管理角色 （1）角色管理SQL语句 CREATE  ROLE  <角色名> [ [ WITH ] option [ ... ] ]; \t --创建角色 ALTER  ROLE  <角色名>  [ [ WITH ] option [ ... ] ]; \t --修改角色属性 ALTER  ROLE  <角色名>  RENAME TO <新角色名>; \t\t --修改角色名称  ALTER  ROLE  <角色名>  SET <参数项> { TO | = } { value | DEFAULT };  \t\t\t\t\t\t\t\t\t                 --修改角色参数值 ALTER  ROLE  <角色名>  RESET <参数项>;\t\t\t --复位角色参数值 DROP  ROLE  <角色名>;\t\t\t\t\t\t --删除指定角色 （2）角色权限授予 GRANT  SELECT,INSERT,UPDATE,DELETE  ON  [数据库表名]  TO  [角色名]; 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。  （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。  （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。  （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。  （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  九、总结及心得体会 通过本次实验我对数据库SQL语句有了更深入的理解，更熟练的操作，知道怎样保证数据库的安全，知道用户要访问数据库，必须先在DBMS中创建其账号，并成为数据库的用户。此后，用户每次访问数据库，都需要在DBMS进行身份验证，只有合法用户才能进入系统，访问操作数据库对象。能够更灵活，能够方便的使用数据库。",
  "studentID": "2017221305028"
 },
 "56": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221005027                   姓    名    田义会                   （实验）\t课程名称    数据库原理与应用                   理论教师    文军                   实验教师    河中海                       电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：田义会\t学号：2017221005027    指导教师：河中海   实验地点：信软学院楼西303     实验时间：2019.06.14 一、实验名称：图书销售管理系统数据库 SQL 应用编程 二、实验学时：4 三、实验目的： 针对图书销售管理数据库开发，了解 SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的 SQL 数据操作访问和后端数据处理功能。  四、实验原理： （1）.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 （2）.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。  五、实验内容： 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行 SQL 编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 在数据库服务器中，执行 SQL 创建图书销售管理系统数据库 BookSale。 在数据库 BookSale 中，执行 SQL 创建数据库表、视图、索引等对象。 在数据库 BookSale 中，执行 SQL 进行数据增、删、查、改访问操作。 在数据库 BookSale 中， 采用 PL/pgSQL 语言编写存储过程函数 Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 在数据库 BookSale 中，采用 PL/pgSQL 语言编写过程语句块，实现对存储过程函数 Pro_CurrentSale 的调用，并输出统计结果。 在数据库 BookSale 中，采用 PL/pgSQL 语言编写编写图书销售表 Insert 触  发器 Tri_InsertSale，实现图书库存数据同步修改处理。 在数据库 BookSale 中，对图书销售表 Insert 触发器 Tri_InsertSale 程序进行功能验证。 在数据库 BookSale 中，创建存储过程函数实现图书销售数量和金额统计。  在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL、PL/pgSQL 语言， 完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验器材（设备、元器件）： pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统：Windows7 / Windows XP  管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11  七、实验步骤： 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。 为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 测试触发器的功能，准备 sale 表的样本数据，并将其插入sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建 BookSale 数据库 SQL 语句：create database \"BookSale\"  运行结果：   创建各数据库表  SQL 语句： create table Auther ( AU_ID\tCHAR(18)\tnot null, AU_Name\tVARCHAR(20)\tnot null,  AU_Gender\tCHAR(2)\tnot null, AU_Phone\tVARCHAR(11)\tnot null, AU_Address\tVARCHAR(50)\tnot null, constraint PK_AUTHER primary key (AU_ID) ); create table Book (  constraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER ( CUST_ID\tCHAR(18)\tnot\t null, CUST_Name\tVARCHAR(20)\tnot \tnull, CUST_Phone\tVARCHAR(15)\t\t\tnot null, CUST_Address    \tVARCHAR(50)     \t\tnot null,  CUST_Email\tVARCHAR(50) \t\t\tnot null,  constraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher ( PUB_ID\tCHAR(11)\tnot null, PUB_Name\tVARCHAR(20)          not null, PUB_Phone\tVARCHAR(15) \t\t\tnot null,  PUB_Address     \tVARCHAR(50)     \t\tnot null,  constraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale (  constraint PK_SALE primary key (SALE_ID) ); create table Stock ( Stock_ID\tVARCHAR(10)\tnot null,  constraint PK_STOCK primary key (Stock_ID) );  运行结果：       创建数据库表中主外键和索引 alter table Book add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key(AU_ID)  references Auther (AU_ID) on delete restrict on update restrict;  alter table Book add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) references Publisher (PUB_ID) on delete restrict on update restrict;  alter table Sale add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN)  references Book (Book_ISBN) on delete restrict on update restrict;  alter table Sale add constraint FK_SALE_CUSTOMER CUSTOMER foreign key (CUST_ID)  references CUSTOMER (CUST_ID) on delete restrict on update restrict;  alter table Stock add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN)  references Book (Book_ISBN) on delete restrict on update restrict;  运行结果：   插入样本数据并对 publisher 表进行增删查改操作 （1）执行 SQL 语句，插入样本数据到图书销售数据库 Insert into Auther values('330309198504150527','吴欣怡','女','13557869867','重庆市万州区人民北路二段九号'); Insert into Auther values('540135199103281548','杨金鱼','男','15558324519','江苏省无锡市天路区白草二十八号'); Insert into Auther values('120857198811123587','朱洁','女','18028975670','北京市朝阳区智学巷六号'); Insert into PUBLISHER values('PUB00000001','高等教育出版社','010-65321854','北京');  Insert into PUBLISHER values('PUB00000002','电子工业出版社','010-65329857','北京');  Insert into PUBLISHER values('PUB00000003','人民邮电出版社','010-65325987','北京'); Insert into BOOK values('9787115502742','330309198504150527','PUB00000001','Web 前端开发最佳实践','2016-01-01', '59','IT 技术','100'); Insert into BOOK values('9875325415577','540135199103281548','PUB00000002','Java EE Web 编 程','2008-01-01', '52','IT 技术','200'); Insert into BOOK values('9865365975234','120857198811123587','PUB00000003',' 数 据 库 实 验 指 导','2013-08-1','29','IT 技术', '150'); Insert into customer values('680554199207120325','林一','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insert into customer values('345021198608120258','黄三','18636598574','浙江省杭州市天路区梅田路二十九号','657873215@qq.com'); Insert into customer values('542244197812121687','玛丽','13615869875','北京市朝阳区梅山路二巷十六号','647864378@qq.com');   运行结果：   （2）查看 publisher 表数据 select * from publiser;  运行结果：  增加一条数据到 publisher 表 SQL 语 句 ： Insert into PUBLISHER values('PUB00000004',' 清 华 大 学 出 版 社 ','010-65323169','北京');   运行结果：  （4）删除一条 publisher 表数据 SQL 语句：delete from publisher where pub_id = 'PUB00000004';   运行结果：   （5）修改一条 publisher 表数据 SQL 语句：update publisher set pub_address = '南京' where pub_id = 'PUB00000003';  运行结果：   创建视图 SQL 语句如下： create view BOOK_AUTHER_PUBLISHER as select B.book_name as \"图书\",AU.au_name as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\" from book as B join auther as AU on B.au_id = AU.au_id join publisher as PU on B.pub_id = PU.pub_id  运行结果：  6.视图数据查询 SQL 语句： select * from BOOK_AUTHER_PUBLISHER;   运行结果：  7.创建触发器函数 SQL 语句： CREATE OR REPLACE FUNCTION InsertSale() RETURNS TRIGGER AS $$ BEGIN IF (TG_OP = 'INSERT') THEN INSERT INTO stock values(new.sale_id,new.book_isbn,new.sale_qty,' 出 库 ',new.sale_date); update book set book_stock = book_stock - new.sale_qty where book.book_isbn = new.book_isbn; RETURN NEW; END IF; RETURN NULL; END; $$ LANGUAGE plpgsql;  运行结果：  8.创建触发器 SQL 语句： CREATE TRIGGER Tri_InsertSale AFTER INSERT ON SALE FOR EACH ROW EXECUTE PROCEDURE InsertSale();   运行结果：  9.测试触发器  SQL 语句： Insertintosalevalues('SA00001','9787115502742','680554199207120325','2019-06-21',15,'799');\nInsertintosalevalues('SA00002','9875325415577','345021198608120258','2019-06-21',20,'10408';\nInsertintosalevalues('SA00003','9865365975234','542244197812121687','2019-06-21',50,'1360';  运行结果：  10.查看 stock 表数据以及对比 book 表数据 SQL语句：SELECT * FROM public.stock  运行结果：  SELECT * FROM public.book  11.创建存储过程 SQL语句： CREATE OR REPLACE FUNCTION countsale(OUT amount int,OUT allmoney money) as $count$  BEGIN \tselect sum(sale_qty) into amount FROM sale WHERE sale_date = '2019-06-21';  \tselect sum(sale_amount) into allmoney FROM sale WHERE sale_date = '2019-06-21'; END; $count$ LANGUAGE plpgsql;  运行结果：  12.调用存储过程 SQL语句：Select * from countsale()  运行结果：    九、总结及心得体会： 这次实验让我更加熟练的使用PostgreSQLAdmin4,以及SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用，提高了数据库 SQL 编程访问能力。同时我也掌握了基本的数据库触发器、存储过程 SQL 编程，提高了我数据库后端编程能力。  对本实验过程及方法、手段的改进建议：                                                       报告评分：                                          指导教师签字：  电 子 科 技 大 学 实   验   报   告 学生姓名：田义会\t学号：2017221005027    指导教师：河中海   实验地点：信软学院楼西303     实验时间：2019.06.14 一、实验名称：图书销售管理系统数据库安全管理  二、实验学时：4  三、实验目的：  了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理  1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容  使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 针对图书销售管理系统数据库，设计数据存取权限控制模型。 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋\t予数据库对象权限。  在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。 分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、商\t家（R_Seller）角色。 分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理\t数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4 数据库管理工具及SQL 语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境  “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11  七、实验步骤  针对图书销售管理系统，在设计数据存取权限控制模型。 在 pgAdmin4 中的 BookSale 数据库中， 使用 SQL 语句创建客户 （R_Customer）角色、商家（R_Seller）角色。 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。   八、实验数据及结果分析  针对图书销售管理系统，设计数据存取权限控制模型。   图 2-1 客户角色安全模型     创建客户角色 \n图 2-2 商家角色安全模型  SQL语句： CREATE ROLE \"R_Customer\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1  运行结果：  创建商家角色  SQL语句： CREATE ROLE \"R_Seller\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1  运行结果：   赋予客户角色权限 SQL语句： GRANT  SELECT ON book TO \"R_Customer\"; GRANT SELECT ON auther TO \"R_Customer\"; GRANT  SELECT ON publisher TO \"R_Customer\";  运行结果：  5.赋予商家角色  SQL语句： GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\"; GRANT SELECT ON stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\";  运行结果：  6.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 SQL语句: CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '123456';   CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456';  运行结果：     7.用客户用户登录数据库，并进行操作来验证是否赋予权限成功。 \t  \t    图 2-10  登录客户用户  测试一：查看 book 表 SQL 语句：select * from book 运行结果：  测试二：删除 book 表中的数据 SQL 语句：delete from book where book_isbn = '9787115502742'  运行结果：   测试三：查看 auther 表 SQL 语句：select * from auther 运行结果：   测试四：插入一条数据到 auther 表中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行结果：  测试五：查看 sale 表 SQL 语句：select * from sale 运行结果：  8.用商家用户登录数据库，并进行操作来验证是否赋予权限成功。           测试一：查看 customer   SQL 语句：select * from customer 运行结果：   测试二：插入一条数据到 auther 中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行结果：   测试三：从 stock 表中删除一条数据 SQL 语句：delete from stock where stock_id = 'SA00001' 运行结果：   测试四：更新 sale 表的一条数据 SQL 语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001' 运行结果：     九、总结及心得体会 了解 了DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，提高了我的数据库管理能力。  十、对本实验过程及方法、手段的改进建议：                                                      报告评分：                                          指导教师签字：  ",
  "studentID": "2017221005027"
 },
 "57": {
  "content": "电子科技大学信息与软件工程学院    实验报告    学    号：2017221005029 姓    名：黄心茹 （实验）\t课程名称：数据库系统原理及应用 理论教师：文军 实验教师：何中海     电子科技大学教务处制表     电 子 科 技 大 学 实   验   报   告 学生姓名：黄心茹   学号：2017221005029  指导教师：何中海 一、实验一：图书销售管理系统数据库 SQL 应用编程二、实验地点：信软楼西303    实验时间：2019.06.21三、实验目的 针对图书销售管理数据库开发，了解 SQL 语言 DDL、DML、DQL 类型语句在数 据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的 SQL 数据操作访问和后端数据处理功能。 四、实验原理 首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行 SQL 编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 在数据库服务器中，执行 SQL 创建图书销售管理系统数据库 BookSale。 在数据库 BookSale 中，执行 SQL 创建数据库表、视图、索引等对象。 在数据库 BookSale 中，执行 SQL 进行数据增、删、查、改访问操作。 在数据库 BookSale 中， 采用 PL/pgSQL 语言编写存储过程函数 Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 在数据库 BookSale 中，采用 PL/pgSQL 语言编写过程语句块，实现对存储过程函数 Pro_CurrentSale 的调用，并输出统计结果。 在数据库 BookSale 中，采用 PL/pgSQL 语言编写编写图书销售表 Insert 触  发器 Tri_InsertSale，实现图书库存数据同步修改处理。 在数据库 BookSale 中，对图书销售表 Insert 触发器 Tri_InsertSale 程序进行功能验证。 在数据库 BookSale 中，创建存储过程函数实现图书销售数量和金额统计。在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL、PL/pgSQL 语言， 完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11  七、实验步骤 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。 为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 测试触发器的功能，准备 sale 表的样本数据，并将其插入sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验数据及结果分析 （1）图书销售管理系统数据库BookSale创建操作  在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 SQL代码： CREATE TABLE CUSTOMER( \tCusID char(5) PRIMARY KEY, \tCusName Varchar(10) NOT NULL, \tCusGender char(2) NOT NULL, \tTelephone char(15) NOT NULL, \tAddress Varchar(50) NOT NULL ) CREATE TABLE DaySellTable( \tSellID INT PRIMARY KEY, \tOpeID char(4) NOT NULL, \tTotalPrice money NOT NULL, \tSellDate date NOT NULL ) CREATE TABLE BookSellTable( \tBookSellID INT PRIMARY KEY, \tOpeID char(4) NOT NULL, \tBookID char(20) NOT NULL, \tBookName char(50) NOT NULL, \tBookPrice money NOT NULL, \tBookSellDate date NOT NULL ) CREATE TABLE OrderTable ( \tOrderID INT PRIMARY KEY, \tCusID char(5) NOT NULL, \tCusName Varchar(10) NOT NULL, \tBookID char(20) NOT NULL, \tBookName Varchar(50) NOT NULL, \tOrderNumber int NOT NULL, \tOrderMoney money NOT NULL, \tOrderDate date NOT NULL ) 结果截图：  对图书销售管理系统数据库表进行数据增、删、查、改SQL操作  1.插入数据SQL代码： select *from ordertable; insert into ordertable values('01','11','张一一','13','追风筝的人','2','90','2019-05-01'); insert into ordertable values('02','12','黄二二','13','追风筝的人','2','90','2019-05-01'); insert into ordertable values('03','13','吴三三','13','追风筝的人','2','90','2019-05-01'); insert into ordertable values('04','14','孙四四','13','追风筝的人','2','90','2019-05-01'); insert into ordertable values('05','15','何五五','13','追风筝的人','2','90','2019-05-01'); SELECT *FROM dayselltable; insert into dayselltable values('01','22','560','2019-05-1'); insert into dayselltable values('02','22','800','2019-05-2'); insert into dayselltable values('03','23','200','2019-05-3'); insert into dayselltable values('04','23','952','2019-05-4'); SELECT *FROM storage; insert into storage values('1','22','13','30','45','2019-05-2'); insert into storage values('2','22','13','30','45','2019-05-4'); insert into storage values('3','22','02','30','45','2019-05-7'); insert into storage values('4','22','02','30','45','2019-05-8'); insert into storage values('5','23','03','30','45','2019-05-8'); insert into storage values('6','23','03','30','45','2019-05-9'); insert into storage values('7','23','04','30','45','2019-05-10'); insert into storage values('8','23','04','30','45','2019-05-12'); SELECT *FROM customer; insert into customer values('11','张一一','男','18054736677','四川成都'); insert into customer values('12','黄二二','女','18054733677','四川成都'); insert into customer values('13','吴三三','男','18054736657','四川成都'); insert into customer values('14','孙四四','男','18054736677','四川成都'); insert into customer values('15','何五五','女','18054736357','四川成都'); insert into customer values('16','夏六六','男','18054736678','四川成都');  插入数据 运行结果截图：           编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  函数SQL语句： CREATE OR REPLACE FUNCTION Pro_CurrentSale(OUT allmoney money) as $count$ BEGIN select sum(ordermoney) into allmoney FROM ordertable WHERE orderdate = '2019-05-01'; END; $count$ LANGUAGE plpgsql;  编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  调用函数：   编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 CREATE OR REPLACE FUNCTION InsertSale() RETURNS TRIGGER AS $$ BEGIN IF (TG_OP = 'INSERT') THEN INSERT INTO storage values(new.bookid,new.bookname,new.price);  update book set book.bookid = book.bookid ; update book set book.bookname = book.bookname ; update book set book.price = book.price ; RETURN NEW; END IF; RETURN NULL; END; $$ LANGUAGE plpgsql; （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 插入数据 \t\t查看数据    电 子 科 技 大 学 实   验   报   告 学生姓名：黄心茹   学号：2017221005029  指导教师：何中海 一、实验二：图书销售管理系统数据库安全管理 二、实验地点：信软楼西303    实验时间：2019.06.21三、实验目的 了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 针对图书销售管理系统数据库，设计数据存取权限控制模型。 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。 分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、商家（R_Seller）角色。 分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4 数据库管理工具及SQL 语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验设备及环境  “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11  七、实验步骤  针对图书销售管理系统，在设计数据存取权限控制模型。 在 pgAdmin4 中的 BookSale 数据库中， 使用 SQL 语句创建客户 （R_Customer）角色、商家（R_Seller）角色。 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。   八、实验数据及结果分析  针对图书销售管理系统数据库，设计数据存取权限控制模型。 客户角色 商家角色 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 CREATE ROLE \"R_Customer\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1  CREATE ROLE \"R_Seller\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1   在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON  ordertable TO \"R_Customer\";   GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON bookselltable TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON dayselltable TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON ordertable TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON storage TO \"R_Seller\";  在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。 CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '123456';  CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456';   分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、商家（R_Seller）角色。 如上 分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  用户身份登陆  商家身份登陆  在客户身份下查看Book信息  在客户身份下查看sale信息：无法查看  在商家身份下查看Book信息  在商家身份下查看dayselltable信息  九、总结及心得体会 通过这两次数据库实验，了解 SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。该实验极大地提升了我对数据库原理以及应用的兴趣。",
  "studentID": "2017221005029"
 },
 "58": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号 2017221005030         姓    名 刘津宁                （实验）\t课程名称 数据库原理及应用      理论教师 文军                  实验教师 何中海                    电子科技大学教务处制表              电 子 科 技 大 学 实   验   报   告   一 学生姓名：刘津宁\t学号：2017221005030      指导教师：何中海 实验地点：信软学院楼西303  实验时间：2019.06.14 一、实验名称：图书销售管理系统数据库SQL应用编程  二、实验学时：4 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。  四、实验原理： 图书销售管理系统数据库SQL应用编程涉及相关知识点： （1）数据库对象（方案、表、索引、视图等）DDL编程应用解决数据库实现及性能优化； （2）数据库数据增、删、查、改DML编程应用解决数据操作访问； （3）数据库触发器、数据库函数编程应用解决业务规则及后端功能实现。  五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  六、实验器材（设备、元器件）： 实验PC计算机  实验步骤： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。      八、实验结果与分析（含重要数据结果分析或核心代码流程分析） （1）图书销售管理系统数据库BookSale创建操作   在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 创建表SQL语句： create table Auther (   AU_ID\t   CHAR(18)\t   not null,   AU_Name\t VARCHAR(20)\tnot null,   AU_Gender \tCHAR(2) \tnot null,   AU_Phone  \tVARCHAR(11) \tnot null,   AU_Address\tVARCHAR(50)\t not null,   constraint PK_AUTHER primary key (AU_ID) ); create table Book (   Book_ISBN   CHAR(13)   not null,   AU_ID \tCHAR(18)\tnull,   PUB_ID\tCHAR(11)\tnull,   Book_Name\t  VARCHAR(50)\tnot null,   Book_Pubdate\t  DATE \tnot null,   Book_Price\tMONEY\tnot null,   Book_Category\t VARCHAR(20)\tnot null,   Book_Stock\tINT4\tnot null,   Book_Notes\tVARCHAR(100)\tnull,   Book_List\t VARCHAR(100)\tnull,   constraint PK_BOOK primary key (Book_ISBN) );  create table CUSTOMER (   CUST_ID\t CHAR(18)\tnot null,   CUST_Name\tVARCHAR(20) \tnot null,   CUST_Phone\tVARCHAR(15)  not null,    CUST_Address    VARCHAR(50)     not null,   CUST_Email\tVARCHAR(50) not null,    constraint PK_CUSTOMER primary key (CUST_ID) );  create table Publisher (   PUB_ID\tCHAR(11)\tnot null,   PUB_Name\tVARCHAR(20)         not null,   PUB_Phone\tVARCHAR(15)    not null,    PUB_Address     VARCHAR(50)     not null,    constraint PK_PUBLISHER primary key (PUB_ID) );  create table Sale ( SALE_ID\tVARCHAR(11)\t not null, Book_ISBN\tCHAR(13)\tnull, CUST_ID\tCHAR(18)\tnull, SALE_Date\tDATE\tnot null, SALE_QTY\tINT4\tnot null, SALE_Amount\tMONEY\tnot null, constraint PK_SALE primary key (SALE_ID) );  create table Stock ( Stock_ID\tVARCHAR(10)\tnot null, Book_ISBN\tCHAR(13)\tnull, Stock_Change\tINT4\tnot null, Stock_Operation\tCHAR(4)\tnot null, Stock_Datetime\tDATE\tnot null, constraint PK_STOCK primary key (Stock_ID) );  alter table Book   add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID)      references Auther (AU_ID)     on delete restrict on update restrict;  alter table Book   add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID)      references Publisher (PUB_ID)     on delete restrict on update restrict; alter table Sale   add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN)     references Book (Book_ISBN)     on delete restrict on update restrict;  alter table Sale   add constraint FK_SALE_CUSTOMER_CUSTOMER foreign key (CUST_ID)     references CUSTOMER (CUST_ID)     on delete restrict on update restrict;  alter table Stock   add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN)      references Book (Book_ISBN) on delete restrict on update restrict;      创建视图SQL语句：create view BOOK_AUTHER_PUBLISHER as select B.book_name as \"图书\",AU.au_name as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\" from book as B join auther as AU on B.au_id = AU.au_id join publisher as PU on B.pub_id = PU.pub_id          对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 执行 SQL 语句，插入样本数据到图书销售数据库： Insert into Auther values('369162197706172233','天一','男','13554874593','四川省成都市成华区'); Insert into Auther values('540134199103283654','叶二','女','15812387538','天津市蓟州区'); Insert into Auther values('120225199903063698','李三','男','18575615472','北京市朝阳区'); Insert into PUBLISHER values('PUB00000001','高等教育出版社','010-65321854','北京'); Insert into PUBLISHER values('PUB00000002','人民出版社','010-65329857','北京');  Insert into PUBLISHER values('PUB00000003','人民出版社','010-65325987','北京'); Insert into BOOK values('9787115502742','369162197706172233','PUB00000001','Web 前端开发最佳实践','2016-01-01', '59','IT 技术','100'); Insert into BOOK values('9875325415577','540134199103283654','PUB00000002','C语言基础','2008-01-01', '52','IT 技术','200'); Insert into BOOK values('9865365975234','120225199903063698','PUB00000003',' 软件工程基础','2013-08-1','29','IT 技术', '150'); Insert into customer values('369162198805247775','五三','15122566523','四川省成都市成华区','123456789@qq.com'); Insert into customer values('369165197805201654','十年','15523689542','天津市蓟州区','325641987@qq.com'); Insert into customer values('135264199406031652','五年','13852603512','北京市朝阳区','852963147@qq.com');    查看customer 表数据的 SQL 语句如下： select * from customer;   增加数据：SQL 语 句 ： Insert into PUBLISHER values('PUB00000004',' 四川出版社','168-226352113','四川');    删除：SQL 语句：delete from publisher where pub_id = 'PUB00000004';   修改：SQL 语句：update publisher set pub_address = '南京' where pub_id = 'PUB00000003';    编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 创建存储过程的 SQL 语句如下。  CREATE OR REPLACE FUNCTION countsale(OUT amount int,OUT allmoney money) as $count$ BEGIN select sum(sale_qty) into amount FROM sale WHERE sale_date = '2019-05-20'; select sum(sale_amount) into allmoney FROM sale WHERE sale_date = '2019-05-20'; END; $count$ LANGUAGE plpgsql;          编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 调用存储过程 SQL 语句如下： Select * from countsale()   编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 创建触发器函数 SQL 语句： CREATE OR REPLACE FUNCTION InsertSale() RETURNS TRIGGER AS $$ BEGIN IF (TG_OP = 'INSERT') THEN INSERT INTO stock values(new.sale_id,new.book_isbn,new.sale_qty,' 出 库 ',new.sale_date); update book set book.book_stock = book.book_stock - new.sale_qty where book.book_isbn = new.book_isbn; RETURN NEW; END IF; RETURN NULL; END; $$ LANGUAGE plpgsql;   创建触发器 SQL 语句： CREATE TRIGGER Tri_InsertSale AFTER INSERT ON SALE FOR EACH ROW EXECUTE PROCEDURE InsertSale();    （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 测试触发器 SQL 语句： Insert into sale values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885');  Insert into sale values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040');  Insert into sale values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450');    九、总结及心得体会： （1）熟悉使用主流的对象-关系数据库PostgreSQL管理系统软件工具pgAdmin4； （2）建立关系数据库SQL语言编程操作与后端数据库编程能力； （3）理解和掌握数据库系统的安全管理模型原理及应用操作能力； 十、对本实验过程及方法、手段的改进建议： 实验时间有点短。                                                      报告评分：                                          指导教师签字：    电 子 科 技 大 学 实   验   报   告   二 学生姓名：刘津宁\t学号：2017221005030      指导教师：何中海 实验地点：信软学院楼西303  实验时间：2019.06.21 一、实验名称：图书销售管理系统数据库安全管理  二、实验学时：4 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理： 图书销售管理系统数据库安全管理涉及相关知识点： （1）数据库角色、用户及权限管理； （2）图书销售管理系统数据库管理实现。  五、实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  六、实验器材（设备、元器件）： 实验PC计算机           七、实验步骤： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。          八、实验结果与分析（含重要数据结果分析或核心代码流程分析） （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。   在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 创建客户角色SQL语句： CREATE ROLE \"R_Customer\"\tWITH LOGIN NOSUPERUSER  NOCREATEDB  NOCREATEROLE  NOINHERIT  NOREPLICATION  CONNECTION LIMIT -1  创建商家角色SQL语句： CREATE ROLE \"R_Seller\"\tWITH LOGIN NOSUPERUSER  NOCREATEDB  NOCREATEROLE NOINHERIT  NOREPLICATION  CONNECTION LIMIT -1    在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 赋予客户权限SQL语句： GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON auther TO \"R_Customer\";  GRANT SELECT ON publisher TO \"R_Customer\";  赋予商家权限SQL语句： GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\"; GRANT SELECT ON stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\";  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 创建客户用户和商家用户，并将客户角色和商家角色赋予他们的SQL语句： CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '369162';  CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '369162';      分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。  （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 登录客户用户：  ①SQL 语句：select * from book   查询成功！权限正确！  ②SQL 语句：delete from book where book_isbn = '9787115502742'   删除失败！权限正确！   登录商家用户：    ①SQL 语句：delete from stock where stock_id = 'SA00001'  删除失败！权限正确！   ②SQL 语句：select * from customer  查询成功！权限正确！  九、总结及心得体会：  了解了 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  十、对本实验过程及方法、手段的改进建议： 实验时间短。",
  "studentID": "2017221005030"
 },
 "59": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼305\t           实验时间：2019.6.10  三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 SQL（Structured Query Language），结构化查询语言，它是一种对数据库进行 访问与操作的数据子语言。SQL可嵌入到编程语言(如JAVA、C#等)中执行或在DBS工具中执行。 SQL不仅仅是一个查询工具，还用于控制DBS提供给用户的所有功能。 在PostgreSQL服务器中，通过执行SQL语句对数据库进行各种操作。 五、实验内容 使用JetBrains DataGrip数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用JetBrains DataGrip数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： JetBrains DataGrip DBS系统： PostgreSQL 11 七、实验步骤 创建图书销售管理系统数据库BookSale 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计 编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证 八、实验数据及结果分析 创建图书销售管理系统数据库BookSale CREATE DATABASE BookSale  在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 CREATE TABLE publish( \tpublishNo CHAR(12) PRIMARY KEY, \tpublishName varchar(40), \tpublishPhone varchar(20), \tpublishAddress varchar(60) ); CREATE TABLE author( \tauthorNo char(12) PRIMARY KEY, \tauthorName char(6), \tauthorAddress varchar(80), \tauthorPhone char(11) ); CREATE TABLE book( \tbookISBN CHAR(22) PRIMARY KEY, \tpublishNo char(12), \tbookName varchar(80), \tauthorNo char(12), \tprice money, \tbookContent text, \tconstraint publishNo_FK foreign key(publishNo) \treferences publish(publishNo) \ton update cascade, \tconstraint authorNo_FK foreign key(authorNo) \treferences author(authorNo) \ton update cascade ); CREATE TABLE store( \tbookISBN char(22) PRIMARY KEY, \tstoreNum int2, \tconstraint bookISBN_FK foreign key(bookISBN) \treferences book(bookISBN) \ton update cascade ); CREATE TABLE sale( \tsaleNo serial PRIMARY KEY, \tbookISBN char(22), \tsaleDate date, \tsaleNum numeric, \tsaleSum money, \tconstraint bookISBN_FK foreign key(bookISBN) \treferences book(bookISBN) \ton update cascade )  CREATE INDEX ISBN ON book(bookISBN);    CREATE VIEW priceView AS  SELECT* FROM book WHERE price<'30'   对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 增： INSERT INTO author VALUES('001','鲁迅','绍兴','11111111111'); INSERT INTO author VALUES('002','周树人','浙江','22222222222'); INSERT INTO author VALUES('003','刘大','河北','33333333333'); INSERT INTO author VALUES('004','王二麻子','广东','44444444444'); \t  INSERT INTO publish VALUES('01','中国人民大学出版社','3367454','北京市'); INSERT INTO publish VALUES('02','机械工业出版社','884561','河北');  INSERT INTO book VALUES('1','01','神曲','003','23','第一章第二章第三章'); INSERT INTO book VALUES('2','02','哈姆雷特','004','46','第四章第二章第三章');  INSERT INTO sale VALUES('0001','1','2019-6-10','2','46'); INSERT INTO sale VALUES('0002','2','2019-6-9','1','46');  INSERT INTO store VALUES('1','35'); INSERT INTO store VALUES('2','85');  改： UPDATE author  SET authorName ='但丁' WHERE authorName ='刘大'   删： delete  from author where authorname='周树人'   查： select * from author join book on author.authorno=book.authorno where bookname='神曲'  编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 create or replace function Pro_CurrentSale(out numsum numeric,out moneysum money)  as $current$ declare \tnumsum numeric;moneysum money; begin \tselect sum(salenum) into $1 as salenum from sale \twhere saledate=current_date; \tselect sum(salesum) into $2 as salesum from sale \twhere saledate=current_date; end; $current$ language plpgsql;  编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 select Pro_CurrentSale()  编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 create or replace function change()        returns trigger as $change$        begin               raise notice '1';               if(TG_OP = 'INSERT') then                      raise notice '2';                      update store set storenum = storenum - new.salenum                      where bookisbn = new.bookisbn;                      raise notice '3';               end if;        return null;        end;        $change$ language plpgsql;  create trigger Tri_InsertSale after insert on sale for each row execute procedure change();   对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 使用Insert操作之前：  对sale表进行Insert操作：  触发器出发之后：  九、总结及心得体会 通过此次实验熟悉了数据库各种基本SQL语句的使用，熟悉了对数据库管理工具Jetbrains DataGrip的使用，理解了数据库中各种类型数据的存储方法和数据之间的约束关系。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼305\t           实验时间：2019.6.10  三、实验目的 了解该DBS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 在SQL语言中，数据控制SQL语句是一种可对用户数据访问权进行控制 的操作语句，它可以控制特定用户或角色对数据表、视图、存储过程、 触发器等数据库对象的访问权限 \t用户要访问数据库，必须先在DBS中创建其账号，并成为 数据库的用户。此后，用户每次访问数据库，都需要在 DBS进行身份验证，只有合法用户才能进入系统，访问操 作数据库对象。在DBS中，为了方便对众多用户及其权限进行管理，通常 将一组具有相同权限的用户定义为角色(Role)。 五、实验内容 使用JetBrains DataGrip数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用JetBrains DataGrip数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows10 管理工具： JetBrains DataGrip DBS系统： PostgreSQL 11 七、实验步骤 针对图书销售管理系统数据库，设计数据存取权限控制模型。在数据库中，创建客户（R_Customer）、商家（R_Seller）角色，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller并为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 针对图书销售管理系统数据库，设计数据存取权限控制模型。在数据库中，创建客户（R_Customer）、商家（R_Seller）角色，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 CREATE ROLE \"R_Customer\" WITH  \tLOGIN  \tNOSUPERUSER  \tNOCREATEDB  \tNOCREATEROLE  \tINHERIT  \tNOREPLICATION  \tNOBYPASSRLS \tCONNECTION LIMIT -1; CREATE ROLE \"R_Seller\" WITH  \tLOGIN  \tNOSUPERUSER  \tNOCREATEDB  \tNOCREATEROLE  \tINHERIT  \tNOREPLICATION  \tNOBYPASSRLS \tCONNECTION LIMIT -1;  GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON store TO \"R_Seller\";  GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON sale TO \"R_Customer\"; GRANT SELECT ON store TO \"R_Customer\";  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller并为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 create user \"U_Customer\" with \tin role \"R_Customer\"; create user \"U_Seller\" with \tin role \"R_Seller\";  分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 （1） 以U_Customer登录：  对表sale执行uodate 操作失败： （2） \t\t以U_Seller登录： \t\t \t\t对表sale执行插入操作： \t 九、总结及心得体会 \t通过此次实验理解了数据库中用户与角色的关系以及它们的意义，自己动手熟悉了数据库中角色和用户的相关操作",
  "studentID": "2017221101017"
 },
 "60": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221101023      姓    名        李豪           （实验）\t课程名称   数据库原理及应用    理论教师        文军           实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：李豪\t\t学号：2017221101023     指导教师：何中海   实验地点：信软学院楼西303     实验时间：2019.06.14 一、实验名称：实验一：图书销售管理系统数据库SQL应用编程 二、实验学时：5 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。  四、实验原理： 针对图书销售管理系统数据库开发，掌握DDL、DML、DQL类型SQL语句在BookSale数据库开发中的应用方法，完成图书销售管理数据库SQL编程操作。  五、实验内容： （1）数据库对象（方案、表、索引、视图等）DDL编程应用解决数据库实现及性能优化； （2）数据库数据增、删、查、改DML编程应用解决数据操作访问； （3）数据库触发器、数据库函数编程应用解决业务规则及后端功能实现。  六、实验器材（设备、元器件）： 项目需用仪器设备名称：实验PC计算机 所需软件： PostgreSQL 11  七、实验步骤： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建BookSale数据库 SQL语句 create database BookSale;  执行结果     2.创建各数据库表以及表中主外键和索引 SQL语句 create table Auther (     AU_ID\t\t\tCHAR(8)\t\t\t\tnot null, \tAU_Hame\t\tVARCHAR(20)\t\tnot null, \tAU_Gender  \t\tCHAR(2)\t\t\t\tnot null,     AU_Phone\t\tVARCHAR(11)\t\tnot null, \tAU_Address  \tVARCHAR(50)\t\tnot null,     constraint PK_AUTHER primary key (AU_ID) ); create table Book ( \tBook_ISBN\t\tCHAR(13)\t\t\tnot null, \tAU_ID\t\t\tCHAR(18)\t\t\tnull, \tPUB_ID\t\t\tCHAR(11)\t\t\tnull,\t \tBook_Name\t\tVARCHAR(50)\t\tnot null, \tBook_Pubdate  \tDATE\t\t\t\tnot null, \tBook_Price\t\tMONEY\t\t\t\tnot null, \tBook_Category\tVARCHAR(20)\t\tnot null, \tBook_Stock  \t\tINT4\t\t\t\tnot null, \tBook_Notes\t\tVARCHAR(100)\t\tnull, \tBook_List\t\tVARCHAR(100)\t\tnull, \t \tconstraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER( \tCUST_ID  \t\tCHAR(18)\t\t\tnot null, \tCUST_Name\t\tVARCHAR(20)\t\tnot null, \tCUST_Phone\t\tVARCHAR(15)\t\tnot null, \tCUST_Address\tVARCHAR(50)\t\tnot null, \tCUST_Email\t\tVARCHAR(50)\t\tnot null, \tconstraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher( \tPUB_ID\t\t\tCHAR(18)\t\t\tnot null, \tPUB_Name\t\tVARCHAR(20)\t\tnot null, \tPUB_Phone\t\tVARCHAR(15)\t\tnot null, \tPUB_Address\t\tVARCHAR(50)\t\tnot null, \tconstraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale ( \tSALE_ID\t\t\tVARCHAR(11)\t\tnot null, \tBook_ISBN\t\t\tCHAR(13)\t\t\tnull, \tCUST_ID  \t\t\tCHAR(18)\t\t\tnull, \tSALE_Date\t\t\tDATE\t\t\t\tnot null, \tSALE_QTY\t\t\tINT4\t\t\t\tnot null, \tSALE_Amount\t\tMONEY\t\t\t\tnot null, \tconstraint PK_SALE primary key (SALE_ID) ); create table Stock ( \tStock_ID\t\t\tVARCHAR(10)\t\tnot null, \tBook_ISBN\t\tCHAR(13)\t\t\tnull, \tStock_Change\t\tINT4\t\t\t\tnot null, \tStock_Operation\tCHAR(4)\t\t\t\tnot null, \tStock_Datetime\tDATE\t\t\t\tnot null, \tconstraint PK_STOCK primary key (Stock_ID) ); alter table Book       add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID)       references Auther (AU_ID)       on delete restrict on update restrict; alter table Book       add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID)       references Publisher (PUB_ID)       on delete restrict on update restrict; alter table Sale       add constraint FK_SAIE_BOOK_SALE_BOOK foreign key (Book_ISBN)       references Book (Book_ISBN)       on delete restrict on update restrict; alter table Sale       add constraint FK_SALE_CUSTOMER_CUSTOMER foreign key (CUST_ID)       references CUSTOMER (CUST_ID)       on delete restrict on update restrict; alter table Stock       add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN)       references Book (Book_ISBN)       on delete restrict on update restrict;  执行结果    3．插入样本数据并对publisher表进行增删改查操作 1）插入样本数据 SQL语句 Insert into Auther values('33030919','王天','男','13554874593','四川省成都市成华区建设北路二段十号'); Insert into Auther values('54013519','叶无双','男','15812387538','浙江省杭州市天路区梅田路二十八号'); Insert into Auther values('12085719','李婷','女','18575615472','北京市朝阳区梅山路二巷八号'); Insert into PUBLISHER values('PUB00000001','高等教育出版社','010-65321854','北京'); Insert into PUBLISHER values('PUB00000002','电子工业出版社','010-65329857','北京'); Insert into PUBLISHER values('PUB00000003','人民邮电出版社','010-65325987','北京'); Insert into BOOK values('9787115502742','33030919','PUB00000001','Web前端开发最佳实践','2016-01-01','59','IT技术','100'); Insert into BOOK values('9875325415577','54013519','PUB00000002','Java EE Web编程','2008-01-01','52','IT技术','200'); Insert into BOOK values('9865365975234','12085719','PUB00000003','数据库实验指导','2013-08-1','29','IT技术','150'); Insert into customer values('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insert into customer values('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十九号','3657873215@qq.com'); Insert into customer values('542244197812121687','鲁丽','13615869875','北京市朝阳区梅山路二巷十六号','647864378@qq.com');  执行结果   2）增加一条数据到publisher表 SQL语句 Insert into PUBLISHER values('PUB00000004','清华大学出版社','010-65323169','北京'); 执行结果   3）删除一条publisher表数据 SQL语句 delete from publisher where pub_id='PUB00000004';  执行结果  4）修改一条publisher表数据 SQL语句 update publisher set pub_address='南京' where pub_id='PUB00000003'; 执行结果  5）查询publisher表的数据 SQL语句 select * from publisher; 执行结果  4.创建视图 SQL语句 create view BOOK_AUTHER_PUBLISHER as select B.book_name as \"图书\",AU.au_hame as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\" from book as B join auther as AU on B.au_id=AU.au_id join publisher as PU on B.pub_id=PU.pub_id; 执行结果  视图创建结果：   \t5.创建触发器 SQL语句 CREATE OR REPLACE FUNCTION InsertSale1() RETURNS TRIGGER AS $$ \tBEGIN \t\tIF(TG_OP='INSERT')THEN \t\t\tINSERT INTO stock values(new.sale_id,new.book_isbn,new.sale_qty,'出库',new.sale_date); \t\t\t              update book set book_stock=book_stock-new.sale_qty where book.book_isbn=new.book_isbn; \t\t\tRETURN NEW; \t\t\tEND IF; \t\t\tRETURN NULL; \t\tEND; $$LANGUAGE plpgsql;  CREATE TRIGGER Tri_InsertSale0 AFTER INSERT ON SALE FOR EACH ROW EXECUTE PROCEDURE InsertSale1();  执行结果   \t6.测试触发器 SQL语句                                                                       Insert into sale values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885');Insert into sale values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040');Insert into sale values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450'); 执行结果  之后stock表的数据  之后book表的数据   \t7.创建存储过程 SQL语句 CREATE OR REPLACE FUNCTION countsale(OUT amount int,OUT allmoney money) as $count$ BEGIN \tselect sum(sale_qty) into amount FROM sale WHERE sale_date='2019-05-20'; \tselect sum(sale_amount) into allmoney FROM sale WHERE sale_date='2019-05-20'; END; $count$ LANGUAGE plpgsql; 执行结果   \t8.调用存储过程 SQL语句 select * from countsale(); 执行结果      九、总结及心得体会： 我掌握了DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法。数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养了我的数据库后端编程能力。训练了我数据库SQL应用编程的复杂工程问题解决能力。                                                       报告评分：                                          指导教师签字： \n  电 子 科 技 大 学 实   验   报   告 学生姓名：李豪\t\t学号：2017221101023     指导教师：何中海   实验地点：信软学院楼西303     实验时间：2019.06.21 一、实验名称：实验二：图书销售管理系统数据库安全管理 二、实验学时：3 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理： 针对图书销售管理系统数据库开发，掌握使用pgAdmin4数据库管理工具及DCL类型SQL语句在数据库安全管理中的应用方法，完成图书销售管理数据库安全管理操作，如角色管理、用户管理、权限管理等系统管理操作。  五、实验内容： （1）数据库角色、用户及权限管理； （2）图书销售管理系统数据库管理实现。  六、实验器材（设备、元器件）： 项目需用仪器设备名称：实验PC计算机 所需软件： PostgreSQL 11  七、实验步骤： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1．针对图书销售管理系统数据库，设计数据存取权限控制模型      2．创建客户（R_Customer）、商家（R_Seller）角色 1）创建客户（R_Customer）角色 SQL语句 CREATE ROLE \"R_Customer\" WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1 执行结果  2）创建商家（R_Seller）角色 SQL语句 CREATE ROLE \"R_Seller\" WITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1 执行结果  角色创建结果   3．赋予客户（R_Customer）、商家（R_Seller）角色权限 SQL语句 GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON auther TO \"R_Customer\"; GRANT SELECT ON publisher TO \"R_Customer\";  GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\"; GRANT SELECT ON stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\"; 执行结果   4．分别创建客户用户U_Customer、商家用户U_Seller，并将客户角色和商家角色赋予他们 SQL语句 CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD'123456';  CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD'123456'; 执行结果  \t用户创建结果     5.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证是否赋予权限成功  \t1）客户用户U_Customer 测试1 SQL语句 select * from book; 执行结果    测试2 SQL语句 delete from book where book_isbn='9787115502742'; 执行结果   测试3 SQL语句 select * from auther; 执行结果   测试4 SQL语句 insert into auther values('33030419','李天','男','12365748953','北京市产阳区李二街18555号'); 执行结果   \t2）商家用户U_Seller 测试1 SQL语句 select * from customer; 执行结果   测试2 SQL语句 insert into auther values('33030419','李天','男','12365748953','北京市产阳区李二街18555号'); 执行结果   测试3 SQL语句 delete from stock where stock_id='SA00001'; 执行结果  测试4 SQL语句 UPDATE sale SET sale_date='2019-05-21' WHERE sale_id='SA00001'; 执行结果   九、总结及心得体会： 我了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法。在此过程中，我掌握了数据库管理能力。我还学会了在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。                                                       报告评分：                                          指导教师签字：",
  "studentID": "2017221101023"
 },
 "61": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t\t\t\t           实验时间：2019.6.10      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 第一章 数据库系统分析与设计建模 1.1 概念数据模型概述 针对数据库系统开发，一个很重要的工作就是建立该系统的数据模型。所谓数据模型是指现实世界中数据对象特征、数据对象关系及其约束的描述形式。数据模型一般由数据结构、数据操作、数据约束三部分组成。数据库应用开发需要建模的数据模型有三个层次： 1）概念数据模型――面向用户的业务数据对象及其联系 2）逻辑数据模型――面向设计者的系统数据对象逻辑表示及其联系 3）物理数据模型――面向开发者的系统数据对象存储结构形式 概念数据模型（CDM，Concept Data Model）也称信息模型。该模型主要以实体－联系(Entity-RelationShip,简称E-R)理论为基础，采用E-R模型图来描述应用系统的数据对象和数据关系，主要用于数据库系统分析建模。 CDM有一组严格定义的模型元素集合，这些模型元素精确地描述了系统的静态特性、动态特性以及完整性约束条件等，其中包括了数据结构、数据操作和完整性约束三部分。 1）数据结构表达为实体和属性; 2）数据操作表达为实体中的记录的插入、删除、修改、查询等操作; 3）完整性约束表达为数据的自身完整性约束（如数据类型、检查、规则等）和数据间的参照完整性约束（如联系、继承联系等）。 1.2 实体、属性及标识符的定义 实体（Entity），也称为实例，对应现实世界中可区别于其他对象的“事件”或“事物”。例如，学校中的每个学生，医院中的每个手术。 每个实体都有用来描述实体特征的一组性质，称之为属性，一个实体由若干个属性来描述。如学生实体可由学号、姓名、性别、出生年月、所在系别、入学年份等属性组成。 实体集（EntitySet）是具体相同类型及相同性质实体的集合。例如学校所有学生的集合可定义为“学生”实体集，“学生”实体集中的每个实体均具有学号、姓名、性别、出生年月、所在系别、入学年份等性质。 实体类型（EntityType）是实体集中每个实体所具有的共同性质的集合，例如“患者”实体类型为：患者｛门诊号，姓名，性别，年龄，身份证号.............｝。实体是实体类型的一个实例，在含义明确的情况下，实体、实体类型通常互换使用。 实体类型中的每个实体包含唯一标识它的一个或一组属性，这些属性称为实体类型的标识符（Identifier），如“学号”是学生实体类型的标识符，“姓名”、“出生日期”、“信址”共同组成“公民”实体类型的标识符。 有些实体类型可以有几组属性充当标识符，选定其中一组属性作为实体类型的主标识符，其他的作为次标识符。 第二章 PostgreSQL 数据库 PostgreSQL是以加州大学伯克利分校计算机系开发的开源的、免费的对象关系型数据库管理系统（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、外键、触发器、视图、事务完整性、MVCC。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、聚集函数、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。事实上， PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99，首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备， 比如 IP 类型和几何类型等；其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等， 同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。PostgreSQL安装核心是数据库服务端进程。它允许在一个独立服务器上。需要访问存储在数据库中的数据的应用程序必须通过数据库进程。这些客户端程序无法直接访问数据，即使它们和服务程序在同一台机器上。 2.1 PostgreSQL数据库简介 PostgreSQL 是一个自由的对象-关系数据库服务器（数据库管理系统），功能很强大。包括了可以说是目前世界上最丰富的数据类型的支持，比如 IP 类型和几何类型等等。PostgreSQL 真正诞生于二十世纪八十年代，它沿用了 ingres 很多的思想,  1995 年正式社区化了, PostgreSQL 从此诞生了。经过近 20 多年的持续开发和经验证的体系结构，PostgreSQL 在数据库领域已经赢得了良好的声誉。 PostgreSQL的源代码可以自由获取，它的授权是在非常自由的开源授权下，这种授权允许用户在各种开源或是闭源项目中使用、修改和发布PostgreSQL的源代码。用户对源代码的可以按用户意愿进行任何修改、改进。因此，PostgreSQL不仅是一个强大的企业级数据库系统，也是一个用户可以开发私用、网络和商业软件产品的数据库开发平台。 PostgreSQL是一种几乎可以运行在各种平台上的免费的开放源码的对象关系数据库管理系统，拥有与企业级数据库相媲美的特性，如完善的SQL标准支持、多版本并发控制、时间点恢复、表空间机制、异步复制、嵌套事务、在线/热备份、一个复杂的查询优化器、预写日志容错技术。它支持国际字符集、多字节字符编码、Unicode，并且对格式化、排序、大小写敏感提供本地化支持。PostgreSQL在管理大数据量方面有良好的可扩展性，对并发用户管理具有自适应性。现在已经出现具有管理超过4万亿字节数据能力的实用版本产品。 开放特性：PostgreSQL内置了丰富的数据类型，如任意精度的数值、无限制长度的文本、几何图元、IP地址、数组等；同时还允许用户定义基于正规SQL类型的新类型，让数据库自身理解复杂数据，自定义类型中还可以包含继承关系。用户可以为数据库内几乎所有的对象定义新的类型，如索引、操作符（可重载现有操作符）、聚集函数、数据域、数据类型转换、会话（编码转换）等。 可编程性：PostgreSQL同样拥有大量的编程接口供用户开发使用，如ODBC、JDBC（Java）、Libpq（C/C++）等。 可定制性：PostgreSQL拥有广泛的编程语言支持来实现函数功能，包括内置的PL/pgSQL过程语言，PL/Perl、plPHP、PL/Python、PL/Ruby、PL/Tcl等脚本语言，以及Java、C/C++等高级编程语言。函数的输出是一系列行类型的集合，可以在查询中当做表来使用，函数也可以被定义成以创建者或者调用者的身份运行。在其他的数据库产品中，函数也会被称为“存储过程”。 索引手段：用户可以自定义索引方法或者使用内置B-Tree索引、Hash表索引、GiST索引、GIN索引。GiST索引不是某种特定的索引类型，而是一种通用索引基础结构，可以在这种结构上实现很多不同的索引策略。PostgreSQL同时还支持如下功能：反向索引检索、表达式索引、部分索引、位图索引扫描。 多种身份认证方式：PostgreSQL中可以使用数据库用户/角色、操作系统、PAM、Kerberos等方式，根据主机配置文件（pg_hba.conf）中的设置执行对应的身份认证。 2.2 PostgreSQL 系统的基本体系结构 PostgreSQL 使用客户机/服务器（C/S）的模式提供服务，一个PostgreSQL会话由下列相关的进程（程序）组成： (1)一个服务器端进程。该进程管理数据库文件，接受客户端与数据库的连接，且代表客户端对数据库进行操作。该进程的程序名叫做 postgres。 (2)前端应用，即需要进行数据库操作的客户端应用。客户端应用可能本身就是多种多样的：它们可以是一个字符界  面的工具， 也可以是一个图形界面的应用，或者是一个通过访问数据库来显示网页的 web 服务器，或者是一个特殊的数据库管理工具。 一些客户端应用是和 PostgreSQL 发布一起提供的，但绝大部分是用户开发的。 和典型的客户端/服务器应用（C/S应用）一样，客户端和服务器可以在不同的主机上。此时，它们通过TCP/IP进行网络连接，你应该记住这一点，因为在客户机上可以访问的文件未必能够在数据库服务器机器上访问（或者只能用不同的文件名进行访问）。 PostgreSQL 服务器可以处理来自客户端的多个并发请求。为了能这样处理，它会为每个请求启动（“forks”）一个新的进程，然后，客户端和新服务器端进程就不再经过最初的postgres 进程而直接通信。 因此， 服务器端的主进程一直运行，等待着来自客户端的连接；而客户端和相关联的服务器端进程则在需要的时候才会运行。PostgreSQL数据库是一种极好可以运行在各种平台上的免费的开放源码的对象关系数据库，它是一种以关系数据库和SQL为基础，扩展了抽象数据类型，从而具备面向对象特性的数据库。 PostgreSQL由连接管理系统（系统控制器），编译执行系统，存储管理系统，事务系统，系统表五大部分组成。 连接管理系统接受外部操作对系统的请求，对操作请求进行预处理和分发，起系统逻辑控制作用；编译执行系统由查询编译器，查询执行器组成，完成操作请求在数据库中的分析处理和转化工作，最终实现物理存储介质中数据的操作；存储管理系统由索引管理器，内存管理器，外存管理器组成，负责存储和管理物理数据，提供对编译查询系统的支持；事务系统由事务管理器，日志管理器，并发控制，锁管理器组成，日志管理器和事务管理器完成对操作请求的事务一致性支持，锁管理器和并发控制提供对并发访问数据的一致性支持；系统表是PostgreSQL数据库的元信息管理中心，包括数据库对象信息和数据库管理控制信息。系统表管理元数据信息，将PostgreSQL数据库的各个模块有机地连接在一起，形成一个高效的数据管理系统。  图2-1 PostgreSQL体系结构图（组成结构和关系）  系统表： 在关系数据库中，为了实现数据库系统的控制，必须提供数据字典的功能。数据字典不仅存储各种对象的描述信息，而且存储系统管理所需的各种对象的细节信息。数据字典包含数据库系统中所有对象及其属性的描述信息，对象之间关系的描述信息，对象属性的自然语言含义以及数据字典变化的历史，数据字典是关系数据库系统管理控制信息的核心，在PostgreSQL数据库系统中系统表扮演着数据字典的角色。系统表是PostgreSQL数据库存放结构元数据的地方，他在PostgreSQL中表现为存放有系统信息的普通表或者视图（用户可以删除，重建）。系统表保存了数据库的所有元数据，所以系统运行时对系统表的访问是非常频繁的。为了提高系统性能，在内存中建立了共享的系统表，使用Hash表提高查询效率。 2.3 pgadmin4  pgadmin4是一款可以让您编辑SQL的软件，您可以在软件上找到编辑器，并从本地添加需要修改的文件，从而完成数据库基本信息管理以及文本修改，本软件是国外设计的，发行到中国以后官方已经添加了中文简体版本，用户只需要在设置界面上找到杂项中的语言设置窗口，就可以转换到中文界面；PostgreSQL数据库管理工具同时提供了十二种管理工具，支持维护、备份、SQL查询、演示WAL、添加新的数据还原点等，功能非常强大！ 软件功能包括广泛的文档、pgAdmin应用程序文档、PostgreSQL文档链接；多个部署模型、桌面模式，使用专门构建的运行时、服务器模式，通过网络支持多个用户；颜色语法高亮查询工具、用于显示/输入数据的快速数据网格、图形查询计划显示、授予向导以快速更新ACL、程序语言调试器（支持pl / pgsql和edb-spl）；自动真空管理、监视仪表板、备份，恢复，真空和需求分析、SQL / shell /批处理作业调度代理、创建，查看和编辑所有常见的PostgreSQL对象。 软件特色： pgAdmin4具有自己专属的SQL编辑器；可以在软件上直接查询SQL的信息；在连接到数据库以后可以自动分析需要的数据；在查询的时候会通知用户具体的SQL内容；可以显示查询内容时间长度；可以显示指定秒数通知程序；支持缓冲区的信息提示在桌面上；支持详细的pgAdmin4数据报告；支持查询SQL的代价信息标注。  pgAdmin导航菜单功能:  1).文件菜单:在文件菜单中当点击服务器根节点下某个节点时可以更改连接密码。 2).编辑菜单: 点击编辑菜单可以对数据库和对象做相应的操作。(右键所选对象相当于编辑中所有相关功能) 3).插件: 启动psql控制台并连接到在pgAdmin中所选的数据库。可以输入相应的命令。 4).视图: 用来调节页面视图的显示。例如：打开与关闭SQL窗口。 5.工具: 在主窗体左面的对象树中点击不同的节点　工具中菜单的高亮显示可做相应的操作。(所选对象右键操作可达到相同效果但工具中可以打开查询工具)。 6).帮助: 可以查看帮助文档 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 图书借阅管理系统数据库方案创建及配置。 图书借阅管理系统数据库方案中创建数据库对象（表、视图、索引、序列等）的SQL操作。 图书借阅管理系统数据库表的数据增、删、查、改SQL操作。 图书借阅管理系统数据库的触发器编程，以实现业务规则数据处理。 图书借阅管理系统数据库的存储过程编程，以实现数据库后端数据处理。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin数据库系统工具开展图书借阅管理系统数据库操作访问，其步骤如下：   1）使用pgAdmin4创建一个小型图书馆数据库library。 2）在library数据库中，通过执行SQL语句创建图书借阅管理系统数据库的表、视图、索引、序列等对象。 3）图书借阅管理系统数据库表中，通过执行SQL语句实现数据增、删、查、改SQL操作。 4）在library数据库中，通过执行SQL语句实现图书借阅管理系统数据库的触发器，以实现业务规则（如依据图书借阅数据对图书库存数据进行同步修改）数据处理。 5）在library数据库中，通过执行SQL语句实现图书借阅管理系统数据库的存储过程，以实现数据库后端数据（如图书借阅统计）处理。 八、实验数据及结果分析 1.图书管理系统数据库Library创建操作  在Windows操作系统中，启动pgAdmin4工具运行。并使用pgAdmin4创建登录/组角色Library_Manager      创建数据库        2. 在图书销售管理系统数据库Library中创建数据库表、视图、索引等对象  创建表：          代码如下    插入数据操作    创建表reader的视图        代码：  查看视图及结果：   插入book数据   数据修改操作        数据查询 假定需要查找数据库实验图书，可编写如下查询SQL语句： SELECT * FROM \"BOOK\" WHERE BOOK_NAME LIKE '数据库实验%';   4.创建触发器 在Library中，通过创建数据库触发器实现特定业务规则，如依据借阅图书数量自动对该图书的库存数量进行处理。为此,需要在图书表BOOK上创建一个Insert触发器，在该触发器程序中完成对BOOK表中BOOK_STORE数据修改处理。实现该功能的触发器函数的SQL程序如下：    创建触发器BORROW_BOOK    为了验证该触发器是否能正确工作，可进行如下测试： 1）查询图书（图书编号为“P00006”）的当前库存  2）假定现在有同学借阅图书编号为“P00006”图书，其SQL语句执行结果 3）重新查询图书（图书编号为“P00006”）的当前库存  重新查询图书（编号为“P00006”）的当前库存为17，比销售前少了5本，即表明触发器程序已经正确执行。  5.存储过程创建 在Library中，通过执行SQL语句实现图书借阅管理系统数据库的存储过程，以实现数据库后端数据（如图书借阅总数目统计）处理。例如，实现一个过程程序统计图书借阅数量统计，该过程程序有一个输入参数：日期，输出结果为该日期销售图书的总销售量。             九、总结及心得体会 通过本次实验，更加深刻学习了如何创建数据库、如何建立视图、索引，更加了解了数据库SQL语言中函数语句如何创建，触发器如何创建以及去检查触发器是否创建成功运行，存储过程的创建。总的来说本次实验还是让我学到了很多东西，最重要的是巩固了上课所学到的知识，把上课所学付诸实践，真正写了代码才有所收获。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306  \t\t\t\t\t     实验时间：2019.6.17    三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 第一章 数据库系统分析与设计建模 1.1 概念数据模型概述 针对数据库系统开发，一个很重要的工作就是建立该系统的数据模型。所谓数据模型是指现实世界中数据对象特征、数据对象关系及其约束的描述形式。数据模型一般由数据结构、数据操作、数据约束三部分组成。数据库应用开发需要建模的数据模型有三个层次： 1）概念数据模型――面向用户的业务数据对象及其联系 2）逻辑数据模型――面向设计者的系统数据对象逻辑表示及其联系 3）物理数据模型――面向开发者的系统数据对象存储结构形式 概念数据模型（CDM，Concept Data Model）也称信息模型。该模型主要以实体－联系(Entity-RelationShip,简称E-R)理论为基础，采用E-R模型图来描述应用系统的数据对象和数据关系，主要用于数据库系统分析建模。 CDM有一组严格定义的模型元素集合，这些模型元素精确地描述了系统的静态特性、动态特性以及完整性约束条件等，其中包括了数据结构、数据操作和完整性约束三部分。 1）数据结构表达为实体和属性; 2）数据操作表达为实体中的记录的插入、删除、修改、查询等操作; 3）完整性约束表达为数据的自身完整性约束（如数据类型、检查、规则等）和数据间的参照完整性约束（如联系、继承联系等）。 1.2 实体、属性及标识符的定义 实体（Entity），也称为实例，对应现实世界中可区别于其他对象的“事件”或“事物”。例如，学校中的每个学生，医院中的每个手术。 每个实体都有用来描述实体特征的一组性质，称之为属性，一个实体由若干个属性来描述。如学生实体可由学号、姓名、性别、出生年月、所在系别、入学年份等属性组成。 实体集（EntitySet）是具体相同类型及相同性质实体的集合。例如学校所有学生的集合可定义为“学生”实体集，“学生”实体集中的每个实体均具有学号、姓名、性别、出生年月、所在系别、入学年份等性质。 实体类型（EntityType）是实体集中每个实体所具有的共同性质的集合，例如“患者”实体类型为：患者｛门诊号，姓名，性别，年龄，身份证号.............｝。实体是实体类型的一个实例，在含义明确的情况下，实体、实体类型通常互换使用。 实体类型中的每个实体包含唯一标识它的一个或一组属性，这些属性称为实体类型的标识符（Identifier），如“学号”是学生实体类型的标识符，“姓名”、“出生日期”、“信址”共同组成“公民”实体类型的标识符。 有些实体类型可以有几组属性充当标识符，选定其中一组属性作为实体类型的主标识符，其他的作为次标识符。 第二章 PostgreSQL 数据库 PostgreSQL是以加州大学伯克利分校计算机系开发的开源的、免费的对象关系型数据库管理系统（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、外键、触发器、视图、事务完整性、MVCC。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、聚集函数、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。事实上， PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99，首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备， 比如 IP 类型和几何类型等；其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等， 同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。PostgreSQL安装核心是数据库服务端进程。它允许在一个独立服务器上。需要访问存储在数据库中的数据的应用程序必须通过数据库进程。这些客户端程序无法直接访问数据，即使它们和服务程序在同一台机器上。 2.1 PostgreSQL数据库简介 PostgreSQL 是一个自由的对象-关系数据库服务器（数据库管理系统），功能很强大。包括了可以说是目前世界上最丰富的数据类型的支持，比如 IP 类型和几何类型等等。PostgreSQL 真正诞生于二十世纪八十年代，它沿用了 ingres 很多的思想,  1995 年正式社区化了, PostgreSQL 从此诞生了。经过近 20 多年的持续开发和经验证的体系结构，PostgreSQL 在数据库领域已经赢得了良好的声誉。 PostgreSQL的源代码可以自由获取，它的授权是在非常自由的开源授权下，这种授权允许用户在各种开源或是闭源项目中使用、修改和发布PostgreSQL的源代码。用户对源代码的可以按用户意愿进行任何修改、改进。因此，PostgreSQL不仅是一个强大的企业级数据库系统，也是一个用户可以开发私用、网络和商业软件产品的数据库开发平台。 PostgreSQL是一种几乎可以运行在各种平台上的免费的开放源码的对象关系数据库管理系统，拥有与企业级数据库相媲美的特性，如完善的SQL标准支持、多版本并发控制、时间点恢复、表空间机制、异步复制、嵌套事务、在线/热备份、一个复杂的查询优化器、预写日志容错技术。它支持国际字符集、多字节字符编码、Unicode，并且对格式化、排序、大小写敏感提供本地化支持。PostgreSQL在管理大数据量方面有良好的可扩展性，对并发用户管理具有自适应性。现在已经出现具有管理超过4万亿字节数据能力的实用版本产品。 开放特性：PostgreSQL内置了丰富的数据类型，如任意精度的数值、无限制长度的文本、几何图元、IP地址、数组等；同时还允许用户定义基于正规SQL类型的新类型，让数据库自身理解复杂数据，自定义类型中还可以包含继承关系。用户可以为数据库内几乎所有的对象定义新的类型，如索引、操作符（可重载现有操作符）、聚集函数、数据域、数据类型转换、会话（编码转换）等。 可编程性：PostgreSQL同样拥有大量的编程接口供用户开发使用，如ODBC、JDBC（Java）、Libpq（C/C++）等。 可定制性：PostgreSQL拥有广泛的编程语言支持来实现函数功能，包括内置的PL/pgSQL过程语言，PL/Perl、plPHP、PL/Python、PL/Ruby、PL/Tcl等脚本语言，以及Java、C/C++等高级编程语言。函数的输出是一系列行类型的集合，可以在查询中当做表来使用，函数也可以被定义成以创建者或者调用者的身份运行。在其他的数据库产品中，函数也会被称为“存储过程”。 索引手段：用户可以自定义索引方法或者使用内置B-Tree索引、Hash表索引、GiST索引、GIN索引。GiST索引不是某种特定的索引类型，而是一种通用索引基础结构，可以在这种结构上实现很多不同的索引策略。PostgreSQL同时还支持如下功能：反向索引检索、表达式索引、部分索引、位图索引扫描。 多种身份认证方式：PostgreSQL中可以使用数据库用户/角色、操作系统、PAM、Kerberos等方式，根据主机配置文件（pg_hba.conf）中的设置执行对应的身份认证。 2.2 PostgreSQL 系统的基本体系结构 PostgreSQL 使用客户机/服务器（C/S）的模式提供服务，一个PostgreSQL会话由下列相关的进程（程序）组成： (1)一个服务器端进程。该进程管理数据库文件，接受客户端与数据库的连接，且代表客户端对数据库进行操作。该进程的程序名叫做 postgres。 (2)前端应用，即需要进行数据库操作的客户端应用。客户端应用可能本身就是多种多样的：它们可以是一个字符界  面的工具， 也可以是一个图形界面的应用，或者是一个通过访问数据库来显示网页的 web 服务器，或者是一个特殊的数据库管理工具。 一些客户端应用是和 PostgreSQL 发布一起提供的，但绝大部分是用户开发的。 和典型的客户端/服务器应用（C/S应用）一样，客户端和服务器可以在不同的主机上。此时，它们通过TCP/IP进行网络连接，你应该记住这一点，因为在客户机上可以访问的文件未必能够在数据库服务器机器上访问（或者只能用不同的文件名进行访问）。 PostgreSQL 服务器可以处理来自客户端的多个并发请求。为了能这样处理，它会为每个请求启动（“forks”）一个新的进程，然后，客户端和新服务器端进程就不再经过最初的postgres 进程而直接通信。 因此， 服务器端的主进程一直运行，等待着来自客户端的连接；而客户端和相关联的服务器端进程则在需要的时候才会运行。PostgreSQL数据库是一种极好可以运行在各种平台上的免费的开放源码的对象关系数据库，它是一种以关系数据库和SQL为基础，扩展了抽象数据类型，从而具备面向对象特性的数据库。 PostgreSQL由连接管理系统（系统控制器），编译执行系统，存储管理系统，事务系统，系统表五大部分组成。 连接管理系统接受外部操作对系统的请求，对操作请求进行预处理和分发，起系统逻辑控制作用；编译执行系统由查询编译器，查询执行器组成，完成操作请求在数据库中的分析处理和转化工作，最终实现物理存储介质中数据的操作；存储管理系统由索引管理器，内存管理器，外存管理器组成，负责存储和管理物理数据，提供对编译查询系统的支持；事务系统由事务管理器，日志管理器，并发控制，锁管理器组成，日志管理器和事务管理器完成对操作请求的事务一致性支持，锁管理器和并发控制提供对并发访问数据的一致性支持；系统表是PostgreSQL数据库的元信息管理中心，包括数据库对象信息和数据库管理控制信息。系统表管理元数据信息，将PostgreSQL数据库的各个模块有机地连接在一起，形成一个高效的数据管理系统。  图2-1 PostgreSQL体系结构图（组成结构和关系）  系统表： 在关系数据库中，为了实现数据库系统的控制，必须提供数据字典的功能。数据字典不仅存储各种对象的描述信息，而且存储系统管理所需的各种对象的细节信息。数据字典包含数据库系统中所有对象及其属性的描述信息，对象之间关系的描述信息，对象属性的自然语言含义以及数据字典变化的历史，数据字典是关系数据库系统管理控制信息的核心，在PostgreSQL数据库系统中系统表扮演着数据字典的角色。系统表是PostgreSQL数据库存放结构元数据的地方，他在PostgreSQL中表现为存放有系统信息的普通表或者视图（用户可以删除，重建）。系统表保存了数据库的所有元数据，所以系统运行时对系统表的访问是非常频繁的。为了提高系统性能，在内存中建立了共享的系统表，使用Hash表提高查询效率。 2.3 pgadmin4  pgadmin4是一款可以让您编辑SQL的软件，您可以在软件上找到编辑器，并从本地添加需要修改的文件，从而完成数据库基本信息管理以及文本修改，本软件是国外设计的，发行到中国以后官方已经添加了中文简体版本，用户只需要在设置界面上找到杂项中的语言设置窗口，就可以转换到中文界面；PostgreSQL数据库管理工具同时提供了十二种管理工具，支持维护、备份、SQL查询、演示WAL、添加新的数据还原点等，功能非常强大！ 软件功能包括广泛的文档、pgAdmin应用程序文档、PostgreSQL文档链接；多个部署模型、桌面模式，使用专门构建的运行时、服务器模式，通过网络支持多个用户；颜色语法高亮查询工具、用于显示/输入数据的快速数据网格、图形查询计划显示、授予向导以快速更新ACL、程序语言调试器（支持pl / pgsql和edb-spl）；自动真空管理、监视仪表板、备份，恢复，真空和需求分析、SQL / shell /批处理作业调度代理、创建，查看和编辑所有常见的PostgreSQL对象。 软件特色： pgAdmin4具有自己专属的SQL编辑器；可以在软件上直接查询SQL的信息；在连接到数据库以后可以自动分析需要的数据；在查询的时候会通知用户具体的SQL内容；可以显示查询内容时间长度；可以显示指定秒数通知程序；支持缓冲区的信息提示在桌面上；支持详细的pgAdmin4数据报告；支持查询SQL的代价信息标注。  pgAdmin导航菜单功能:  1).文件菜单:在文件菜单中当点击服务器根节点下某个节点时可以更改连接密码。 2).编辑菜单: 点击编辑菜单可以对数据库和对象做相应的操作。(右键所选对象相当于编辑中所有相关功能) 3).插件: 启动psql控制台并连接到在pgAdmin中所选的数据库。可以输入相应的命令。 4).视图: 用来调节页面视图的显示。例如：打开与关闭SQL窗口。 5.工具: 在主窗体左面的对象树中点击不同的节点　工具中菜单的高亮显示可做相应的操作。(所选对象右键操作可达到相同效果但工具中可以打开查询工具)。 6).帮助: 可以查看帮助文档 五、实验内容 使用pgAdmin4数据库开发工具对图书借阅管理系统数据库进行数据库管理，并完成数据库备份/恢复处理，具体实验内容如下: 图书借阅管理系统数据库拥有者用户（Library_Manager）创建 图书借阅管理系统数据库角色创建 图书借阅管理系统模式（Schema）创建 图书借阅管理系统数据库角色权限设置 图书借阅管理系统数据库其他用户创建与角色分派 图书借阅管理系统用户的数据库对象访问 在实验计算机上，利用pgAdmin4数据库系统工具，完成图书借阅管理系统数据库管理与维护，同时记录实验过程的规划、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin4数据库系统工具开展图书借阅管理系统数据库管理与维护，其步骤如下：   1）创建数据库拥有者用户Library_Manager 2）创建Library数据库 3）创建图书借阅管理系统数据库客户、经理角色 4）分派创建角色的权限 5）创建图书借阅管理系统用户 6）分派创建用户的角色 7）验证创建用户的数据库对象访问权限 8）数据库备份管理 9）数据库恢复管理 八、实验数据及结果分析 创建数据库拥有者用户Library_Manager，其角色为superuser.（与实验一同） 在Windows操作系统中，启动pgAdmin4工具运行。并使用pgAdmin4创建登录/组角色Library_Manager 创建数据库Library 使用pgAdmin4工具创建数据库Library，Owner为Library_Manager 创建图书借阅管理系统数据库客户、经理角色 在实际应用中，可以由DBA按业务需要创建用户自定义角色。在系统的用户管理中，通常会把多个用户赋予一个组，这样在设置权限时只需给该组设置即可，撤销权限时也是从该组撤消。在PostgreSQL中，首先需要创建一个代表组的角色，之后再将该角色的membership权限赋给独立的用户角色即可，按实验要求，我们需要两个组角色，分别为数据库经理Manager和客户Reader， 分派创建角色的权限     数据库对象在被创建时都会被赋予一个所有者，通常而言，所有者就是执行对象创建语句的角色。对于大多数类型的对象，其初始状态是只有所有者(或超级用户)可以对该对象做任何事情。如果要允许其它用户可以使用该对象，必须赋予适当的权限。  在本实验中，经理(Manager)角色对数据库方案中所有表拥有Insert、Delete、Update、Select操作权限，而客户（Reader）角色对数据库方案中部分数据表（如BOOK、READER）具有Insert、Delete、Update、Select操作权限。   其次为客户Reader赋予BOOK和READER的相应权限   为新建用户授予自定义角色 在此前，分别创建了系统自定义角色manager和reader。现可以将这些自定义角色授予新用户。 本实验将创建一个新用户“user1”，并给他赋予“reader”角色。在“登录/组角色”右键，点击“创建”再点击“登录/组角色”    选中组角色reader，点击右键，选中“属性”选项。在出现的界面中点击“成员”，并选择user1成员，点击保存     查询user1用户的数据库访问权限 首先查询reader角色的权限          PostgreSQL中，Inherit表示组角色reader的任何一个成员角色都将自动继承除“超级用户权限”外的所有权限   九、总结及心得体会 通过本次实验，熟悉了典型的数据库管理工具使用，掌握了应用系统的数据库管理技术与方法，如数据库角色管理、用户管理、权限管理、数据库备份与恢复等系统管理操作，以及完成数据库对象操作访问。这些虽然在课堂中都有所学到，但是没有实际操作过。本次实验给我们了一次实际操作的机会，巩固了所学知识。 ",
  "studentID": "2017221102002"
 },
 "62": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221102003      姓    名         毕成          （实验）\t课程名称   数据库原理及应用    理论教师         文军          实验教师         文军              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：毕成\t\t学号：2017221102003     指导教师：文军  实验地点：303     实验时间：19.06.14 一、实验名称：图书销售管理系统数据库SQL应用编程  二、实验学时：5 三、实验目的：针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。  四、实验原理：  实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  六、实验器材（设备、元器件）：实验PC计算机,PostgreSQL 11  七、实验步骤： （1）图书销售管理系统数据库BookSale创建操作      在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 首先用create语句创建数据库表，并编入相应数据            用select as from where语句创建视图    用create index on 语句创建索引    对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 用insert into values语句增加数据      用delete from 语句进行删除操作    用select语句进行查看操作           用update命令进行修改   编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 用create declare begin end等操作编写存储过程    编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理，并对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。        八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 通过数据库SQL应用编程成功实现了数据库的创建，以及数据库表，视图，索引的创建，成功进行增删查改的操作，编写存储过程和触发器，完成实验内容。 九、总结及心得体会： 通过本次实验掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。 十、对本实验过程及方法、手段的改进建议：                                                      报告评分：                                          指导教师签字：     电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221102003      姓    名        毕成           （实验）\t课程名称  数据库原理及应用     理论教师        文军           实验教师        文军               电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：毕成\t\t学号：2017221102003       指导教师：文军 实验地点：303     实验时间：19.06.14 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3 三、实验目的：对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理：  五、实验内容：（1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  实验器材（设备、元器件）：实验PC计算机,PostgreSQL 11 实验步骤：（1）针对图书销售管理系统数据库，设计数据存取权限控制模型。在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 用create role with 语句创建角色并赋予相应权限    在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 用grant on to 语句赋予数据库对象权限       在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。  用create user with语句创建用户，in role语句分派角色     （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。      八、实验结果与分析（含重要数据结果分析或核心代码流程分析）   成功创建数据库，创建角色并赋予权限，创建用户并访问数据库。 九、总结及心得体会：   通过本次实验理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。 十、对本实验过程及方法、手段的改进建议：                                                      报告评分：                                          指导教师签字： ",
  "studentID": "2017221102003"
 },
 "63": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼303\t\t\t\t\t           实验时间：2019.6.14      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 第一章 数据库系统分析与设计建模 1.1 概念数据模型概述 针对数据库系统开发，一个很重要的工作就是建立该系统的数据模型。所谓数据模型是指现实世界中数据对象特征、数据对象关系及其约束的描述形式。数据模型一般由数据结构、数据操作、数据约束三部分组成。数据库应用开发需要建模的数据模型有三个层次： 1）概念数据模型――面向用户的业务数据对象及其联系 2）逻辑数据模型――面向设计者的系统数据对象逻辑表示及其联系 3）物理数据模型――面向开发者的系统数据对象存储结构形式 概念数据模型（CDM，Concept Data Model）也称信息模型。该模型主要以实体－联系(Entity-RelationShip,简称E-R)理论为基础，采用E-R模型图来描述应用系统的数据对象和数据关系，主要用于数据库系统分析建模。 CDM有一组严格定义的模型元素集合，这些模型元素精确地描述了系统的静态特性、动态特性以及完整性约束条件等，其中包括了数据结构、数据操作和完整性约束三部分。 1）数据结构表达为实体和属性; 2）数据操作表达为实体中的记录的插入、删除、修改、查询等操作; 3）完整性约束表达为数据的自身完整性约束（如数据类型、检查、规则等）和数据间的参照完整性约束（如联系、继承联系等）。 1.2 实体、属性及标识符的定义 实体（Entity），也称为实例，对应现实世界中可区别于其他对象的“事件”或“事物”。例如，学校中的每个学生，医院中的每个手术。 每个实体都有用来描述实体特征的一组性质，称之为属性，一个实体由若干个属性来描述。如学生实体可由学号、姓名、性别、出生年月、所在系别、入学年份等属性组成。 实体集（EntitySet）是具体相同类型及相同性质实体的集合。例如学校所有学生的集合可定义为“学生”实体集，“学生”实体集中的每个实体均具有学号、姓名、性别、出生年月、所在系别、入学年份等性质。 实体类型（EntityType）是实体集中每个实体所具有的共同性质的集合，例如“患者”实体类型为：患者｛门诊号，姓名，性别，年龄，身份证号.............｝。实体是实体类型的一个实例，在含义明确的情况下，实体、实体类型通常互换使用。 实体类型中的每个实体包含唯一标识它的一个或一组属性，这些属性称为实体类型的标识符（Identifier），如“学号”是学生实体类型的标识符，“姓名”、“出生日期”、“信址”共同组成“公民”实体类型的标识符。 有些实体类型可以有几组属性充当标识符，选定其中一组属性作为实体类型的主标识符，其他的作为次标识符。 第二章 PostgreSQL 数据库 PostgreSQL是以加州大学伯克利分校计算机系开发的开源的、免费的对象关系型数据库管理系统（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、外键、触发器、视图、事务完整性、MVCC。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、聚集函数、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。事实上， PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99，首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备， 比如 IP 类型和几何类型等；其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等， 同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。PostgreSQL安装核心是数据库服务端进程。它允许在一个独立服务器上。需要访问存储在数据库中的数据的应用程序必须通过数据库进程。这些客户端程序无法直接访问数据，即使它们和服务程序在同一台机器上。 2.1 PostgreSQL数据库简介 PostgreSQL 是一个自由的对象-关系数据库服务器（数据库管理系统），功能很强大。包括了可以说是目前世界上最丰富的数据类型的支持，比如 IP 类型和几何类型等等。PostgreSQL 真正诞生于二十世纪八十年代，它沿用了 ingres 很多的思想,  1995 年正式社区化了, PostgreSQL 从此诞生了。经过近 20 多年的持续开发和经验证的体系结构，PostgreSQL 在数据库领域已经赢得了良好的声誉。 PostgreSQL的源代码可以自由获取，它的授权是在非常自由的开源授权下，这种授权允许用户在各种开源或是闭源项目中使用、修改和发布PostgreSQL的源代码。用户对源代码的可以按用户意愿进行任何修改、改进。因此，PostgreSQL不仅是一个强大的企业级数据库系统，也是一个用户可以开发私用、网络和商业软件产品的数据库开发平台。 PostgreSQL是一种几乎可以运行在各种平台上的免费的开放源码的对象关系数据库管理系统，拥有与企业级数据库相媲美的特性，如完善的SQL标准支持、多版本并发控制、时间点恢复、表空间机制、异步复制、嵌套事务、在线/热备份、一个复杂的查询优化器、预写日志容错技术。它支持国际字符集、多字节字符编码、Unicode，并且对格式化、排序、大小写敏感提供本地化支持。PostgreSQL在管理大数据量方面有良好的可扩展性，对并发用户管理具有自适应性。现在已经出现具有管理超过4万亿字节数据能力的实用版本产品。 开放特性：PostgreSQL内置了丰富的数据类型，如任意精度的数值、无限制长度的文本、几何图元、IP地址、数组等；同时还允许用户定义基于正规SQL类型的新类型，让数据库自身理解复杂数据，自定义类型中还可以包含继承关系。用户可以为数据库内几乎所有的对象定义新的类型，如索引、操作符（可重载现有操作符）、聚集函数、数据域、数据类型转换、会话（编码转换）等。 可编程性：PostgreSQL同样拥有大量的编程接口供用户开发使用，如ODBC、JDBC（Java）、Libpq（C/C++）等。 可定制性：PostgreSQL拥有广泛的编程语言支持来实现函数功能，包括内置的PL/pgSQL过程语言，PL/Perl、plPHP、PL/Python、PL/Ruby、PL/Tcl等脚本语言，以及Java、C/C++等高级编程语言。函数的输出是一系列行类型的集合，可以在查询中当做表来使用，函数也可以被定义成以创建者或者调用者的身份运行。在其他的数据库产品中，函数也会被称为“存储过程”。 索引手段：用户可以自定义索引方法或者使用内置B-Tree索引、Hash表索引、GiST索引、GIN索引。GiST索引不是某种特定的索引类型，而是一种通用索引基础结构，可以在这种结构上实现很多不同的索引策略。PostgreSQL同时还支持如下功能：反向索引检索、表达式索引、部分索引、位图索引扫描。 多种身份认证方式：PostgreSQL中可以使用数据库用户/角色、操作系统、PAM、Kerberos等方式，根据主机配置文件（pg_hba.conf）中的设置执行对应的身份认证。 2.2 PostgreSQL 系统的基本体系结构 PostgreSQL 使用客户机/服务器（C/S）的模式提供服务，一个PostgreSQL会话由下列相关的进程（程序）组成： (1)一个服务器端进程。该进程管理数据库文件，接受客户端与数据库的连接，且代表客户端对数据库进行操作。该进程的程序名叫做 postgres。 (2)前端应用，即需要进行数据库操作的客户端应用。客户端应用可能本身就是多种多样的：它们可以是一个字符界  面的工具， 也可以是一个图形界面的应用，或者是一个通过访问数据库来显示网页的 web 服务器，或者是一个特殊的数据库管理工具。 一些客户端应用是和 PostgreSQL 发布一起提供的，但绝大部分是用户开发的。 和典型的客户端/服务器应用（C/S应用）一样，客户端和服务器可以在不同的主机上。此时，它们通过TCP/IP进行网络连接，你应该记住这一点，因为在客户机上可以访问的文件未必能够在数据库服务器机器上访问（或者只能用不同的文件名进行访问）。 PostgreSQL 服务器可以处理来自客户端的多个并发请求。为了能这样处理，它会为每个请求启动（“forks”）一个新的进程，然后，客户端和新服务器端进程就不再经过最初的postgres 进程而直接通信。 因此， 服务器端的主进程一直运行，等待着来自客户端的连接；而客户端和相关联的服务器端进程则在需要的时候才会运行。PostgreSQL数据库是一种极好可以运行在各种平台上的免费的开放源码的对象关系数据库，它是一种以关系数据库和SQL为基础，扩展了抽象数据类型，从而具备面向对象特性的数据库。 PostgreSQL由连接管理系统（系统控制器），编译执行系统，存储管理系统，事务系统，系统表五大部分组成。 连接管理系统接受外部操作对系统的请求，对操作请求进行预处理和分发，起系统逻辑控制作用；编译执行系统由查询编译器，查询执行器组成，完成操作请求在数据库中的分析处理和转化工作，最终实现物理存储介质中数据的操作；存储管理系统由索引管理器，内存管理器，外存管理器组成，负责存储和管理物理数据，提供对编译查询系统的支持；事务系统由事务管理器，日志管理器，并发控制，锁管理器组成，日志管理器和事务管理器完成对操作请求的事务一致性支持，锁管理器和并发控制提供对并发访问数据的一致性支持；系统表是PostgreSQL数据库的元信息管理中心，包括数据库对象信息和数据库管理控制信息。系统表管理元数据信息，将PostgreSQL数据库的各个模块有机地连接在一起，形成一个高效的数据管理系统。  图2-1 PostgreSQL体系结构图（组成结构和关系）  系统表： 在关系数据库中，为了实现数据库系统的控制，必须提供数据字典的功能。数据字典不仅存储各种对象的描述信息，而且存储系统管理所需的各种对象的细节信息。数据字典包含数据库系统中所有对象及其属性的描述信息，对象之间关系的描述信息，对象属性的自然语言含义以及数据字典变化的历史，数据字典是关系数据库系统管理控制信息的核心，在PostgreSQL数据库系统中系统表扮演着数据字典的角色。系统表是PostgreSQL数据库存放结构元数据的地方，他在PostgreSQL中表现为存放有系统信息的普通表或者视图（用户可以删除，重建）。系统表保存了数据库的所有元数据，所以系统运行时对系统表的访问是非常频繁的。为了提高系统性能，在内存中建立了共享的系统表，使用Hash表提高查询效率。 2.3 pgadmin4  pgadmin4是一款可以让您编辑SQL的软件，您可以在软件上找到编辑器，并从本地添加需要修改的文件，从而完成数据库基本信息管理以及文本修改，本软件是国外设计的，发行到中国以后官方已经添加了中文简体版本，用户只需要在设置界面上找到杂项中的语言设置窗口，就可以转换到中文界面；PostgreSQL数据库管理工具同时提供了十二种管理工具，支持维护、备份、SQL查询、演示WAL、添加新的数据还原点等，功能非常强大！ 软件功能包括广泛的文档、pgAdmin应用程序文档、PostgreSQL文档链接；多个部署模型、桌面模式，使用专门构建的运行时、服务器模式，通过网络支持多个用户；颜色语法高亮查询工具、用于显示/输入数据的快速数据网格、图形查询计划显示、授予向导以快速更新ACL、程序语言调试器（支持pl / pgsql和edb-spl）；自动真空管理、监视仪表板、备份，恢复，真空和需求分析、SQL / shell /批处理作业调度代理、创建，查看和编辑所有常见的PostgreSQL对象。 软件特色： pgAdmin4具有自己专属的SQL编辑器；可以在软件上直接查询SQL的信息；在连接到数据库以后可以自动分析需要的数据；在查询的时候会通知用户具体的SQL内容；可以显示查询内容时间长度；可以显示指定秒数通知程序；支持缓冲区的信息提示在桌面上；支持详细的pgAdmin4数据报告；支持查询SQL的代价信息标注。  pgAdmin导航菜单功能:  1).文件菜单:在文件菜单中当点击服务器根节点下某个节点时可以更改连接密码。 2).编辑菜单: 点击编辑菜单可以对数据库和对象做相应的操作。(右键所选对象相当于编辑中所有相关功能) 3).插件: 启动psql控制台并连接到在pgAdmin中所选的数据库。可以输入相应的命令。 4).视图: 用来调节页面视图的显示。例如：打开与关闭SQL窗口。 5.工具: 在主窗体左面的对象树中点击不同的节点　工具中菜单的高亮显示可做相应的操作。(所选对象右键操作可达到相同效果但工具中可以打开查询工具)。 6).帮助: 可以查看帮助文档 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 图书借阅管理系统数据库方案创建及配置。 图书借阅管理系统数据库方案中创建数据库对象（表、视图、索引、序列等）的SQL操作。 图书借阅管理系统数据库表的数据增、删、查、改SQL操作。 图书借阅管理系统数据库的触发器编程，以实现业务规则数据处理。 图书借阅管理系统数据库的存储过程编程，以实现数据库后端数据处理。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin数据库系统工具开展图书借阅管理系统数据库操作访问，其步骤如下：   1）使用pgAdmin4创建一个小型图书馆数据库library。 2）在library数据库中，通过执行SQL语句创建图书借阅管理系统数据库的表、视图、索引、序列等对象。 3）图书借阅管理系统数据库表中，通过执行SQL语句实现数据增、删、查、改SQL操作。 4）在library数据库中，通过执行SQL语句实现图书借阅管理系统数据库的触发器，以实现业务规则（如依据图书借阅数据对图书库存数据进行同步修改）数据处理。 5）在library数据库中，通过执行SQL语句实现图书借阅管理系统数据库的存储过程，以实现数据库后端数据（如图书借阅统计）处理。 八、实验数据及结果分析 1.图书管理系统数据库Library创建操作  在Windows操作系统中，启动pgAdmin4工具运行。并使用pgAdmin4创建登录/组角色Library_Manager      创建数据库    2. 在图书销售管理系统数据库Library中创建数据库表、视图、索引等对象  创建表：          代码如下    插入数据操作    创建表reader的视图        代码：  查看视图及结果：   插入book数据   数据修改操作        数据查询 假定需要查找数据库实验图书，可编写如下查询SQL语句： SELECT * FROM \"BOOK\" WHERE BOOK_NAME LIKE '数据库实验%';   4.创建触发器 在Library中，通过创建数据库触发器实现特定业务规则，如依据借阅图书数量自动对该图书的库存数量进行处理。为此,需要在图书表BOOK上创建一个Insert触发器，在该触发器程序中完成对BOOK表中BOOK_STORE数据修改处理。实现该功能的触发器函数的SQL程序如下：    创建触发器BORROW_BOOK    为了验证该触发器是否能正确工作，可进行如下测试： 1）查询图书（图书编号为“P00006”）的当前库存  2）假定现在有同学借阅图书编号为“P00006”图书，其SQL语句执行结果 ・3）重新查询图书（图书编号为“P00006”）的当前库存  重新查询图书（编号为“P00006”）的当前库存为17，比销售前少了5本，即表明触发器程序已经正确执行。  5.存储过程创建 在Library中，通过执行SQL语句实现图书借阅管理系统数据库的存储过程，以实现数据库后端数据（如图书借阅总数目统计）处理。例如，实现一个过程程序统计图书借阅数量统计，该过程程序有一个输入参数：日期，输出结果为该日期销售图书的总销售量。             九、总结及心得体会 通过本次实验，更加深刻学习了如何创建数据库、如何建立视图、索引，更加了解了数据库SQL语言中函数语句如何创建，触发器如何创建以及去检查触发器是否创建成功运行，存储过程的创建。总的来说本次实验还是让我学到了很多东西，最重要的是巩固了上课所学到的知识，把上课所学付诸实践，真正写了代码才有所收获。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼303  \t\t\t\t\t     实验时间：2019.6.21    三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 第一章 数据库系统分析与设计建模 1.1 概念数据模型概述 针对数据库系统开发，一个很重要的工作就是建立该系统的数据模型。所谓数据模型是指现实世界中数据对象特征、数据对象关系及其约束的描述形式。数据模型一般由数据结构、数据操作、数据约束三部分组成。数据库应用开发需要建模的数据模型有三个层次： 1）概念数据模型――面向用户的业务数据对象及其联系 2）逻辑数据模型――面向设计者的系统数据对象逻辑表示及其联系 3）物理数据模型――面向开发者的系统数据对象存储结构形式 概念数据模型（CDM，Concept Data Model）也称信息模型。该模型主要以实体－联系(Entity-RelationShip,简称E-R)理论为基础，采用E-R模型图来描述应用系统的数据对象和数据关系，主要用于数据库系统分析建模。 CDM有一组严格定义的模型元素集合，这些模型元素精确地描述了系统的静态特性、动态特性以及完整性约束条件等，其中包括了数据结构、数据操作和完整性约束三部分。 1）数据结构表达为实体和属性; 2）数据操作表达为实体中的记录的插入、删除、修改、查询等操作; 3）完整性约束表达为数据的自身完整性约束（如数据类型、检查、规则等）和数据间的参照完整性约束（如联系、继承联系等）。 1.2 实体、属性及标识符的定义 实体（Entity），也称为实例，对应现实世界中可区别于其他对象的“事件”或“事物”。例如，学校中的每个学生，医院中的每个手术。 每个实体都有用来描述实体特征的一组性质，称之为属性，一个实体由若干个属性来描述。如学生实体可由学号、姓名、性别、出生年月、所在系别、入学年份等属性组成。 实体集（EntitySet）是具体相同类型及相同性质实体的集合。例如学校所有学生的集合可定义为“学生”实体集，“学生”实体集中的每个实体均具有学号、姓名、性别、出生年月、所在系别、入学年份等性质。 实体类型（EntityType）是实体集中每个实体所具有的共同性质的集合，例如“患者”实体类型为：患者｛门诊号，姓名，性别，年龄，身份证号.............｝。实体是实体类型的一个实例，在含义明确的情况下，实体、实体类型通常互换使用。 实体类型中的每个实体包含唯一标识它的一个或一组属性，这些属性称为实体类型的标识符（Identifier），如“学号”是学生实体类型的标识符，“姓名”、“出生日期”、“信址”共同组成“公民”实体类型的标识符。 有些实体类型可以有几组属性充当标识符，选定其中一组属性作为实体类型的主标识符，其他的作为次标识符。 第二章 PostgreSQL 数据库 PostgreSQL是以加州大学伯克利分校计算机系开发的开源的、免费的对象关系型数据库管理系统（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、外键、触发器、视图、事务完整性、MVCC。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、聚集函数、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。事实上， PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99，首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备， 比如 IP 类型和几何类型等；其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等， 同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。PostgreSQL安装核心是数据库服务端进程。它允许在一个独立服务器上。需要访问存储在数据库中的数据的应用程序必须通过数据库进程。这些客户端程序无法直接访问数据，即使它们和服务程序在同一台机器上。 2.1 PostgreSQL数据库简介 PostgreSQL 是一个自由的对象-关系数据库服务器（数据库管理系统），功能很强大。包括了可以说是目前世界上最丰富的数据类型的支持，比如 IP 类型和几何类型等等。PostgreSQL 真正诞生于二十世纪八十年代，它沿用了 ingres 很多的思想,  1995 年正式社区化了, PostgreSQL 从此诞生了。经过近 20 多年的持续开发和经验证的体系结构，PostgreSQL 在数据库领域已经赢得了良好的声誉。 PostgreSQL的源代码可以自由获取，它的授权是在非常自由的开源授权下，这种授权允许用户在各种开源或是闭源项目中使用、修改和发布PostgreSQL的源代码。用户对源代码的可以按用户意愿进行任何修改、改进。因此，PostgreSQL不仅是一个强大的企业级数据库系统，也是一个用户可以开发私用、网络和商业软件产品的数据库开发平台。 PostgreSQL是一种几乎可以运行在各种平台上的免费的开放源码的对象关系数据库管理系统，拥有与企业级数据库相媲美的特性，如完善的SQL标准支持、多版本并发控制、时间点恢复、表空间机制、异步复制、嵌套事务、在线/热备份、一个复杂的查询优化器、预写日志容错技术。它支持国际字符集、多字节字符编码、Unicode，并且对格式化、排序、大小写敏感提供本地化支持。PostgreSQL在管理大数据量方面有良好的可扩展性，对并发用户管理具有自适应性。现在已经出现具有管理超过4万亿字节数据能力的实用版本产品。 开放特性：PostgreSQL内置了丰富的数据类型，如任意精度的数值、无限制长度的文本、几何图元、IP地址、数组等；同时还允许用户定义基于正规SQL类型的新类型，让数据库自身理解复杂数据，自定义类型中还可以包含继承关系。用户可以为数据库内几乎所有的对象定义新的类型，如索引、操作符（可重载现有操作符）、聚集函数、数据域、数据类型转换、会话（编码转换）等。 可编程性：PostgreSQL同样拥有大量的编程接口供用户开发使用，如ODBC、JDBC（Java）、Libpq（C/C++）等。 可定制性：PostgreSQL拥有广泛的编程语言支持来实现函数功能，包括内置的PL/pgSQL过程语言，PL/Perl、plPHP、PL/Python、PL/Ruby、PL/Tcl等脚本语言，以及Java、C/C++等高级编程语言。函数的输出是一系列行类型的集合，可以在查询中当做表来使用，函数也可以被定义成以创建者或者调用者的身份运行。在其他的数据库产品中，函数也会被称为“存储过程”。 索引手段：用户可以自定义索引方法或者使用内置B-Tree索引、Hash表索引、GiST索引、GIN索引。GiST索引不是某种特定的索引类型，而是一种通用索引基础结构，可以在这种结构上实现很多不同的索引策略。PostgreSQL同时还支持如下功能：反向索引检索、表达式索引、部分索引、位图索引扫描。 多种身份认证方式：PostgreSQL中可以使用数据库用户/角色、操作系统、PAM、Kerberos等方式，根据主机配置文件（pg_hba.conf）中的设置执行对应的身份认证。 2.2 PostgreSQL 系统的基本体系结构 PostgreSQL 使用客户机/服务器（C/S）的模式提供服务，一个PostgreSQL会话由下列相关的进程（程序）组成： (1)一个服务器端进程。该进程管理数据库文件，接受客户端与数据库的连接，且代表客户端对数据库进行操作。该进程的程序名叫做 postgres。 (2)前端应用，即需要进行数据库操作的客户端应用。客户端应用可能本身就是多种多样的：它们可以是一个字符界  面的工具， 也可以是一个图形界面的应用，或者是一个通过访问数据库来显示网页的 web 服务器，或者是一个特殊的数据库管理工具。 一些客户端应用是和 PostgreSQL 发布一起提供的，但绝大部分是用户开发的。 和典型的客户端/服务器应用（C/S应用）一样，客户端和服务器可以在不同的主机上。此时，它们通过TCP/IP进行网络连接，你应该记住这一点，因为在客户机上可以访问的文件未必能够在数据库服务器机器上访问（或者只能用不同的文件名进行访问）。 PostgreSQL 服务器可以处理来自客户端的多个并发请求。为了能这样处理，它会为每个请求启动（“forks”）一个新的进程，然后，客户端和新服务器端进程就不再经过最初的postgres 进程而直接通信。 因此， 服务器端的主进程一直运行，等待着来自客户端的连接；而客户端和相关联的服务器端进程则在需要的时候才会运行。PostgreSQL数据库是一种极好可以运行在各种平台上的免费的开放源码的对象关系数据库，它是一种以关系数据库和SQL为基础，扩展了抽象数据类型，从而具备面向对象特性的数据库。 PostgreSQL由连接管理系统（系统控制器），编译执行系统，存储管理系统，事务系统，系统表五大部分组成。 连接管理系统接受外部操作对系统的请求，对操作请求进行预处理和分发，起系统逻辑控制作用；编译执行系统由查询编译器，查询执行器组成，完成操作请求在数据库中的分析处理和转化工作，最终实现物理存储介质中数据的操作；存储管理系统由索引管理器，内存管理器，外存管理器组成，负责存储和管理物理数据，提供对编译查询系统的支持；事务系统由事务管理器，日志管理器，并发控制，锁管理器组成，日志管理器和事务管理器完成对操作请求的事务一致性支持，锁管理器和并发控制提供对并发访问数据的一致性支持；系统表是PostgreSQL数据库的元信息管理中心，包括数据库对象信息和数据库管理控制信息。系统表管理元数据信息，将PostgreSQL数据库的各个模块有机地连接在一起，形成一个高效的数据管理系统。  图2-1 PostgreSQL体系结构图（组成结构和关系）  系统表： 在关系数据库中，为了实现数据库系统的控制，必须提供数据字典的功能。数据字典不仅存储各种对象的描述信息，而且存储系统管理所需的各种对象的细节信息。数据字典包含数据库系统中所有对象及其属性的描述信息，对象之间关系的描述信息，对象属性的自然语言含义以及数据字典变化的历史，数据字典是关系数据库系统管理控制信息的核心，在PostgreSQL数据库系统中系统表扮演着数据字典的角色。系统表是PostgreSQL数据库存放结构元数据的地方，他在PostgreSQL中表现为存放有系统信息的普通表或者视图（用户可以删除，重建）。系统表保存了数据库的所有元数据，所以系统运行时对系统表的访问是非常频繁的。为了提高系统性能，在内存中建立了共享的系统表，使用Hash表提高查询效率。 2.3 pgadmin4  pgadmin4是一款可以让您编辑SQL的软件，您可以在软件上找到编辑器，并从本地添加需要修改的文件，从而完成数据库基本信息管理以及文本修改，本软件是国外设计的，发行到中国以后官方已经添加了中文简体版本，用户只需要在设置界面上找到杂项中的语言设置窗口，就可以转换到中文界面；PostgreSQL数据库管理工具同时提供了十二种管理工具，支持维护、备份、SQL查询、演示WAL、添加新的数据还原点等，功能非常强大！ 软件功能包括广泛的文档、pgAdmin应用程序文档、PostgreSQL文档链接；多个部署模型、桌面模式，使用专门构建的运行时、服务器模式，通过网络支持多个用户；颜色语法高亮查询工具、用于显示/输入数据的快速数据网格、图形查询计划显示、授予向导以快速更新ACL、程序语言调试器（支持pl / pgsql和edb-spl）；自动真空管理、监视仪表板、备份，恢复，真空和需求分析、SQL / shell /批处理作业调度代理、创建，查看和编辑所有常见的PostgreSQL对象。 软件特色： pgAdmin4具有自己专属的SQL编辑器；可以在软件上直接查询SQL的信息；在连接到数据库以后可以自动分析需要的数据；在查询的时候会通知用户具体的SQL内容；可以显示查询内容时间长度；可以显示指定秒数通知程序；支持缓冲区的信息提示在桌面上；支持详细的pgAdmin4数据报告；支持查询SQL的代价信息标注。  pgAdmin导航菜单功能:  1).文件菜单:在文件菜单中当点击服务器根节点下某个节点时可以更改连接密码。 2).编辑菜单: 点击编辑菜单可以对数据库和对象做相应的操作。(右键所选对象相当于编辑中所有相关功能) 3).插件: 启动psql控制台并连接到在pgAdmin中所选的数据库。可以输入相应的命令。 4).视图: 用来调节页面视图的显示。例如：打开与关闭SQL窗口。 5.工具: 在主窗体左面的对象树中点击不同的节点　工具中菜单的高亮显示可做相应的操作。(所选对象右键操作可达到相同效果但工具中可以打开查询工具)。 6).帮助: 可以查看帮助文档 五、实验内容 使用pgAdmin4数据库开发工具对图书借阅管理系统数据库进行数据库管理，并完成数据库备份/恢复处理，具体实验内容如下: 图书借阅管理系统数据库拥有者用户（Library_Manager）创建 图书借阅管理系统数据库角色创建 图书借阅管理系统模式（Schema）创建 图书借阅管理系统数据库角色权限设置 图书借阅管理系统数据库其他用户创建与角色分派 图书借阅管理系统用户的数据库对象访问 在实验计算机上，利用pgAdmin4数据库系统工具，完成图书借阅管理系统数据库管理与维护，同时记录实验过程的规划、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin4数据库系统工具开展图书借阅管理系统数据库管理与维护，其步骤如下：   1）创建数据库拥有者用户Library_Manager 2）创建Library数据库 3）创建图书借阅管理系统数据库客户、经理角色 4）分派创建角色的权限 5）创建图书借阅管理系统用户 6）分派创建用户的角色 7）验证创建用户的数据库对象访问权限 8）数据库备份管理 9）数据库恢复管理 八、实验数据及结果分析 创建数据库拥有者用户Library_Manager，其角色为superuser.（与实验一同） 在Windows操作系统中，启动pgAdmin4工具运行。并使用pgAdmin4创建登录/组角色Library_Manager 创建数据库Library 使用pgAdmin4工具创建数据库Library，Owner为Library_Manager 创建图书借阅管理系统数据库客户、经理角色 在实际应用中，可以由DBA按业务需要创建用户自定义角色。在系统的用户管理中，通常会把多个用户赋予一个组，这样在设置权限时只需给该组设置即可，撤销权限时也是从该组撤消。在PostgreSQL中，首先需要创建一个代表组的角色，之后再将该角色的membership权限赋给独立的用户角色即可，按实验要求，我们需要两个组角色，分别为数据库经理Manager和客户Reader， 分派创建角色的权限     数据库对象在被创建时都会被赋予一个所有者，通常而言，所有者就是执行对象创建语句的角色。对于大多数类型的对象，其初始状态是只有所有者(或超级用户)可以对该对象做任何事情。如果要允许其它用户可以使用该对象，必须赋予适当的权限。  在本实验中，经理(Manager)角色对数据库方案中所有表拥有Insert、Delete、Update、Select操作权限，而客户（Reader）角色对数据库方案中部分数据表（如BOOK、READER）具有Insert、Delete、Update、Select操作权限。   其次为客户Reader赋予BOOK和READER的相应权限   为新建用户授予自定义角色 在此前，分别创建了系统自定义角色manager和reader。现可以将这些自定义角色授予新用户。 本实验将创建一个新用户“user1”，并给他赋予“reader”角色。在“登录/组角色”右键，点击“创建”再点击“登录/组角色”    选中组角色reader，点击右键，选中“属性”选项。在出现的界面中点击“成员”，并选择user1成员，点击保存     查询user1用户的数据库访问权限 首先查询reader角色的权限          PostgreSQL中，Inherit表示组角色reader的任何一个成员角色都将自动继承除“超级用户权限”外的所有权限   九、总结及心得体会 通过本次实验，熟悉了典型的数据库管理工具使用，掌握了应用系统的数据库管理技术与方法，如数据库角色管理、用户管理、权限管理、数据库备份与恢复等系统管理操作，以及完成数据库对象操作访问。这些虽然在课堂中都有所学到，但是没有实际操作过。本次实验给我们了一次实际操作的机会，巩固了所学知识。 ",
  "studentID": "2017221102005"
 },
 "64": {
  "content": "  电子科技大学信息与软件工程学院    实 验 报 告    学    号       2017221102010\t                姓    名      刘行亮                 （实验）\t课程名称      数据库原理与应用                 理论教师      文军                 实验教师      文军                     电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：刘行亮\t\t学号：2017221102010         指导教师：文军   实验地点：信软303     实验时间：2019.6.21  一、实验一：图书销售管理系统数据库 SQL 应用编程二、实验室名称：\t实验时间： 三、实验目的 针对图书销售管理数据库开发，了解 SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的 SQL 数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行 SQL 编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行 SQL 创建图书销售管理系统数据库 BookSale。 2.在数据库 BookSale 中，执行 SQL 创建数据库表、视图、索引等对象。 3.在数据库 BookSale 中，执行 SQL 进行数据增、删、查、改访问操作。 4. 在 数 据 库 BookSale 中 ， 采 用 PL/pgSQL 语 言 编 写 存 储 过 程 函 数 Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库 BookSale 中，采用 PL/pgSQL 语言编写过程语句块，实现对存储过程函数 Pro_CurrentSale 的调用，并输出统计结果。 6.在数据库 BookSale 中，采用 PL/pgSQL 语言编写编写图书销售表 Insert 触  发器Tri_InsertSale，实现图书库存数据同步修改处理。                     7.在数据库 BookSale 中，对图书销售表 Insert 触发器 Tri_InsertSale 程序进行 功能验证。 8.在数据库 BookSale 中，创建存储过程函数实现图书销售数量和金额统计。在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL、PL/pgSQL 语言， 完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管 理 工 具 ：      pgAdmin4 DBMS 系统： PostgreSQL 11 七、实验步骤 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。  八、实验数据及结果分析 创建 BookSale 数据库 实现思路与方法：使用 SQL 语句来进行数据库的创建。 SQL 语句：create database \"BookSale\" 运行操作界面如图 1-1 所示。         图 1-1 创建数据库 数据库操作结果面如图 1-2 所示。     图 1-2 数据库创建完成 结果分析：成功创建数据库。 创建各数据库表以及表中主外键和索引 实现思路与方法：首先明确图书销售管理系统的实体、实体属性以及各实体之间的联系，再通过 SQL 语句对表进行创建，表对应实体，实体属性对应表中的列，通过主外键来将表联系起来。 SQL 语句： create table Auther ( AU_ID\tCHAR(18)\tnot null, AU_Name\tVARCHAR(20)\tnot null,  AU_Gender\tCHAR(2)\tnot null, AU_Phone\tVARCHAR(11)\tnot null, AU_Address\tVARCHAR(50)\tnot null, constraint PK_AUTHER primary key (AU_ID) ); create table Book ( constraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER ( CUST_ID\tCHAR(18)\tnot null, CUST_Name\tVARCHAR(20)\tnot null, CUST_Phone\tVARCHAR(15) not null, CUST_Address    VARCHAR(50)     not null, CUST_Email\tVARCHAR(50) not null, constraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher ( PUB_ID\tCHAR(11)\tnot null, PUB_Name\tVARCHAR(20)          not null, PUB_Phone\tVARCHAR(15) not null, PUB_Address     VARCHAR(50)     not null, constraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale ( constraint PK_SALE primary key (SALE_ID) ); create table Stock ( Stock_ID\tVARCHAR(10)\tnot null,  constraint PK_STOCK primary key (Stock_ID) ); alter table Book add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) references Auther (AU_ID) on delete restrict on update restrict; alter table Book add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) references Publisher (PUB_ID) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_CUSTOMER CUSTOMER foreign key (CUST_ID) references CUSTOMER (CUST_ID) on delete restrict on update restrict; alter table Stock add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict;  将上面的 SQL 程序，提交到数据库服务器执行，其执行作界面如图 1-3 所示。  图 1-3 创建数据库表 SQL 程序执行结果  当 SQL 程序成功执行后，可以在数据库看到新添加的数据库表对象，如图 1-4 所示。  图 1-4 图书销售数据库表对象 结果分析：成功创建各数据库表。  插入样本数据并对 publisher 表进行增删查改操作 实现思路与方法：首先准备样本数据，尽可能使得数据符合实际应用并且要能满足后续的数据处理操作。这里以 publisher 表为例，给出该表的数据增、删、查、改 SQL 语句操作访问。 1）执行 SQL 语句，插入样本数据到图书销售数据库 Insert into Auther values('330309198504150527','王天','男','13554874593','四川省成都市成华区建设北路二段十号'); Insert into Auther values('540135199103281548','叶无双','男','15812387538','浙江省杭州市天路区梅田路二十八号'); Insert into Auther values('120857198811123587','李婷','女','18575615472','北京市朝阳区梅山路二巷八号 '); Insert into PUBLISHER values('PUB00000001','高等教育出版社','010-65321854','北京'); Insert into PUBLISHER values('PUB00000002','电子工业出版社','010-65329857','北京'); Insert into PUBLISHER values('PUB00000003','人民邮电出版社','010-65325987','北京'); Insert into BOOK values('9787115502742','330309198504150527','PUB00000001','Web 前端开发最佳实践 ','2016-01-01', '59','IT 技术','100'); Insert into BOOK values('9875325415577','540135199103281548','PUB00000002','Java EE Web 编 程  ','2008-01-01', '52','IT 技术','200'); Insert into BOOK values('9865365975234','120857198811123587','PUB00000003',' 数 据 库 实 验 指 导 ','2013-08-1','29','IT 技术', '150'); Insert into customer values('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insert into customer values('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十九号','657873215@qq.com'); Insert into customer values('542244197812121687','鲁丽','13615869875','北京市朝阳区梅山路二巷十六号','647864378@qq.com'); 样本数据插入 SQL 程序的运行操作界面如图 1-5 所示。 图 1-5 插入样本数据 SQL 程序执行 查看 publisher 表数据的 SQL 语句如下： select * from publiser; 运行该 SQL 语句，其执行结果如图 1-6 所示。      图 1-6 查询 publisher 表数据  结果分析：插入表数据成功无误。  2）增加一条数据到 publisher 表 SQL 语 句 ： Insert into PUBLISHER values('PUB00000004',' 清 华 大 学 出 版 社 ','010-65323169','北京'); 运行操作界面如图 1-7 所示。     执行结果如图 1-8 所示。 \n图 1-7 插入一条新数据到 publisher 表     图 1-8 查询插入新数据之后的 publisher 表 结果分析：插入表数据成功。  3）删除一条 publisher 表数据 SQL 语句：delete from publisher where pub_id = 'PUB00000004'; 运行操作界面如图 1-9 所示。    图 1-9 删除 publisher 表的一条数据 其执行结果如图 1-10 所示。       图 1-10 查询删除数据后的 publisher 表 结果分析：确实删除掉了对应的 pub_id 的数据，删除操作执行成功。  4）修改一条 publisher 表数据 SQL 语句：update publisher set pub_address = '南京' where pub_id = 'PUB00000003'; 该语句运行操作结果如图 1-11 所示。  图 1-11 更新 publisher 表的一条数据 再对 piblisher 进行查询，其执行结果如图 1-12 所示。    图 1-12 查询更新数据后的 publisher 表 结果分析：对应 pub_id 的数据确实被成功修改。  4.创建视图 实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数据查询。创建完视图之后可用 select 语句来查看视图，用法：select * from 视图名。例如，创建视图 BOOK_AUTHER_PUBLISHER 实现图书信息查询，其 SQL 语句如下： create view BOOK_AUTHER_PUBLISHER as select B.book_name as \"图书\",AU.au_name as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\" from book as B join auther as AU on B.au_id = AU.au_id join publisher as PU on B.pub_id = PU.pub_id  该 SQL 运行操作结果如图 1-13 所示：      图 1-13  创建视图 采用如下 SQL 语句实现视图数据查询： select * from BOOK_AUTHER_PUBLISHER; 该 SQL 语句执行结果如图 1-14 所示。   图 1-14  查看视图 结果分析：视图展示数据对应正确且按需展示，视图创建成功。  5.创建触发器函数 实现思路与方法：创建触发器函数实现在有一条销售数据插入 sale 表时，同时在库存表 stock 中插入图书的库存变化记录，并修改对应图书表 book 的库存数，为后续的创建触发器提供函数方法。 创建触发器函数 SQL 语句： CREATE OR REPLACE FUNCTION InsertSale() RETURNS TRIGGER AS $$ BEGIN IF (TG_OP = 'INSERT') THEN INSERT INTO stock values(new.sale_id,new.book_isbn,new.sale_qty,' 出 库 ',new.sale_date); update book set book.book_stock = book.book_stock - new.sale_qty where book.book_isbn = new.book_isbn; RETURN NEW;     END; \nEND IF; RETURN NULL;  $$ LANGUAGE plpgsql; 运行操作界面如图 1-15 所示。 图 1-15  创建触发器函数  创建触发器 实现思路与方法：创建触发器，关联销售表，在销售表插入一个新数据之后， 执行上一步编写的触发器函数。 创建触发器 SQL 语句： CREATE TRIGGER Tri_InsertSale AFTER INSERT ON SALE FOR EACH ROW EXECUTE PROCEDURE InsertSale();  运行操作界面如图 1-16 所示。    测试触发器 \n图 1-16 创建触发器  实现思路与方法：在销售表中插入几个样本数据，之后再查看库存表和图书 表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插入销售表的数据一致。 测试触发器 SQL 语句： Insert into sale values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885'); Insert into sale values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040'); Insert into sale values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450');  运行操作界面如图 1-17 所示。  图 1-17  测试触发器 结果展示，查看 stock 表数据以及对比 book 表数据。  Stock 表数据如图 1-18 所示。 图 1-18 查看测试触发器之后的 stock 表数据 Book 表之前的数据如图 1-19 所示。    图 1-19  查看 book 表在测试触发器之前的数据  触发器执行之后的 book 表数据如图 1-20 所示。     结果分析： \n图 1-20  查看 book 表在测试触发器之后的数据  Stock 表本来没有数据，在 sale 插入数据之后，将库存数据进行记录，记录数据 正确，同时更新了 book 表中各对应图书的库存量，更新数据正确，触发器功能实现正确。  创建存储过程 实现思路与方法：通过存储过程实现某日图书销售数量和金额统计。创建存储过程的 SQL 语句如下。  CREATE OR REPLACE FUNCTION countsale(OUT amount int,OUT allmoney money) as $count$ BEGIN select sum(sale_qty) into amount FROM sale WHERE sale_date = '2019-05-20'; select sum(sale_amount) into allmoney FROM sale WHERE sale_date = '2019-05-20'; END; $count$ LANGUAGE plpgsql; 该 SQL 语句运行操作界面如图 1-21 所示。         调用存储过程 \n图 1-21  创建存储过程  实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况 一致，调用存储过程 SQL 语句如下： Select * from countsale() 存储过程调用语句执行结果如图 1-22 所示。 图 1-22  调用存储过程 结果分析：调用存储过程输出的总销售量和总金额数据正确，存储过程功能正确。  总结及心得体会 初步熟悉了SQL编程，对数据库原理及应用有了更深的认识。  电\t子\t科\t技\t大\t学 实\t验\t报\t告  一、实验二：图书销售管理系统数据库安全管理  二、实验室名称：\t实验时间：  三、实验目的 了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  4.在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。 5.分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL 语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。 3. 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析 1.针对图书销售管理系统，设计数据存取权限控制模型。 实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家， 客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水  信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以对库存表只有查看权限。他们的数据库存取访问权限控制模型设计如图 2-1 与图 2-2 所示。   图 2-1 客户角色安全模型         2.创建客户角色和商家角色 \n图 2-2 商家角色安全模型  实现思路与方法：使用 SQL 语句进行角色创建，因为客户角色和商家角色 都是普通角色，因此除了登录的功能之外其他的高级权限都为 no。创建客户角色的 SQL 语句： CREATE ROLE \"R_Customer\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1 创建客户角色的 SQL 运行界面如图 2-3 所示。   图 2-3 创建客户角色 创建商家角色的 SQL 语句： CREATE ROLE \"R_Seller\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1  创建商家角色的运行界面如图 2-4 所示。 图 2-4 创建商家角色 创建两个角色的结果展示如图 2-5 所示。 图 2-5 完成创建两个角色 结果分析：在角色用户表中看到 R_Customer,R_Seller，角色创建成功。  3.赋予客户、商家角色权限 实现思路与方法：使用 SQL 语句给两个角色赋予在步骤 1 定义的权限。赋予客户角色 SQL 语句： GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON auther TO \"R_Customer\"; GRANT SELECT ON publisher TO \"R_Customer\";  运行界面如图 2-6 所示。    图 2-6 赋予客户角色权限  赋予商家角色 SQL 语句： GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\"; GRANT SELECT ON stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\";  运行界面如图 2-7 所示。      图 2-7 赋予商家角色权限  结果分析：权限赋予成功。  4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 实现思路与方法：使用 SQL 语句创建用户，并将对应的角色赋予他们。其 SQL 语句如下。 CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '123456';   CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456';  SQL 运行界面如图 2-8 所示。         运行结果如图 2-9 所示。 \n图 2-8 创建两个用户    图 2-9 完成创建两个用户 结果分析：在角色用户表中发现 U_Customer,U_Seller，创建用户成功。  5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功。 实现思路与方法：用客户用户和商家用户进行登录，通过对各表进行增删查改操作来观察操作结果来验证是否与赋予他们的权限一致。 首先我们来登录客户用户来进行测试。登录客户用户如图 2-10 所示。  图 2-10  登录客户用户  测试一：查看 book 表 SQL 语句：select * from book 运行界面和结果展示如图 2-11 所示。      图 2-11 客户用户查看 book 表数据  结果分析：客户用户可查看 book 表，权限正确。  测试二：删除 book 表中的数据 SQL 语句：delete from book where book_isbn = '9787115502742' 运行界面和结果展示如图 2-12 所示：     图 2-12  客户用户删除 book 表数据 结果分析：删除失败，客户用户不具有删除 book 表中数据的权限，权限正确。  测试三：查看 auther 表 SQL 语句：select * from auther 运行界面和结果展示如图 2-13 所示。   图 2-13 客户用户查看 auther 表 结果分析：客户用户可查看 auther 表，权限正确。  测试四：插入一条数据到 auther 表中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-14 所示。 图 2-14 客户用户插入一条新数据到 auther 表 结果分析：客户用户无法在 auther 表中插入数据，权限正确。  测试五：查看 sale 表 SQL 语句：select * from sale 运行界面如图 2-15 所示。 图 2-15 客户用户查看 sale 表  结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过， 测试客户用户的权限正确。 测试完客户用户之后，我们登录商家用户来进行下一步的测试。登录商家用户如图 2-16 所示。    测试一：查看 customer \n图 2-16  登录商家用户  SQL 语句：select * from customer 运行界面和结果展示如图 2-17 所示。 图 2-17 商家用户查看 customer 表 结果分析：商家用户具有查看客户表的权限，权限正确。  测试二：插入一条数据到 auther 中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-18 所示。    图 2-18  商家用户插入一条新数据到 auther 表 通过查看 auther 表进行结果展示如图 2-19 所示。   图 2-19 商家用户查询插入一条新数据后的 auther 表 结果分析：auther 表中新增了如上插入的数据，商家用户具有插入 auther 表数据的权限，权限正确。  测试三：从    stock        表中删除一条数据SQL 语句：delete from stock where stock_id = 'SA00001' 运行界面如图 2-20 所示。 图 2-20 商家用户删除一条 stock 表数据 结果分析：商家用户不具有删除 stock 表数据的权限，权限正确。  测试四：更新 sale 表的一条数据 SQL 语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001' 运行界面如图 2-21 所示。  图 2-21 商家用户更新一条 sale 表数据 结果展示，通过查看 sale 来查看结果如图 2-22 所示。    图 2-22 商家用户查看 sale 表数据 结果分析：sale 表中对应的数据被修改正确，商家用户具有修改 sale 数据的权限，权限正确。通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确。  九、总结及心得体会 对数据库的安全性有了更深的了解与体会，更加熟练运用admin4的相关功能。",
  "studentID": "2017221102010"
 },
 "65": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼306\t\t\t\t\t           实验时间：2019.6.10      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 第一章 数据库系统分析与设计建模 1.1 概念数据模型概述 针对数据库系统开发，一个很重要的工作就是建立该系统的数据模型。所谓数据模型是指现实世界中数据对象特征、数据对象关系及其约束的描述形式。数据模型一般由数据结构、数据操作、数据约束三部分组成。数据库应用开发需要建模的数据模型有三个层次： 1）概念数据模型――面向用户的业务数据对象及其联系 2）逻辑数据模型――面向设计者的系统数据对象逻辑表示及其联系 3）物理数据模型――面向开发者的系统数据对象存储结构形式 概念数据模型（CDM，Concept Data Model）也称信息模型。该模型主要以实体－联系(Entity-RelationShip,简称E-R)理论为基础，采用E-R模型图来描述应用系统的数据对象和数据关系，主要用于数据库系统分析建模。 CDM有一组严格定义的模型元素集合，这些模型元素精确地描述了系统的静态特性、动态特性以及完整性约束条件等，其中包括了数据结构、数据操作和完整性约束三部分。 1）数据结构表达为实体和属性; 2）数据操作表达为实体中的记录的插入、删除、修改、查询等操作; 3）完整性约束表达为数据的自身完整性约束（如数据类型、检查、规则等）和数据间的参照完整性约束（如联系、继承联系等）。 1.2 实体、属性及标识符的定义 实体（Entity），也称为实例，对应现实世界中可区别于其他对象的“事件”或“事物”。例如，学校中的每个学生，医院中的每个手术。 每个实体都有用来描述实体特征的一组性质，称之为属性，一个实体由若干个属性来描述。如学生实体可由学号、姓名、性别、出生年月、所在系别、入学年份等属性组成。 实体集（EntitySet）是具体相同类型及相同性质实体的集合。例如学校所有学生的集合可定义为“学生”实体集，“学生”实体集中的每个实体均具有学号、姓名、性别、出生年月、所在系别、入学年份等性质。 实体类型（EntityType）是实体集中每个实体所具有的共同性质的集合，例如“患者”实体类型为：患者｛门诊号，姓名，性别，年龄，身份证号.............｝。实体是实体类型的一个实例，在含义明确的情况下，实体、实体类型通常互换使用。 实体类型中的每个实体包含唯一标识它的一个或一组属性，这些属性称为实体类型的标识符（Identifier），如“学号”是学生实体类型的标识符，“姓名”、“出生日期”、“信址”共同组成“公民”实体类型的标识符。 有些实体类型可以有几组属性充当标识符，选定其中一组属性作为实体类型的主标识符，其他的作为次标识符。 第二章 PostgreSQL 数据库 PostgreSQL是以加州大学伯克利分校计算机系开发的开源的、免费的对象关系型数据库管理系统（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、外键、触发器、视图、事务完整性、MVCC。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、聚集函数、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。事实上， PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99，首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备， 比如 IP 类型和几何类型等；其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等， 同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。PostgreSQL安装核心是数据库服务端进程。它允许在一个独立服务器上。需要访问存储在数据库中的数据的应用程序必须通过数据库进程。这些客户端程序无法直接访问数据，即使它们和服务程序在同一台机器上。 2.1 PostgreSQL数据库简介 PostgreSQL 是一个自由的对象-关系数据库服务器（数据库管理系统），功能很强大。包括了可以说是目前世界上最丰富的数据类型的支持，比如 IP 类型和几何类型等等。PostgreSQL 真正诞生于二十世纪八十年代，它沿用了 ingres 很多的思想,  1995 年正式社区化了, PostgreSQL 从此诞生了。经过近 20 多年的持续开发和经验证的体系结构，PostgreSQL 在数据库领域已经赢得了良好的声誉。 PostgreSQL的源代码可以自由获取，它的授权是在非常自由的开源授权下，这种授权允许用户在各种开源或是闭源项目中使用、修改和发布PostgreSQL的源代码。用户对源代码的可以按用户意愿进行任何修改、改进。因此，PostgreSQL不仅是一个强大的企业级数据库系统，也是一个用户可以开发私用、网络和商业软件产品的数据库开发平台。 PostgreSQL是一种几乎可以运行在各种平台上的免费的开放源码的对象关系数据库管理系统，拥有与企业级数据库相媲美的特性，如完善的SQL标准支持、多版本并发控制、时间点恢复、表空间机制、异步复制、嵌套事务、在线/热备份、一个复杂的查询优化器、预写日志容错技术。它支持国际字符集、多字节字符编码、Unicode，并且对格式化、排序、大小写敏感提供本地化支持。PostgreSQL在管理大数据量方面有良好的可扩展性，对并发用户管理具有自适应性。现在已经出现具有管理超过4万亿字节数据能力的实用版本产品。 开放特性：PostgreSQL内置了丰富的数据类型，如任意精度的数值、无限制长度的文本、几何图元、IP地址、数组等；同时还允许用户定义基于正规SQL类型的新类型，让数据库自身理解复杂数据，自定义类型中还可以包含继承关系。用户可以为数据库内几乎所有的对象定义新的类型，如索引、操作符（可重载现有操作符）、聚集函数、数据域、数据类型转换、会话（编码转换）等。 可编程性：PostgreSQL同样拥有大量的编程接口供用户开发使用，如ODBC、JDBC（Java）、Libpq（C/C++）等。 可定制性：PostgreSQL拥有广泛的编程语言支持来实现函数功能，包括内置的PL/pgSQL过程语言，PL/Perl、plPHP、PL/Python、PL/Ruby、PL/Tcl等脚本语言，以及Java、C/C++等高级编程语言。函数的输出是一系列行类型的集合，可以在查询中当做表来使用，函数也可以被定义成以创建者或者调用者的身份运行。在其他的数据库产品中，函数也会被称为“存储过程”。 索引手段：用户可以自定义索引方法或者使用内置B-Tree索引、Hash表索引、GiST索引、GIN索引。GiST索引不是某种特定的索引类型，而是一种通用索引基础结构，可以在这种结构上实现很多不同的索引策略。PostgreSQL同时还支持如下功能：反向索引检索、表达式索引、部分索引、位图索引扫描。 多种身份认证方式：PostgreSQL中可以使用数据库用户/角色、操作系统、PAM、Kerberos等方式，根据主机配置文件（pg_hba.conf）中的设置执行对应的身份认证。 2.2 PostgreSQL 系统的基本体系结构 PostgreSQL 使用客户机/服务器（C/S）的模式提供服务，一个PostgreSQL会话由下列相关的进程（程序）组成： (1)一个服务器端进程。该进程管理数据库文件，接受客户端与数据库的连接，且代表客户端对数据库进行操作。该进程的程序名叫做 postgres。 (2)前端应用，即需要进行数据库操作的客户端应用。客户端应用可能本身就是多种多样的：它们可以是一个字符界  面的工具， 也可以是一个图形界面的应用，或者是一个通过访问数据库来显示网页的 web 服务器，或者是一个特殊的数据库管理工具。 一些客户端应用是和 PostgreSQL 发布一起提供的，但绝大部分是用户开发的。 和典型的客户端/服务器应用（C/S应用）一样，客户端和服务器可以在不同的主机上。此时，它们通过TCP/IP进行网络连接，你应该记住这一点，因为在客户机上可以访问的文件未必能够在数据库服务器机器上访问（或者只能用不同的文件名进行访问）。 PostgreSQL 服务器可以处理来自客户端的多个并发请求。为了能这样处理，它会为每个请求启动（“forks”）一个新的进程，然后，客户端和新服务器端进程就不再经过最初的postgres 进程而直接通信。 因此， 服务器端的主进程一直运行，等待着来自客户端的连接；而客户端和相关联的服务器端进程则在需要的时候才会运行。PostgreSQL数据库是一种极好可以运行在各种平台上的免费的开放源码的对象关系数据库，它是一种以关系数据库和SQL为基础，扩展了抽象数据类型，从而具备面向对象特性的数据库。 PostgreSQL由连接管理系统（系统控制器），编译执行系统，存储管理系统，事务系统，系统表五大部分组成。 连接管理系统接受外部操作对系统的请求，对操作请求进行预处理和分发，起系统逻辑控制作用；编译执行系统由查询编译器，查询执行器组成，完成操作请求在数据库中的分析处理和转化工作，最终实现物理存储介质中数据的操作；存储管理系统由索引管理器，内存管理器，外存管理器组成，负责存储和管理物理数据，提供对编译查询系统的支持；事务系统由事务管理器，日志管理器，并发控制，锁管理器组成，日志管理器和事务管理器完成对操作请求的事务一致性支持，锁管理器和并发控制提供对并发访问数据的一致性支持；系统表是PostgreSQL数据库的元信息管理中心，包括数据库对象信息和数据库管理控制信息。系统表管理元数据信息，将PostgreSQL数据库的各个模块有机地连接在一起，形成一个高效的数据管理系统。  图2-1 PostgreSQL体系结构图（组成结构和关系）  系统表： 在关系数据库中，为了实现数据库系统的控制，必须提供数据字典的功能。数据字典不仅存储各种对象的描述信息，而且存储系统管理所需的各种对象的细节信息。数据字典包含数据库系统中所有对象及其属性的描述信息，对象之间关系的描述信息，对象属性的自然语言含义以及数据字典变化的历史，数据字典是关系数据库系统管理控制信息的核心，在PostgreSQL数据库系统中系统表扮演着数据字典的角色。系统表是PostgreSQL数据库存放结构元数据的地方，他在PostgreSQL中表现为存放有系统信息的普通表或者视图（用户可以删除，重建）。系统表保存了数据库的所有元数据，所以系统运行时对系统表的访问是非常频繁的。为了提高系统性能，在内存中建立了共享的系统表，使用Hash表提高查询效率。 2.3 pgadmin4  pgadmin4是一款可以让您编辑SQL的软件，您可以在软件上找到编辑器，并从本地添加需要修改的文件，从而完成数据库基本信息管理以及文本修改，本软件是国外设计的，发行到中国以后官方已经添加了中文简体版本，用户只需要在设置界面上找到杂项中的语言设置窗口，就可以转换到中文界面；PostgreSQL数据库管理工具同时提供了十二种管理工具，支持维护、备份、SQL查询、演示WAL、添加新的数据还原点等，功能非常强大！ 软件功能包括广泛的文档、pgAdmin应用程序文档、PostgreSQL文档链接；多个部署模型、桌面模式，使用专门构建的运行时、服务器模式，通过网络支持多个用户；颜色语法高亮查询工具、用于显示/输入数据的快速数据网格、图形查询计划显示、授予向导以快速更新ACL、程序语言调试器（支持pl / pgsql和edb-spl）；自动真空管理、监视仪表板、备份，恢复，真空和需求分析、SQL / shell /批处理作业调度代理、创建，查看和编辑所有常见的PostgreSQL对象。 软件特色： pgAdmin4具有自己专属的SQL编辑器；可以在软件上直接查询SQL的信息；在连接到数据库以后可以自动分析需要的数据；在查询的时候会通知用户具体的SQL内容；可以显示查询内容时间长度；可以显示指定秒数通知程序；支持缓冲区的信息提示在桌面上；支持详细的pgAdmin4数据报告；支持查询SQL的代价信息标注。  pgAdmin导航菜单功能:  1).文件菜单:在文件菜单中当点击服务器根节点下某个节点时可以更改连接密码。 2).编辑菜单: 点击编辑菜单可以对数据库和对象做相应的操作。(右键所选对象相当于编辑中所有相关功能) 3).插件: 启动psql控制台并连接到在pgAdmin中所选的数据库。可以输入相应的命令。 4).视图: 用来调节页面视图的显示。例如：打开与关闭SQL窗口。 5.工具: 在主窗体左面的对象树中点击不同的节点　工具中菜单的高亮显示可做相应的操作。(所选对象右键操作可达到相同效果但工具中可以打开查询工具)。 6).帮助: 可以查看帮助文档 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 图书借阅管理系统数据库方案创建及配置。 图书借阅管理系统数据库方案中创建数据库对象（表、视图、索引、序列等）的SQL操作。 图书借阅管理系统数据库表的数据增、删、查、改SQL操作。 图书借阅管理系统数据库的触发器编程，以实现业务规则数据处理。 图书借阅管理系统数据库的存储过程编程，以实现数据库后端数据处理。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin数据库系统工具开展图书借阅管理系统数据库操作访问，其步骤如下：   1）使用pgAdmin4创建一个小型图书馆数据库library。 2）在library数据库中，通过执行SQL语句创建图书借阅管理系统数据库的表、视图、索引、序列等对象。 3）图书借阅管理系统数据库表中，通过执行SQL语句实现数据增、删、查、改SQL操作。 4）在library数据库中，通过执行SQL语句实现图书借阅管理系统数据库的触发器，以实现业务规则（如依据图书借阅数据对图书库存数据进行同步修改）数据处理。 5）在library数据库中，通过执行SQL语句实现图书借阅管理系统数据库的存储过程，以实现数据库后端数据（如图书借阅统计）处理。 八、实验数据及结果分析 1.图书管理系统数据库Library创建操作  在Windows操作系统中，启动pgAdmin4工具运行。并使用pgAdmin4创建登录/组角色Library_Manager      创建数据库    2. 在图书销售管理系统数据库Library中创建数据库表、视图、索引等对象  创建表：          代码如下    插入数据操作    创建表reader的视图        代码：  查看视图及结果：   插入book数据   数据修改操作        数据查询 假定需要查找数据库实验图书，可编写如下查询SQL语句： SELECT * FROM \"BOOK\" WHERE BOOK_NAME LIKE '数据库实验%';   4.创建触发器 在Library中，通过创建数据库触发器实现特定业务规则，如依据借阅图书数量自动对该图书的库存数量进行处理。为此,需要在图书表BOOK上创建一个Insert触发器，在该触发器程序中完成对BOOK表中BOOK_STORE数据修改处理。实现该功能的触发器函数的SQL程序如下：    创建触发器BORROW_BOOK    为了验证该触发器是否能正确工作，可进行如下测试： 1）查询图书（图书编号为“P00006”）的当前库存  2）假定现在有同学借阅图书编号为“P00006”图书，其SQL语句执行结果 3）重新查询图书（图书编号为“P00006”）的当前库存  重新查询图书（编号为“P00006”）的当前库存为17，比销售前少了5本，即表明触发器程序已经正确执行。  5.存储过程创建 在Library中，通过执行SQL语句实现图书借阅管理系统数据库的存储过程，以实现数据库后端数据（如图书借阅总数目统计）处理。例如，实现一个过程程序统计图书借阅数量统计，该过程程序有一个输入参数：日期，输出结果为该日期销售图书的总销售量。             九、总结及心得体会 通过本次实验，更加深刻学习了如何创建数据库、如何建立视图、索引，更加了解了数据库SQL语言中函数语句如何创建，触发器如何创建以及去检查触发器是否创建成功运行，存储过程的创建。总的来说本次实验还是让我学到了很多东西，最重要的是巩固了上课所学到的知识，把上课所学付诸实践，真正写了代码才有所收获。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼306  \t\t\t\t\t     实验时间：2019.6.17    三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 第一章 数据库系统分析与设计建模 1.1 概念数据模型概述 针对数据库系统开发，一个很重要的工作就是建立该系统的数据模型。所谓数据模型是指现实世界中数据对象特征、数据对象关系及其约束的描述形式。数据模型一般由数据结构、数据操作、数据约束三部分组成。数据库应用开发需要建模的数据模型有三个层次： 1）概念数据模型――面向用户的业务数据对象及其联系 2）逻辑数据模型――面向设计者的系统数据对象逻辑表示及其联系 3）物理数据模型――面向开发者的系统数据对象存储结构形式 概念数据模型（CDM，Concept Data Model）也称信息模型。该模型主要以实体－联系(Entity-RelationShip,简称E-R)理论为基础，采用E-R模型图来描述应用系统的数据对象和数据关系，主要用于数据库系统分析建模。 CDM有一组严格定义的模型元素集合，这些模型元素精确地描述了系统的静态特性、动态特性以及完整性约束条件等，其中包括了数据结构、数据操作和完整性约束三部分。 1）数据结构表达为实体和属性; 2）数据操作表达为实体中的记录的插入、删除、修改、查询等操作; 3）完整性约束表达为数据的自身完整性约束（如数据类型、检查、规则等）和数据间的参照完整性约束（如联系、继承联系等）。 1.2 实体、属性及标识符的定义 实体（Entity），也称为实例，对应现实世界中可区别于其他对象的“事件”或“事物”。例如，学校中的每个学生，医院中的每个手术。 每个实体都有用来描述实体特征的一组性质，称之为属性，一个实体由若干个属性来描述。如学生实体可由学号、姓名、性别、出生年月、所在系别、入学年份等属性组成。 实体集（EntitySet）是具体相同类型及相同性质实体的集合。例如学校所有学生的集合可定义为“学生”实体集，“学生”实体集中的每个实体均具有学号、姓名、性别、出生年月、所在系别、入学年份等性质。 实体类型（EntityType）是实体集中每个实体所具有的共同性质的集合，例如“患者”实体类型为：患者｛门诊号，姓名，性别，年龄，身份证号.............｝。实体是实体类型的一个实例，在含义明确的情况下，实体、实体类型通常互换使用。 实体类型中的每个实体包含唯一标识它的一个或一组属性，这些属性称为实体类型的标识符（Identifier），如“学号”是学生实体类型的标识符，“姓名”、“出生日期”、“信址”共同组成“公民”实体类型的标识符。 有些实体类型可以有几组属性充当标识符，选定其中一组属性作为实体类型的主标识符，其他的作为次标识符。 第二章 PostgreSQL 数据库 PostgreSQL是以加州大学伯克利分校计算机系开发的开源的、免费的对象关系型数据库管理系统（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、外键、触发器、视图、事务完整性、MVCC。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、聚集函数、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。它提供了相对其他开放源代码数据库系统(比如 MySQL 和 Firebird)，和专有系统(比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server)之外的另一种选择。事实上， PostgreSQL 的特性覆盖了 SQL-2/SQL-92 和 SQL-3/SQL-99，首先，它包括了可以说是目前世界上最丰富的数据类型的支持，其中有些数据类型可以说连商业数据库都不具备， 比如 IP 类型和几何类型等；其次，PostgreSQL 是全功能的自由软件数据库，很长时间以来，PostgreSQL 是唯一支持事务、子查询、多版本并行控制系统（MVCC）、数据完整性检查等特性的唯一的一种自由软件的数据库管理系统。  从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等， 同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。PostgreSQL强壮的一个原因源于它的架构。和商业数据库一样，PostgreSQL可以用于C/S(客户/服务器)环境。这对于用户和开发人员有很多好处。PostgreSQL安装核心是数据库服务端进程。它允许在一个独立服务器上。需要访问存储在数据库中的数据的应用程序必须通过数据库进程。这些客户端程序无法直接访问数据，即使它们和服务程序在同一台机器上。 2.1 PostgreSQL数据库简介 PostgreSQL 是一个自由的对象-关系数据库服务器（数据库管理系统），功能很强大。包括了可以说是目前世界上最丰富的数据类型的支持，比如 IP 类型和几何类型等等。PostgreSQL 真正诞生于二十世纪八十年代，它沿用了 ingres 很多的思想,  1995 年正式社区化了, PostgreSQL 从此诞生了。经过近 20 多年的持续开发和经验证的体系结构，PostgreSQL 在数据库领域已经赢得了良好的声誉。 PostgreSQL的源代码可以自由获取，它的授权是在非常自由的开源授权下，这种授权允许用户在各种开源或是闭源项目中使用、修改和发布PostgreSQL的源代码。用户对源代码的可以按用户意愿进行任何修改、改进。因此，PostgreSQL不仅是一个强大的企业级数据库系统，也是一个用户可以开发私用、网络和商业软件产品的数据库开发平台。 PostgreSQL是一种几乎可以运行在各种平台上的免费的开放源码的对象关系数据库管理系统，拥有与企业级数据库相媲美的特性，如完善的SQL标准支持、多版本并发控制、时间点恢复、表空间机制、异步复制、嵌套事务、在线/热备份、一个复杂的查询优化器、预写日志容错技术。它支持国际字符集、多字节字符编码、Unicode，并且对格式化、排序、大小写敏感提供本地化支持。PostgreSQL在管理大数据量方面有良好的可扩展性，对并发用户管理具有自适应性。现在已经出现具有管理超过4万亿字节数据能力的实用版本产品。 开放特性：PostgreSQL内置了丰富的数据类型，如任意精度的数值、无限制长度的文本、几何图元、IP地址、数组等；同时还允许用户定义基于正规SQL类型的新类型，让数据库自身理解复杂数据，自定义类型中还可以包含继承关系。用户可以为数据库内几乎所有的对象定义新的类型，如索引、操作符（可重载现有操作符）、聚集函数、数据域、数据类型转换、会话（编码转换）等。 可编程性：PostgreSQL同样拥有大量的编程接口供用户开发使用，如ODBC、JDBC（Java）、Libpq（C/C++）等。 可定制性：PostgreSQL拥有广泛的编程语言支持来实现函数功能，包括内置的PL/pgSQL过程语言，PL/Perl、plPHP、PL/Python、PL/Ruby、PL/Tcl等脚本语言，以及Java、C/C++等高级编程语言。函数的输出是一系列行类型的集合，可以在查询中当做表来使用，函数也可以被定义成以创建者或者调用者的身份运行。在其他的数据库产品中，函数也会被称为“存储过程”。 索引手段：用户可以自定义索引方法或者使用内置B-Tree索引、Hash表索引、GiST索引、GIN索引。GiST索引不是某种特定的索引类型，而是一种通用索引基础结构，可以在这种结构上实现很多不同的索引策略。PostgreSQL同时还支持如下功能：反向索引检索、表达式索引、部分索引、位图索引扫描。 多种身份认证方式：PostgreSQL中可以使用数据库用户/角色、操作系统、PAM、Kerberos等方式，根据主机配置文件（pg_hba.conf）中的设置执行对应的身份认证。 2.2 PostgreSQL 系统的基本体系结构 PostgreSQL 使用客户机/服务器（C/S）的模式提供服务，一个PostgreSQL会话由下列相关的进程（程序）组成： (1)一个服务器端进程。该进程管理数据库文件，接受客户端与数据库的连接，且代表客户端对数据库进行操作。该进程的程序名叫做 postgres。 (2)前端应用，即需要进行数据库操作的客户端应用。客户端应用可能本身就是多种多样的：它们可以是一个字符界  面的工具， 也可以是一个图形界面的应用，或者是一个通过访问数据库来显示网页的 web 服务器，或者是一个特殊的数据库管理工具。 一些客户端应用是和 PostgreSQL 发布一起提供的，但绝大部分是用户开发的。 和典型的客户端/服务器应用（C/S应用）一样，客户端和服务器可以在不同的主机上。此时，它们通过TCP/IP进行网络连接，你应该记住这一点，因为在客户机上可以访问的文件未必能够在数据库服务器机器上访问（或者只能用不同的文件名进行访问）。 PostgreSQL 服务器可以处理来自客户端的多个并发请求。为了能这样处理，它会为每个请求启动（“forks”）一个新的进程，然后，客户端和新服务器端进程就不再经过最初的postgres 进程而直接通信。 因此， 服务器端的主进程一直运行，等待着来自客户端的连接；而客户端和相关联的服务器端进程则在需要的时候才会运行。PostgreSQL数据库是一种极好可以运行在各种平台上的免费的开放源码的对象关系数据库，它是一种以关系数据库和SQL为基础，扩展了抽象数据类型，从而具备面向对象特性的数据库。 PostgreSQL由连接管理系统（系统控制器），编译执行系统，存储管理系统，事务系统，系统表五大部分组成。 连接管理系统接受外部操作对系统的请求，对操作请求进行预处理和分发，起系统逻辑控制作用；编译执行系统由查询编译器，查询执行器组成，完成操作请求在数据库中的分析处理和转化工作，最终实现物理存储介质中数据的操作；存储管理系统由索引管理器，内存管理器，外存管理器组成，负责存储和管理物理数据，提供对编译查询系统的支持；事务系统由事务管理器，日志管理器，并发控制，锁管理器组成，日志管理器和事务管理器完成对操作请求的事务一致性支持，锁管理器和并发控制提供对并发访问数据的一致性支持；系统表是PostgreSQL数据库的元信息管理中心，包括数据库对象信息和数据库管理控制信息。系统表管理元数据信息，将PostgreSQL数据库的各个模块有机地连接在一起，形成一个高效的数据管理系统。  图2-1 PostgreSQL体系结构图（组成结构和关系）  系统表： 在关系数据库中，为了实现数据库系统的控制，必须提供数据字典的功能。数据字典不仅存储各种对象的描述信息，而且存储系统管理所需的各种对象的细节信息。数据字典包含数据库系统中所有对象及其属性的描述信息，对象之间关系的描述信息，对象属性的自然语言含义以及数据字典变化的历史，数据字典是关系数据库系统管理控制信息的核心，在PostgreSQL数据库系统中系统表扮演着数据字典的角色。系统表是PostgreSQL数据库存放结构元数据的地方，他在PostgreSQL中表现为存放有系统信息的普通表或者视图（用户可以删除，重建）。系统表保存了数据库的所有元数据，所以系统运行时对系统表的访问是非常频繁的。为了提高系统性能，在内存中建立了共享的系统表，使用Hash表提高查询效率。 2.3 pgadmin4  pgadmin4是一款可以让您编辑SQL的软件，您可以在软件上找到编辑器，并从本地添加需要修改的文件，从而完成数据库基本信息管理以及文本修改，本软件是国外设计的，发行到中国以后官方已经添加了中文简体版本，用户只需要在设置界面上找到杂项中的语言设置窗口，就可以转换到中文界面；PostgreSQL数据库管理工具同时提供了十二种管理工具，支持维护、备份、SQL查询、演示WAL、添加新的数据还原点等，功能非常强大！ 软件功能包括广泛的文档、pgAdmin应用程序文档、PostgreSQL文档链接；多个部署模型、桌面模式，使用专门构建的运行时、服务器模式，通过网络支持多个用户；颜色语法高亮查询工具、用于显示/输入数据的快速数据网格、图形查询计划显示、授予向导以快速更新ACL、程序语言调试器（支持pl / pgsql和edb-spl）；自动真空管理、监视仪表板、备份，恢复，真空和需求分析、SQL / shell /批处理作业调度代理、创建，查看和编辑所有常见的PostgreSQL对象。 软件特色： pgAdmin4具有自己专属的SQL编辑器；可以在软件上直接查询SQL的信息；在连接到数据库以后可以自动分析需要的数据；在查询的时候会通知用户具体的SQL内容；可以显示查询内容时间长度；可以显示指定秒数通知程序；支持缓冲区的信息提示在桌面上；支持详细的pgAdmin4数据报告；支持查询SQL的代价信息标注。  pgAdmin导航菜单功能:  1).文件菜单:在文件菜单中当点击服务器根节点下某个节点时可以更改连接密码。 2).编辑菜单: 点击编辑菜单可以对数据库和对象做相应的操作。(右键所选对象相当于编辑中所有相关功能) 3).插件: 启动psql控制台并连接到在pgAdmin中所选的数据库。可以输入相应的命令。 4).视图: 用来调节页面视图的显示。例如：打开与关闭SQL窗口。 5.工具: 在主窗体左面的对象树中点击不同的节点　工具中菜单的高亮显示可做相应的操作。(所选对象右键操作可达到相同效果但工具中可以打开查询工具)。 6).帮助: 可以查看帮助文档 五、实验内容 使用pgAdmin4数据库开发工具对图书借阅管理系统数据库进行数据库管理，并完成数据库备份/恢复处理，具体实验内容如下: 图书借阅管理系统数据库拥有者用户（Library_Manager）创建 图书借阅管理系统数据库角色创建 图书借阅管理系统模式（Schema）创建 图书借阅管理系统数据库角色权限设置 图书借阅管理系统数据库其他用户创建与角色分派 图书借阅管理系统用户的数据库对象访问 在实验计算机上，利用pgAdmin4数据库系统工具，完成图书借阅管理系统数据库管理与维护，同时记录实验过程的规划、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin4数据库系统工具开展图书借阅管理系统数据库管理与维护，其步骤如下：   1）创建数据库拥有者用户Library_Manager 2）创建Library数据库 3）创建图书借阅管理系统数据库客户、经理角色 4）分派创建角色的权限 5）创建图书借阅管理系统用户 6）分派创建用户的角色 7）验证创建用户的数据库对象访问权限 8）数据库备份管理 9）数据库恢复管理 八、实验数据及结果分析 创建数据库拥有者用户Library_Manager，其角色为superuser.（与实验一同） 在Windows操作系统中，启动pgAdmin4工具运行。并使用pgAdmin4创建登录/组角色Library_Manager 创建数据库Library 使用pgAdmin4工具创建数据库Library，Owner为Library_Manager 创建图书借阅管理系统数据库客户、经理角色 在实际应用中，可以由DBA按业务需要创建用户自定义角色。在系统的用户管理中，通常会把多个用户赋予一个组，这样在设置权限时只需给该组设置即可，撤销权限时也是从该组撤消。在PostgreSQL中，首先需要创建一个代表组的角色，之后再将该角色的membership权限赋给独立的用户角色即可，按实验要求，我们需要两个组角色，分别为数据库经理Manager和客户Reader， 分派创建角色的权限     数据库对象在被创建时都会被赋予一个所有者，通常而言，所有者就是执行对象创建语句的角色。对于大多数类型的对象，其初始状态是只有所有者(或超级用户)可以对该对象做任何事情。如果要允许其它用户可以使用该对象，必须赋予适当的权限。  在本实验中，经理(Manager)角色对数据库方案中所有表拥有Insert、Delete、Update、Select操作权限，而客户（Reader）角色对数据库方案中部分数据表（如BOOK、READER）具有Insert、Delete、Update、Select操作权限。   其次为客户Reader赋予BOOK和READER的相应权限   为新建用户授予自定义角色 在此前，分别创建了系统自定义角色manager和reader。现可以将这些自定义角色授予新用户。 本实验将创建一个新用户“user1”，并给他赋予“reader”角色。在“登录/组角色”右键，点击“创建”再点击“登录/组角色”    选中组角色reader，点击右键，选中“属性”选项。在出现的界面中点击“成员”，并选择user1成员，点击保存     查询user1用户的数据库访问权限 首先查询reader角色的权限          PostgreSQL中，Inherit表示组角色reader的任何一个成员角色都将自动继承除“超级用户权限”外的所有权限   九、总结及心得体会 通过本次实验，熟悉了典型的数据库管理工具使用，掌握了应用系统的数据库管理技术与方法，如数据库角色管理、用户管理、权限管理、数据库备份与恢复等系统管理操作，以及完成数据库对象操作访问。这些虽然在课堂中都有所学到，但是没有实际操作过。本次实验给我们了一次实际操作的机会，巩固了所学知识。 ",
  "studentID": "2017221102014"
 },
 "66": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221102016      姓    名         龙锐          （实验）\t课程名称   数据库原理及应用    理论教师         文军          实验教师         文军              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：龙锐\t\t学号：2017221102016     指导教师：文军  实验地点：303     实验时间：19.06.14 一、实验名称：图书销售管理系统数据库SQL应用编程  二、实验学时：5 三、实验目的：针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。  四、实验原理：  实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  六、实验器材（设备、元器件）：实验PC计算机,PostgreSQL 11  七、实验步骤： （1）图书销售管理系统数据库BookSale创建操作      在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 首先用create语句创建数据库表，并编入相应数据            用select as from where语句创建视图    用create index on 语句创建索引    对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 用insert into values语句增加数据      用delete from 语句进行删除操作    用select语句进行查看操作           用update命令进行修改   编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 用create declare begin end等操作编写存储过程    编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理，并对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。        八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 通过数据库SQL应用编程成功实现了数据库的创建，以及数据库表，视图，索引的创建，成功进行增删查改的操作，编写存储过程和触发器，完成实验内容。 九、总结及心得体会： 通过本次实验掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。 十、对本实验过程及方法、手段的改进建议：                                                      报告评分：                                          指导教师签字：     电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221102003      姓    名        毕成           （实验）\t课程名称  数据库原理及应用     理论教师        文军           实验教师        文军               电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：毕成\t\t学号：2017221102003       指导教师：文军 实验地点：303     实验时间：19.06.14 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3 三、实验目的：对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理：  五、实验内容：（1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  实验器材（设备、元器件）：实验PC计算机,PostgreSQL 11 实验步骤：（1）针对图书销售管理系统数据库，设计数据存取权限控制模型。在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 用create role with 语句创建角色并赋予相应权限    在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 用grant on to 语句赋予数据库对象权限       在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。  用create user with语句创建用户，in role语句分派角色     （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。      八、实验结果与分析（含重要数据结果分析或核心代码流程分析）   成功创建数据库，创建角色并赋予权限，创建用户并访问数据库。 九、总结及心得体会：   通过本次实验理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。 十、对本实验过程及方法、手段的改进建议：                                                      报告评分：                                          指导教师签字：  \n电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221102016      姓    名        龙锐           （实验）\t课程名称  数据库原理及应用     理论教师        文军           实验教师        文军               电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：龙锐\t\t学号：2017221102016       指导教师：文军 实验地点：303     实验时间：19.06.14 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3 三、实验目的：对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理：  五、实验内容：（1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  实验器材（设备、元器件）：实验PC计算机,PostgreSQL 11 实验步骤：（1）针对图书销售管理系统数据库，设计数据存取权限控制模型。在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 用create role with 语句创建角色并赋予相应权限    在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 用grant on to 语句赋予数据库对象权限       在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。  用create user with语句创建用户，in role语句分派角色     （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。      八、实验结果与分析（含重要数据结果分析或核心代码流程分析）   成功创建数据库，创建角色并赋予权限，创建用户并访问数据库。 九、总结及心得体会：   通过本次实验理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。 十、对本实验过程及方法、手段的改进建议：                                                      报告评分：                                          指导教师签字： ",
  "studentID": "2017221102016"
 },
 "67": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号 2017221103006         姓    名 任晓光                （实验）\t课程名称 数据库原理及应用      理论教师 文军                  实验教师 何中海                    电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：任晓光\t\t学号：2017221103006  指导教师：何中海 实验地点：信软楼西303     实验时间：2019-06-14 一、实验名称：图书销售管理系统数据库 SQL 应用编程 二、实验学时：4学时 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 四、实验原理： 针对图书销售管理系统数据库开发，掌握DDL、DML、DQL类型SQL语句在BookSale数据库开发中的应用方法，完成图书销售管理数据库SQL编程操作。 图书管理系统，是一个由人、计算机等组成的能进行管理信息的收集、传递、加工、保存、维护和使用的系统。 pgAdmin，一个设计，维护和管理 Postgres 数据库用的通用工具。它能在各种平台的Windows，Linux，FreeBSD，Mac和Solaris服务器上使用。特性包括：任意 SQL 语句。可用于数据库，表，索引，序列，视图，触发器， 函数和语言的浏览器和'构造器'。用户，组和权限配置对话框。带有升级脚本生成功能的版本跟踪。Microsoft MSysConf 表的配置。数据输入和输出向导。数据库的CRUD操作。数据库迁移向导。对数据库，表，索引，序列，语言和视图预定义的报表。pgadmin 是与 Postgres 分开发布的，可以从www.pgadmin.org下载。 结构化查询语言(Structured Query Language)简称SQL(发音：/es kju el/ \"S-Q-L\")，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统；同时也是数据库脚本文件的扩展名。 结构化查询语言是高级的非过程化编程语言，允许用户在高层数据结构上工作。它不要求用户指定对数据的存放方法，也不需要用户了解具体的数据存放方式，所以具有完全不同底层结构的不同数据库系统, 可以使用相同的结构化查询语言作为数据输入与管理的接口。结构化查询语言语句可以嵌套，这使它具有极大的灵活性和强大的功能。 1986年10月，美国国家标准协会对SQL进行规范后，以此作为关系式数据库管理系统的标准语言（ANSI X3. 135-1986），1987年得到国际标准组织的支持下成为国际标准。不过各种通行的数据库系统在其实践过程中都对SQL规范作了某些编改和扩充。所以，实际上不同数据库系统之间的SQL不能完全相互通用。 五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）： 电脑 七、实验步骤： \t第一步：创建数据库 然后查看一下数据库是否被创建了：  可以看到，成功的创建了数据库 然后，创建各种数据库中的表，比如作者表，书本表，以及顾客表等，代码如下： \n create table Auther ( AU_ID CHAR(18) not null, AU_Name VARCHAR(20) not null, AU_Gender CHAR(2) not null, AU_Phone VARCHAR(11) not null, AU_Address VARCHAR(50) not null, constraint PK_AUTHER primary key (AU_ID) ); create table Book ( Book_ISBN CHAR(13) not null, AU_ID CHAR(18) null, PUB_ID CHAR(11) null, Book_Name VARCHAR(50) not null, Book_Pubdate DATE not null, Book_Price MONEY not null, Book_Category VARCHAR(20) not null, Book_Stock INT4 not null, Book_Notes VARCHAR(100) null, Book_List VARCHAR(100) null, constraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER ( CUST_ID CHAR(18) not null, CUST_Name VARCHAR(20) not null, CUST_Phone VARCHAR(15) not null, CUST_Address VARCHAR(50) not null, CUST_Email VARCHAR(50) not null, constraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher ( PUB_ID CHAR(11) not null, PUB_Name VARCHAR(20) not null, PUB_Phone VARCHAR(15) not null, PUB_Address VARCHAR(50) not null, constraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale ( SALE_ID VARCHAR(11) not null, Book_ISBN CHAR(13) null, CUST_ID CHAR(18) null, SALE_Date DATE not null, SALE_QTY INT4 not null, SALE_Amount MONEY not null, constraint PK_SALE primary key (SALE_ID) ); create table Stock ( Stock_ID VARCHAR(10) not null, Book_ISBN CHAR(13) null, Stock_Change INT4 not null, Stock_Operation CHAR(4) not null, Stock_Datetime DATE not null, constraint PK_STOCK primary key (Stock_ID) ); alter table Book add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) references Auther (AU_ID) on delete restrict on update restrict; alter table Book add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) references Publisher (PUB_ID) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_CUSTOMER__CUSTOMER foreign key (CUST_ID) references CUSTOMER (CUST_ID) on delete restrict on update restrict; alter table Stock add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; 在数据库管理界面上面运行如下：  查看左边的目录，看这些表是否被创建出来了：  然后，对数据库进行插入操作，将各个表都插入一些数据，代码如下： Insert into Auther values('111111111111111111','孙悟空','男','17898726378','花果山');  Insert into Auther values('222222222222222222','玉帝','男','1234567890','天庭');  Insert into Auther values('333333333333333333','嫦娥','女','17689724356','广寒宫 ');  Insert into PUBLISHER values('PUB00000001','地球出版社','121212121212','地球');  Insert into PUBLISHER values('PUB00000002','月球出版社','456789876543','月球');  Insert into PUBLISHER values('PUB00000003','火星出版社','876543456776','火星');  Insert into BOOK values('1111111112222','111111111111111111','PUB00000001','听课技巧','1111-11-11','11','生活','999');  Insert into BOOK values('1111111113333','222222222222222222','PUB00000002','喝水技巧','1111-11-11','11','生活','999');  Insert into BOOK values('1111111114444','333333333333333333','PUB00000003','吃饭技巧','1111-11-11','11','生活','999');  Insert into customer values('555555555555555555','杨戬','14567876545','灌江口','7654321@qq.com');  Insert into customer values('666666666666666666','典韦','18612345543','许昌','8765433@qq.com');  Insert into customer values('777777777777777777','安琪拉','13623456765','王者公园','875437654@qq.com'); 在postgreSQL中运行这段代码：  查看是否已经插入，运行select语句，进行检查：  可以看到，数据已经成功的插入到了表中。 然后进行插入操作：  查看结果：  然后，进行删除操作，验证是否正确：  可以看到，显示已经删除成功了，但是还是需要再次查询确认一下：  实验修改：  修改结果如下：  4创建视图  查看视图是否成功创建：  创建触发器与触发器函数：  然后，就是对触发器进行测试，观察看看是否触发器可以正常的执行。 首先，向sale中插入数据：  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 实验已经顺利完成了，其中，对数据库表的增删改查操作都顺利完成，触发器的操作也已经顺利完成了。  在数据库插入的这个代码中，insert into 语句只要合理运用，每个数据的类型都满足要求，就可以成功的插入到表中，包括数据库的增删改查，都有特定的语句。  在创建触发器时，要创建触发器要使用到的函数，因为触发器所执行的操作，依赖于存储过程，也就是函数。 九、总结及心得体会： \t在数据库的使用中，SQL语句是一个重要的操作手段，尤其是在编写触发器函数的时候，非常重要。在编写触发器时，要注意触发器的每一步操作，都要对照触发器所依靠的那个表来进行，因为有一点错误，就会导致触发器失败。 十、对本实验过程及方法、手段的改进建议： 暂无                                                      报告评分：                                          指导教师签字： \n  电 子 科 技 大 学 实   验   报   告 学生姓名：任晓光\t\t学号：2017221103006    指导教师：何中海  实验地点：信软楼西303   实验时间：2019-06-21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：4学时 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： \tPowerDesigner最初由Xiao-Yun Wang（王晓昀）在SDP Technologies公司开发完成。PowerDesigner是Sybase的企业建模和设计解决方案，采用模型驱动方法，将业务与IT结合起来，可帮助部署有效的企业体系架构，并为研发生命周期管理提供强大的分析与设计技术。PowerDesigner独具匠心地将多种标准数据建模技术（UML、业务流程建模以及市场领先的数据建模）集成一体，并与 .NET、WorkSpace、PowerBuilder、Java、Eclipse 等主流开发平台集成起来，从而为传统的软件开发周期管理提供业务分析和规范的数据库设计解决方案。此外，它支持60多种关系数据库管理系统（RDBMS）/版本。PowerDesigner运行在Microsoft Windows平台上，并提供了Eclipse插件。 pgAdmin，一个设计，维护和管理 Postgres 数据库用的通用工具。它能在各种平台的Windows，Linux，FreeBSD，Mac和Solaris服务器上使用。特性包括：任意 SQL 语句。可用于数据库，表，索引，序列，视图，触发器， 函数和语言的浏览器和'构造器'。用户，组和权限配置对话框。带有升级脚本生成功能的版本跟踪。Microsoft MSysConf 表的配置。数据输入和输出向导。数据库的CRUD操作。数据库迁移向导。对数据库，表，索引，序列，语言和视图预定义的报表。pgadmin 是与 Postgres 分开发布的，可以从www.pgadmin.org下载。 结构化查询语言(Structured Query Language)简称SQL(发音：/es kju el/ \"S-Q-L\")，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统；同时也是数据库脚本文件的扩展名。 结构化查询语言是高级的非过程化编程语言，允许用户在高层数据结构上工作。它不要求用户指定对数据的存放方法，也不需要用户了解具体的数据存放方式，所以具有完全不同底层结构的不同数据库系统, 可以使用相同的结构化查询语言作为数据输入与管理的接口。结构化查询语言语句可以嵌套，这使它具有极大的灵活性和强大的功能。 1986年10月，美国国家标准协会对SQL进行规范后，以此作为关系式数据库管理系统的标准语言（ANSI X3. 135-1986），1987年得到国际标准组织的支持下成为国际标准。不过各种通行的数据库系统在其实践过程中都对SQL规范作了某些编改和扩充。所以，实际上不同数据库系统之间的SQL不能完全相互通用。  五、实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  六、实验器材（设备、元器件）： 计算机 七、实验步骤： 1、设计数据存取权限控制模型 客户  商家  2、创建客户（R_Customer）角色。  结果如下：  3、创建客户（R_Customer）角色。  查询结果如下：  授予客户权限：  然后授予商家权限：  创建两个账户，一个是客户，一个是商家：  结果如下：  使用消费者账户登录数据库：  然后进行操作，看看是否有权限： 1：查询  可以查询，下面尝试一下删除：  操作被拒绝了，没有权限，下面尝试一下查看author表：  成功了，下面查询sale表：  被拒绝了，由此可见消费者的权限是正确的，下面以商家登录数据库，查看是否正确：  查看customer表：  有权限，下面看看对author的插入权限：  有权限，成功的将数据插入到了表中。试一下从stock表中删除：  被拒绝了，看一下是否可以更新sale表：  成功修改了，证明拥有更新数据权限。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 实验结果很成功！其中在grant授予用户权限时，需要指明用户对某个表是否有某个权限。尤其是NOCREATEDB等这些词，不可以将NO分开写，否则就会造成错误。还有就是，在实验用户的权限的时候，需要断开服务器，然后修改用户名，进行连接，才可以更换成想要实验的用户。 九、总结及心得体会： \t对于这个用户权限的控制很重要，可以保护数据库的数据不被不应该修改的角色修改。创建角色的时候要分配好权限，不然很容易造成坏用户恶意修改信息。 十、对本实验过程及方法、手段的改进建议：                                                      报告评分：                                          指导教师签字： ",
  "studentID": "2017221103006"
 },
 "68": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号  2017221103007       姓    名     祝李吉           （实验）\t课程名称 数据库原理及应用     理论教师      文军            实验教师     何中海               电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：祝李吉\t\t学号：2017221103007    指导教师：何中海   实验地点：信软学院楼西303        实验时间：2019年6月14日 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：5学时 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 四、实验原理： 在关系数据库系统中，所有对数据库的访问操作均可通过DBMS执行SQL语句操作来实现。例如，通过执行CREATE TABLE、ALTER TABLE、DROP TABLE语句实现数据库表创建、修改和删除处理。通过执行INSERT、UPDATE、DELETE语句实现数据库表中数据添加、数据修改、数据删除处理。通过执行SELECT语句实现数据库表数据查询处理。在PostgreSQL数据库系统中，可以使用数据库开发工具pgAdmin或psql命令行工具执行SQL语句，实现数据库对象及其数据的操作访问。 在PostgreSQL数据库中，存储过程、触发器和游标都可使用PL/pgSQL编程实现的数据处理。按照PL/pgSQL提供的语句和程序结构，实现数据库后端功能编程处理。可以使用数据库开发工具pgAdmin或psql命令行工具执行PL/pgSQL程序，实现数据库后端功能处理。 五、实验内容： 图书销售管理系统数据库BookSale创建操作。 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作。 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）： 实验PC计算机 七、实验步骤： 创建数据库BookSale。 SQL语句：CREATE DATABASE BookSale; 执行结果如图1-1所示： 图1-1 创建数据库结果图 创建数据库表，包括作者、图书、出版社、图书类别、销售、库存、商店、折扣。 作者SQL语句： 出版社SQL语句： 图书SQL语句： 图书类别SQL语句： 折扣SQL语句：  库存SQL语句： 商店SQL语句： 销售SQL语句：  执行结果如图1-2所示： 图1-2 创建表执行结果图 为每个表插入数据。 作者SQL语句： 商店SQL语句： 折扣SQL语句： 出版社SQL语句： 图书类别SQL语句： 图书SQL语句： 库存SQL语句：    销售SQL语句： 创建图书数据表的视图。 SQL语句： 执行结果如图1-3所示： 图1-3 创建视图执行结果图 为图书数据表的书名创建索引。 SQL语句： CREATE INDEX BookName_Idx ON Books (BookName); 执行结果如图1-4所示：   图1-4 创建索引执行结果图 对作者数据表进行增加操作。 SQL语句：INSERT INTO Writer VALUES('000000000011','张磊','北京市','13822344231'); 增加前数据如图1-5所示： 图1-5 增加数据前的数据图 增加后数据如图1-6所示： 图1-6 增加数据后的数据图   对作者数据表进行删除操作。 SQL语句：DELETE FROM Writer    WHERE WriterName='张磊' 执行结果如图1-7所示： 图1-7 删除数据后的数据图 对图书数据表和图书类别数据表进行查询操作。 SQL语句： 语句说明： 查找图书类别为小说的书名和作者。 执行结果如图1-8所示： 图1-8 查询操作执行结果图 对作者数据表进行更改操作。 SQL语句： 执行结果如图1-9所示： 图1-9 更改操作执行结果图 编写Pro_CurrentSale,实现当日图书销售量及销售金额汇总统计。 SQL语句： 编写过程语句块，实现对函数Pro_CurrentSale的调用 SQL语句：SELECT pro_currentsale() 执行结果如图1-10所示： 图1-10 函数调用结果图 编写图书销售表Inser触发器Tri_InsertSale,实现图书库存数据同步修改处理。 触发器的执行函数SQL语句： 触发器SQL语句： 对图书销售表Inser触发器Tri_InsertSale程序进行功能验证。 Insert SQL语句：INSERT INTO Sell VALUES('21','0000000000000000000001', '000000000001','2019-06-15','4','64') 执行Insert语句前的库存表如图1-11所示： 图1-11 执行Insert语句前的库存表 执行Insert语句后的库存表如图1-12所示： 图1-12 执行Insert语句后的库存表 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） Pro_CurrentSale函数： 函数说明： 通过返回record记录型变量，实现输出每个书店当日的销售量和销售金额，其中用到了SETOF和RETURN NEXT用于输出查询到的多个记录值。在函数主体，用了一个for循环，实现对书店名的遍历，在每个循环中，通过SELECT INTO 语句进行赋值，以及SUM()函数进行求和，再通过JOIN…ON…语句将销售表和书店表连接，用于对当前书店进行统计，对时间的表示用到了CURRENT_DATE函数返回当前时间值。 Tri_InsertSale触发器执行函数和触发器创建： 函数说明： 在触发器执行函数中，通过一个更新语句以及NEW特殊变量，实现对库存量的修改，创建触发器时，主要需要注意AFTER INSERT语句，即触发器在INSERT语句执行之后触发。 九、总结及心得体会： 在本次实验中，通过对图书销售管理系统数据库的开发，创建数据库，创建表，插入数据，再编写函数和触发器一系列过程，掌握了DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，同时也掌握了基本的数据库触发器、存储过程编程方法。 在实验期间，遇到的问题有很多。在创建表时，对于有外键依赖属性的表，应先创建其所依赖的表，否则会引起创建错误，在插入数据时也是类似问题，需先插入那些不含外键的表的数据，这些细节问题，看似很小，实则对数据库的影响很大。编写函数时，最初对record记录型变量使用不熟悉，不知如何返回多条记录，通过查询，用了SETOF语句才实现。对for语句的使用也不熟悉，刚开始忘书写END LOOP语句导致了多次错误。在编写代码时，也一定要注意缩进，否则会引起逻辑错误。最后一定要标记出语言，否则会编写错误。在编写触发器时，触发器执行函数的返回类型一定时触发器，否则会导致错误，以及熟悉对特殊变量的使用。 通过本次实验，对数据库的使用更加熟练，对许多命令的结构与细节更加熟悉，也发现了自己比较多的薄弱环节，特别是在存储过程的编写上，对很多数据类型和语法还不是很熟悉。 十、对本实验过程及方法、手段的改进建议： 在编写存储过程时，可以实现输出每个书店每本书的销量与销售额，不仅可以输出当日的统计数据，还可以指定一个输入参数，输出特定日期的统计数据，丰富其功能。                                                      报告评分：                                          指导教师签字： \n 电 子 科 技 大 学 实   验   报   告 学生姓名：祝李吉\t\t学号：2017221103007    指导教师：何中海   实验地点：信软学院楼西303        实验时间：2019年6月21日 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3学时 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 在PostgreSQL数据库系统中，实现数据存取安全模型是确保数据库安全访问的基本手段。在数据安全存取模型中，需要设计数据库的角色、角色的数据库对象操作权限、数据库用户、数据库用户的角色赋予，以及数据库对象的操作权限集合。根据设计的数据安全存取模型，系统管理员使用数据库管理工pgAdmin去创建角色，授予系统管理权限和对象操作权限。此外，还需要创建用户，并对用户赋予必要的角色。之后，用户就可以对数据库对象进行访问。 五、实验内容： 在PostgreSQL数据库系统软件环境中，实现图书销售数据库BookSale的安全管理。针对图书销售管理，设计数据存取安全模型，分别采用管理工具操作或SQL程序方式实现该数据库的角色、权限、用户安全管理，具体实验内容如下： 针对图书销售管理系统数据库，设计数据存取权限控制模型。 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）： 实验PC计算机 七、实验步骤： 设计数据存取权限控制模型。 图2-1 客户角色权限模型 图2-2 商家角色权限模型 创建客户(R_Customer)、商家(R_Seller)角色。 SQL语句： 执行结果如图2-3所示： 图2-3 创建角色执行结果图 根据业务规则，为两个角色赋予权。 SQL语句： 执行部分结果如图2-4，2-5所示： 图2-4 R_Customer对图书类别表的权限 图2-5 R_Seller对图书表的权限 创建客户用户U_Customer，商家用户U_Seller，并分别为他们分派客户R_Customer和商家R_Seller角色。 SQL语句： 执行结果如图2-6所示： 图2-6 创建用户执行结果图 以客户U_Customer身份访问图书销售管理数据库。 登录过程如图2-7所示： 图2-7 登录过程图 以客户U_Customer身份对Writer表进行读操作。 SQL语句：SELECT * FROM WRITER 执行结果如图2-8所示：  图2-8 对Writer表进行读操作结果图 以客户U_Customer身份对Sell表进行读操作。 SQL语句：SELECT * FROM Sell 执行结果如图2-9所示： 图2-9 对Sell表进行读操作结果图 以客户U_Customer身份对Writer表进行删除操作。 SQL语句：DELETE FROM Writer     WHERE WriterName='小王' 执行结果如图2-10所示： 图2-10 对Writer表进行删除操作结果图 以客户U_Customer身份对Writer表进行更改操作。 SQL语句： 执行结果如图2-11所示： 图2-11 对Writer表进行更改操作结果图 以客户U_Customer身份对Writer表进行插入操作。 SQL语句：INSERT INTO Writer VALUES('000000000007','张磊','成都市电子科技大学','18113104968') 执行结果如图2-12所示： 图2-12 对Writer表进行插入操作结果图 以客户U_Seller身份访问图书销售管理数据库。 登录过程如图2-13所示： 图2-13 登录过程图 以客户U_Seller身份对Writer表进行读操作。 SQL语句：SELECT * FROM Writer 执行结果如图2-14所示： 图2-14 对Writer表进行读结果图 以客户U_Seller身份对Writer表进行更改操作。 SQL语句： 执行结果如图2-15所示： 图2-15 对Writer表进行更改结果图 以客户U_Seller身份对Writer表进行删除操作。 SQL语句：DELETE FROM Writer      WHERE WriterName='小王' 执行结果如图2-16所示： 图2-16 对Writer表进行删除操作结果图 以客户U_Seller身份对Writer表进行插入操作。 SQL语句：INSERT INTO Writer VALUES('000000000004','小王','成都市成华区','13880029856') 执行结果如图2-17所示： 图2-17 对Writer表进行插入结果图 以客户U_Seller身份对Publish表进行读操作。 SQL语句：SELECT * FROM Publish 执行结果如图2-18所示： 图2-18 对Publish表进行读结果图 以客户U_Seller身份对Publish表进行删除操作。 SQL语句：DELETE FROM Publish     WHERE PublishName='译林' 执行结果如图2-19所示： 图2-19 对Publish表进行删除结果图 以客户U_Seller身份对Publish表进行更改操作。 SQL语句： 执行结果如图2-20所示： 图2-20 对Publish表进行更改结果图 以客户U_Seller身份对Publish表进行插入操作。 SQL语句：INSERT INTO Publish VALUES('000000000004','西南交大','88724824','成都市') 执行结果如图2-21所示： 图2-21 对Publish表进行插入结果图  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 当以U_Customer登录访问数据库时，由于对Writer表只有读取权限，所以在对Writer表执行删除、插入、更改操作时，会提示permission denied for table Writer。由于对销售表没有任何权限，所以进行读操作也会提示permission denied for table Writer。 当以U_Seller登录访问数据库时，由于对对Writer表拥有读取、删除、更改、插入权限，所以4个访问操作等能成功，而对于Publish表只有读取权限，所以在对Publish表进行更改、删除、插入操作会提示permission denied for table Publish。验证了所实现数据存取权限控制模型为正确的。 九、总结及心得体会： 在这次实验中，通过创建客户和商家两个角色，并进行授权，分别以两个角色的用户对数据库进行访问操作，了解了DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理权限管理的基本方法。 由于此次实验涉及的逻辑问题并不强，主要是对于几个命令的熟悉和使用，所以基本没遇到什么问题，只需要注重语法格式即可。 通过两次实验，熟悉了数据库的基本操作，也掌握了许多命令，对课堂上学习的理论知识有很大提高。 十、对本实验过程及方法、手段的改进建议： 暂无。                                                      报告评分：                                          指导教师签字： ",
  "studentID": "2017221103007"
 },
 "69": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西303\t\t\t\t\t实验时间：2019.6.14      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实 体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设 计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。  2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在 本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过 程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、 存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行SQL创建图书销售管理系统数据库BookSale。 2.在数据库BookSale中，执行SQL创建数据库表、视图、索引等对象。 3.在数据库BookSale中，执行SQL进行数据增、删、查、改访问操作。 4.在数据库BookSale中，采用PL/pgSQL语言编写存储过程函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库BookSale中，采用PL/pgSQL语言编写过程语句块，实现对存储过程函数Pro_CurrentSale的调用，并输出统计结果。 6.在数据库BookSale中，采用PL/pgSQL语言编写编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.在数据库BookSale中，对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 8.在数据库BookSale中，创建存储过程函数实现图书销售数量和金额统计。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL、PL/pgSQL语言，完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数 据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、 auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。  3.为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执 行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。  4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、 作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。  5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书 的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。  6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。  7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之 后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据 的修改情况。  8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。  9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验数据及结果分析 1. 创建 BookSale 数据库 实现思路与方法：使用 SQL 语句来进行数据库的创建。 SQL 语句：create database \"BookSale\" 运行操作界面如图 1-1 所示。 图 1-1 创建数据库 数据库操作结果面如图 1-2 所示。  图 1-2 数据库创建完成 结果分析：成功创建数据库。 2. 创建各数据库表以及表中主外键和索引 实现思路与方法：首先明确图书销售管理系统的实体、实体属性以及各实体 之间的联系，再通过 SQL 语句对表进行创建，表对应实体，实体属性对应表中 的列，通过主外键来将表联系起来。 SQL 语句：  create table Auther ( AU_ID CHAR(18) not null, AU_Name VARCHAR(20) not null, AU_Gender CHAR(2) not null, AU_Phone VARCHAR(11) not null, AU_Address VARCHAR(50) not null, constraint PK_AUTHER primary key (AU_ID) ); create table Book ( Book_ISBN CHAR(13) not null, AU_ID CHAR(18) null, PUB_ID CHAR(11) null, Book_Name VARCHAR(50) not null, Book_Pubdate DATE not null, Book_Price MONEY not null, Book_Category VARCHAR(20) not null, Book_Stock INT4 not null, Book_Notes VARCHAR(100) null, Book_List VARCHAR(100) null, constraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER ( CUST_ID CHAR(18) not null, CUST_Name VARCHAR(20) not null, CUST_Phone VARCHAR(15) not null, CUST_Address VARCHAR(50) not null, CUST_Email VARCHAR(50) not null, constraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher ( PUB_ID CHAR(11) not null, PUB_Name VARCHAR(20) not null, PUB_Phone VARCHAR(15) not null, PUB_Address VARCHAR(50) not null, constraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale ( SALE_ID VARCHAR(11) not null, Book_ISBN CHAR(13) null, CUST_ID CHAR(18) null, SALE_Date DATE not null, SALE_QTY INT4 not null, SALE_Amount MONEY not null, constraint PK_SALE primary key (SALE_ID) ); create table Stock ( Stock_ID VARCHAR(10) not null, Book_ISBN CHAR(13) null, Stock_Change INT4 not null, Stock_Operation CHAR(4) not null, Stock_Datetime DATE not null, constraint PK_STOCK primary key (Stock_ID) ); alter table Book add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) references Auther (AU_ID) on delete restrict on update restrict; alter table Book add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) references Publisher (PUB_ID) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_CUSTOMER__CUSTOMER foreign key (CUST_ID) references CUSTOMER (CUST_ID) on delete restrict on update restrict; alter table Stock add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; 将上面的 SQL 程序，提交到数据库服务器执行，其执行作界面如图 1-3 所示。  图 1-3 创建数据库表 SQL 程序执行结果 当 SQL 程序成功执行后，可以在数据库看到新添加的数据库表对象，如图 1-4 所示。  图 1-4 图书销售数据库表对象  结果分析：成功创建各数据库表。 3. 插入样本数据并对 publisher 表进行增删查改操作 实现思路与方法：首先准备样本数据，尽可能使得数据符合实际应用并且要 能满足后续的数据处理操作。这里以 publisher 表为例，给出该表的数据增、删、 查、改 SQL 语句操作访问。  1）执行 SQL 语句，插入样本数据到图书销售数据库  Insert into Auther values('330309198504150527','王天','男','13554874593','四川省成都市成华区建设北路 二段十号');  Insert into Auther values('540135199103281548','叶无双','男','15812387538','浙江省杭州市天路区梅田路 二十八号');  Insert into Auther values('120857198811123587','李婷','女','18575615472','北京市朝阳区梅山路二巷八号 ');  Insert into PUBLISHER values('PUB00000001','高等教育出版社','010-65321854','北京');  Insert into PUBLISHER values('PUB00000002','电子工业出版社','010-65329857','北京');  Insert into PUBLISHER values('PUB00000003','人民邮电出版社','010-65325987','北京');  InsertintoBOOKvalues('9787115502742','330309198504150527','PUB00000001','Web 前端开发最佳实践 ','2016-01-01','59','IT 技术','100');  InsertintoBOOKvalues('9875325415577','540135199103281548','PUB00000002','Java EE Web 编 程','2008-01-01','52','IT 技术','200');  Insertinto BOOK values('9865365975234','120857198811123587','PUB00000003',' 数 据 库 实 验 指 导 ','2013-08-1','29','IT 技术','150');  Insert into customer values('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二 段十一号','450448745@qq.com');  Insert into customer values('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十 九号','657873215@qq.com');  Insert into customer values('542244197812121687','鲁丽','13615869875','北京市朝阳区梅山路二巷十六号 ','647864378@qq.com');  样本数据插入 SQL 程序的运行操作界面如图 1-5 所示。  图 1-5 插入样本数据 SQL 程序执行 查看 publisher 表数据的 SQL 语句如下： select*frompubliser; 运行该 SQL 语句，其执行结果如图 1-6 所示。  图 1-6 查询 publisher 表数据 结果分析：插入表数据成功无误。 2）增加一条数据到 publisher 表 SQL 语 句 ： Insert into PUBLISHER values('PUB00000004',' 清 华 大 学 出 版 社 ','010-65323169','北京'); 运行操作界面如图 1-7 所示。  图 1-7 插入一条新数据到 publisher 表 执行结果如图 1-8 所示。  图 1-8 查询插入新数据之后的 publisher 表  结果分析：插入表数据成功。 3）删除一条publisher 表数据 SQL语句： Delete from publisher where pub_id='PUB00000004'; 运行操作界面如图 1-9 所示。  图 1-9 删除 publisher 表的一条数据 其执行结果如图 1-10 所示。  图 1-10 查询删除数据后的 publisher 表 结果分析：确实删除掉了对应的 pub_id 的数据，删除操作执行成功。 4）修改一条 publisher 表数据 SQL 语句：update publisher set pub_address='南京'where pub_id='PUB00000003'; 该语句运行操作结果如图 1-11 所示。  图 1-11 更新 publisher 表的一条数据 再对 publisher 进行查询，其执行结果如图 1-12 所示。  图 1-12 查询更新数据后的 publisher 表 结果分析：对应 pub_id 的数据确实被成功修改。 4.创建视图 实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数 据查询。创建完视图之后可用 select 语句来查看视图，用法：select *from 视图 名。例如，创建视图 BOOK_AUTHER_PUBLISHER 实现图书信息查询，其 SQL 语句如下： create view BOOK_AUTHER_PUBLISHER as select B.book_name as \"图书\",AU.au_name as\"作者\",PU.pub_name as\"出版社\",B.book_price as \"图书价格\" from book as Bjoin auther as AU on B.au_id=AU.au_id join publisher as PU on B.pub_id=PU.pub_id 该 SQL 运行操作结果如图 1-13 所示：  图 1-13 创建视图 采用如下 SQL 语句实现视图数据查询： select*from BOOK_AUTHER_PUBLISHER; 该 SQL 语句执行结果如图 1-14 所示。  图 1-14 查看视图 结果分析：视图展示数据对应正确且按需展示，视图创建成功。 5.创建触发器函数 实现思路与方法：创建触发器函数实现在有一条销售数据插入 sale 表时，同 时在库存表 stock 中插入图书的库存变化记录，并修改对应图书表 book 的库存 数，为后续的创建触发器提供函数方法。创建触发器函数 SQL 语句：  CREATE OR REPLACE FUNCTION InsertSale()RETURNS TRIGGER AS $$  BEGIN  IF(TG_OP='INSERT')THEN \t INSERT INTO stock values(new.sale_id,new.book_isbn,new.sale_qty,'出库',new.sale_date);  update book set book.book_stock = book.book_stock - new.sale_qty where book.book_isbn = new.book_isbn;  RETURN NEW;  END IF;  RETURN NULL;  END;  $$ LANGUAGE plpgsql; 运行操作界面如图 1-15 所示。  图 1-15 创建触发器函数 6. 创建触发器 实现思路与方法：创建触发器，关联销售表，在销售表插入一个新数据之后， 执行上一步编写的触发器函数。 创建触发器 SQL 语句：  CREATE TRIGGER Tri_InsertSale  AFTER INSERT ON SALE  FOR EACH ROW EXECUTE PROCEDURE InsertSale(); 运行操作界面如图 1-16 所示。  图 1-16 创建触发器 7. 测试触发器 实现思路与方法：在销售表中插入几个样本数据，之后再查看库存表和图书 表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插 入销售表的数据一致.测试触发器 SQL 语句：  Insert into sale values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885');  Insert into sale values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040');  Insert into sale values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450'); 运行操作界面如图 1-17 所示。  图 1-17 触发器创建成功 结果展示，查看 stock 表数据以及对比 book 表数据。 Stock 表数据如图 1-18 所示。  图 1-18 查看测试触发器之后的 stock 表数据 Book 表之前的数据如图 1-19 所示。  图 1-19 查看 book 表在测试触发器之前的数据 触发器执行之后的 book 表数据如图 1-20 所示。  图 1-20 查看 book 表在测试触发器之后的数据 结果分析： Stock 表本来没有数据，在 sale 插入数据之后，将库存数据进行记录，记录数据 正确，同时更新了 book 表中各对应图书的库存量，更新数据正确，触发器功能 实现正确。 8. 创建存储过程 实现思路与方法：通过存储过程实现某日图书销售数量和金额统计。创建存储过程的 SQL 语句如下。 CREATE OR REPLACE FUNCTION countsale(OUT amountint,OUT allmoneymoney) as$count$  BEGIN  Select sum(sale_qty) into amount FROM sale WHERE sale_date= '2019-05-20';  Select sum(sale_amount)into allmoney FROM sale WHERE sale_date='2019-05-20';  END;  $count$ LANGUAGE plpgsql; 该 SQL 语句运行操作界面如图 1-21 所示。  图 1-21 创建存储过程 9. 调用存储过程 实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况 一致，调用存储过程 SQL 语句如下： Select*from count sale() 存储过程调用语句执行结果如图 1-22 所示。  图 1-22 调用存储过程 结果分析：调用存储过程输出的总销售量和总金额数据正确，存储过程功能正确 九、总结及心得体会   本次实验对我来说主要是学会了数据库的基本用法，比如说创建数据库，创建表格。还有一些其他的数据库的基本操作，比如说表格数据的增删查改，创建为视图后的增删查改，都是对数据库的基本操作，但这些却极为重要，因为这些基本操作是非常基本的，但却会让数据库的结构产生一些重大的变化。这个实验稍微复杂点的东西就是触发器函数和存储过程的构建，最主要的就是这个触发器的构建让我对数据库有了新的认识，是一个很奇妙的结构，经过这次实验后，我对数据库的兴趣浓厚了许多。\n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称： 信软学院楼西303 \t\t  实验时间：2019.6.21 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库 数据的安全性。  2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派 角色。  3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作 的时候就会受到不同程度的制约 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。  2.在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。  3.在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。  4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并 为客户用户分配客户角色，为商家用户分配商家角色。  5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理 数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两 用户不同的角色权限 八、实验数据及结果分析 1.针对图书销售管理系统，设计数据存取权限控制模型。 实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家， 客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水 信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有 查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有 所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以 对库存表只有查看权限。他们的数据库存取访问权限控制模型设计如图 2-1 与图 2-2 所示。  图 2-1 客户角色安全模型  图 2-2 商家角色安全模型 2.创建客户角色和商家角色 实现思路与方法：使用 SQL 语句进行角色创建，因为客户角色和商家角色 都是普通角色，因此除了登录的功能之外其他的高级权限都为 no。 创建客户角色的 SQL 语句：  CREATE ROLE \"R_Customer\" WITH  LOGIN  NOSUPERUSER  NOCREATEDB  NOCREATEROLE  NOINHERIT  NOREPLICATION  CONNECTION LIMIT-1  创建客户角色的 SQL 运行界面如图 2-3 所示。  图 2-3 创建客户角色 创建商家角色的 SQL 语句：  CREATE ROLE \"R_Seller\" WITH  LOGIN  NOSUPERUSER  NOCREATEDB  NOCREATEROLE  NOINHERIT  NOREPLICATION  CONNECTION LIMIT-1 创建商家角色的运行界面如图 2-4 所示。  图 2-4 创建商家角色 创建两个角色的结果展示如图 2-5 所示。  图 2-5 完成创建两个角色 结果分析：在角色用户表中看到 R_Customer,R_Seller，角色创建成功。 3.赋予客户、商家角色权限 实现思路与方法：使用 SQL 语句给两个角色赋予在步骤 1 定义的权限。 赋予客户角色 SQL 语句：  GRANT SELECT ON book TO \"R_Customer\";  GRANT SELECT ON auther TO \"R_Customer\";  GRANT SELECT ON publisher TO \"R_Customer\"; 运行界面如图 2-6 所示。  图 2-6 赋予客户角色权限 赋予商家角色 SQL 语句：  GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\";  GRANT SELECT ON stock TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\";  GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\"; 运行界面如图 2-7 所示。  图 2-7 赋予商家角色权限 结果分析：权限赋予成功。 4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 实现思路与方法：使用 SQL 语句创建用户，并将对应的角色赋予他们。其 SQL 语句如下。  CREATE USER \"U_Customer\" WITH  LOGIN  CONNECTION LIMIT-1  IN ROLE \"R_Customer\"  PASSWORD'123456'; CREATE USER \"U_Seller\" WITH  LOGIN CONNECTION LIMIT-1  IN ROLE \"R_Seller\"  PASSWORD'123456'; SQL 运行界面如图 2-8 所示。  图 2-8 创建两个用户 运行结果如图 2-9 所示。  图 2-9 完成创建两个用户 结果分析：在角色用户表中发现 U_Customer,U_Seller，创建用户成功。 5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限 成功。 实现思路与方法：用客户用户和商家用户进行登录，通过对各表进行增删查 改操作来观察操作结果来验证是否与赋予他们的权限一致。 首先我们来登录客户用户来进行测试。 登录客户用户如图 2-10 所示。  图 2-10 登录客户用户 测试一：查看 book 表 SQL 语句：select*from book 运行界面和结果展示如图 2-11 所示。  图 2-11 客户用户查看 book 表数据 结果分析：客户用户可查看 book 表，权限正确。 测试二：删除 book 表中的数据 SQL 语句：delete from book where book_isbn= '9787115502742' 运行界面和结果展示如图 2-12 所示：  图 2-12 客户用户删除 book 表数据 结果分析：删除失败，客户用户不具有删除 book 表中数据的权限，权限正 确。 测试三：查看 auther 表 SQL 语句：select*from auther 运行界面和结果展示如图 2-13 所示。  图 2-13 客户用户查看 auther 表 结果分析：客户用户可查看 auther 表，权限正确。 测试四：插入一条数据到 auther 表中 SQL 语句： insert intoauther values('330304198802150325','李天','男','12365748953','北京 市产阳区李二路 18555 号') 运行界面如图 2-14 所示。  图 2-14 客户用户插入一条新数据到 auther 表 结果分析：客户用户无法在 auther 表中插入数据，权限正确。 测试五：查看 sale 表 SQL 语句：select*from sale 运行界面如图 2-15 所示。  图 2-15 客户用户查看 sale 表 结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过， 测试客户用户的权限正确。 测试完客户用户之后，我们登录商家用户来进行下一步的测试。 登录商家用户如图 2-16 所示。  图 2-16 登录商家用户 测试一：查看 customer SQL 语句：select*from customer 运行界面和结果展示如图 2-17 所示。  图 2-17 商家用户查看 customer 表 结果分析：商家用户具有查看客户表的权限，权限正确。 测试二：插入一条数据到 auther 中 SQL 语句：  insert into auther values('330304198802150325','李天','男','12365748953','北京 市产阳区李二路 18555 号') 运行界面如图 2-18 所示。  图 2-18 商家用户插入一条新数据到 auther 表 通过查看 auther 表进行结果展示如图 2-19 所示。  图 2-19 商家用户查询插入一条新数据后的 auther 表 结果分析：auther 表中新增了如上插入的数据，商家用户具有插入 auther 表 数据的权限，权限正确。 测试三：从 stock 表中删除一条数据 SQL 语句： delete from stock where stock_id='SA00001' 运行界面如图 2-20 所示。  图 2-20 商家用户删除一条 stock 表数据 结果分析：商家用户不具有删除 stock 表数据的权限，权限正确。 测试四：更新 sale 表的一条数据 SQL 语句： UPDATE sale SET sale_date='2019-05-21' WHERE sale_id='SA00001' 运行界面如图 2-21 所示。  图 2-21 商家用户更新一条 sale 表数据  结果展示，通过查看 sale 来查看结果如图 2-22 所示。  图 2-22 商家用户查看 sale 表数据 结果分析：sale 表中对应的数据被修改正确，商家用户具有修改 sale 数据的权限，权限正确。通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确 九、总结及心得体会 这次实验主要是对角色与用户的权限赋予和检测这些权限的语句。这次实验比起实验一来说，我觉得要更加的简单，但是也向我介绍数据库的一些基本知识，让我知道权限的种类有这么多，对以后的数据库开发有更大的益处。这些角色的创建与赋予权限也让数据库有更大的灵活性。这个实验虽然基础但却很重要，希望以后能再次做到这样的实验。",
  "studentID": "2017221103008"
 },
 "70": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号2017221103014          姓    名冯世维                  （实验）\t课程名称图书销售管理系统       理论教师 文军                  实验教师 何中海                    电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：冯世维\t\t学号：2017221103014        指导教师：何中海、文军   实验地点：信软楼西303     实验时间：2019.06.14、2019.06.21 一、实验名称：图书销售管理系统数据库SQL应用编程及安全管理 二、实验学时：8 三、实验目的： 实验项目1（图书销售管理系统数据库SQL应用编程）目的 \t针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法,培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 实验项目2（图书销售管理系统安全管理）目的 \t对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 在关系数据库系统中，所有对数据库的访问操作均可通过DBMS执行SQL语句操作来实现。例如，通过执行CREATE TABLE、ALTER TABLE、DROP TABLE语句实现数据库表创建、修改和删除处理。通过执行INSERT、UPDATE、DELETE语句实现数据库表中数据添加、数据修改、数据删除处理。通过执行SELECT语句实现数据库表数据查询处理。在PostgreSQL数据库系统中，可以使用数据库开发工具pgAdmin或psql命令行工具执行SQL语句，实现数据库对象及其数据的操作访问。 在PostgreSQL数据库中，存储过程、触发器和游标都可使用PL/pgSQL编程实现的数据处理。按照PL/pgSQL提供的语句和程序结构，实现数据库后端功能编程处理。可以使用数据库开发工具pgAdmin或psql命令行工具执行PL/pgSQL程序，实现数据库后端功能处理。 五、实验内容： 实验项目1（图书销售管理系统数据库SQL应用编程）实验内容 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 实验项目2（图书销售管理系统数据库SQL应用编程）实验内容 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）： 装有PostgreSQL 11的PC一台 七、实验步骤： 实验1 1.执行以下语句，创建数据库表booksale，如图1-1所示 \t\t\t\t\t\t\t\t图1-1 结果分析：数据库创建成功。 2.执行下列SQL语句，创建数据库表，并定义完整性约束，如图1-2所示 \t\t\t\t\t\t\t\t图1-2 结果分析：数据库表创建成功且规定约束。 3.执行下面的SQL语句，创建视图，如图1-3所示     图1-3视图  4.执行下面的SQL语句，向创建的表中插入数据，图1-4为插入成功提示图  图1-4插入成功提示图  图1-5作者信息数据图  图1-6书籍信息数据图  图1-7顾客信息数据图  图1-8出版社信息数据图  图1-9销售信息数据图（此处并未插入）   图1-10存货量数据图 5.执行SQL语句，实现数据删除操作 \t1）增加一条数据到 publisher 表 SQL 语句：   图1-11增加一条数据到出版社表 \t 图1-12插入数据成功 2）删除publisher表中的上述数据 \tSQL语句：  图1-13删除数据成功  图1-14删除后的出版社表 6.执行SQL语句，实现数据查找 \t查找book表的SQL语句：  图1-15查询book表 7.执行SQL语句，实现数据修改 \t修改数据的SQL语句：  \t 图1-16修改成功  图1-17修改成功后表中数据显示 8.编写函数Pro_CurrentSale，实现对当日销售量及销售金额进行统计，具体函数声明如下 其中，函数的输入参数为当日的日期  图1-18构建函数结果 9.编写过程语句块，实现对函数Pro_CurentSale的调用，并输出统计的结果 图1-19函数运算结果  10.编写图书销售表insert触发器Tri_InsertSale,实现图书库存数据同步修改处理。具体触发器处理函数和触发器创建SQL语句如下  图1-20触发器函数创建  图1-21触发器创建SQL语句 11.执行以下SQL语句，向sale表中插入销售数据，对触发器程序进行功能验证。  图1-22插入数据  图1-23 插入数据后数据变动 实验2： 针对图书销售管理系统，在设计数据存取权限控制模型。 角色权限表  在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。  创建用户代码如：     图2-1创建角色成功 创建商家角色代码：       图2-2创建商家角色成功  图2-3创建角色结果 在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。  赋予用户权限代码如：    图2-4赋予成功图 赋予商户权限代码如：         图2-5赋予成功图 在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并 为客户用户分配客户角色，为商家用户分配商家角色。  实现代码如：         图2-6分配角色  图2-7分配角色成功  分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理 数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两 用户不同的角色权限。 1）：用户登陆后查询book表  图2-8用户查询book表 2）：用户登陆后修改book表 \t显示错误，不足权限 3）：商户登陆后查询book表  图2-9商户查询book表 4）：商户插入数据到Author表  图2-10商户插入数据成功 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 综合以上分析可以得出结论：成功实现了图书销售管理系统数据库SQL应用编程和成功实现了图书销售管理系统安全管理任务。 十、对本实验过程及方法、手段的改进建议： \t实验前的作业锻炼的很好，所以实验时并没有什么压力，主要还是做实验时需要仔细分析和仔细编码，出了错误会比较难去发现。                                                      报告评分：                                          指导教师签字：",
  "studentID": "2017221103014"
 },
 "71": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号2017221103015          姓    名张磊                   （实验）\t课程名称图书销售管理系统       理论教师 文军                  实验教师 何中海                    电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：张磊\t\t学号：2017221103015        指导教师：何中海、文军   实验地点：信软楼西303     实验时间：2019.06.14、2019.06.21 一、实验名称：图书销售管理系统数据库SQL应用编程及安全管理 二、实验学时：8 三、实验目的： 实验项目1（图书销售管理系统数据库SQL应用编程）目的 \t针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法,培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 实验项目2（图书销售管理系统安全管理）目的 \t对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 在关系数据库系统中，所有对数据库的访问操作均可通过DBMS执行SQL语句操作来实现。例如，通过执行CREATE TABLE、ALTER TABLE、DROP TABLE语句实现数据库表创建、修改和删除处理。通过执行INSERT、UPDATE、DELETE语句实现数据库表中数据添加、数据修改、数据删除处理。通过执行SELECT语句实现数据库表数据查询处理。在PostgreSQL数据库系统中，可以使用数据库开发工具pgAdmin或psql命令行工具执行SQL语句，实现数据库对象及其数据的操作访问。 在PostgreSQL数据库中，存储过程、触发器和游标都可使用PL/pgSQL编程实现的数据处理。按照PL/pgSQL提供的语句和程序结构，实现数据库后端功能编程处理。可以使用数据库开发工具pgAdmin或psql命令行工具执行PL/pgSQL程序，实现数据库后端功能处理。 五、实验内容： 实验项目1（图书销售管理系统数据库SQL应用编程）实验内容 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 实验项目2（图书销售管理系统数据库SQL应用编程）实验内容 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）： 装有PostgreSQL 11的PC一台 七、实验步骤： 实验1 1.执行以下语句，创建数据库表booksale 2.执行下列SQL语句，创建数据库表，并定义完整性约束 4.执行下面的SQL语句，创建视图 5.执行下面的SQL语句，创建索引对象 6.执行下面的SQL语句，向创建的表中插入数据 7.执行SQL语句，实现数据删除操作 8.执行SQL语句，实现数据查找 9.执行SQL语句，实现数据修改 10.编写函数Pro_CurrentSale，实现对当日销售量及销售金额进行统计，具体函数声明如下 其中，函数的输入参数为当日的日期 11.编写过程语句块，实现对函数Pro_CurentSale的调用，并输出统计的结果 12.编写图书销售表insert触发器Tri_InsertSale,实现图书库存数据同步修改处理。具体触发器处理函数和触发器创建SQL语句如下 13.执行以下SQL语句，向sale表中插入销售数据，对触发器程序进行功能验证。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 实验2 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 \t1）设计角色权限表如下 角色权限表 \t2）设计数据库存取控制安全模型如下图所示  2.在数据库中，执行下列SQL语句，创建客户（R_Customer）、商家（R_seller）角色 3.根据步骤1中的权限表，执行下列SQL语句，为客户和商家角色赋予数据库对象权限 4.执行下列SQL语句，在数据库中，分别创建客户用户（U_Customer）、和商家用户（U_seller），并为他们分配角色 5.分别以客户用户U_Customer、商家用户U_seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 九、总结及心得体会： 实验1 执行数据库创建语句后结果如图1和图2所示 图1 创建数据库SQL语句执行结果 图2 创建完成后数据库对象界面 从图1和图2可以看出，成功创建了图书销售管理数据库booksale。 执行数据库表创建语句执行后，表对象界面，如图3所示。 图3 数据库表创建完成后表对象界面 从图3可以看出，成功创建了相关的数据库表 创建视图对象语句的执行结果及完成后视图对象界面如图4和图5所示 图4 创建视图对象语句执行结果 图5 创建视图对象完成后视图对象界面 从图4和图5可以看出成功创建了视图对象 创建数据库索引对象语句的执行结果及执行后索引对象界面如图6和图7所示 图6 索引对象创建语句执行结果 图7 索引对象界面 从图6和图7可以看出，成功创建了数据库索引对象 验证数据库表的查询操作，验证结果如图8所示 图8 数据库表查询操作验证结果 从图8可以看出数据库表查询操作正常 验证数据库表更新操作，验证结果如图9所示           图9 数据库表更新操作验证结果 从图9可以看出，数据库表更新操作正常 编写过程语句块对函数Pro_CurrentSale进行调用，输出统计结果。调用过程及输出结果如图10所示       图10 调用函数Pro_CurrentSale输出结果 从图10可以看出成功调用了函数Pro_CurrentSale，输出了当日的销售额和销售量。 对触发器Tri_InsertSale功能进行验证，创建好的触发器对象界面如图11所示。执行插入操作之前，库存表inventory中对应表项信息如图12所示，插入操作完成后，库存表inventory中对应表现信息变为如图13所示。 图11 创建完成后针对sale表的触发器对象界面 图12 执行insert操作之前库存表对应表项信息 图13 执行insert操作之后库存表对应项信息 从图12和图13的对比以及执行的插入语句来看，触发器的功能正常，实现了同步修改库存表的功能。 综合以上实验结果分析可以得出结论：成功实现了图书销售管理数据库系统创建与相关SQL应用编程操作。 实验2 创建客户和商家角色后，角色对象界面如图14所示   图14 客户和商家角色对象界面 为两个角色赋予数据库对象权限后，创建客户用户U_Customer和商家用户U_seller，并分别为他们分配R_Customer和R_seller角色，赋予初始密码为“123456”。创建完成后，用户对象界面如图15所示         图15 客户用户和商家用户对象界面 以客户用户U_Customer身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。首先以用户U_Customer身份创建一个服务器，输入主机地址为本机，服务器名称为U_Customer，输入用户名为U_Customer，输入用户U_Customer的密码。创建界面以及创建完成后的服务器对象界面如图16和图17所示       图16 创建服务器界面 图17 服务器对象界面 接着访问图书销售管理数据库，验证用户U_Customer的权限，部分验证结果如图18-2所示 所示图18 验证客户用户是否具有数据库创建权限 从上图可以看出客户用户不具备创建数据库的权限   图19 验证客户用户是否具有角色创建权限 从上图可以看出客户用户不具备创建数据库角色的权限 图20 验证客户用户对authorrank表的查询权限 从上图中可以看出用户对表authorrank不具备查询权限         图21 验证客户用户对数据库表author的查询权限 从图21可以看出，查询语句成功返回了查询结果，说明客户用户对作者表具有查询权限 其它客户用户的权限的验证过程同上，在此不再赘述。接下来以商家用户的身份创建服务器，验证商家用户的数据库存取控制权限。部分验证结果如图22-26所示     图22 以商家用户身份创建服务器界面  图23 创建完成后服务器对象界面   图24 验证商家用户创建数据库的权限 从图24可以看出，商家用户创建数据库的请求被拒绝，说明商家用户不具备创建数据库的权限 图25 验证商家用户创建数据库角色的权限 从图25可以看出，商家用户创建数据库角色的请求被拒绝，说明商家用户不具备创建数据库角色的权限。 图26 验证商家用户对数据库折扣表的插入数据权限 从图26可以看出，返回了成功信息，说明商家用户对折扣表具有相应的插入数据权限 综合以上分析可以得出结论：成功实现了图书销售管理系统安全管理任务。 十、对本实验过程及方法、手段的改进建议： \t实验时可否在大型机上面进行相关的实验，提供创建好的数据库，直接在该数据库上进行响应的操作，另外可以尝试进行数据库嵌入式编程相关方面的实验，可以更贴近实际工程应用。                                                      报告评分：                                          指导教师签字：",
  "studentID": "2017221103015"
 },
 "72": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221103022      姓    名       马雪驰          （实验）\t课程名称   数据库原理及应用    理论教师       文  军          实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：马雪驰\t\t学号：2017221103022    指导教师：何中海   实验地点：信软楼西303     实验时间：2019.6.14 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：4 三、实验目的： 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理： 1.首先对图书销售管理系统进行数据需求分析,定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案,通过SQL编程执行来完成对数据库的实现操作。在本实验中，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建,并编写SQL语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容： 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤： 1.在数据库服务器中，采用SQL语句执行方式，创建图书销售管理系统数据库booksale。 2.在BookSale数据库中,采用SQL语句执行方式，创建book(图书表)、auther(作者表)、publisher (出版社表)、stock (库存流水表)、customer (客户表)、sale(销售表)，以及各表主键外键的创建，并为给表创建索引。  3.为book、auther、publisher、 customer 表准备样本数据，采用SQL语句执行方式，将样本数据插入到表中。采用SQL语句对book、auther、 publisher、customner表进行数据修改、删除、查询、统计等访问操作。 4.创建视图book auther publisher,该视图查询数据库,输出图书名、作者、出版社以及图书价格等数据。对视图book_view进行数据查询访问操作。 5.编写触发器函数，实现在sale表数据插入时，级联操作stock表，将图书的库存流水进行记录，同时级联更新book表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器,实现上一步中提到的功能。 7.测试触发器的功能，准备sale 表的样本数据，并将其插入sale表，插入之后查看stock表是否有对应的更新，并对比插入sale数据前后book中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建booksale数据库 使用create database booksale_2017221103022;语句进行创建：    创建结果如下：    由此可见，数据库booksale_2017221103022创建成功。 创建各个数据库表以及表中的外键和索引 先创建表： 将上述代码执行，执行结果如下：   执行完后，在数据库中查看新添加的数据库表对象：  得知数据库表对象创建成功。 插入样本数据，并对auther_2017221103022表进行增删改查操作 插入样本数据到数据库中 执行结果如下：   插入数据成功。 查看auther_2017221103022表数据的代码如下： select *from auther_2017221103022; 执行结果如下：   查询成功。  2）接着添加一条数据进去：    接着我们查询一下，结果如下：    结果成功。  3）接下来进行删除操作，以auther_name为基准删除刚插入的数据。 delete from auther_2017221103022 where auther_name='祝晴';       再用select操作后发现成功。   修改一条auther_2017221103022表数据  执行结果   创建视图 实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数据查询。创建完视图之后可用 select 语句来查看视图，用法：select * from 视图名。例如，创建视图 book_au_pub_view 实现图书信息查询，其代码如下；   再进行视图数据查询： select* from book_au_pub_view;  查询结果如下：   视图创建成功。 5.创建触发器函数 创建触发器函数实现在有一条销售数据插入 sale 表时，同时在库存表 stock 中插入图书的库存变化记录，并修改对应图书表 book 的库存数，为后续的创建触发器提供函数方法。代码如下：   接下来创建触发器：  6.测试触发器 在销售表中插入几个样本数据，之后再查看库存表和图书表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插入销售表的数据一致。    再查看stock表和book表    很明显，触发器执行成功。 创建存储过程 通过存储过程实现某日图书销售数量和金额统计。     调用存储过程 实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况一致 Select * from countsale()；    九、总结及心得体会： 通过这次实验，我了解了SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握了基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。 对本实验过程及方法、手段的改进建议： 无                                                      报告评分：                                          指导教师签字： \n 电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221103022      姓    名       马雪驰          （实验）\t课程名称   数据库原理及应用    理论教师       文  军          实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：马雪驰\t\t学号：2017221103022    指导教师：何中海   实验地点：信软楼西303     实验时间：2019.6.21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：4 三、实验目的： 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容： 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤： 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。 3.在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对客户（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建客户角色和商家角色 使用 SQL 语句进行角色创建，因为客户角色和商家角色都是普通角色，因此除了登录的功能之外其他的高级权限都为 no。代码如下：      2.赋予客户与商家权限 代码如下：    一次性赋予了商家和客户角色的权限成功。  创建客户用户以及商家用户，并将客户的角色和商家角色赋予他们，代码如下：    创建成功。   分别用客户用户和商家用户登录数据库，并对权限进行验证。 首先登录客户用户进行测试。  1）查看book表   结果正确。 删除一条book_2017221103022表数据   可以看出没有权限。成功。 查看auther表   结果正确。 添加一条数据进auther_2017221103022表   权限不够，成功。 查看sale表  权限不够，成功。 接下来登录商家用户进行测试。   查看customer_2017221103022表  执行成功。 插入一条数据到auther_2017221103022中： 接下来查询验证。   可见添加成功。 从stock_2017221103022中删除一条数据  权限不够，成功。  更新sale_2017221103022一条数据   查询验证一下。   成功。  九、总结及心得体会： 通过这次实验，我了解了该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养了数据库管理能力。 对本实验过程及方法、手段的改进建议： 无                                                      报告评分：                                          指导教师签字：",
  "studentID": "2017221103022"
 },
 "73": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号 2017221104006         姓    名 赖文韬                （实验）\t课程名称 数据库原理及应用      理论教师 文军                  实验教师 何中海                    电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：赖文韬\t\t学号：201722110406    指导教师：何中海 实验地点：信软楼303     实验时间：2019.6.14 一、实验名称：图书销售管理系统数据库 SQL 应用编程\t 二、实验学时：8 三、实验目的： 针对图书销售管理数据库开发，了解 SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的 SQL 数据操作访问和后端数据处理功能。  四、实验原理： 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）： pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP管理工具：pgAdmin4 DBMS 系统： PostgreSQL 11  七、实验步骤： 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库BookSale。 2.在BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther（作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为 book、auther、publisher、customer表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、customer 表进行数据修改、删除、查询、统计等访问操作。 4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） （1）图书销售管理系统数据库BookSale创建操作 SQL 语句：create database \"BookSale\"  （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象  运行结果：             （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 1）添加数据 查看publisher数据表语句： 查看结果如下：    2）增加数据  查看结果：  3）删除数据 查看结果：   4）修改数据  查看结果： （4）创建视图 查看：  （5）创建触发器函数 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。   （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 结果展示，查看 stock 表数据以及对比 book 表数据：      Stock表： book表：  九、总结及心得体会： 通过本次实验，我学会了如何创建数据库，以及增删改查数据，和创建触发器。 十、对本实验过程及方法、手段的改进建议： 无改进建议                                                            报告评分：                                          指导教师签字： 电子科技大学信息与软件工程学院    实 验 报 告    学    号 2017221104006         姓    名 赖文韬                （实验）\t课程名称 数据库原理及应用      理论教师 文军                  实验教师 何中海                    电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：赖文韬\t\t学号：201722110406    指导教师：何中海 实验地点：信软楼303     实验时间：2019.6.21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：8 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）： pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP管理工具：pgAdmin4 DBMS 系统： PostgreSQL 11  七、实验步骤： 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户（R_Customer）角色、商家（R_Seller）角色。 3. 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 创建客户角色： 创建商家角色：    创建结果：  （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 赋予客户角色 SQL 语句： 赋予商家角色 SQL 语句：  （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。    创建结果： 创建成功。  （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 首先我们来登录客户用户来进行测试： 测试一：查看 book 表 测试二：删除 book 表中的数据 结果分析：删除失败，客户用户不具有删除 book 表中数据的权限，权限正确。 测试三：查看 auther 表 结果分析：客户用户可查看 auther 表，权限正确。 测试四：插入一条数据到 auther 表中 结果分析：客户用户无法在 auther 表中插入数据，权限正确。  登入商家用户： 测试一：查看 customer       结果分析：商家用户具有查看客户表的权限，权限正确。 测试二：插入一条数据到 auther 中 结果分析：auther 表中新增了如上插入的数据，商家用户具有插入 auther 表数据的权限，权限正确。 九、总结及心得体会： 通过本次实验，我学会了如何设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 十、对本实验过程及方法、手段的改进建议： 无改进建议                                                                           报告评分：                                          指导教师签字：",
  "studentID": "2017221104006"
 },
 "74": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号  2017221104017        姓    名       涂一吉          （实验）\t课程名称  数据库原理及应用     理论教师       何中海          实验教师        文军               电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：涂一吉\t\t学号：2017221104017    指导教师：何中海  实验地点：实验楼303     实验时间：19.6.10 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：4学时 三、实验目的： 针对图书销售管理数据库开发，了解 SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的 SQL 数据操作访问和后端数据处理功能。 四、实验原理： 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容： 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行 SQL 编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行 SQL 创建图书销售管理系统数据库 BookSale。 2.在数据库 BookSale 中，执行 SQL 创建数据库表、视图、索引等对象。 3.在数据库 BookSale 中，执行 SQL 进行数据增、删、查、改访问操作。 4. 在 数 据 库 BookSale 中 ， 采 用 PL/pgSQL 语 言 编 写 存 储 过 程 函 数 Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库 BookSale 中，采用 PL/pgSQL 语言编写过程语句块，实现对存储过程函数 Pro_CurrentSale 的调用，并输出统计结果。 6.在数据库 BookSale 中，采用 PL/pgSQL 语言编写编写图书销售表 Insert 触发器Tri_InsertSale，实现图书库存数据同步修改处理。                      7.在数据库 BookSale 中，对图书销售表 Insert 触发器 Tri_InsertSale 程序进行 功能验证。 8.在数据库 BookSale 中，创建存储过程函数实现图书销售数量和金额统计。在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL、PL/pgSQL 语言， 完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： 数据库原理及应用实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统：win10 数据库管理工具：PgAdmin4 数据库：PostgreSQL11 七、实验步骤： 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建数据库  2.创建数据库表并定义主键外键                                                运行结果：  3.数据插入以及增删改查操作                   执行查操作:select * from publiser; 运行结果:          执行增操作:Insert into PUBLISHER values('PUB00000004',' 清 华 大 学 出 版 社','010-65323169','北京'); 运行结果:  执行删操作:delete from publisher where pub_id = 'PUB00000004'; 运行结果：   执行修改操作:update publisher set pub_address = '南京' where pub_id = 'PUB00000003'; 运行结果: 4.创建视图  调用视图：select * from BOOK_AUTHER_PUBLISHER; 运行结果：     5.创建触发器函数               6.创建触发器 执行语句： CREATE TRIGGER Tri_InsertSale  AFTER INSERT ON SALE FOR EACH ROW EXECUTE PROCEDURE InsertSale(); 执行结果：    7.触发器测试 执行语句： Insert into sale values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885'); Insert into sale values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040');  Insert into sale values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450'); 运行结果：     8.创建存储过程        9.调用存储功能 运行语句：Select * from countsale()； 九、总结及心得体会： 需要熟练SQL语言，难度一般。 对本实验过程及方法、手段的改进建议： 无                                                      报告评分：                                          指导教师签字：                  电 子 科 技 大 学 实   验   报   告 学生姓名：涂一吉\t\t学号：2017221104017    指导教师：何中海  实验地点：实验楼303     实验时间：19.6.15 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：4学时 三、实验目的： 了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容： 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  4.在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。 5.分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL 语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： 数据库原理及应用实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统：win10 数据库管理工具：PgAdmin4 数据库：PostgreSQL11 七、实验步骤： 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。 3. 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析）  1.数据存取权限控制模型     2.创建角色 顾客：       商家：        3.权限赋予 顾客：    商家：       4.创建实例        5.验证数据库正确性 查看商家权限： 数据增添和删除    结果： 权限正确 九、总结及心得体会： 视图的创建是一个难点，权限赋予在理清楚人物的关系后比较简单。 十、对本实验过程及方法、手段的改进建议： 无                                                      报告评分：                                          指导教师签字：",
  "studentID": "2017221104017"
 },
 "75": {
  "content": "  电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221104024       姓    名         吴桐            （实验）课程名称   数据库原理及应用      理论教师         文军            实验教师        何中海               电子科技大学教务处制表  电\t子\t科\t技\t大\t学 实\t验\t报\t告  一、实验一：图书销售管理系统数据库 SQL 编程 二、实验室名称：303\t实验时间：2019.6.14  三、实验目的 针对图书销售管理数据库开发，了解 SQL 语言 DDL、DML、DQL 类型语句在数据库操作访问中的应用方法，培养数据库 SQL 编程访问能力。同时也掌握基本的数据库触发器、存储过程 SQL 编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的 SQL 数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行 SQL 编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行 SQL 创建图书销售管理系统数据库 BookSale。 2.在数据库 BookSale 中，执行 SQL 创建数据库表、视图、索引等对象。 3.在数据库 BookSale 中，执行 SQL 进行数据增、删、查、改访问操作。 4. 在 数 据 库 BookSale 中 ， 采 用 PL/pgSQL 语 言 编 写 存 储 过 程 函 数 Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库 BookSale 中，采用 PL/pgSQL 语言编写过程语句块，实现对存储过程函数 Pro_CurrentSale 的调用，并输出统计结果。 6.在数据库 BookSale 中，采用 PL/pgSQL 语言编写编写图书销售表 Insert 触  发器Tri_InsertSale，实现图书库存数据同步修改处理。                     7.在数据库 BookSale 中，对图书销售表 Insert 触发器 Tri_InsertSale 程序进行 功能验证。 8.在数据库 BookSale 中，创建存储过程函数实现图书销售数量和金额统计。在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL、PL/pgSQL 语言， 完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为： pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP  管 理 工 具 ： pgAdmin4 DBMS  系统： PostgreSQL 11 七、实验步骤 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。  八、实验数据及结果分析 创建 BookSale 数据库 实现思路与方法：使用 SQL 语句来进行数据库的创建。 SQL 语句：create database \"BookSale\" 运行操作界面如图 1-1 所示。               图 1-1 创建数据库 数据库操作结果面如图 1-2 所示。           图 1-2 数据库创建完成 结果分析：成功创建数据库。 创建各数据库表以及表中主外键和索引 实现思路与方法：首先明确图书销售管理系统的实体、实体属性以及各实体之间的联系，再通过 SQL 语句对表进行创建，表对应实体，实体属性对应表中的列，通过主外键来将表联系起来。 SQL 语句： create table Auther ( AU_ID\tCHAR(18)\tnot null, AU_Name\tVARCHAR(20)\tnot null,  AU_Gender\tCHAR(2)\tnot null, AU_Phone\tVARCHAR(11)\tnot null, AU_Address\tVARCHAR(50)\tnot null,  constraint PK_AUTHER primary key (AU_ID) ); create table Book ( constraint PK_BOOK primary key (Book_ISBN) ); create table CUSTOMER ( CUST_ID\tCHAR(18)\tnot null, CUST_Name\tVARCHAR(20)\tnot null, CUST_Phone\tVARCHAR(15)          not null,  CUST_Address         VARCHAR(50)          not null,  CUST_Email\tVARCHAR(50)          not null,  constraint PK_CUSTOMER primary key (CUST_ID) ); create table Publisher ( PUB_ID\tCHAR(11)\tnot null, PUB_Name\tVARCHAR(20)          not null, PUB_Phone\tVARCHAR(15)          not null,  PUB_Address          VARCHAR(50)          not null,  constraint PK_PUBLISHER primary key (PUB_ID) ); create table Sale ( constraint PK_SALE primary key (SALE_ID) ); create table Stock ( Stock_ID\tVARCHAR(10)\tnot null,  constraint PK_STOCK primary key (Stock_ID) ); alter table Book add constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) references Auther (AU_ID) on delete restrict on update restrict; alter table Book add constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) references Publisher (PUB_ID) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict; alter table Sale add constraint FK_SALE_CUSTOMER CUSTOMER foreign key (CUST_ID) references CUSTOMER (CUST_ID) on delete restrict on update restrict; alter table Stock add constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) references Book (Book_ISBN) on delete restrict on update restrict;  将上面的 SQL 程序，提交到数据库服务器执行，其执行作界面如图 1-3 所示。  图 1-3 创建数据库表 SQL 程序执行结果  当 SQL 程序成功执行后，可以在数据库看到新添加的数据库表对象，如图 1-4 所示。  图 1-4 图书销售数据库表对象 结果分析：成功创建各数据库表。  插入样本数据并对 publisher 表进行增删查改操作 实现思路与方法：首先准备样本数据，尽可能使得数据符合实际应用并且要能满足后续的数据处理操作。这里以 publisher 表为例，给出该表的数据增、删、查、改 SQL 语句操作访问。 1）执行 SQL 语句，插入样本数据到图书销售数据库 Insert into Auther values('330309198504150527','王天','男','13554874593','四川省成都市成华区建设北路二段十号'); Insert into Auther values('540135199103281548','叶无双','男','15812387538','浙江省杭州市天路区梅田路二十八号'); Insert into Auther values('120857198811123587','李婷','女','18575615472','北京市朝阳区梅山路二巷八号 '); Insert into PUBLISHER values('PUB00000001','高等教育出版社','010-65321854','北京');  Insert into PUBLISHER values('PUB00000002','电子工业出版社','010-65329857','北京');  Insert into PUBLISHER values('PUB00000003','人民邮电出版社','010-65325987','北京'); Insert into BOOK values('9787115502742','330309198504150527','PUB00000001','Web 前端开发最佳实践','2016-01-01', '59','IT 技术','100'); Insert into BOOK values('9875325415577','540135199103281548','PUB00000002','Java EE Web 编 程 ','2008-01-01', '52','IT 技术','200'); Insert into BOOK values('9865365975234','120857198811123587','PUB00000003',' 数 据 库 实 验 指 导','2013-08-1','29','IT 技术', '150'); Insert into customer values('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insert into customer values('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十九号','657873215@qq.com'); Insert into customer values('542244197812121687','鲁丽','13615869875','北京市朝阳区梅山路二巷十六号','647864378@qq.com'); 样本数据插入 SQL 程序的运行操作界面如图 1-5 所示。 图 1-5 插入样本数据 SQL 程序执行 查看 publisher 表数据的 SQL 语句如下： select * from publiser; 运行该 SQL 语句，其执行结果如图 1-6 所示。            图 1-6 查询 publisher 表数据  结果分析：插入表数据成功无误。  2）增加一条数据到 publisher 表 SQL 语 句 ： Insert into PUBLISHER values('PUB00000004',' 清 华 大 学 出 版 社 ','010-65323169','北京'); 运行操作界面如图 1-7 所示。       执行结果如图 1-8 所示。 \n图 1-7 插入一条新数据到 publisher 表     图 1-8 查询插入新数据之后的 publisher 表 结果分析：插入表数据成功。  3）删除一条 publisher 表数据 SQL 语句：delete from publisher where pub_id = 'PUB00000004'; 运行操作界面如图 1-9 所示。    图 1-9 删除 publisher 表的一条数据 其执行结果如图 1-10 所示。          图 1-10 查询删除数据后的 publisher 表 结果分析：确实删除掉了对应的 pub_id 的数据，删除操作执行成功。  4）修改一条 publisher 表数据 SQL 语句：update publisher set pub_address = '南京' where pub_id = 'PUB00000003'; 该语句运行操作结果如图 1-11 所示。  图 1-11 更新 publisher 表的一条数据 再对 piblisher 进行查询，其执行结果如图 1-12 所示。             图 1-12 查询更新数据后的 publisher 表 结果分析：对应 pub_id 的数据确实被成功修改。  4.创建视图 实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数据查询。创建完视图之后可用 select 语句来查看视图，用法：select * from 视图名。例如，创建视图 BOOK_AUTHER_PUBLISHER 实现图书信息查询，其 SQL 语句如下： create view BOOK_AUTHER_PUBLISHER as select B.book_name as \"图书\",AU.au_name as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\" from book as B join auther as AU on B.au_id = AU.au_id join publisher as PU on B.pub_id = PU.pub_id  该 SQL 运行操作结果如图 1-13 所示：          图 1-13  创建视图 采用如下 SQL 语句实现视图数据查询： select * from BOOK_AUTHER_PUBLISHER; 该 SQL 语句执行结果如图 1-14 所示。   图 1-14  查看视图 结果分析：视图展示数据对应正确且按需展示，视图创建成功。  5.创建触发器函数 实现思路与方法：创建触发器函数实现在有一条销售数据插入 sale 表时，同时在库存表 stock 中插入图书的库存变化记录，并修改对应图书表 book 的库存数，为后续的创建触发器提供函数方法。 创建触发器函数 SQL 语句： CREATE OR REPLACE FUNCTION InsertSale() RETURNS TRIGGER AS $$ BEGIN IF (TG_OP = 'INSERT') THEN INSERT INTO stock values(new.sale_id,new.book_isbn,new.sale_qty,' 出 库 ',new.sale_date); update book set book.book_stock = book.book_stock - new.sale_qty where book.book_isbn = new.book_isbn; RETURN NEW;     END; \nEND IF; RETURN NULL;  $$ LANGUAGE plpgsql; 运行操作界面如图 1-15 所示。 图 1-15  创建触发器函数  创建触发器 实现思路与方法：创建触发器，关联销售表，在销售表插入一个新数据之后， 执行上一步编写的触发器函数。 创建触发器 SQL 语句： CREATE TRIGGER Tri_InsertSale AFTER INSERT ON SALE FOR EACH ROW EXECUTE PROCEDURE InsertSale();  运行操作界面如图 1-16 所示。 图 1-16 创建触发器    测试触发器 \n   实现思路与方法：在销售表中插入几个样本数据，之后再查看库存表和图书 表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插入销售表的数据一致。 测试触发器 SQL 语句： Insert into sale values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885'); Insert into sale values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040'); Insert into sale values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450');  运行操作界面如图 1-17 所示。  图 1-17  测试触发器 结果展示，查看 stock 表数据以及对比 book 表数据。  Stock 表数据如图 1-18 所示。 图 1-18 查看测试触发器之后的 stock 表数据 Book 表之前的数据如图 1-19 所示。       图 1-19  查看 book 表在测试触发器之前的数据  触发器执行之后的 book 表数据如图 1-20 所示。     结果分析： \n图 1-20  查看 book 表在测试触发器之后的数据  Stock 表本来没有数据，在 sale 插入数据之后，将库存数据进行记录，记录数据 正确，同时更新了 book 表中各对应图书的库存量，更新数据正确，触发器功能实现正确。  创建存储过程 实现思路与方法：通过存储过程实现某日图书销售数量和金额统计。创建存储过程的 SQL 语句如下。  CREATE OR REPLACE FUNCTION countsale(OUT amount int,OUT allmoney money) as $count$ BEGIN select sum(sale_qty) into amount FROM sale WHERE sale_date = '2019-05-20'; select sum(sale_amount) into allmoney FROM sale WHERE sale_date = '2019-05-20'; END; $count$ LANGUAGE plpgsql; 该 SQL 语句运行操作界面如图 1-21 所示。              调用存储过程 \n   图 1-21  创建存储过程  实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况 一致，调用存储过程 SQL 语句如下： Select * from countsale() 存储过程调用语句执行结果如图 1-22 所示。 图 1-22  调用存储过程 结果分析：调用存储过程输出的总销售量和总金额数据正确，存储过程功能正确。  九、总结及心得体会 本次实验中，我对数据库的基本操作更加熟悉和掌握，而且特别是对函数以及触发器的应用。函数和触发器的相关内容在上课时，因为老师的讲课速度有些快，我并没有很深的理解，掌握上也很生疏，本次实验让我在一定程度上复习了上课的内容。另一方面，我也体会到了数据库工作人员的辛苦。因为，这次实验真的很麻烦，特别是插入数据的过程极其麻烦。  电\t子\t科\t技\t大\t学 实\t验\t报\t告  一、实验二：图书销售管理系统数据库安全管理  二、实验室名称：303\t实验时间：2019.6.21  三、实验目的 了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  4.在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。 5.分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL 语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以及网络环境，pc 计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS 系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。 3. 在 pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析 1.针对图书销售管理系统，设计数据存取权限控制模型。 实现思路与方法：针对图书销售管理系统，主要的是两个角色，客户和商家， 客户角色对于任何的数据表都最多只有读取权限，而图书的销售信息、库存流水  信息和其他客户的信息都不应该被客户查看到。因此客户角色对于整个系统只有查看图书、作者、出版社表的权限。而商家角色则具有对除了库存表以外，具有所有表的增删查改权限。因为库存表的数据都是根据销售表来进行变化的，所以对库存表只有查看权限。他们的数据库存取访问权限控制模型设计如图 2-1 与图 2-2 所示。   图 2-1 客户角色安全模型         2.创建客户角色和商家角色 \n图 2-2 商家角色安全模型  实现思路与方法：使用 SQL 语句进行角色创建，因为客户角色和商家角色 都是普通角色，因此除了登录的功能之外其他的高级权限都为 no。创建客户角色的 SQL 语句： CREATE ROLE \"R_Customer\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1 创建客户角色的 SQL 运行界面如图 2-3 所示。   图 2-3 创建客户角色 创建商家角色的 SQL 语句： CREATE ROLE \"R_Seller\"\tWITH LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOREPLICATION CONNECTION LIMIT -1  创建商家角色的运行界面如图 2-4 所示。 图 2-4 创建商家角色 创建两个角色的结果展示如图 2-5 所示。 图 2-5 完成创建两个角色 结果分析：在角色用户表中看到 R_Customer,R_Seller，角色创建成功。  3.赋予客户、商家角色权限 实现思路与方法：使用 SQL 语句给两个角色赋予在步骤 1 定义的权限。赋予客户角色 SQL 语句： GRANT SELECT ON book TO \"R_Customer\"; GRANT SELECT ON auther TO \"R_Customer\"; GRANT SELECT ON publisher TO \"R_Customer\";  运行界面如图 2-6 所示。    图 2-6 赋予客户角色权限  赋予商家角色 SQL 语句： GRANT SELECT,INSERT,UPDATE,DELETE ON book TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON auther TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON publisher TO \"R_Seller\"; GRANT SELECT ON stock TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON sale TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON customer TO \"R_Seller\";  运行界面如图 2-7 所示。            图 2-7 赋予商家角色权限  结果分析：权限赋予成功。  4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 实现思路与方法：使用 SQL 语句创建用户，并将对应的角色赋予他们。其 SQL 语句如下。 CREATE USER \"U_Customer\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Customer\" PASSWORD '123456';   CREATE USER \"U_Seller\" WITH LOGIN CONNECTION LIMIT -1 IN ROLE \"R_Seller\" PASSWORD '123456';  SQL 运行界面如图 2-8 所示。              运行结果如图 2-9 所示。 \n   图 2-8 创建两个用户    图 2-9 完成创建两个用户 结果分析：在角色用户表中发现 U_Customer,U_Seller，创建用户成功。  5.分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功。 实现思路与方法：用客户用户和商家用户进行登录，通过对各表进行增删查改操作来观察操作结果来验证是否与赋予他们的权限一致。 首先我们来登录客户用户来进行测试。登录客户用户如图 2-10 所示。  图 2-10  登录客户用户  测试一：查看 book 表 SQL 语句：select * from book 运行界面和结果展示如图 2-11 所示。            图 2-11 客户用户查看 book 表数据  结果分析：客户用户可查看 book 表，权限正确。  测试二：删除 book 表中的数据 SQL 语句：delete from book where book_isbn = '9787115502742' 运行界面和结果展示如图 2-12 所示：        图 2-12  客户用户删除 book 表数据 结果分析：删除失败，客户用户不具有删除 book 表中数据的权限，权限正确。  测试三：查看 auther 表 SQL 语句：select * from auther 运行界面和结果展示如图 2-13 所示。   图 2-13 客户用户查看 auther 表 结果分析：客户用户可查看 auther 表，权限正确。  测试四：插入一条数据到 auther 表中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-14 所示。 图 2-14 客户用户插入一条新数据到 auther 表 结果分析：客户用户无法在 auther 表中插入数据，权限正确。  测试五：查看 sale 表 SQL 语句：select * from sale 运行界面如图 2-15 所示。 图 2-15 客户用户查看 sale 表  结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过， 测试客户用户的权限正确。 测试完客户用户之后，我们登录商家用户来进行下一步的测试。登录商家用户如图 2-16 所示。     测试一：查看customer \n图 2-16  登录商家用户  SQL 语句：select * from customer 运行界面和结果展示如图 2-17 所示。 图 2-17 商家用户查看 customer 表 结果分析：商家用户具有查看客户表的权限，权限正确。  测试二：插入一条数据到 auther 中 SQL 语句：insert into auther values('330304198802150325','李天','男','12365748953','北京市产阳区李二路 18555 号') 运行界面如图 2-18 所示。       图 2-18  商家用户插入一条新数据到 auther 表 通过查看 auther 表进行结果展示如图 2-19 所示。   图 2-19 商家用户查询插入一条新数据后的 auther 表 结果分析：auther 表中新增了如上插入的数据，商家用户具有插入 auther 表数据的权限，权限正确。  测试三：从 stock 表中删除一条数据SQL 语句：delete from stock where stock_id = 'SA00001' 运行界面如图 2-20 所示。 图 2-20 商家用户删除一条 stock 表数据 结果分析：商家用户不具有删除 stock 表数据的权限，权限正确。  测试四：更新 sale 表的一条数据 SQL 语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'SA00001' 运行界面如图 2-21 所示。  图 2-21 商家用户更新一条 sale 表数据 结果展示，通过查看 sale 来查看结果如图 2-22 所示。    图 2-22 商家用户查看 sale 表数据 结果分析：sale 表中对应的数据被修改正确，商家用户具有修改 sale 数据的权限，权限正确。通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确。  九、总结及心得体会 本次是在上次实验的基础上对数据库进行安全管理，总的来说难度并不大，并且复杂程度上和第一次相比也要低很多。通过这次试验，我对数据库安全管理以及人员授权管理等方面有了很大的理解进步。受益匪浅。 ",
  "studentID": "2017221104024"
 },
 "76": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼303\t           实验时间：2019年7月14日      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1. 本实验中我们所使用的数据库是PostgreSQL数据库，PostgreSQL是以加州大学伯克利分校计算机系开发的 POSTGRES，现在已经更名为PostgreSQL，版本 4.2为基础的对象关系型数据库管理系统（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、外键、触发器、视图、事务完整性、MVCC。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、聚集函数、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。 使用一个软件我们应该先了解它的优点，从技术角度来讲，PostgreSQL 采用的是比较经典的C/S（client/server）结构，也就是一个客户端对应一个服务器端守护进程的模式，这个守护进程分析客户端来的查询请求，生成规划树，进行数据检索并最终把结果格式化输出后返回给客户端。为了便于客户端的程序的编写，由数据库服务器提供了统一的客户端 C 接口。而不同的客户端接口都是源自这个 C 接口，比如ODBC，JDBC，Python，Perl，Tcl，C/C++，ESQL等， 同时也要指出的是，PostgreSQL 对接口的支持也是非常丰富的，几乎支持所有类型的数据库客户端接口。这一点也可以说是 PostgreSQL 一大优点。 2. 我们在实验中需要用到的存储过程，有的数据库是和函数不一样的，但是在这里就像函数一样的创建。通过函数，可以在数据库服务器端执行指令程序。尽管这样的指令程序可以使用基本的SQL语句写成，但是由于其缺乏流程控制等功能，所以在PostgreSQL中引入了使用其它程序语言编写函数的能力。 3. 本实验中另一个比较有难度的题目是触发器（和建立表增删改查相比），触发器是由SQL语句查询所触发的事件。如：一个INSERT语句可能触发一个检查数据完整性的触发器。触发器通常由INSERT或UPDATE语句触发。在PostgreSQL中，可在数据表上设置触发器，但无法在视图中设置（对视图的UPDATE或者INSERT操作可以使用规则（RULE）定义）。多个触发器可依据字母顺序依次执行。此外，除了使用内嵌的PL/PgSQL语言之外，触发器的函数也可以用PL/Perl，PL/Python等语言编写。 4. PostgreSQL内置丰富的数据类型，包括： 任意精度的数值 无限制长度文本 几何图元 IP地址与IPv6地址 无类域间路由地址块，MAC地址 数组 此外，用户可以创建自定义数据类型，通常通过PostgreSQL的GiST机制，它们也能被很好得索引，比如PostGIS地理信息系统的数据类型。 5. 关于另一个很重要的概念视图，视图(VIEW)是一个伪表。 它不是物理表，而是作为普通表选择查询。视图也可以表示连接的表。 它可以包含表的所有行或来自一个或多个表的所选行。视图便于用户执行以下操作： 它以自然和直观的方式构建数据，并使其易于查找。 它限制对数据的访问，使得用户只能看到有限的数据而不是完整的数据。 它归总来自各种表中的数据以生成报告。 6. 索引：在创建索引时，由于我们学的比较简单，没有指明创建的索引是哪一种类型的，其实PostgreSQL有很多种的索引类型。postgresql提供的索引类型有：B-tree、hash、gist和gin。大多情况下，B-tree索引比较常用，用户可以使用create index命令创建一个B-tree索引。也就是说默认情况下我们就是创建的这一种索引。B-tree适合处理那些能够按顺序存储的数据，比如对于一些字段涉及使用：< ,<= ,= ,>= 或 >操作符之一进行比较的时候，可以建立一个索引。也可以使用B-tree索引搜索来实现与这些运算符的组合相同的构造，如BETWEEN和IN。此外，索引列上的IS NULL或IS NOT NULL条件可以与B-tree索引一起使用。对于涉及模式匹配运算符LIKE的查询，优化器还可以使用B-tree索引，如果模式是常量，并且锚定到字符串的开头，例如col LIKE 'foo％'或 col?'^ foo'，但不能是col LIKE'％bar'。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.首先进行图书销售管理系统数据库BookSale创建操作。因为需要进行SQL编程操作，所以我们不使用右键然后创建数据库，这种图形界面来创建的方式。 打开工具，点击查询工具，如下图所示，就可以输入命令了。        在这里使用CREATE DATABASE BookSale;命令来创建一个数据库，创建后的结果如图所示，可以看到图形界面中，用红色框框标记的地方，出现了我们所创建的数据库。        2. 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象。 建立表之前，先用表格的形式把几个表的结构定义列举出来，我们可以在下表中看到，一共需要创建5个table。 表7-1 Publisher的结构定义  表7-2 PurchaseList的结构定义  表7-3 storage的结构定义  表7-4 book的结构定义  表7-5 sale的结构定义 接下来就可以完成表的创建工作的，创建表的SQL语句如下：  创建表后的结果如下图，可以看到出现了四个表被成功的创建了：             建立索引的SQL语句和运行结果如下：              建立视图，查询书的名字和书的数量，我们可以看到创建好的视图如下所示：          运行这个视图，看一下结果是什么，通过下图我们可以看到这个视图被成功的创建了，数据都正确的显示：        建立的约束如下，我们可以看到ISBN_FK还有主键的定义，主键就自动的命名了。              3. 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作。 首先插入数据的SQL语句如下：  插入界面以及插入的结果                                                 删除一条数据的SQL语句如下所示： 运行成功的界面如下，可以看到删除成功。             删除后还需要再修改数据，因为刚才把三号删掉了，现在把第四号变成第三号。         4. 编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 存储过程的界面以及执行结果如下                 5. 编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。           八、实验数据及结果分析 1. 首先检查建立表之后的建立是否成功。我们一共建立了5个表，下图中有全部的5个表，这说明建立表是成功的。         2. 然后我们再来检查视图的建立，通过在最左边的窗口观察，我们发现出现了我们所建立的视图          但是这还不够，为了验证视图的建立是成功的，我们还要检查一下视图这个虚拟表的内容。 这是一个查询书和库存的视图，我们可以看到书的名字和对应的库存都是正确的，这说明视图的建立成功。       3. 插入数据后，我们还需要检查数据插入的是否成功，就可以把这几个表的内容都显示出来，如下图所示，可以看到插入的数据都出现在了表中，对于数据的操作也是成功的。                                        九、总结及心得体会 通过本次实验使我更熟练的掌握了数据库语句的使用，对数据库语句有了更深的理解。在创建数据库之前首先先设计数据库都包括哪些表，并且设计表中的属性名、属性类型、属性长度等详细属性。 设计好这些内容之后，打开数据库使用SQL语句创建数据库表，之后使用INSERT语句插入数据，对表进行最基础的增删改查的操作。 并且对存储过程的实际使用有了新的理解，存储过程在实际的使用中确实是很有用的，创建存储过程之后，再创建触发器。    \n电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼303\t          实验时间：2019年7月21日      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 权限分为两部分，一部分是“系统权限”或者数据库用户的属性，可以授予role或user（两者区别在于login权限）；一部分为数据库对象上的操作权限。对超级用户不做权限检查，其它走acl。对于数据库对象，开始只有所有者和超级用户可以做任何操作，其它走acl。在pg里，对acl模型做了简化，组和角色都是role，用户和角色的区别是角色没有login权限。 可以用下面的命令创建和删除角色， CREATE ROLEname; DROP ROLEname; 为了方便，也可以在 shell 命令上直接调用程序和，这些工具对相应命令提供了封装: createusername dropusername 数据库对象上的权限有： SELECT，INSERT，UPDATE，DELETE，RULE，REFERENCES，TRIGGER，CREATE，TEMPORARY，EXECUTE，和USAGE等，   五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。  （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。  运行界面和运行结果如下：                  （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。   给售卖者赋予权限  运行界面以及运行结果                    （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 创建角色的SQL语句如下  创建后的运行结果如下所示：可以看到运行成功。             （5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。用SQL shell登录我们创建的用户，可以看到登录成功。               八、实验数据及结果分析 1. 在对角色对各个数据库赋予权限后，检查他们的权限赋予情况。首先查看book表，点击属性，然后选择安全。            然后我们就能看到对于book表的各个角色的权限情况。对于R_Customer来说只能读，而对于R_seller来说既能读又能修改删除更新。         然后再用相同的办法查询另外几个表，运行结果都是配置成功的。           2. 检查我们创建的user能否成功的使用，可以打开SQL shell登录，这里我们点击SQL shell，输入对应的用户名和密码，然后成功登录，这说明我们对于用户的配置也是成功的。        我们也可以在下面的登录/组角色查一下有没有我们所建立的用户和角色，通过下图我们可以看到我们之前所创建的用户和角色都是成功的          九、总结及心得体会 通过本次实验使我更熟练的掌握了数据库语句的使用，对数据库语句有了更深的理解。对数据库权限管理也有了更深的理解，在实际场景中如何给数据库用户和角色分配合适的权限有了更深的感悟。 在实际操作场景中，要根据实际的情况给不同的角色赋予不同的权限，不然数据会不安全，系统正常稳定的运行，不会威胁到系统的安全性，不会因为角色有越界的权限而产生问题。 在本系统中如果顾客有了商户的权限，那么如果有顾客对数据库随意的修改，甚至修改自己的订单来让自己免费拿到商品，这个公司就会非常的危险了，会造成大量的损失。所以对于数据库的权限控制还是要慎重。 ",
  "studentID": "2017221104027"
 },
 "77": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221105008      姓    名       王亦达          （实验）\t课程名称   数据库原理及应用    理论教师        文军           实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：王亦达\t\t学号：2017221105008   指导教师：文军 实验地点：信软学院楼西303    实验时间：2017-6-14 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：5学时 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 四、实验原理： 在关系数据库系统中，所有对数据库的访问操作均可通过DBMS执行SQL语句来实现。例如，通过执行CREATE TABLE、ALTER TABLE、DROP TABLE语句实现数据库表的创建、修改和删除；通过执行INSERT、UPDATE、DELETE等语句实现数据库中数据的添加、修改、删除；并通过执行SELECT语句实现数据库数据的查询。在PostgreSQL数据库系统中，可以使用数据库开发工具pgAdmin或psql命令行工具执行SQL语句，实现数据库对象及其数据的操作。 存储过程、触发器和游标都可使用PL/pgSQL编程实现的数据处理，按照PL /pgSQL提供的语句和程序结构，实现数据库后端功能编程处理。可以使用数据库开发工具pgAdmin或psql命令行工具执行PL/pgSQL程序，实现数据库后端功能处理。 五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）：     PC一台，PostgreSQL 11。 七、实验步骤： （1）创建BookSale数据库 （2）创建数据库表 创建Book表储存图书信息 创建Customer表储存顾客信息 创建Seller表储存销售员信息 创建SaleRecord表记录图书销售信息 创建Buyer表储存进货员信息 创建BuyRecord表储存进货记录 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 添加数据 Customer表 Book表 Seller表 SaleRecord表     Buyer表v./ BuyRecord表 删除数据 查找数据  修改数据  （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 1）创建触发器执行函数  2）创建触发器  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1、数据库表的创建结果  图1 book表  图2 customer表  图3 seller表  图4 salerecord表  图5 buyer表  图6 buyrecord表 2、数据添加结果 Book表  图7 Book表结果 Customer表  图8 Customer表结果 Seller表  图9 Seller表结果 Buyer表  图10 Buyer表结果 SaleRecord表  图11 SaleRecord表结果 BuyRecord表  图12 BuyRecord表结果 3、删除后的SaleRecord表  图13 删除后的SaleRecord表 4、查找数据结果  图14 查找数据结果 5、修改后SaleRecord表  图15 修改后SaleRecord表 6、创建函数结果  图16 创建函数结果 7、函数执行结果  图17 函数执行结果 8、创建触发器   1）触发器执行函数的创建  图18 触发器执行函数创建结果   2）在SaleRecord表上创建触发器  图19 创建触发器结果 9、对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 添加语句：  添加前Book表  图20 添加前Book表 添加后Book表  图21 添加后Book表 可以看到添加前《平凡世界》库存为152本，添加后库存变为151本，说明触发器功能正确。 九、总结及心得体会：     本次实验我实践了数据库的创建，表的创建，表的增、删、查、改，过程函数函数的创建和触发器的创建，通过实验我对数据库表的操作更熟练了，也解决了过程函数和触发器的创建与执行的问题，对数据库函数有了更深的理解，今后使用过程函数也会越来越熟练。 十、对本实验过程及方法、手段的改进建议：     无                                                      报告评分：                                          指导教师签字：  电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221105008      姓    名       王亦达          （实验）\t课程名称   数据库原理及应用    理论教师        文军           实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：王亦达\t\t学号：2017221105008   指导教师：文军 实验地点：信软学院楼西303    实验时间：2017-6-21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3学时 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 在PostgreSQL数据库系统中，实现数据存取安全模型是恶报数据库安全访问的基本手段，在数据安全存取模型中，需要设计书看的角色、角色的数据库对象操作权限、数据库用户、数据库用户的角色赋予，以及数据库对象的操作权限集合。根据设计的数据安全存取模型，系统管理员使用数据库管理工具pgAdmin去创建角色，授予系统管理权限和对象操作权限。此外，系统管理员还需要创建用户，并对用户赋予必要的角色，之后，用户就可以对 数据库对象进行访问。 五、实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）：     PC一台，PostgreSQL 11。 七、实验步骤： （1）创建角色权限表  （2）创建客户（R_Customer）、商家（R_Seller）角色。  （3）为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  （4）创建客户用户U_Customer、商家用户U_Seller。  （5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1、添加角色结果  图1 添加角色结果 2、为角色赋予对象权限执行情况  图2 赋予对象权限 3、创建用户结果  图3 创建用户结果 5、用客户（U_Customer）用户访问验证 （1）对Book的查找 由图4可以看到，客户用户可以对book表进行查找  图4 客户查找book表验证 （2）对Book表的插入 由图5可以看出，客户没有对book表插入的权限   图5 客户插入book表验证 （3）对Customer的查找 由图6可以看出，客户有对Customer表进行查找的权限。  图6 客户查找Customer表验证 （4）对Customer表的插入 由图7可以看出，客户有对Customer表的插入权限。  图7 客户插入Customer表验证 （5）对Customer表的删除 由图8可以看出，客户没有对Customer表的删除权限。  图8 客户删除Customer表验证 （6）对SaleRecord表的查找 由图9可以看出，客户有对SaleRecord表的查找权限。  图9 客户查找SaleRecord表验证 （7）对Buyer表的查找 由图10可以看出，客户没有对Buyer表的查找权限。  图10 客户查找Buyer表验证 （8）对BuyRecord表的查找 由图11可以看出，客户没有对BuyRecord表的查找权限。  图11 客户查找BuyRecord表验证 6、用商家（U_Seller）用户访问验证 （1）对Seller表的查找 由图12可以看出，商家有对Seller表的查找权限。  图12 商家查找Seller表验证 （2）对Seller表的插入 由图13可以看出，商家有对Seller表的插入权限。  图13 商家插入Seller表验证 （3）对Seller表的修改 由图14可以看出，商家有对Seller表的修改权限。  图14 商家修改Seller表验证 （4）对Seller表的删除 由图15可以看出，商家有对Seller表的删除权限。  图15 商家删除Seller表验证 九、总结及心得体会：     通过本次实验我练习了数据库安全管理的方法，学会了创建角色、管理角色权限和用户权限的验证，对数据库安全管理有了更深的认识，也加强了对SQL语言的掌握。 十、对本实验过程及方法、手段的改进建议：     无                                                      报告评分：                                          指导教师签字： ",
  "studentID": "2017221105008"
 },
 "78": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软学院楼西306\t 实验时间：2019.5.20      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 数据库数据模型 概念数据模型 主要用来描述世界的概念化结构，它使数据库的设计人员在设计的初始阶段，摆脱计算机系统及 DBMS 的具体技术问题，集中精力分析数据以及数据之间的联系等，与具体的数据管理系统（Database Management System，简称 DBMS）无关。概念数据模型必须换成逻辑数据模型，才能在 DBMS 中实现。 逻辑数据模型 用户从数据库所看到的模型，是具体的 DBMS 所支持的数据模型，如网状数据模型 (Network Data Model)、 层次数据模型 (Hierarchical Data Model) 等等。 此模型既要面向用户，又要面向系统 ，主要用于 数据库管理系统 （DBMS）的实现。 物理数据模型 面向计算机物理表示的模型，描述了数据在储存介质上的组织结构，它不但与具体的 DBMS 有关，而且还与操作系统和硬件有关。每一种逻辑数据模型在实现时都有起对应的物理数据模型。DBMS 为了保证其独立性与可移植性，大部分物理数据模型的实现工作又系统自动完成，而设计者只设计索引、聚集等特殊结构。 存储过程 存储过程和用户自定义函数（UDF）是SQL和过程语句的集合，它存储于数据库服务器并能被SQL接口调用。  触发器 PostgreSQL触发器是一组动作或数据库回调函数，它们在指定的表上执行指定的数据库事件(即，INSERT，UPDATE，DELETE或TRUNCATE语句)时自动运行。 触发器用于验证输入数据，执行业务规则，保持审计跟踪等。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 说明：本节需学生编写内容。学生应针对本实验，给出具体实验步骤内容。 (1)在本次实验中，采用数据库管理软件pgAdmin运行postgreSQL命令，因此首先需要在实验机上运行数据库服务以及pgAdmin软件。  (2)利用powerDesigner，根据题目需要，对图书销售系统进行设计和建模，分别建立概念数据模型、逻辑数据模型以及物理数据模型。 (3)模型建立完成后，根据相关规则将模型转换为SQL语言，并在pgAdmin运行。 (4)编写实验报告。 八、实验数据及结果分析 说明：本节需学生编写内容。学生应按照上述步骤完整给出各个实验内容的具体实践操作展示及过程说明，并体现出解决问题思路、编程方法等设计内涵文字描述。在报告内容中，需要有基本的SQL程序代码、运行操作界面、操作数据等结果内容。 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （a）创建数据库表 （b）创建视图 （c）创建索引  （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作  （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  九、总结及心得体会 通过本次实验，掌握了数据库建模的基本步骤和方法，能够从概念模型开始，层层递进，建立起逻辑模型和物理模型，最后生成sql脚本，创建出实验要求的数据库，大大提升了对数据库建模的理解。 在实践中学习了Powerdesigner设计数据库模型的基本操作和使用技巧，例如实体和关系的连接、关系中一对多、多对多的情况，以及逐渐、外键的约束等，通过实际操作，加深了课堂理论知识的熟悉程度。 实验缺乏一定的数据，需要学生自己编写、插入一定数量的数据条目才能验证数据库能否正常工作，对实验效率造成了影响，希望以后的实验中，能够给出一定数量的数据。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软学院楼西306  \t实验时间：2019.05.27 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 角色 PostgreSQL使用角色的概念管理数据库访问权限。  根据角色自身的设置不同，一个角色可以看做是一个数据库用户，或者一组数据库用户。  角色可以拥有数据库对象(比如表)以及可以把这些对象上的权限赋予其它角色， 以控制谁拥有访问哪些对象的权限。  操作角色的语句： create role db_role1; /*--创建角色*/ drop role db_role1;  /*--删除角色*/   \\du  --在命令格式下查看所有角色的命令  角色的权限 一个数据库角色可以有很多权限，这些权限定义了角色和拥有角色的用户可以做的事情。  create role db_role1 LOGIN; --创建具有登录权限的角色db_role1 create role db_role2 SUPERUSER; --创建具有超级用户权限的角色 create role db_role3 CREATEDB; --创建具有创建数据库权限的角色 create role db_role4 CREATEROLE --创建具有创建角色权限的角色 alter role db_role1 nologin nocreatedb; --修改角色取消登录和创建数据库权限  用户 其实用户和角色都是角色，只是用户是具有登录权限的角色。 create user db_user1 password '123'; --创建用户 create role db_user1 password '123' LOGIN;  --同上一句等价 drop user db_user1;   --删除用户 alter user db_user1 password '123456'; --修改密码 alter user db_user1 createdb createrole; --对用户授权  赋予角色控制权限 我们可以使用GRANT 和REVOKE命令赋予用户角色，来控制权限。 create user db_user1; --创建用户1 create user db_user2; --创建用户2 create role db_role1 createdb createrole; --创建角色1 grant db_role1 to db_user1,db_user2; --给用户1,2赋予角色1,两个用户就拥有了创建数据库和创建角色的权限 revoke db_role1 from db_user1; --从用户1移除角色1，用户不在拥有角色1的权限 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 编写SQL语句，在pgAdmin执行相关语句，创建实验所需的各种角色； 根据业务规则编写权限分配相关SQL语句，并在数据库中执行； 在创建角色的基础上，编写创建用户SQL语句，在数据库中执行； 以不同身份访问数据库，验证权限控制的正确性； 编写实验报告。 八、实验数据及结果分析 数据存取权限控制模型如下：  创建客户（R_Customer）、商家（R_Seller）角色SQL如下：  根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。SQL如下：  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。SQL如下：  分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。SQL如下：  分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 以客户(U_Customer)身份访问Books表，有权限，得到书本信息；尝试插入信息，没有权限，被拒绝插入信息。如图所示。  以商家(U_Sellrt)身份访问BookType表，有权限，得到书本类型信息，尝试插入信息，有权限，成功插入信息，如图所示。  九、总结及心得体会 通过本次实验，掌握了数据库权限控制的基本方法，在实验中创建了具有不同权限的角色，并将角色的权限通过继承分配给新建的用户，最后，通过不同的用户身份对数据库进行访问，验证了权限分配的正确性。 经过实践，对pgAdmin、psql的使用更为熟悉，能够同时掌握在GUI和命令行模式下进行数据库的设计和实现，大大提升了对postgre数据库的掌握。 认识到事先划分用户权限、建立起权限控制模型的重要性，有利于后续SQL语句编写的准确度，防止遗漏。 实验确实数据库备份和恢复环节，建议以后数据库实验中可加入这两个环节，丰富学生对数据库使用的知识。",
  "studentID": "2017221105009"
 },
 "79": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼西303       实验时间：2019.06.15 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 （1）数据库基本操作 SQL（ Structured Query Language,结构化查询语言 ）是一种对关系数据库进行访问的数据操作语言。 SQL主要操作功能：数据库对象创建、修改、删除；数据库表的数据插入、修改、删除、查询、统计；存储过程、触发器、函数等程序执行；数据库权限、角色、用户等管理。 数据定义语言（Data Definition Language，DDL）是SQL语言中用于创建、修改或删除数据库对象的语句。 \tCREATE DATABASE - 创建新数据库 \tDROP DATABASE C 删除数据库 \tALTER DATABASE - 修改数据库属性  \tCREATE TABLE - 创建新表  \tALTER TABLE C 修改数据库表结构 \tDROP TABLE - 删除表 \tCREATE INDEX - 创建索引 \tDROP INDEX - 删除索引 数据操纵语言（Data Manipulation Language，DML）是SQL语言中用于增添、修改、删除数据的语句。 \tINSERT - 向数据库表中插入数据  \tUPDATE - 更新数据库表中的数据 \tDELETE - 从数据库表中删除数据 数据查询语言（Data Query Language，DQL）是SQL语言中用于对数据库进行数据查询的语句。 数据控制语言（Data Control Language，DCL）是用于对数据库对象访问权进行控制的SQL语句。 \tGRANT C 授予用户对数据库对象的权限 \tDENY C 拒绝授予用户对数据库对象的权限 \tREVOKE C 撤消用户对数据库对象的权限 （2）存储过程 \t存储过程（Stored Procedure）是一种数据库的对象； \t由一组能完成特定功能的SQL 语句集构成； \t是把经常会被重复使用的SQL语句逻辑块封装起来，经编译后，存储在数据库服务器端； \t当被再次调用时，而不需要再次编译； \t当客户端连接到数据库时，用户通过指定存储过程的名字并给出参数，数据库就可以找到相应的存储过程予以调用。 \t不同的数据库系统创建存储过程的语法存在差异； \t许多数据库为创建存储过程和函数提供不同命令； \t如ORACLE、MySQL、SQL SERVER等数据库，使用CREATE PRECEDURE命令创建存储过程，使用CREATE FUNCTION命令创建函数。 PostgreSQL使用CREATE FUNCTION命令创建存储过程。 CREATE [ OR REPLACE ] FUNCTION  name     ( [ [ argmode ] [ argname ] argtype [ { DEFAULT | = } default_expr ] [, ...] ] )     [ RETURNS retype | RETURNS TABLE ( column_name column_type [, ...] ) ] AS $$         //$$用于声明存储过程的实际代码的开始 DECLARE         -- 声明段 BEGIN         --函数体语句 END; $$ LANGUAGE lang_name;  //$$ 表明代码的结束, LANGUAGE后面指明所用的编程语言 使用存储过程的优点：减少网络通信量；执行速度更快；更强的适应性；降低了业务实现与应用程序的耦合；降低了开发的复杂性；保护数据库元信息；增强了数据库的安全性。 使用存储过程的缺点：SQL本身是一种结构化查询语言，而存储过程本质上是过程化的程序；面对复杂的业务逻辑，过程化处理逻辑相对比较复杂；而SQL语言的优势是面向数据查询而非业务逻辑的处理。如果存储过程的参数或返回数据发生变化，一般需要修改存储过程的代码，同时还需要更新主程序调用存储过程的代码。开发调试复杂，由于缺乏支持存储过程的集成开发环境，存储过程的开发调试要比一般程序困难。可移植性差。 （3）触发器 触发器是特殊类型的存储过程，主要由操作事件(INSERT、UPDATE、DELETE) 触发而被自动执行。 触发器可以实现比约束更复杂的数据完整性，经常用于加强数据的完整性约束和业务规则。触发器本身是一个特殊的事务单位。与表相关联：必须定义在表或视图上。自动触发：由执行INSERT、DELETE、UPDATE操作时触发。不能直接调用，也不能传递或接受参数。是事务的一部分：触发器和触发语句作为可在触发器内回滚的单个事务。  触发器执行的次数可分： （1）语句级触发器：由关键字FOR  EACH  STATEMENT声明，在触发器作用的表上执行一条SQL语句时，该触发器只执行一次，即使是修改了零行数据的SQL，也会导致相应的触发器执行。如果都没有被指定，FOR EACH STATEMENT会是默认值。（2）行级触发器：由关键字FOR  EACH  ROW标记的触发器，当触发器作用的表的数据发生变化时，每变化一行就会执行一次触发器。例如，假设学生成绩表有DELETE触发器，当在该表执行DELETE语句删除记录时，如果删除了20条记录，则将导致 DELETE触发器被执行20 次。按触发的时间分为三类： （1）BEFORE触发器：在触发事件之前执行触发器。（2）AFTER触发器：在触发事件之后执行触发器。（3）INSTEAD OF触发器：当触发事件发生后，执行触发器中指定的函数，而不是执行产生触发事件的SQL 语句，从而替代产生触发事件的SQL操作。在表或视图上，对于INSERT、UPDATE 或 DELETE 三种触发事件，每种最多可以定义一个INSTEAD OF 触发器。 CREATE  TRIGGER  触发器名        { BEFORE | AFTER | INSTEAD OF }      ON 表名      [ FOR [ EACH ] { ROW | STATEMENT } ]      EXECUTE PROCEDURE 存储过程名 ( 参数列表 ) ① 指明所定义的触发器名    ② BEFORE | AFTER | INSTEAD OF  指明触发器被触发的时间 ③ ON 表名 指明触发器所依附的表 ④ FOR  EACH  { ROW | STATEMENT }  指明触发器被触发的次数 ⑤ EXECUTE PROCEDURE 存储过程名 ( 参数列表 )  指明触发时所执行的存储过程 创建触发器基本步骤：检查数据库中将要创建的触发器所依附的表或视图是否存在，如果不存在，必须首先创建该表或视图。创建触发器被触发时所要执行的触发器函数，该函数的类型必须是TRINGER型，是触发器的执行函数。但要注意，有些数据库不需要独立定义触发器函数，而是在创建触发器时，定义触发器的过程体。创建触发器，一般需要指明触发器依附的表，触发器被触发执行的时间，触发器是行级触发器还是语句级触发器，触发器执行需要满足的条件。 四、实验原理 在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.\t创建 BookSale 数据库 2.\t创建各数据库表以及表中主外键和索引 3.\t创建视图 4.\t插入样本数据并对 publisher 表进行增删查改操作 5.\t创建触发器函数 6.\t创建触发器 7.\t测试触发器 8.\t创建存储过程 9.\t调用存储过程 八、实验数据及结果分析 创建图书销售管理系统数据库BookSale  图 1- 1创建BookSale 在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象  图 1- 2创建表   图 1- 3创建索引   图 1- 4创建视图 对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 增：  图 1- 5增加author表   图 1- 6增加publish表   图 1- 7增加book表  图 1- 8增加sale表   图 1- 9增加store表 改：   图 1- 10改author表 删：   图 1- 11删除author表 查：   图 1- 12查找author表 编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。   图 1- 13编写存储过程Pro_CurrentSale 编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。   图 1- 14编写过程语句块 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。   图 1- 15编写触发器Tri_InsertSale 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 使用Insert操作之前：  图 1- 16使用Insert操作之前 对sale表进行Insert操作：  图 1- 17对sale表进行Insert操作 触发器出发之后：  图 1- 18触发器出发之后 九、总结及心得体会 通过此次实验熟悉了数据库各SQL语句使用，理解对数据库中各类型数据的存储方法和数据之间的约束关系。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼西303 \t        实验时间：2019.06.21 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 在SQL语言中，数据控制SQL语句是一种可对用户数据访问权进行控制 的操作语句，它可以控制特定用户或角色对数据表、视图、存储过程、 触发器等数据库对象的访问权限 用户要访问数据库，必须先在DBMS中创建其账号，并成为 数据库的用户。此后，用户每次访问数据库，都需要在 DBMS进行身份验证，只有合法用户才能进入系统，访问操 作数据库对象。在DBMS中，为了方便对众多用户及其权限进行管理，通常 将一组具有相同权限的用户定义为角色(Role)。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。  2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户 （R_Customer）角色、商家（R_Seller）角色。  3.在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。  4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并 为客户用户分配客户角色，为商家用户分配商家角色。  5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理 数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两 用户不同的角色权限。 八、实验数据及结果分析 创建客户角色、商家角色 创建客户角色 创建商家角色 运行结果： 根据设计的数据存取权限控制模型对客户 （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限 对客户角色赋予权限 对商家角色赋予权限 运行结果： 创建客户用户 U_Customer、商家用户 U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色 验证 登录客户用户，验证SELECT DELETE INSERT等操作 登录商家用户，验证SELECT INSERT DELETE UPDATE等操作  九、总结及心得体会 通过此次实验理解了数据库中用户与角色的关系以及它们的意义，自己动手熟悉了数据库中角色和用户的相关操作。",
  "studentID": "2017221105027"
 },
 "80": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号      2017221201025        姓    名         税文俐           （实验）\t课程名称     数据库原理及应用       理论教师          陆鑫            实验教师         何中海                   电 子 科 技 大 学 实   验   报   告 学生姓名：税文俐\t\t学号：2017221201025      指导教师：何中海   实验地点：信软楼西303                      实验时间：2019.6. 14 实验名称：图书销售管理系统数据库SQL应用编程 实验学时：4 实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。。 实验原理： 首先对图书销售管理系统进行数据需求分析,定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计,给出数据库设计方案 基于数据库设计方案,通过SL编程执行来完成对数据库的实现操作。在本实验中,使用SL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建,并编写SL语句对数据库表进行数据的增删查改操作,以及利用视图存储过程、触发器实现业务数据处理 实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 实验器材（设备、元器件）：实验PC计算机、PostgreSQL 11 实验步骤：  在数据库服务器中,采用SQL语句执行方式,创建图书销售管理系统数据库 BookSale 在 BookSale数据库中,采用SQL语句执行方式,创建表Book、Purchase、Sell、Supplier,以及各表主键外键的创建。 为Book表创建索引 为Book、Purchase、Sell、Supplier、Stock表准备样本数据,采用SQL语句执行方式,将样本数据插入到表中。 采用SQL语句对Book、Purchase、Sell、Supplier、Stock表进行数据修改、删除、查询、统计等访问操作 创建视图BookOfRenWenShe，StoryBook对视图进行数据查询访问操作 编写存储过程函数,实现统计某日图书的销售总量以及总金额数据 调用存储过程函数,查看输出结果是否准确实现业务数据处理功能。 编写触发器函数,实现在sale表数据插入时,级联操作 stock表,将图书的库存流水进行记录,同时级联更新book表中对应图书的库存数据 创建完触发器函数之后,创建相对应的触发器,实现上一步中提到的功能 测试触发器的功能,准备sale表的样本数据,并将其插入sale表,插入之后查看 stock表是否有对应的更新,并对比插入sale数据前后book中对应数据的修改情况 实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建BookSale数据库 SQL语句如下：   创建结果： 2.创建各数据库表以及表中的主外键 创建结果： 3.创建以图书名称来索引图书表  4.为各表插入样本数据 （1）Book表： 插入结果： （2）Supplier表   结果： （3）Sell表  （4）purchase表 5.增删查改操作 （1）更新Book数据  （2）更新Supplier表    （3）查找文学类书籍  （4）删除《那不勒斯四部曲》这本书 已经没有这本书了 6.创建视图 （1）创建人文社书籍的视图  （2）创建小说类书籍的视图  7. 编写存储过程Pro_CurrentSale   8. 编写过程语句块，实现对存储过程Pro_CurrentSale的调用  9.创建触发器函数InsertSale()  10.创建触发器Tri_InsertSale  11.对触发器进行测试 （1）Book表原始数据  （2）对Sell表进行更新  （3）查看Stock表 可知：有出库数据 （4）查看Book表 可知：Book表数据更新 总结及心得体会： 在编写触发器的时候，要先建立存储数据的表，在编写触发器函数，然后才是建立触发器。当对表进行数据更新后，即是调用了触发器。 数据库设计时，要考虑清楚该数据库要实现的功能，从而设计相应地表。 对本实验过程及方法、手段的改进建议： 在编写SQL语句之前，应该先进行构思，设计好数据库才开始动手。避免之后花过多时间进行修改 对表的外主键的设定有多种方式，要灵活运用 \n 电 子 科 技 大 学 实   验   报   告 学生姓名：税文俐\t\t学号：2017221201025      指导教师：何中海   实验地点：信软楼西303                      实验时间：2019.6. 21 实验名称：图书销售管理系统数据库安全管理 实验学时：3 实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 实验原理： 设计数据存取权限控制模型,对各角色进行不同权限的赋予,保证数据库数据的安全性。 使用SQL语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色 使用不同的用户登录时,就拥有了该用户的权限,在对数据库表进行操作的时候就会受到不同程度的制约 实验内容： （（1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 实验器材（设备、元器件）：实验PC计算机、PostgreSQL 11 实验步骤：  1.针对图书销售管理系统,在设计数据存取权限控制模型 2.在 pgadmin4中的 Booksale数据库中,使用SQL语句创建客户( R_Customer)角色、商家( R_Seller)角色 3.在 pgadmin4中,根据第一步设计的数据存取权限控制模型对客户( R_Customer)角色、商家( R_Seller)角色赋予所定义的数据库对象权限。 4.在 pgadmin4中,分别创建客户用户 U_Customer、商家用户 U_Seller,并为客户用户分配客户角色,为商家用户分配商家角色 5.分别以客户用户 U_Customer、商家用户 U_Seller身份访问图书销售管理数据库,并分别以这两个用户对各数据库表进行操作,以验证是否正确分配了两用户不同的角色权限。 实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.针对图书销售管理系统,在设计数据存取权限控制模型 2.创建客户和商家角  3.赋予客户、商家权限  4. 创建客户用户和商家用户,并将客户角色和商家角色赋予他们        5.分别以客户、商家用户登录，验证权限是否赋予成功 （1）以客户用户登录 （2）能查看Book表数据 （3）不能删除Book表中数据  （4）无法查看Purchase表 （5）以商家用户登录 （6）可以查看Purchase表 （7）可以删除Book表数据 （8）删除结果  总结及心得体会： 根据功能设想谁会使用该数据库，在进行角色的设计和拥有的权限。 设计时考虑系统的安全需要。 对本实验过程及方法、手段的改进建议： 对角色的功能需要要思考全面",
  "studentID": "2017221201025"
 },
 "81": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：\t\t\t\t\t           实验时间：2019.06.14      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 数据库创建SQL语句基本格式： CREATE  DATABASE  <数据库名>; 数据库表创建SQL语句基本格式： CREATE TABLE  <表名>  （ <列名1>  <数据类型>  [列完整性约束]， \t  <列名2>  <数据类型>   [列完整性约束]，\t     <列名3>  <数据类型>  [列完整性约束]，     …     CONSTRAINT  <约束名>  PRIMARY Key(主键列)    )；  索引（Index）是一种按照关系表中指定列的取值顺序组织元组数据存储的数据结构，使用它可以加快表中数据的查询访问。索引作用有支持对数据库表中数据快速查找，其机理类似图书目录可以快速定位章节内容。索引优点有提高数据检索速度，可快速连接关联表，减少分组和排序时间。索引开销为创建和维护索引都需要较大开销，索引会占用额外存储空间，数据操纵因维护索引带来系统性能开销。 索引创建SQL语句基本格式： CREATE INDEX  <索引名>  ON <表名><（列名）>； 索引修改SQL语句基本格式： ALTER  INDEX  <索引名> <修改项>； ALTER  INDEX  <索引名> RENAME TO <新索引名>； 索引删除SQL语句基本格式： DROP  INDEX  <索引名> ；  数据插入SQL语句基本格式 INSERT  INTO  <表名|视图名>[<列名表>]  VALUES （列值表）; 数据更新SQL语句基本格式 UPDATE  <表名|视图名> SET  <列名1>=<表达式1> [，<列名2>=<表达式2>...] [WHERE   <条件表达式>]； 数据删除SQL语句基本格式 DELETE  FROM  <表名|视图名> [WHERE   <条件表达式>]； 数据查询SQL语句格式 SELECT  [ALL|DISTINCT]  <目标列>[，<目标列>…] [ INTO <新表> ] FROM  <表名|视图名>[，<表名|视图名>…] [ WHERE  <条件表达式> ] [ GROUP BY  <列名> [HAVING <条件表达式> ]] [ ORDER BY  <列名> [ ASC | DESC ] ]; 在WHERE子句中可以使用如下方式，指定范围数据。 使用BETWEEN..AND关键词来限定列值范围，还可以使用关键词LIKE与通配符来限定查询条件。 使用通配符来限定字符串数据范围。下划线（_）通配符用于代表一个未指定的字符。百分号（%）通配符用于代表一个或多个未指定的字符。 在SQL查询Where子句中，还可以使用多个条件表达式，并通过逻辑运算符（AND、OR、NOT）连接操作，以及使用IN或NOT IN关键词，进一步限定结果集的数据范围。 如果结果集需要按多个列排序，可以分别加入关键字ASC或DESC改变。  子查询SQL语句基本格式： SELECT    <目标列>[，<目标列>…] FROM  <表名> WHERE  <条件中嵌套另一关系表的SELECT 查询结果集>  视图――是一种通过基础表或其它视图构建的虚拟表。它本身没有自己的数据，而是使用了存储在基础表中的数据。 视图创建SQL语句基本格式 CREATE  VIEW  <视图名>[(列名1)，(列名2)，…]  AS  <SELECT查询>； 视图删除基本格式 DROP  VIEW  <视图名>；  存储过程（Stored Procedure）是一种数据库的对象；由一组能完成特定功能的SQL 语句集构成；是把经常会被重复使用的SQL语句逻辑块封装起来，经编译后，存储在数据库服务器端；当被再次调用时，而不需要再次编译；当客户端连接到数据库时，用户通过指定存储过程的名字并给出参数，数据库就可以找到相应的存储过程予以调用。PostgreSQL使用CREATE FUNCTION命令创建存储过程。 创建存储过程的语法 CREATE [ OR REPLACE ] FUNCTION  name     ( [ [ argmode ] [ argname ] argtype [ { DEFAULT | = } default_expr ] [, ...] ] )     [ RETURNS retype | RETURNS TABLE ( column_name column_type [, ...] ) ] AS $$         //$$用于声明存储过程的实际代码的开始 DECLARE         -- 声明段 BEGIN         --函数体语句 END; $$ LANGUAGE lang_name;  //$$ 表明代码的结束, LANGUAGE后面指明所用的编程语言 在查询窗口执行存储过程，语法形式如下：  select 存储过程名（参数）； 存储过程调用其它存储过程，语法形式如下： select  into 自定义变量  from 存储过程名（参数）；  触发器是特殊类型的存储过程，主要由操作事件(INSERT、UPDATE、DELETE) 触发而被自动执行。触发器可以实现比约束更复杂的数据完整性，经常用于加强数据的完整性约束和业务规则。触发器本身是一个特殊的事务单位。与表相关联：必须定义在表或视图上。自动触发：由执行INSERT、DELETE、UPDATE操作时触发。不能直接调用，也不能传递或接受参数。是事务的一部分：触发器和触发语句作为可在触发器内回滚的单个事务。  按触发的语句分为： INSERT触发器、DELETE触发器、UPDATE触发器  触发器执行的次数可分： 语句级触发器，行级触发器。 按触发的时间分为三类：  （1）BEFORE触发器：在触发事件之前执行触发器。 （2）AFTER触发器：在触发事件之后执行触发器。 （3）INSTEAD OF触发器：当触发事件发生后，执行触发器中指定的函数，而不是执行产生触发事件的SQL 语句，从而替代产生触发事件的SQL操作。 PostgreSQL创建触发器的基本语法 CREATE  TRIGGER  触发器名        { BEFORE | AFTER | INSTEAD OF }      ON 表名      [ FOR [ EACH ] { ROW | STATEMENT } ]      EXECUTE PROCEDURE 存储过程名 ( 参数列表 ) PostgreSQL创建触发器的基本步骤： （1）检查数据库中将要创建的触发器所依附的表或视图是否存在，如果不存在，必须首先创建该表或视图。 （2）创建触发器被触发时所要执行的触发器函数，该函数的类型必须是TRINGER型，是触发器的执行函数。但要注意，有些数据库不需要独立定义触发器函数，而是在创建触发器时，定义触发器的过程体。 （3）创建触发器，一般需要指明触发器依附的表，触发器被触发执行的时间，触发器是行级触发器还是语句级触发器，触发器执行需要满足的条件 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 设计BookSale数据库。 创建BookSale数据库，使用pgadmin4中的图形化界面或者执行CREATE DATABASE BookSale;创建数据库。 根据BookSale数据库设计，编写SQL语句定义数据表项，列约束和表约束，创建相应的数据表。 为个每个表的主键建立索引。 建立视图方便，对数据信息的全部的查询。 向创建的各个数据表插入样例数据。 对数据表进行增、删、改、查操作。 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计，并调用输出统计结果。 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理，并验证。 八、实验数据及结果分析 创建数据库 创建数据库，如下图所示，在pgadmin4中创建数据库，输入数据库名BookSale，点击save创建数据库。或者直接执行SQL语句：CREATE DATABASE BookSale;创建数据库。  图 1 创建数据库 如下图所示，成功创建BookSale数据库。  图 2 成功创建数据库      创建数据表 在BookSale数据库中启动query tool，写入SQL语句，创建BookSale数据库中相应的数据表。 Author表代表图书的作者实体，包括AuthorId,AuthorName,AuthorTel三项属性，其中AuthorId为主键。 Press代表图书出版社的实体，包括PressId，PressName，PressTel，PressAdd四项属性，其中PressId为主键。 Book代表图书实体，包括ISBN，PressId，BookName，Price四项属性，其中ISBN为主键唯一标识图书，PressId作为外键关联Press表确定出版社。 Complie是表示图书与作者之间的关系，往往一个图书会存在多个作者，每个作者又会写过多本书，因此添加Complie表来关联图书与作者。其中AuthorId，ISBN作为共同主键，又分别作为关联Author表和ISBN表的外键。 Inventory表记录库存ISBN既作为主键，有关联Book表的ISBN，Quantity记录该种书的库存值。 Sale表存储销售记录，SaleId作为自增长主键，ISBN关联Book表的ISBN，SaleDate表明销售日期，SaleQuantity表明销售的数量，SaleAmount表明销售的总金额。 编写SQL语句，创建数据表，源代码见下表。 表格 1 创建数据库表SQL源代码 向数据表中插入测试数据 如下表所示，插入数据的SQL源代码如下表所示。 表格 2 插入测试数据SQL语句 执行SQL语句向其中插入数据，运行结果如下图所示。  图 3 插入测试数据 创建索引和视图 执行上表中的创建数据表SQL文件，成功运行，成功创建数据表，如下图所示。  图 4 成功创建数据库表 为加快检索数据，因此为每个表的主键创建索引,如下图所示。  图 5 成功创建索引 为方便查看图书的详细内容创建BookDetailView视图，实现多表关联显示处Book的完整信息。如下图所示。  图 6 成功创建视图 使用视图，显示出图书的所有信息，如下图所示。  图 7 使用视图 对author表进行增删改查操作 查询Author表的全部记录，如下图所示。  图 8 查看Author表 对Author表增加一条记录，再查询整个表，可以看到，成功增添一条记录，如下图所示。 图 9 向Author表插入记录并验证 对Author表中的authorid为201911110006的记录进行修改，将authorname修改为张三，authortel修改为12345678910。执行SQL语句后，再次查询全表，可以发现修改成功，如下图所示。  图 10 对Author表进行更新操作并验证 对Author表中的authorid为201911110006的记录进行删除，执行SQL语句后，再次查询全表，可以发现成功删除该条记录。需要注意的是该条数据没有与具体的书籍关联，因此可以自由删除。若该作者与书籍存在关联，应先删除相应的书籍记录，才能删除该记录，如下图所示。  图 11 对Author表进行删除操作并验证 对Book表进行增删改查操作 查看Book表全部记录，如下图所示。  图 12 查询Book表 向Book表中添加一条记录，需要注意的是Book表中的pressid关联于Press表中的pressid存在外键约束，因此插入数据的pressid字段一定要存在于Press表中，执行插入SQL语句后，再次查询全表，插入数据成功，如下图所示。  图 13 向Book表插入数据并验证 修改刚插入的数据，修改价格为198.50，执行更新SQL语句，再次查询，修改成功，如下图所示。  图 14 更新Book表数据并验证 删除插入的记录，执行删除SQL语句，再次查询全表，删除成功。需要注意，Book表中的主键isbn被Inventory表作为外键关联约束，因此在删除某一条书籍记录时，要首先删除Inventory表中的库存记录，也可以在定义表的时候定义级联操作，如下图所示。  图 15 删除Book表数据并验证      编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计 编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计，SQL源代码如下图所示。 表格 3 Pro_CurrentSale()函数源代码 创建Pro_CurrentSale函数，调用该函数，显示出当日的总销量和总销售金额，如下图所示。  图 16 创建Pro_CurrentSale()函数并调用 显示Sale全表，可以验证，Pro_CurrentSale正确显示出当日的总销量和总销售金额，如下图所示。  图 17 验证Pro_CurrentSale()函数正确性 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 首先编写Sale_insert存储过程，实现Sale表售出书籍Inventory表的库存同步减少，再编写图书销售表Insert触发器Tri_InsertSale，当每次对Sale表进行插入操作时，对每条记录执行Sale_insert（）函数，实现图书库存数据同步修改处理。 表格 4 Tri_InsertSale触发器SQL源代码 执行Tri_InsertSale创建语句，如下图所示。  图 18 Tri_InsertSale创建 验证触发器是否正常 使用创建的BookDetailView视图，查看所有图书的详细信息，可以发现《现代密码学》、《汇编语言》、《数据库》这三本书的库存分别有20，5，60，如下图所示。  图 19 查看书籍库存 分别插入三本的的销售数据，其中《数据库》销售10本，《汇编语言》销售1本，《现代密码学》销售10本，再次利用BookDetailView视图查看书籍库存，《现代密码学》10本、《汇编语言》4本、《数据库》50本，符合要求库存进行了同步更新，如下图所示。  图 20 执行插入操作验证触发器 九、总结及心得体会 总结： 书和作者之间的关系是多对多，一个作者可能写了多本书，一本书可以有多个作者，因此为表示这种关系，应添加一个编著表，实现多对多的映射。 插入数据时，完整地插入数据直接使用INSERT INTO tablename VALUES (value,…)，若插入数据记录不包含全部列，需要在tablename后指明插入的列项。 在postgreSQL中函数就是存储过程，存储过程中就是一组SQL语句地集合，类似于其他语言中地函数一样。本次实验中Pro_CurrentSale()函数，实际上就是用SELECT查出Sale表的在当日产生所有数据记录，对SaleQuantity，SaleAmount分别求和就得到的统计值。由于需要返回两个值，因此返回类型可以是一个二维表结构。其中表项中的数据类型需要注意SaleQuantity求和后的值与本身的INT类型不同，而是BIGINT，SaleAmount求和后与本身相同仍是MONEY类型。 创建触发器可以分为两步，第一步是创建触发器执行函数，这个函数的创建和存储过程函数相差不大，必须指定函数返回的类型为trigger，触发器函数中有一些不需要声明的特殊变量，NEW：代表行级触发INSERT和UPDATE操作时的新数据行，TG_OP：代表触发器由哪个操作触发。 ；第二部是创建触发器，指明依附的表和被触发的时间是行级还是语句级，以及触发器执行需要满足的条件。本次实验中的触发器应该是在INSERT操作时触发，对于每行都要进行触发。 心得体会： 视图可以给用户带来很多地便利，第一是可以简化复杂地SQL操作，给我的感觉类似于函数，将复杂的操作封装在里面；第二是可以集中地展示特定地数据，例如本次实验中我们时常会去查看Book地相关信息，而这些信息又分散在不同地表中，使用视图可以将他们集成显示；第三是提高数据访问地安全性，用户就不知道完整地表项，数据会相对安全；第四点是具有一定地数据独立性，如果我采用视图去查询，真实地表项发生结果改变不会影响到我。 存储过程函数和触发器函数相同，都是对一组SQL语句的封装，再加上了一些控制分支语句。再编写的时候要注意函数的格式，函数的返回类型，参数的类型，其中的SQL语句就与普通的SQL语句相同。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：  \t\t\t\t\t          实验时间：2019.06.14      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 用户管理：在数据库安全管理中，DBMS需要对每个用户进行管理，如用户创建、用户修改、用户删除管理等。 实现用户管理方式：数据库服务器执行SQL语句管理用户，通过管理工具GUI操作管理用户。 用户创建SQL语句 CREATE USER  <用户账号名> [ [WITH]  option […]]; 用户修改SQL语句 ALTER USER  <用户名>  [ [ WITH ] option [ ... ] ];  \t--修改用户的属性 ALTER USER  <用户名>  RENAME TO <新用户名>;  --修改用户的名称 ALTER USER  <用户名>  SET <参数项> { TO | = } { value | DEFAULT };--修改参数值   ALTER USER  <用户名>  RESET <参数项>;\t--重置用户参数值 用户删除SQL语句 DROP  USER  <用户名>;  数据库权限管理是指DBA管理员或数据库对象拥有者对其所拥有对象进行权限控制设置 权限管理基本操作：授予权限、收回权限、拒绝权限。 权限类别：数据库系统权限、数据库对象访问操作权限、数据库对象定义操作权限。 权限管理SQL语句 GRANT  <权限名> ON  <对象名>  TO {数据库用户名|用户角色名}； REVOKE  <权限名> ON  <对象名>  FROM {数据库用户名|用户角色名}； DENY  <权限名> ON  <对象名> TO {数据库用户名|用户角色名}； 在DBMS中，为了方便对众多用户及其权限进行管理，通常将一组具有相同权限的用户定义为角色(Role)。 角色管理内容：创建角色、修改角色、删除角色。 角色管理实现方式：执行SQL语句管理角色，，通过GUI操作管理角色 角色管理SQL语句 CREATE  ROLE  <角色名> [ [ WITH ] option [ ... ] ]; --创建角色 ALTER  ROLE  <角色名>  [ [ WITH ] option [ ... ] ]; --修改角色属性 ALTER  ROLE  <角色名>  RENAME TO <新角色名>;  --修改角色名称  ALTER  ROLE  <角色名>  SET <参数项> { TO | = } { value | DEFAULT }; --修改参数 ALTER  ROLE  <角色名>  RESET <参数项>;--复位角色参数值 DROP  ROLE  <角色名>;\t--删除指定角色 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 针对图书销售管理系统数据库，设计数据存取权限控制模型。 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验数据及结果分析 针对图书销售管理系统数据库，设计数据存取权限控制模型，其权限模型中分为两个角色，客户是到店进行购买的角色，因此只能够对书籍的简单信息进行查看，对于库存和销售等无权查看；商家负责进货和销售对数据库有绝对的控制权，因此对所有表拥有全部权限，其权限控制模型如下表所示。 表格 5 权限控制模型 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。显然商家和客户角色都不是超级用户，只是数据库的使用者。使用CREATE ROLE 语句创建角色，其中需要指定一些参数：LOGIN允许角色登陆数据库，NOSUPERUSER不是超级用户，NOCRETAEDB没有创建数据库的权限，NOCRETAEROLE没有创建角色的权限，CONNECTION LIMIET C 不限制连接数。，执行结果如下图所示。  图 21 创建角色 在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。依照控制模型使用GRANT语句对角色赋予对应表相应的权限，如下图所示。  图 22 给角色赋予权限  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。使用CREATE USER 语句创建用户，其中需要指明用户登陆的密码，如下图所示。  图 23 创建用户 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。给用户分派角色时，使用GRANT语句，如下图所示。  图 24 给用户分派角色 分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 验证用户U_Customer对author表的权限，如下图所示。因为该用户的权限只有查询，因此当执行插入、更新、删除操作时均被拒绝，只有查询操作能正常执行，符合权限要求。  图 25 客户对author表控制权限验证 验证用户U_Customer对press表的权限，如下图所示。因为该用户的权限只有查询，因此当执行插入、更新、删除操作时均被拒绝，只有查询操作能正常执行，符合权限要求。  图 26 客户对press表权限验证 验证用户U_Customer对book表的权限，如下图所示。因为该用户的权限只有查询，因此当执行插入、更新、删除操作时均被拒绝，只有查询操作能正常执行，符合权限要求。  图 27 客户对book表权限验证 验证用户U_Customer对complie表的权限，如下图所示。因为该用户的权限只有查询，因此当执行插入、更新、删除操作时均被拒绝，只有查询操作能正常执行，符合权限要求。  图 28 客户对compile表权限验证 验证用户U_Customer对inventory表的权限，如下图所示。因为该用户无权限，因此当执行查询、插入、更新、删除操作时均被拒绝，符合权限要求。  图 29 客户对inventory表权限验证 验证用户U_Customer对Sale表的权限，如下图所示。因为该用户无权限，因此当执行查询、插入、更新、删除操作时均被拒绝，符合权限要求。  图 30客户对sale表权限验证 验证用户U_Seller对author表的权限，如下图所示。因为该用户拥有全部权限，因此当执行查询、插入、更新、删除操作时均正确执行，符合权限要求。   图 31 商家对author表权限验证 验证用户U_Seller对press表的权限，如下图所示。因为该用户拥有全部权限，因此当执行查询、插入、更新、删除操作时均正确执行，符合权限要求。  图 32 商家对press表权限验证 验证用户U_Seller对book表的权限，如下图所示。因为该用户拥有全部权限，因此当执行查询、插入、更新、删除操作时均正确执行，符合权限要求。  图 33商家对book表权限验证 验证用户U_Seller对compile表的权限，如下图所示。因为该用户拥有全部权限，因此当执行查询、插入、更新、删除操作时均正确执行，符合权限要求。  图 34 商家对compile表权限验证 验证用户U_Seller对inventory表的权限，如下图所示。因为该用户拥有全部权限，因此当执行查询、插入、更新、删除操作时均正确执行，符合权限要求。  图 35 商家对inventory表权限验证 验证用户U_Seller对sale表的权限，如下图所示。因为该用户拥有全部权限，因此当执行查询、插入、更新、删除操作时均正确执行，符合权限要求。  图 36 商家对sale表权限验证 九、总结及心得体会 总结： 对用户赋予角色的操作可以有两种方式，第一种：在创建用户时就指明它是属于哪几种角色；第二种：是使用GRANT语句将角色赋给用户。 心得体会： 对数据库进行合理的权限管理是保证数据库安全的重要手段，建立权限控制模型时一定要符合业务逻辑。首先DBA拥有全部权限，对于商家、老板等用户可以将数据库的全部权限赋予，对于客户最多只能赋予某些表的查询权限，因为核心数据不能让所有的人都看到。",
  "studentID": "2017221301016"
 },
 "82": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  实验一：图书销售管理系统数据库设计 实验二：图书销售管理系统数据库创建与数据访问操作      实验三：图书销售管理系统数据库后端编程 二、实验室名称：信软楼303\t           实验时间：  2019-6-14 三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 1.首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案，通过 SQL 编程执行来完成对数据库的实现操作。在本实验中，使用 SQL 语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，并编写 SQL 语句对数据库表进行数据的增删查改操作，以及利用视图、存储过程、触发器实现业务数据处理。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行SQL创建图书销售管理系统数据库BookSale。 2.在数据库BookSale中，执行SQL创建数据库表、视图、索引等对象。 3.在数据库BookSale中，执行SQL进行数据增、删、查、改访问操作。 4.在数据库BookSale中，采用PL/pgSQL语言编写存储过程函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库BookSale中，采用PL/pgSQL语言编写过程语句块，实现对存储过程函数Pro_CurrentSale的调用，并输出统计结果。 6.在数据库BookSale中，采用PL/pgSQL语言编写编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.在数据库BookSale中，对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 8.在数据库BookSale中，创建存储过程函数实现图书销售数量和金额统计。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL、PL/pgSQL语言，完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： MAC OS 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数据库 BookSale。 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、 sale（销售表），以及各表主键外键的创建，并为给表创建索引。 3.为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、 customer 表进行数据修改、删除、查询、统计等访问操作。 4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。 5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。 7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据的修改情况。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验数据及结果分析 1.创建BookSaleLan数据库 实现思路与方法：使用SQL语句来进行数据库的创建。 SQL语句：create database “BookSaleLan” 运行操作界面如下图所示。  数据库操作结果面如下图所示：  结果分析：成功创建数据库。  2.创建数据库表以及表中外键和索引 实现思路与方法：首先明确图书销售管理系统的实体、实体属性以及各实体之间的联系，再通过 SQL 语句对表进行创建，表对应实体，实体属性对应表中的列，通过主外键来将表联系起来。 SQL语句： create table Auther_2017221302004( \tAU_ID\t\tchar(18)\t\tnot null, \tAU_Name\t\tvarchar(20)\t\tnot null, \tAU_Gender \tchar(2)\t\t\tnot null, \tAU_Phone \tvarchar(11) \tnot null, \tAU_Address\tvarchar(50)\t\tnot null, \tconstraint\tPK_AUTHER primary key (AU_ID) );  create table Book_2017221302004 ( \tBook_ISBN\tchar(13)\t\tnot null, \tAU_ID\t\tchar(18)\t\tnull, \tPUB_ID\t\tchar(11)\t\tnull, \tBook_Name\tvarchar(50)\t\tnot null, \tBook_Pubdate\tdate\t\tnot null, \tBook_Price \tmoney \t\t\tnot null, \tBook_Category varchar(20) \tnot null, \tBook_Stock \tint4 \t\t\tnot null, \tBook_Notes \tvarchar(100) \tnull, \tBook_List \tvarchar(100) \tnull, \tconstraint PK_BOOK primary key (Book_ISBN) );  create table CUSTOMER_2017221302004 ( \tCUST_ID \t\tchar(18) \t\tnot null, \tCUST_Name \t\tvarchar(20) \tnot null, \tCUST_Phone \t\tvarchar(15) \tnot null, \tCUST_Address\tvarchar(50) \tnot null, \tCUST_Email \t\tvarchar(50)\t\tnot null, \tconstraint PK_CUSTOMER \t\tprimary key (CUST_ID) );  create table Publisher_2017221302004 ( \tPUB_ID \t\tchar(11) \tnot null, \tPUB_Name \tvarchar(20) not null, \tPUB_Phone \tvarchar(15) not null, \tPUB_Address varchar(50) not null, \tconstraint PK_PUBLISHER primary key (PUB_ID) );  create table Sale_2017221302004 ( \tSALE_ID \tvarchar(11) not null, \tBook_ISBN \tchar(13) \tnull, \tCUST_ID \tchar(18) \tnull, \tSALE_Date \tdate \t\tnot null, \tSALE_QTY \tint4 \t\tnot null, \tSALE_Amount money \t\tnot null, \tconstraint PK_SALE primary key (SALE_ID) );  create table Stock_2017221302004 ( \tStock_ID \t\tvarchar(10) not null, \tBook_ISBN \t\tchar(13) \tnull, \tStock_Change \tint4 \t\tnot null, \tStock_Operation char(4) \tnot null, \tStock_Datetime \tdate \t\tnot null, \tconstraint PK_STOCK primary key (Stock_ID) );  alter table Book_2017221302004 \tadd constraint FK_BOOK_BOOK_AUTH_AUTHER foreign key (AU_ID) \t\treferences Auther_2017221302004 (AU_ID) \t\ton delete restrict on update restrict; \t\t alter table Book_2017221302004 \tadd constraint FK_BOOK_BOOK_PUBL_PUBLISHE foreign key (PUB_ID) \t\treferences Publisher_2017221302004 (PUB_ID) \t\ton delete restrict on update restrict; \t\t alter table Sale_2017221302004 \tadd constraint FK_SALE_BOOK_SALE_BOOK foreign key (Book_ISBN) \t\treferences Book_2017221302004 (Book_ISBN) \t\ton delete restrict on update restrict; \t\t alter table Sale_2017221302004 \tadd constraint FK_SALE_CUSTOMER_CUSTOMER foreign key (CUST_ID) \t\treferences CUSTOMER_2017221302004 (CUST_ID) \t\ton delete restrict on update restrict; \t\t alter table Stock_2017221302004 \tadd constraint FK_STOCK_BOOK_STOC_BOOK foreign key (Book_ISBN) \t\treferences Book_2017221302004 (Book_ISBN) \t\ton delete restrict on update restrict;  将上面的SQL 程序，提交到数据库服务器执行，其执行作界面如图所示。    当SQL 程序成功执行后，可以在数据库看到新添加的数据库表对象，如图 ：    3.插入样本数据并对auther_2017221302004表进行增删查改操作 实现思路与方法：首先准备样本数据，尽可能使得数据符合实际应用并且要能满足后续的数据处理操作。这里以auther_2017221302004 表为例，给出该表的数据增、删、查、改SQL 语句操作访问。 1）执行SQL 语句，插入样本数据到图书销售数据库 insert into auther_2017221302004 values('450702199812239003','彭业鉴','男','18877709336','四川省成都市成华区建设北路二段十号'); insert into auther_2017221302004 values('540135199103281548','叶无双','男','15812387538','浙江省杭州市天路区梅田路二十八号'); insert into auther_2017221302004 values('120857198811123587','李婷','女','18575615472','北京市朝阳区梅山路二巷八号'); insert into auther_2017221302004 values('330309198504150527','王天','男','13554874593','四川省成都市成华区建设北路二段十号'); insert into publisher_2017221302004 values('PUB00000000','彭业鉴教育出版社','010-65432123','北京'); insert into publisher_2017221302004 values('PUB00000001','高等教育出版社','010-65321854','北京'); insert into publisher_2017221302004 values('PUB00000002','电子工业出版社','010-65329857','北京'); insert into publisher_2017221302004 values('PUB00000003','人民邮电出版社','010-65325987','北京'); insert into book_2017221302004 values('2017221302004','450702199812239003','PUB00000000','彭业鉴的数据库实验书','2019-6-10','60','IT 技术','300'); insert into book_2017221302004 values('9787115502742','330309198504150527','PUB00000001','Web 前端开发最佳实践','2016-01-01','59','IT 技术','100'); insert into book_2017221302004 values('9875325415577','540135199103281548','PUB00000002','Java EE Web 编程','2008-01-01','52','IT 技术','200'); insert into book_2017221302004 values('9865365975234','120857198811123587','PUB00000003',' 数据库实验指导','2013-08-1','29','IT 技术','150');  insert into customer_2017221302004 values('450702199901018114','业鉴','18844408336','广西省钦州市尖山镇九鸦村','1163668040@qq.com'); Insert into customer_2017221302004 values('680554199207120325','林天','15963512578','四川省成都市成华区建设北路二段十一号','450448745@qq.com'); Insert into customer_2017221302004 values('345021198608120258','宫铃','18636598574','浙江省杭州市天路区梅田路二十九号','657873215@qq.com'); Insert into customer_2017221302004 values('542244197812121687','鲁丽','13615869875','北京市朝阳区梅山路二巷十六号','647864378@qq.com'); 样本数据插入SQL 程序的运行操作界面如图所示。   查看auther_2017221302004表数据语句如下： select * from auther_2017221302004; 运行该SQL 语句，其执行结果如图所示。  结果分析：插入表数据成功无误。  2）增加一条数据到auther_2017221302004表 SQL 语句： insert into auther_2017221302004 values('250801199812238117','彭彭彭','男','27396227447','四川省成都市电子科技大学'); 运行操作界面如图所示：  执行结果如图所示：   3）删除一条publisher 表数据 SQL语句：delete from auther_2017221302004 where au_phone='27396227447'; 运行操作结果如图：  其执行及如果如图所示：   4）修改一条auther_2017221302004表数据 SQL语句：update auther_2017221302004 set au_phone='17396227337' where au_name='彭业鉴'; 该语句运行操作结果如图所示：  再对auther_2017221302004表进行查询：  结果分析：对应au_phone数据确实成功被修改。  4.创建视图 实现思路与方法：创建一个视图将多个表关联查询，通过视图实现简单的数据查询。创建完视图之后可用select 语句来查看视图，用法：select * from 视图名。例如，创建视图BOOK_AUTHER_PUBLISHER 实现图书信息查询，其SQL 语句如下： create view BOOK_AUTHER_PUBLISHER as  select B.book_name as \"图书\",AU.au_name as \"作者\",PU.pub_name as \"出版社\",B.book_price as \"图书价格\" from book_2017221302004 as B join auther_2017221302004 as AU on B.au_id=AU.au_id join publisher_2017221302004 as PU on B.pub_id = PU.pub_id \t该SQL 运行操作结果如图所示：  采用如下SQL 语句实现视图数据查询：select * from BOOK_AUTHER_PUBLISHER; 该SQL 语句执行结果如图所示。  结果分析：视图展示数据对应正确且按需展示，视图创建成功。  5.创建触发器函数 实现思路与方法：创建触发器函数实现在有一条销售数据插入sale 表时，同时在库存表stock 中插入图书的库存变化记录，并修改对应图书表book 的库存数，为后续的创建触发器提供函数方法。 创建触发器函数SQL 语句 create or replace function insertsale() returns trigger as $$ \tbegin \t\tif (TG_OP = 'insert') then \t\t\tinsert into stock values(new.sale_id,new.book_isbn,new.sale_qty,'出库',new.sale_date); \t\t\tupdate book_2017221302004 set  book_2017221302004.book_stock=book_2017221302004.book_stock-new.sale_qty  where book_2017221302004.book_isbn = new.book_isbn; \t\t\treturn new; \t\tend if; \t\treturn null; \tend; $$ language plpgsql; 运行操作结果如图所示   6.创建触发器 实现思路与方法：创建触发器，关联销售表，在销售表插入一个新数据之后，执行上一步编写的触发器函数。 创建触发器SQL 语句： create trigger tri_insertsale after insert on sale_2017221302004 for each row execute procedure InsertSale(); 运行操作界面如图：   7.测试触发器 实现思路与方法：在销售表中插入几个样本数据，之后再查看库存表和图书表的数据，观察这两个表中的数据是否发生变化，并且观察数据的变化是否与插入销售表的数据一致。 测试触发器SQL 语句： Insert into sale_2017221302004 values('SA00001','9787115502742','680554199207120325','2019-05-20',15,'885'); Insert into sale_2017221302004 values('SA00002','9875325415577','345021198608120258','2019-05-20',20,'1040'); Insert into sale_2017221302004 values('SA00003','9865365975234','542244197812121687','2019-05-20',50,'1450'); 运行操作界面如图：  结果展示，查看stock_2017221302004 表数据以及对比book_2017221302004 表数据。    结果分析： Stock 表本来没有数据，在sale 插入数据之后，并未能将库存数据进行记录，记录数据正确，但却同时更新了book 表中各对应图书的库存量，更新数据正确，触发器功能实现出现了错误。  8.创建存储过程 实现思路与方法：通过存储过程实现某日图书销售数量和金额统计。创建存储过程的SQL 语句如下。 create or replace function countsale(OUT amount int,OUT allmoney money) as $count$ begin \tselect sum(sale_qty) into amount from sale_2017221302004 where sale_date = '2019-05-20'; \tselect sum(sale_amount) into allmoney from sale_2017221302004 where sale_date='2019-05-20'; end; $count$ language plpgsql; 该SQL 语句运行操作界面如图所示。  9.调用存储过程 实现思路与方法：调用上一步的存储过程，观察输出的结果是否与真实情况一致，调用存储过程SQL 语句如下： select *from countsale() 存储过程调用语句执行结果如图所示。  结果分析：调用存储过程输出的总销售量和总金额数据正确，存储过程功能正确。 九、总结及心得体会 \t本次实验主要是对数据库进行创建，表的创建，数据的插入和增删查改，触发器的创建以及存储过程的创建。书上的内容较为理论化，要进行动手操作。就比如说，在postgresql中的关键字其实是部分大小写的，但是单引号里边的内容却要分大小写，如果不注意将TG_OP = ‘INSERT’写成TG_OP = ‘insert’,那么不能得到想要的结果。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库系统管理 二、实验室名称：信软楼303\t\t\t\t          实验时间：2019-6-14 三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作的时候就会受到不同程度的制约。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 5.分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 6.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。       六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： MAC OS 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2. 在pgAdmin4 中的BookSale 数据库中， 使用SQL 语句创建客户（R_Customer）角色、商家（R_Seller）角色。 3.在pgAdmin4 中， 根据第一步设计的数据存取权限控制模型对客户（R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。 4.在pgAdmin4 中，分别创建客户用户U_Customer、商家用户U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户U_Customer、商家用户U_Seller 身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两 用户不同的角色权限。 八、实验数据及结果分析 1.创建客户角色和商家角色 实现思路与方法：使用SQL 语句进行角色创建，因为客户角色和商家角色都是普通角色，因此除了登录的功能之外其他的高级权限都为no。 创建客户角色的SQL 语句： create role \"R_Customer_2017221302004\"\twith LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOREPLICATION NOINHERIT CONNECTION LIMIT -1 创建客户角色的SQL运行界面如图所示：  创建商家角色的SQL语句： create role \"R_Seller_2017221302004\"\twith LOGIN NOSUPERUSER NOCREATEDB NOCREATEROLE NOREPLICATION NOINHERIT CONNECTION LIMIT -1 创建商家角色的运行界面如图所示：  创建两个角色的结果如图所示：  结果分析：在角色用户表中看到刚创建的两个角色，角色创建成功。  2.赋予客户、商家角色权限 实现思路与方法：使用SQL 语句给两个角色赋予在步骤1 定义的权限。 赋予客户角色SQL 语句： grant select on book_2017221302004 to \"R_Customer_2017221302004\"; grant select on auther_2017221302004 to \"R_Customer_2017221302004\"; grant select on publisher_2017221302004 to \"R_Customer_2017221302004\"; 运行界面如图所示：  赋予商家角色SQL语句： grant select,insert,update,delete on book_2017221302004 to \"R_Seller_2017221302004\"; grant select,insert,update,delete on auther_2017221302004 to \"R_Seller_2017221302004\"; grant select,insert,update,delete on publisher_2017221302004 to \"R_Seller_2017221302004\"; grant select on stock_2017221302004 to \"R_Seller_2017221302004\"; grant select ,insert,update,delete on sale_2017221302004 to \"R_Seller_2017221302004\"; grant select,insert,update,delete on customer_2017221302004 to \"R_Seller_2017221302004\"; 运行界面如图所示：   结果分析：权限赋予成功。  4.创建客户用户和商家用户，并将客户角色和商家角色赋予他们 实现思路与方法：使用SQL 语句创建用户，并将对应的角色赋予他们。 其SQL语句如下： create user \"U_Customer_2017221302004\" with login connection limit -1 in role \"R_Customer_2017221302004\" password '304009';  create user \"U_Seller_2017221302004\" with login connection limit -1 in role \"R_Seller_2017221302004\" password '304009'; 其运行界面如下：  运行结果如下：  5. 分别用客户用户和商家用户登录数据库，并进行操作来验证是否赋予权限成功。 实现思路与方法：用客户用户和商家用户进行登录，通过对各表进行增删查改操作来观察操作结果来验证是否与赋予他们的权限一致。 首先我们来登录客户用户来进行测试。 登陆用户客户如图所示：  测试一：查看book_2017221302004表 SQL语句：select * from book_2017221302004; 运行界面结果：  \t结果分析：成功输出。 \t测试二：删除book_2017221302004表中的数据 运行结果如图所示：  结果分析：删除失败，客户用户不具有删除权限，权限正确。 测试三：查看auther_2017221302004表 运行结果如图所示：  结果分析：客户可以查看该表，权限正确。 测试四：插入一条数据到该表中 运行结果如图所示：  结果分析：客户无法插入数据，权限正确。 测试五：查看sale_2017221302004表 运行结果如图所示：  结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过，测试客户用户的权限正确。  登陆商家用户进行测试  测试一：查看Customer表 运行结果如图所示：  结果分析：商家用户具有查看客户表的权限，权限正确。  测试二：插入一条数据到auther_2017221302004 中 运行结果如图所示：  查看该表：  结果分析：auther_2017221302004 表中新增了如上插入的数据，商家用户具有插入auther_2017221302004 表数据的权限，权限正确。 \t 测试三：从stock_2017221302004表中删除数据 \t运行结果如图所示：  结果分析：商家用户不具有删除stock_2017221302004 表数据的权限，权限正确。 测试四：更新sale_2017221302004表的一条数据 运行结果如图所示：  结果展示，通过查看sale_2017221302004 来查看,结果如图所示。  结果分析：sale_2017221302004表中对应的数据被修改正确，商家用户具有修改sale_2017221302004数据的权限，权限正确。通过四个测试，每个测试结果都正确，说明商家用户权限赋予正确。 九、总结及心得体会 本次实验主要是对数据库进行角色管理，一般来说需要经过一下几个步骤：首先是创建角色，然后赋予角色对数据库表的操作权限，最后再创建用户，并且赋予相应的角色。",
  "studentID": "2017221302004"
 },
 "83": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221302011      姓    名      孙玉龙           （实验）\t课程名称  数据库原理及应用     理论教师       文军            实验教师      何中海               电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：孙玉龙\t\t学号：2017221302011 指导教师：何中海   实验地点：信软楼西303     实验时间：2019.06.14 一、实验名称：图书销售管理系统数据库SQL应用编程、图书销售管理系统数据库安全管理 二、实验学时：8 三、实验目的： 1.针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 2.对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 1. 图书销售管理系统数据库SQL应用编程 (1)首先对图书销售管理系统进行数据需求分析，定义组成系统数据结构的实体，实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型的设计。进一步对图书销售管理系统进行物理模型的设计，给出数据库设计方案。 (2)基于数据库设计方案，通过SQL编程完成对数据库的实现。在本实验中，主要使用SQL语言创建数据库，创建表，创建视图和索引，创建存储过程和触发器，实现对数据的增删查改功能。 2. 图书销售管理系统数据库安全管理 (1)设计数据库存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 (2)使用SQL语句进行角色用户创建，对角色进行权限赋予，对用户分派角色。 (3)使用不同的用户登陆时，就拥有了改用户的权限，在对数据库表进行操作时就会收到不同程度的制约。 五、实验内容： 1.图书销售管理系统数据库SQL应用编程 （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 2.图书销售管理系统数据库安全管理 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）： 实验PC计算机 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤： 1. 图书销售管理系统数据库SQL应用编程 (1)数据库 CREATE DATABASE Booksale (2)创建表、示图、索引等 创建表：   (3) 插入数据  删除数据： 查找数据：  更新数据：   (4)编写函数Pro_CurrentSale  (5)调用该函数  (6)编写触发器Tri_InsertSale。 编写触发器函数: 建立触发器：  (7)调用该触发器 插入数据： 删除操作： 更新操作： 2. 图书销售管理系统数据库安全管理 (1) 针对图书销售管理系统数据库，设计数据存取权限控制模型。 实现思路：在图书销售管理系统中，客户用户和商家用户至多有insert和update，或者update的权限。 客户用户对在售查看和删除，插入的权限，商家用户对OnSale有插入权限和读权限 客户模型： 商家模型 (2)在数据库BookSale中，使用SQL语句创建客户(R_Customer)角色和商家(R_Seller)角色。 create role R_Customer WITH login nosuperuser nocreatedb nocreaterole noinherit noreplication connection limit -1; create role R_Seler WITH login nosuperuser nocreatedb nocreaterole noinherit noreplication CONNECTION LIMIT -1; 运行结果如图  (3)对角色R_Customre和R_Seller赋予权限。 grant select,update on booklist to R_Customer; grant select,insert,update on orderform to R_Customer;  grant select,insert,delete,update on booklist to R_Seler ; grant select,delete,update on orderform to R_Seler; 查询结果：  (4)创建用户U_Customer和U_Seller，并为客户用户分配客户角色，为商家用户分配商家角色。 create user U_Customer with login connection limit -1 in role R_Customer password '123456';  create user U_Seller with login connection limit -1 in role R_Seler password '123456'; 查询结果如图  (5)分别以U_Customer和U_Seller的身份访问BookSale数据库，并对各数据表进行操作，验证是否分配了改用户的角色的权限。 U_Customer 对表booklist的SELCET权限，orderform的SELECT、UPDATE和INSERT 权限以及由于触发器存在而需要的对Booklist表的UPDATE权限：  INSERT INTO orderform VALUES('10007','孙玉龙','35','雅典娜之剑','电子科技大学','1','2019-6-30'); UPDATE orderform set orderaddress='山东聊城' Where ordernumber='10003' 执行后结果：  U_Seller对表booklist的全操作和对表orderform的SELECT、UPDATE、DELETE操作。 对booklist的完全操作权限： INSERT INTO booklist VALUES('00008','威尔斯','隐身人','100','28'); UPDATE booklist set bookremain='120' WHERE booknumber='00001'; DELETE FROM booklist WHERE booknumber='00004'; SELECT * FROM booklist; 修改结果如图：  对表orderform的SELECT、UPDATE、DELETE操作权限： 操作前：  操作后：  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1. 图书销售管理系统数据库SQL应用编程 初始数据插入后表内数据： Booklist:  Orderform  删除数据:’10002’订单  查找数据：孙玉龙的订单  修改数据：10003订单的购买量为3  创建的函数pro_currentsale()调用结果：（运行日期为2019-06-29）  数据库修改前的库存和订单：   插入新的订单INSERT INTO orderform VALUES('10006','张三','50','钢铁是怎样炼成的','四川成都','2','2019-06-29')，触发器触发，booklist改变：  可以看到，张三订购两本《钢铁是怎样炼成的》后，该书库存相应的减少了两本 同样的，采取DELETE和UPDATE操作： DELETE FROM orderform WHERE ordernumber='10001'  可以看到，订单删除（取消后），《数据库系统》库存相应的增加了一本 UPDATE orderform set orderamount='10' WHERE ordernumber='10004'  可以看到，订单数目由3增加到10后，《雅典娜之剑》的库存量减少了七本。 2. 图书销售管理系统数据库安全管理 实验过程截图可知，实验结果正确，实验成功。 九、总结及心得体会： 总的来说，实验最困难的阶段在于一开始的构思设计阶段，好的设计思路和结构能够更容易实现更多的功能。我个人的功能实现就在编码阶段因为表格结构设计的原因出现了难以实现的困难。总体设计的难度要比编码更高一些。 十、对本实验过程及方法、手段的改进建议： 暂无。                                                      报告评分：                                          指导教师签字：",
  "studentID": "2017221302011"
 },
 "84": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221303001      姓    名        曹洪水         （实验）\t课程名称  数据库原理及应用     理论教师        文军           实验教师        何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：曹洪水\t学号：2017221303001   指导教师：何中海 实验地点：信软学院楼西303  实验时间：2019.01.12 一、实验一：图书销售管理系统数据库SQL应用编程 二、实验学时：4 三、实验目的： 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。  四、实验原理： \t1.首先对图书销售管理系统进行需求分析，定义实体、实体属性和实体之间的关系。通过建模设计工具，进一步对图书销售管理数据库进行物理模型设计。 \t2.基于数据库设计方案，通过SQL编程执行完成对数据库的操作，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，最后利用视图、存储过程、触发器实现业务数据处理。  五、实验内容： 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行SQL创建图书销售管理系统数据库BookSale。 2.在数据库BookSale中，执行SQL创建数据库表、视图、索引等对象。 3.在数据库BookSale中，执行SQL进行数据增、删、查、改访问操作。 4.在数据库BookSale中，采用PL/pgSQL语言编写存储过程函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库BookSale中，采用PL/pgSQL语言编写过程语句块，实现对存储过程函数Pro_CurrentSale的调用，并输出统计结果。 6.在数据库BookSale中，采用PL/pgSQL语言编写编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.在数据库BookSale中，对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 8.在数据库BookSale中，创建存储过程函数实现图书销售数量和金额统计。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL、PL/pgSQL语言，完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11  七、实验步骤： 1.在数据库服务器中，创建数据库BookSale_2017221303001. 2.在数据库中采用SQL语句创建图书表、作者表、出版社表、库存流水表、客户表、销售表、以及各表主键外间的创建，并创建索引。 3.为各个准备数据数据并进行插入操作。 4.创建视图BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。 5.编写触发器函数，实现在sale_005表插入时，级联操作stock_005表。 6.创建完触发器函数之后，创建对应的触发器。 7.测试触发器功能。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建BookSale_2017221303001数据库： SQL语句：create database \"BookSale_2017221303001\"    数据库界面截图     2.创建各数据库表以及表中主外键和索引： 首先明确实体及其之间的关系，然后进行创建。 SQL语句： 运行结果   3.插入数据并对publisher005进行增删改查操作： SQL语句如下： 运行结果       使用select *from publisher005; 结果如下：   4.创建视图： SQL语句如下：     使用select * from BOOK_AUTHER_PUBLISHER005;查询结果如下：  5.创建触发器函数： 创建触发器函数实现有一条销售数据插入sale005时，同时在stock005中修改图书的库存。 SQL语句：      6.创建触发器： SQL语句：  7.测试触发器： 测试所用SQL语句：  Book005表之后的数据如下：  测试触发器之后的stock005如下：   与之前插入的数据不同，说明触发器编译成功     8.创建存储过程： SQL语句如下：   9.调用存储过程： 使用SQL语句：select * from countsale() 执行结果：   九、总结及心得体会： 通过此次实验，我学会了更多关于数据库基础操作的使用方法，而且也打深了自己的基础，对于许多基础操作有了更好的掌握。 十、对本实验过程及方法、手段的改进建议： 在实验中，可以添加更多具有挑战性的实验内容，这样有助于学生加深对于数据库的操作理解                                                                                  电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库SQL应用编程 二、实验学时：4    三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用SQL语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登陆时，就拥有了该用户的权限，在对数据库表进行操作时就会受到不同程度的约束。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer005）、商家（R_Seller005）角色。 3.在数据库中，根据业务规则为客户（R_Customer005）、商家（R_Seller005）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer005、商家用户U_Seller005。 5.分别为客户用户U_Customer005、商家用户U_Seller005分派客户（R_Client005）、商家（R_Seller005）角色。 6.分别以客户用户U_Customer005、商家用户U_Seller005身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2.在pgAdmin4中的BookSale_2017221303005数据库中，使用SQL语句创建客户（R_Customer005）角色、商家（R_Seller005）角色。 3.在pgAdmin4中，根据第一步设计的数据存取权限控制模型对客户（R_Customer005）角色、商家（R_Seller005）角色赋予所定义的数据库对象权限 4.在pgAdmin4中，分别创建客户用户U_Customer005、商家用户U_Seller005，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户U_Customer005、商家用户U_Seller005身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析 1.创建客户角色和商家角色： SQL语句：      2.赋予客户、商家角色权限： SQL语句：     3.创建客户用户和商家用户，将客户角色和商家角色赋予给他们： SQL语句：  4.分别用客户用户和商家用户验证是否赋予权限成功： 首先登陆客户用户：  查询book005功能可以运行。  从book005中删除数据由于权限不够所以无法进行。  查看auther005表可以正常运行。  往auther005中插入数据由于权限不足所以无法进行。  查看sale005由于权限不足无法进行         2.\t登陆商家用户：  查看customer005操作如下：   插入一条数据到auther中：        插入成功  测试从stock中删除数据：  权限不足  更新sale005中的数据：     结论：通过以上对与角色权限的测试，可以看到，各个角色权限都符合之前的设计。 九、总结及心得体会 通过这次实验，我更好的体会到了多角色对于建立用户时的方便，而不至于没建立一个新的用户就赋予一次权限。       报告评分：                                          指导教师签字",
  "studentID": "2017221303001"
 },
 "85": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221303006     姓    名        董佳宇         （实验）\t课程名称    数据库原理及应用   理论教师         文军          实验教师        何中海             电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：董佳宇\t\t学号：2017221303006   指导教师：何中海   实验地点：信软楼303     实验时间：2019.6.14 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：5 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 四、实验原理： \tSQL相关语句。 五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）： 装有Postgre11环境的WINDOWS PC机一台。 七、实验步骤： \t先建立数据库，然后分析数据库中的表种类，建立相应的表，执行增删改查的操作，然后编写并调用函数Pro_CurrentSale，最后编写触发器以及触发器对应的存储过程。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.建立一个BookSale数据库： CREATE DATABASE BookSale; 2. 在图书销售管理系统数据库BookSale中创建数据库表，视图以及索引： 首先，经过分析，这个系统需要建立十个表：分别为：地区表Locationtable，作者表AuthorTable，图书类别表BookKindTable，出版社表PublisherTable，商店表ShopTable，折扣表DiscountTable，图书表BookTable，销售表SaleTable，库存表StoreTable，编著排名表WriterRankTable 以下是建立上述十个表的语句： CREATE TABLE LocationTable ( LocationID\t\tchar(22)\tPRIMARY KEY, Locationname\tvarchar(20)\tNOT NULL );  CREATE TABLE AuthorTable ( AuthorID\t\tchar(12)\tPRIMARY KEY, LocationID\t\tchar(22)\tNOT NULL, AuthorName\t\tvarchar(40)\tNOT NULL, AuthorLocation\tvarchar(80)\tNOT NULL, AuthorPhone\t\tchar(11)\tNOT NULL, CONSTRAINT\tLocationID_FK FOREIGN KEY(LocationID) REFERENCES LocationTable(LocationID) \tON DELETE CASCADE \tON UPDATE CASCADE );   CREATE TABLE BookKindTable ( KindID\t\tchar(5)\t\tPRIMARY KEY, KindName\tvarchar(20)\tNOT NULL );  CREATE TABLE PublisherTable ( PublisherID\t\tchar(12)\tPRIMARY KEY, PublisherName\tvarchar(40)\tNOT NULL, PublisherPhone\tvarchar(20)\tNOT NULL, PublisherLocation\tvarchar(60)\tNOT NULL );  CREATE TABLE ShopTable ( ShopID\t\tchar(12)\tPRIMARY KEY, ShopName\tvarchar(40)\tNOT NULL, PostID\t\tchar(5)\t\tNOT NULL, ShopLocation\tvarchar(80)\tNOT NULL );  CREATE TABLE DiscountTable ( DiscountID\tint2\t\tPRIMARY KEY, ShopID\t\tchar(12)\tNOT NULL, DiscountPercent\tint2\tNOT NULL, DiscountKind\tvarchar(20)\tNOT NULL, CONSTRAINT\tShopID_FK FOREIGN KEY(ShopID) REFERENCES ShopTable(ShopID) \tON DELETE CASCADE \tON UPDATE CASCADE );  CREATE TABLE BookTable ( ISBN\tchar(22)\tPRIMARY KEY, PublisherID\tchar(12)\tNOT NULL, KindID\t\tchar(5)\t\tNOT NULL, BookName\tvarchar(80)\tNOT NULL, PublishDate\tDate\t\tNOT NULL, BookPrice\tMoney\t\tNOT NULL, Bookindex\tvarchar(2000)\tNOT NULL, BookCatalogue\tText\tNOT NULL, CONSTRAINT\tPublisherID_FK FOREIGN KEY(PublisherID) REFERENCES PublisherTable(PublisherID) \tON DELETE CASCADE \tON UPDATE CASCADE, CONSTRAINT\tKindID_FK FOREIGN KEY(KindID) REFERENCES BookKindTable(KindID) \tON DELETE CASCADE \tON UPDATE CASCADE );  CREATE TABLE SaleTable ( SaleID\tSerial\tPRIMARY KEY, ISBN\tchar(22)\tNOT NULL, ShopID\tchar(12)\tNOT NULL, SaleDate\tDate\tNOT NULL, SaleNumber\tNumeric\tNOT NULL, SalePrice\tMoney\tNOT NULL, CONSTRAINT\tISBN_FK FOREIGN KEY(ISBN) REFERENCES BookTable(ISBN) \tON DELETE CASCADE \tON UPDATE CASCADE, CONSTRAINT\tShopID_FK FOREIGN KEY(ShopID) REFERENCES ShopTable(ShopID) \tON DELETE CASCADE \tON UPDATE CASCADE\t );  CREATE TABLE StoreTable ( ShopID\tchar(12)\tNOT NULL, ISBN\tchar(22)\tNOT NULL, StoreNumber\tint2\tNOT NULL, CONSTRAINT\tStoreTable_PK\tPRIMARY KEY(ShopID,ISBN), CONSTRAINT\tISBN_FK FOREIGN KEY(ISBN) REFERENCES BookTable(ISBN) \tON DELETE CASCADE \tON UPDATE CASCADE, CONSTRAINT\tShopID_FK FOREIGN KEY(ShopID) REFERENCES ShopTable(ShopID) \tON DELETE CASCADE \tON UPDATE CASCADE );  CREATE TABLE WriteRankTable ( AuthorID\tchar(12)\tNOT NULL, ISBN\t\tchar(22)\tNOT NULL, RankOrder\tint2\t\tNOT NULL, CONSTRAINT\tWriteRankTable_PK\tPRIMARY KEY(AuthorID,ISBN), CONSTRAINT\tISBN_FK FOREIGN KEY(ISBN) REFERENCES BookTable(ISBN) \tON DELETE CASCADE \tON UPDATE CASCADE, CONSTRAINT\tAuthorID_FK FOREIGN KEY(AuthorID) REFERENCES AuthorTable(AuthorID) \tON DELETE CASCADE \tON UPDATE CASCADE ); 以下是建视图语句，以建立图书的视图为例： CREATE VIEW BookView AS SELECT ISBN,PublisherID,Bookname,BookPrice FROM BookTable; 索引的话，针对所有的主键建立， 下面以图书表为例建立索引： CREATE INDEX Book_Idx ON BookTable (ISBN); 3.对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 以BookKindTable表的增改删查为例进行演示。 INSERT INTO BookKindTable VALUES('00001','教科书'); INSERT INTO BookKindTable VALUES('00002','课内辅导书'); INSERT INTO BookKindTable VALUES('00003','课外书'); SELECT * FROM BookKindTable; 结果如下图  然后，删除第三行，将第二行kindname修改为课外书 DELETE FROM BookKindTable WHERE kindid='00003'; UPDATE BookKindTable SET kindname='课外书' WHERE kindid='00002'; SELECT * FROM BookKindTable; 结果如下：  4.编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 create or replace function Pro_CurrentSale() returns record as  $$ \tdeclare count1 record; \tbegin \t\tselect sum(salenumber) as salenumber,sum(saleprice) as saleprice into count1 FROM saletable WHERE saledate=current_date; \t\treturn count1; \tend $$ language plpgsql; 然后我们插入示例数据 insert into publishertable values('000000000001','高等教育出版社','13888888888','天安门广场'); insert into booktable values('978-7-115-50247-2','000000000001','00001','数据库原理','2005-6-12',388,'主要讲了数据库的应用','数据库操作，存储过程'); insert into booktable values('978-7-115-50247-3','000000000001','00001','操作系统','2005-6-12',298,'主要讲了操作系统的应用','操作系统操作，哲学家问题'); insert into shoptable values('000000000001','新华书店','12345','北京天坛广场'); insert into saletable values(10,'978-7-115-50247-2','000000000001','2019-6-21',3,600); insert into saletable values(11,'978-7-115-50247-3','000000000001','2019-6-21',2,300); 5.编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 调用存储过程： Select Pro_CurrentSale(); 结果如下：  结果完全正确。 6.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 首先建立触发器调用的存储过程 create or replace function Pro_InsertSale() returns trigger as $$ \tdeclare salenumber1 integer; \tbegin \t\tselect salenumber into salenumber1 FROM saletable; \t\tupdate storetable set storenumber = storenumber-salenumber1 where new.shopid=shopid and new.isbn=isbn; \t\treturn null; \tend $$ language plpgsql; 然后建立需要的触发器 create trigger Tri_InsertSale AFTER INSERT ON saletable FOR EACH ROW EXECUTE PROCEDURE Pro_InsertSale(); 然后输入如下信息，插入并验算结果是否正确： insert into storetable values('000000000001','978-7-115-50247-2',100); insert into saletable values(13,'978-7-115-50247-2','000000000001','2019-6-21',3,600); select * from storetable; 结果输入如下图：  值变为了97，说明结果正确  九、总结及心得体会： 通过本次实验，我熟练掌握了SQL语句的增删改查操作，并可以建立触发器以及存储过程，对它们的理解从理论层面上升到了操作层面，老师精心设计的例子，对每个部分的知识点都有所考察，起到了很好的查漏补缺效果。 十、对本实验过程及方法、手段的改进建议：无                                                      报告评分：                                          指导教师签字： 电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221303006     姓    名       董佳宇          （实验）\t课程名称    数据库原理及应用   理论教师        文军           实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：董佳宇\t\t学号：2017221303006    指导教师：何中海 实验地点：信软实验楼303     实验时间：2019/6/21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3学时 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 相关SQL语句。 五、实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）：   具有WINDOWS10系统的计算机一台。 七、实验步骤： 首先分析角色的种类以及其该拥有的权限，然后创建角色，并为其赋予角色权限，进而创建用户，为用户赋予角色，使其拥有角色的权限，最后在命令行中用用户对数据库进行操作，检查权限是否正确。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析）： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 我们在这个数据库中，将角色分为了两个部分：商家和客户，针对我的十个表，我们可以得知的权限关系如下表所示：  （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 利用create role即可，代码如下: CREATE ROLE R_Customer; CREATE ROLE R_Seller; 结果如下：  （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 \t利用grant语句即可，以（1）分析结果进行赋予权限： GRANT SELECT ON Authortable TO R_Customer; GRANT SELECT ON Bookkindtable TO R_Customer; GRANT SELECT ON Booktable TO R_Customer; GRANT SELECT ON discounttable TO R_Customer; GRANT SELECT ON locationtable TO R_Customer; GRANT SELECT ON publishertable TO R_Customer; GRANT SELECT ON saletable TO R_Customer; GRANT SELECT ON shoptable TO R_Customer; GRANT SELECT ON storetable TO R_Customer; GRANT SELECT ON writeranktable TO R_Customer;  GRANT SELECT ON Authortable TO R_Seller; GRANT SELECT ON Bookkindtable TO R_Seller; GRANT SELECT,UPDATE,DELETE,INSERT ON Booktable TO R_Seller; GRANT SELECT,UPDATE,DELETE,INSERT ON discounttable TO R_Seller; GRANT SELECT ON locationtable TO R_Seller; GRANT SELECT ON publishertable TO R_Seller; GRANT SELECT,INSERT ON saletable TO R_Seller; GRANT SELECT,UPDATE,DELETE,INSERT ON shoptable TO R_Seller; GRANT SELECT,UPDATE,DELETE,INSERT ON storetable TO R_Seller; GRANT SELECT ON writeranktable TO R_Seller; 结果如下：  （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 代码如下： CREATE USER U_Customer \tPASSWORD '12345678' \tIN ROLE R_Customer; CREATE USER U_Seller \tPASSWORD '12345678' \tIN ROLE R_Seller; 结果如下：  （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 为了验证角色的权限，我打开了SQL Shell来进行检验。首先是U_Customer，如下图所示：  其次是U_Seller，如下图所示：  实验结果均正确且满足要求。 九、总结及心得体会： 对于数据库的权限控制，可以先将用户划分为几类角色，然后对每一类的角色赋予相应的权限即可很好的实现,而不必为每个用户逐个授权，这尤其适用于用户量较多的系统中。  十、对本实验过程及方法、手段的改进建议：无                                                      报告评分：                                          指导教师签字： ",
  "studentID": "2017221303006"
 },
 "86": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221303012      姓    名        杨映雷         （实验）\t课程名称  数据库原理及应用     理论教师        文军           实验教师        何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：杨映雷\t学号：2017221303012   指导教师：何中海 实验地点：信软学院楼西303  实验时间：2019.01.12 一、实验一：图书销售管理系统数据库SQL应用编程 二、实验学时：4 三、实验目的： 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。  四、实验原理： \t1.首先对图书销售管理系统进行需求分析，定义实体、实体属性和实体之间的关系。通过建模设计工具，进一步对图书销售管理数据库进行物理模型设计。 \t2.基于数据库设计方案，通过SQL编程执行完成对数据库的操作，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建，最后利用视图、存储过程、触发器实现业务数据处理。  五、实验内容： 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行SQL创建图书销售管理系统数据库BookSale。 2.在数据库BookSale中，执行SQL创建数据库表、视图、索引等对象。 3.在数据库BookSale中，执行SQL进行数据增、删、查、改访问操作。 4.在数据库BookSale中，采用PL/pgSQL语言编写存储过程函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库BookSale中，采用PL/pgSQL语言编写过程语句块，实现对存储过程函数Pro_CurrentSale的调用，并输出统计结果。 6.在数据库BookSale中，采用PL/pgSQL语言编写编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 7.在数据库BookSale中，对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 8.在数据库BookSale中，创建存储过程函数实现图书销售数量和金额统计。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL、PL/pgSQL语言，完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。  六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11  七、实验步骤： 1.在数据库服务器中，创建数据库BookSale_2017221303012. 2.在数据库中采用SQL语句创建图书表、作者表、出版社表、库存流水表、客户表、销售表、以及各表主键外间的创建，并创建索引。 3.为各个准备数据数据并进行插入操作。 4.创建视图BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、作者、出版社以及图书价格等数据。 5.编写触发器函数，实现在sale_005表插入时，级联操作stock_005表。 6.创建完触发器函数之后，创建对应的触发器。 7.测试触发器功能。 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建BookSale_2017221303001数据库： SQL语句：create database \"BookSale_2017221303012\"        2.创建各数据库表以及表中主外键和索引： 首先明确实体及其之间的关系，然后进行创建。 SQL语句： 运行结果   3.插入数据并对publisher005进行增删改查操作： SQL语句如下： 运行结果       使用select *from publisher005; 结果如下：   4.创建视图： SQL语句如下：     使用select * from BOOK_AUTHER_PUBLISHER005;查询结果如下：  5.创建触发器函数： 创建触发器函数实现有一条销售数据插入sale005时，同时在stock005中修改图书的库存。 SQL语句：      6.创建触发器： SQL语句：  7.测试触发器： 测试所用SQL语句：  Book005表之后的数据如下：  测试触发器之后的stock005如下：   与之前插入的数据不同，说明触发器编译成功     8.创建存储过程： SQL语句如下：   9.调用存储过程： 使用SQL语句：select * from countsale() 执行结果：   九、总结及心得体会： 通过此次实验，我学会了更多关于数据库基础操作的使用方法，而且也打深了自己的基础，对于许多基础操作有了更好的掌握。 十、对本实验过程及方法、手段的改进建议： 在实验中，可以添加更多具有挑战性的实验内容，这样有助于学生加深对于数据库的操作理解                                                                                  电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库SQL应用编程 二、实验学时：4    三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库数据的安全性。 2.使用SQL语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色。 3.使用不同的用户登陆时，就拥有了该用户的权限，在对数据库表进行操作时就会受到不同程度的约束。 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。 2.在数据库中，创建客户（R_Customer005）、商家（R_Seller005）角色。 3.在数据库中，根据业务规则为客户（R_Customer005）、商家（R_Seller005）角色赋予数据库对象权限。 4.在数据库中，分别创建客户用户U_Customer005、商家用户U_Seller005。 5.分别为客户用户U_Customer005、商家用户U_Seller005分派客户（R_Client005）、商家（R_Seller005）角色。 6.分别以客户用户U_Customer005、商家用户U_Seller005身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 1.针对图书销售管理系统，在设计数据存取权限控制模型。 2.在pgAdmin4中的BookSale_2017221303005数据库中，使用SQL语句创建客户（R_Customer005）角色、商家（R_Seller005）角色。 3.在pgAdmin4中，根据第一步设计的数据存取权限控制模型对客户（R_Customer005）角色、商家（R_Seller005）角色赋予所定义的数据库对象权限 4.在pgAdmin4中，分别创建客户用户U_Customer005、商家用户U_Seller005，并为客户用户分配客户角色，为商家用户分配商家角色。 5.分别以客户用户U_Customer005、商家用户U_Seller005身份访问图书销售管理数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两用户不同的角色权限。  八、实验数据及结果分析 1.创建客户角色和商家角色： SQL语句：      2.赋予客户、商家角色权限： SQL语句：     3.创建客户用户和商家用户，将客户角色和商家角色赋予给他们： SQL语句：  4.分别用客户用户和商家用户验证是否赋予权限成功： 首先登陆客户用户：  查询book005功能可以运行。  从book005中删除数据由于权限不够所以无法进行。  查看auther005表可以正常运行。  往auther005中插入数据由于权限不足所以无法进行。  查看sale005由于权限不足无法进行         2.\t登陆商家用户：  查看customer005操作如下：   插入一条数据到auther中：        插入成功  测试从stock中删除数据：  权限不足  更新sale005中的数据：     结论：通过以上对与角色权限的测试，可以看到，各个角色权限都符合之前的设计。 九、总结及心得体会 通过这次实验，我更好的体会到了多角色对于建立用户时的方便，而不至于没建立一个新的用户就赋予一次权限。       报告评分：                                          指导教师签字",
  "studentID": "2017221303012"
 },
 "87": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221303013   姓    名        邹凯         （实验）\t课程名称    数据库原理及应用 理论教师         文军        实验教师        何中海           电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：邹凯\t\t学号：2017221303013   指导教师：何中海   实验地点：信软楼303     实验时间：2019.6.14 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：5 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 四、实验原理： \tSQL相关语句。 五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）： 装有Postgre11环境的WINDOWS PC机一台。 七、实验步骤： \t先建立数据库，然后分析数据库中的表种类，建立相应的表，执行增删改查的操作，然后编写并调用函数Pro_CurrentSale，最后编写触发器以及触发器对应的存储过程。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 首先创建数据库  创建三个表，图书表，销售表，库存表     创建视图  创建索引  然后数据增删查改操作示例  编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 create or replace function Pro_CurrentSale() returns record as  $$ \tdeclare count1 record; \tbegin \t\tselect sum(salenumber) as salenumber,sum(saleprice) as saleprice into count1 FROM saletable WHERE saledate=current_date; \t\treturn count1; \tend $$ language plpgsql; 编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 调用存储过程： Select Pro_CurrentSale(); 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 首先建立触发器调用的存储过程 create or replace function Pro_InsertSale() returns trigger as $$ \tdeclare salenumber1 integer; \tbegin \t\tselect salenumber into salenumber1 FROM saletable; \t\tupdate storetable set storenumber = storenumber-salenumber1 where new.shopid=shopid and new.isbn=isbn; \t\treturn null; \tend $$ language plpgsql; 然后建立需要的触发器 create trigger Tri_InsertSale AFTER INSERT ON saletable FOR EACH ROW EXECUTE PROCEDURE Pro_InsertSale(); 总结及心得体会： 创建数据库并对数据操作是一个简单但是繁琐的过程，其中有许多SQL语句操作，在实验过程中我对其了解更多了，学到了许多知识。 十、对本实验过程及方法、手段的改进建议：无                                                      报告评分：                                          指导教师签字：  实验二 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3学时 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 相关SQL语句。 五、实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）：   具有WINDOWS10系统的计算机一台。 七、实验步骤： 首先分析角色的种类以及其该拥有的权限，然后创建角色，并为其赋予角色权限，进而创建用户，为用户赋予角色，使其拥有角色的权限。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析）： 创建角色  赋予权限  创建用户  九、总结及心得体会： 对于数据库的权限控制，可以先将用户划分为几类角色，然后对每一类的角色赋予相应的权限即可很好的实现,而不必为每个用户逐个授权，这尤其适用于用户量较多的系统中。  十、对本实验过程及方法、手段的改进建议：无                                                      报告评分：                                          指导教师签字： ",
  "studentID": "2017221303013"
 },
 "88": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221303020     姓    名       唐金森          （实验）\t课程名称    数据库原理及应用   理论教师       文军            实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：唐金森\t\t学号：2017221303020    指导教师：何中海 实验地点：信软实验楼303     实验时间：2019/6/14 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：5学时 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 四、实验原理： SQL语句相关知识。 五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）： 实验PC计算机 PostgreSQL 11 七、实验步骤： 创建数据库BookSale， 利用power designer设计数据库模型， power designer导出sql语句， 数据库执行sql语句， 执行增改删查的操作， 编写函数Pro_CurrentSale， 调用Pro_CurrentSale， 编写触发器Tri_InsertSale， 验证触发器Tri_InsertSale。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） create database booksale。  power designer设计模型：  导出sql语句：  导出的sql语句部分如下所示  执行sql语句（包括建表，建立索引，建立约束）：  实现增删查改： 插入地区表：  更新地区表：  查询：  删除：  创建存储过程：  为了验证，插入一组数据： insert into booktype values('001','教育'); insert into publisher values('001','高等教育出版社','18222222222','成华区'); insert into shop values('001','馋嘴小站','610000','成华区186号'); insert into book values('978-7-115-50274-2','001','001','数据库','2018-5-5','500','无','无'); insert into sale values('001','001','978-7-115-50274-2','2019-6-15','1','500'); insert into addrtable values('001','成都'); insert into author values('001','001','张大强','高新西区','18388888888'); insert into discount values('001','001','5','无'); insert into editorder values('001','001','001','1'); insert into store values('001','978-7-115-50274-2','100');  验证存储过程：  创建触发器函数：  创建触发器：  验证触发器： 在sale中插入一个数据：  发现store中对应数据减少一。  九、总结及心得体会： 触发器中类型要兼容，否则可能出现bug，导致自认为触发器没有工作。 十、对本实验过程及方法、手段的改进建议： 无。                                                      报告评分：                                          指导教师签字： 电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221303020     姓    名       唐金森          （实验）\t课程名称    数据库原理及应用   理论教师       文军            实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：唐金森\t\t学号：2017221303020    指导教师：何中海 实验地点：信软实验楼303     实验时间：2019/6/21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3学时 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： SQL语句相关知识。 五、实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）： 实验PC计算机 PostgreSQL 11 七、实验步骤： 创建角色。 赋予角色权限。 创建用户。 赋予用户角色。 在命令行中以用户访问数据库。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 创建角色：  赋予权限： 消费者：  销售员：  创建用户并分派角色：  用psql登陆consumer用户访问：  如图所示，他对库存表并无访问权限，而对图书表具有访问权限。 登陆seller用户访问：  九、总结及心得体会： 对于数据库，如果有一系列访问控制相同的用户，可以先设置成为角色。 十、对本实验过程及方法、手段的改进建议： 无。                                                      报告评分：                                          指导教师签字：   ",
  "studentID": "2017221303020"
 },
 "89": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221303022     姓    名        陈潇           （实验）\t课程名称   数据库原理及运用    理论教师         文军          实验教师        何中海             电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：陈潇\t\t学号：2017221303022   指导教师：文军 实验地点：信软楼西303   实验时间：2019.6.14 一、实验名称：数据库实验 二、实验学时：8学时 三、实验目的： 完成图书销售管理系统的数据库设计。 完成图书销售管理系统数据库的创建与数据访问操作。 完成图书销售管理系统数据库后端编程 完成图书销售管理系统数据库安全管理 四、实验原理： 在数据库应用系统的数据库设计中，我们用实体关系图（E-R图）方法来展示系统概念数据模型和逻辑数据模型，改模型抽象出系统实体和实体关系，在设计系统逻辑数据模型后，针对应用所采用的Postgresql数据库软件系统进行系统物理数据模型设计，本实验使用powerdesigner建模工具提供的功能开展系统概念数据模型、逻辑数据模型、物理数据模型设计，并对所设计的数据库迷行设计进行检验与完善。 在关系数据库系统中，所有对数据库的访问操作均可以通过DBMS执行SQL语句来实现。 在Postgresql中，存储过程、触发器和游标都可以使用PL/pgsql编程实现的数据处理。按照PL/pgsql提供的语句和程序结构，实现数据库后端功能编程处理，可以使用数据库开发工具pgAdmin或psql命令行工具执行PL/pgsql程序，实现数据库后端功能处理。 在Postgresql中，实现数据存取安全模型是确保数据库安全访问的基本手段。在数据安全存取模型中，需要设计数据库的角色、角色的数据库对象操作权限、数据库用户、数据库与用户的角色赋予、以及数据库对象的操作权限集合。根据设计的数据安全存取模型，系统管理员使用数据库管理工具pgAdmin去创建角色，授予系统管理权限和对象从挨揍权限。此外，系统管理员还需要创建用户，并对用户赋予必要的角色，之后，用户就可以对数据库对象进行访问。 五、实验内容： 实验一： 图书销售管理系统数据需求分析。 图书销售管理系统概念数据模型初步设计。 对初步概念数据模型进行拓展，定义多个模型分图。 解决分图模型中的实体冲突、数据冗余、数据共享等问题、 确保概念数据模型的规范性、一致性和完整性，进行数据模型检查与处理。 将系统概念数据模型转换为支持关系数据库的系统逻辑数据模型。 对系统逻辑数据模型进行规范化完善设计。 将系统逻辑数据模型转换为支持Postgresql数据库系统的系统物理数据模型。 对系统物理数据模型进行完善，增加支持系统业务功能的存储过程、触发器、试图、索引等对象设计。 对系统物理数据模型进行检验与完善。 利用建模工具完成本系统数据库设计报告的生成。 实验二： 完成对数据库BookSale的创建数据库表、索引、视图等对象操作，进行数据的增改删查操作，进行试图的查询修改操作。 实验三： 编写存储过程Pro_CurrentSale,实现当日图书销售量及销售金额汇总统计。 编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 编写 图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 编写游标程序cur_PressBookList，实现各个出版社图书列表的显示输出处理。 实验四： 在数据库中创建客户（R_Customer）、商家（R_Seller）角色 在数据库中，根据业务规则为客户、商家角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller 分别为客户用户U_Customer、商家用户U_Seller分配角色 分别以客户用户、商家用户身份访问图书销售管理数据库，检验数据存取权限模型机制的正确性。 六、实验器材（设备、元器件）： Win10操作系统，Postgresql 11，pgAdmin4，Powerdesigner 七、实验步骤： 实验一： 设计系统概念数据模型 设计系统逻辑数据模型 设计系统物理数据模型 检查概念模型正确性 生成数据库 实验二： 创建数据库 将数据录入数据库 创建并使用视图 实验三： 编写存储过程Pro_CurrentSale,实现当日图书销售量及销售金额汇总统计。 编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 编写 图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 编写游标程序cur_PressBookList，实现各个出版社图书列表的显示输出处理。 实验四： 在数据库中创建客户（R_Customer）、商家（R_Seller）角色 在数据库中，根据业务规则为客户、商家角色赋予数据库对象权限。 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller 分别为客户用户U_Customer、商家用户U_Seller分配角色 分别以客户用户、商家用户身份访问图书销售管理数据库，检验数据存取权限模型机制的正确性。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 实验一： 需求分析：销售系统有购买者与图书两个实体，图书可以使用图书目录寻找，共三个实体，他们的属性分别有姓名、编号、作者等，具体属性见下图数据模型。 设计系统概念数据模型如图  设计系统逻辑数据模型 使用Tools->Generate Logic Data Model命令生成系统逻辑数据模型，经过完善如图  设计系统物理数据模型 使用工具栏中的自动生成物理数据模型功能，自动转化出数据模型如图：  检查概念模型正确性 使用工具栏中的check model工具实现工具审查  修改完善到无错误。  使用powerdesigner生成数据库SQL脚本：  生成结果如图：   实验二： 创建数据库 依照实验一中生成的SQL脚本生成数据库：  创建表格：   插入数据：  查询表结果：     创建并使用视图 我们创建一个查看订单编号、购买者姓名、图书名称的视图，SQL代码如下图： Create view 单人购买记录 as Select 订单.订单编号,购买者.姓名,图书.书名 From 订单 join 购买者 on 订单.身份证号=购买者.身份证号 Join 图书 on 订单.图书编号=图书.图书编号； 查看执行结果： Select * from 单人购买记录;  实验三： 编写存储过程Pro_CurrentSale,实现当日图书销售量和销售金额的统计。  运行结果： 首先我们查看订单记录内容：  然后查看函数返回内容：  编写 图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。  编写游标程序cur_PressBookList，实现各个出版社图书列表的显示输出处理。 Query： Open cur_PressBookList for excute ‘select * from 图书 group by 出版社’ 实验四： 在数据库中创建客户（R_Customer）、商家（R_Seller）角色   在数据库中，根据业务规则为客户、商家角色赋予数据库对象权限。  在数据库中，分别创建客户用户U_Customer、商家用户U_Seller   分别为客户用户U_Customer、商家用户U_Seller分配角色   分别以客户用户、商家用户身份访问图书销售管理数据库，检验数据存取权限模型机制的正确性。  可以发现，权限赋予正常。用户能访问图书表而不能访问订单表，如设定。 九、总结及心得体会： 通过四个实验，对数据库有了更整体系统的认识。 在实验一中，熟悉了powerdesigner工具的使用，对于数据库设计中的系统概要数据模型设计，系统逻辑数据模型设计，系统物理数据模型设计三种设计之间的相似点与区别有了更深的了解，将其转换成SQL语言脚本，有了对数据模型转换成数据库表项更深入的理解。 在实验二中，熟悉了pgAdmin的使用，使用GUI图形界面与query相结合的方式将表建立，插入数据，建立视图并进行检验。 在实验三中，熟悉了PL/pgSQL的语法，对于存储过程、游标、触发器的创建以及应用以及他们的意义有了更深的认识：存储过程用于快速进行数据库访问，触发器用于保证数据的一致性，游标用于快捷存储集合类型的查询结果。 在实验四中，对于角色和用户的相同点和不同点有了更深的认识，可以看到，创造他们的语法是相似的，区别在于USER和ROLE两个字段的不同，在赋予权限等语法上，两者语法类似。 十、对本实验过程及方法、手段的改进建议：                                                      报告评分：                                          指导教师签字：",
  "studentID": "2017221303022"
 },
 "90": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼304\t\t\t\t\t   实验时间：2019.6.3      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理  在一个PostgreSQL数据库中，可以创建多种数据库对象。 创建数据库 在数据库系统中，最大的数据库对象就是数据库本身。SQL提供了数据库对象的创建与维护语句，包括数据库创建、数据库属性修改、数据库删除等。以下分别对这些语句进行说明。 数据库创建SQL语句基本语句格式为 CREATE DATABASE <数据库名>; 创建表   表(Table)是一种用户组织存储数据的数据库对象。在PostgreSQL 数据库中，表首先属于某个schema,而schema又属于某个数据库，其他数据库对象与表对象一样，从而构成了PostgreSQL 数据库的3层逻辑结构。在PostgreSQL数据库中，表对象可以有3种类型:关系表、继承表、外部表。从中可以看出PostgreSQL 数据库作为对象关系数据库与关系数据库不同之处。 创建视图 视图(View)是-种基于虚拟表操作数据的数据库对象。与大多数关系数据库-样,PostgreSQL数据库使用视图用于简化查询逻辑，当然也可使用视图更新基本表中的数据。此外，PostgreSQL数据库还支持物化视图，可通过缓存来实现快速的数据库查询处理。 创建索引 索引是一种针对表 中指定列的值进行排序的数据结构，使用它可以加快表中数据的查询。索引对象创建SQL语句基本语句格式为 CREATE INDEX <索引名> ON <表名>< (列名....1)>; 其中，CREATE INDEX 为创建索引语句的关键词: <索引名>为在指定表中针对某列创建索引的名称。该语句执行后，系统在表中为指定列创建其列值的索引，使索引可实现数据表的快速查询。 数据增、删、查、改SQL操作 INSERT、UPDATE、DELETE 3种语句为核心，分别完成数据的插人、更新与删除处理。 所有数据查询操作都可以通过SELECT语句实现，其基本语句格式为 SELECT [ALL|DISTINCT] <目标列>[,<目标列>…] [INTO <新表> ] FROM <表名>[,<表名>…] [ WHERE <条件表达式> ] [ GROUP BY  <列名> [HAVING <条件表达式>] [ ORDER BY <列名> [ ASG | DESG ] 存储过程及其调用 存储过程是一种数据库的对象，由一组能完成特定功能的 SQL语句集构成。它把经常会被重复使用的SQL语句逻辑块封装起来，经编译后，存储在数据库服务器端。当被再次调用时，不需要再次编通;当客户端连接到数据库时，用户通过指定存储过程的名称并给出参数。数据库就可以找到相应的存储过程并子以调用。 许多数据库为创建存储过程和函数提供不同命令，如Oracle、MySQL、SQL Server等数据库管理系统，使用CREATE PRECEDURE命令创建存储过程，使用CREATE FUNCTION命令创建函数。PostgreSQL 数据库没有为创建存储过程提供专用命令，而是通过创建数据库函数来实现存储过程的功能， 触发器及其应用  触发器( Trigger)是一-种事件触发自动执行数据库访问操作功能程序的数据库对象。PostgreSQL数据库与其他关系数据库一样， 均支持多种类型触发器，如插人触发器、修改触发器、删除触发器，同时还可设置触发级别(语句级、行级)，以及触发时机(修改前触发、修改后触发)。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 创建数据库，名为booksale  2.创建表  3.创建今日销售（today_sale_view）视图  4.创建图书编号索引成功  5.数据操作 5.1.添加数据到表中    5.2删除数据  5.3修改数据  5.4.查找数据  6.编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  7.实现对存储过程Pro_CurrentSale的调用，并输出统计结果  8.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 8.1编写存储过程，由于修改仓库对应数量  8.2.编写insert行级触发器，作用于sale表  9.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证  九、总结及心得体会 通过本次实验实现了数据库的基本操作，对表的创建，添加删除以及修改数据。以及基本的视图创建和函数编写。 \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼304  \t\t\t\t\t 实验时间：2019.6.14      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理 在数据库存取控制安全模型中，每个数据库对象被定义若干操作访问权限。每个用户可以对应多个角色，每个角色也可对应多个用户。用户、角色均可以被赋予若干数据库对象的操作访问权限。一旦用户通过系统身份认证，DBMS就限制该用户在权限许可的范围内针对特定数据库对象进行访问操作。 用户要 访问数据库。必须先在DBMS中创建用户账号，并成为数据库的用户。此后，用户每次连接访份鉴别，只有合法用户才能进入在PostgreSQL数据库系统中，用户访向访问操作数据库对象。 SQL命令创建 标准SQL提供了专门创建用户的SQL操作命令语句。在数据库中，只能通过特定权限的用户创建其他用户，如系统管理员用户或超级用户可以执行创建用户的SQL操作命令语句，创建其他用户。 创建用户的SQL语句基本格式为CREATE USER <用户账号名> [ [with] option […] ]； 其中，CREATE USER为创建用户语可的关键词: <用户账号名>为将被创建的用户名称，opion为用户的属性选项在PstgrSQL数据库用户创建中，允许有如 option 属性选项。 权限管理 数据库权限管理指DBA或数据库对象拥有者对其所拥有对象进行权限控制设置。权限管理的基本操作包括授予权限、收回权限和拒绝权限。在DBMS中，我们可以通过执行权限控制SQL语句或通过运行数据库管理工具实现用户权限的管理。 执行SQL控制语句进行权限管理 在SQL中，用于权限管理的控制语句有GRANT授权语句、REVOKE收回权限语句和DENY拒绝权限语句。 角色管理 在DBMS中，为了方便对众多用户及其权限进行管理，系统通常将组具有相同权限的用户定义为角色( Role )。不同的角色就代表不同权限集合的用户集合。 进行角色管理的好处是系统管理员只需对具有不同权限的用户类别进行划分，并将其定义为不同角色，不同角色授予不同的权限，而不必关心具体有多少用户。当角色中的成员发生变化时，如新增用户或删除用户，系统管理员都无须做任何关于权限的操作。 在DBMS中，角色分为预定义的系统角色和用户定义角色两种。 在DBMS中，角色管理是对用户自定义角色进行操作管理，包括角色创建、角色修改、角色删除。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型 数据库有客户、商家两类角色，分别为其赋予对数据库对象的不同权限 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 实验数据及结果分析 对图书销售管理系统数据库，使用powerdesigner设计数据存取权限控制模型。   创建客户（R_Customer）、商家（R_Seller）角色  为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限  创建客户用户U_Customer、商家用户U_Seller且为其分派客户（R_Customer）、商家（R_Seller）角色  分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性  九、总结及心得体会 通过本次实验了解了数据库中用户的创建以及相关权限的分配，实现了数据库的安全机制。创建用户时权限的分配至关重要，若分配不当会造成严重后果。",
  "studentID": "2017221303023"
 },
 "91": {
  "content": "电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221304023     姓    名           倪雅琼      （实验）\t课程名称     数据库原理及应用  理论教师          文军         实验教师          何中海           电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：倪雅琼\t\t学号：2017221304023         指导教师：何中海  实验地点：信软楼西303     实验时间：2019.6.14 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：4 三、实验目的： 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数 据库操作访问中的应用方法， 培养数据库SQL编程访问能力。 同时也掌握基本的 数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成 图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理： 1.首先对图书销售管理系统进行数据需求分析， 定义组成系统数据结构的实 体、 实体属性以及实体之间的关系。 通过建模设计工具完成系统概念数据模型设 计。进一步对图书销售管理数据库进行物理模型设计，给出数据库设计方案。 2.基于数据库设计方案， 通过SQL编程执行来完成对数据库的实现操作。 在 本实验中，使用SQL语句完成对数据库、关系表、索引、视图、触发器、存储过 程的创建， 并编写SQL语句对数据库表进行数据的增删查改操作， 以及利用视图、 存储过程、触发器实现业务数据处理。  五、实验内容： 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操 作，并完成触发器、存储过程后端编程，具体实验内容如下: 1.在数据库服务器中，执行SQL创建图书销售管理系统数据库BookSale。 2.在数据库BookSale中，执行SQL创建数据库表、视图、索引等对象。 3.在数据库BookSale中，执行SQL进行数据增、删、查、改访问操作。 4.在数据库BookSale中，采用PL/pgSQL语言编写存储过程函数 Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 5.在数据库BookSale中， 采用PL/pgSQL语言编写过程语句块， 实现对存储 过程函数Pro_CurrentSale的调用，并输出统计结果。 6.在数据库BookSale中，采用PL/pgSQL语言编写编写图书销售表Insert触 发器 Tri_InsertSale，实现图书库存数据同步修改处理。\n 7.在数据库 BookSale 中，对图书销售表 Insert 触发器 Tri_InsertSale 程序进行\n 功能验证。\n 8.在数据库 BookSale 中，创建存储过程函数实现图书销售数量和金额统计。\n 在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL、PL/pgSQL 语言，\n 完成图书销售管理系统数据库应用编程操作，同时记录实验过程的步骤、操作、\n 运行结果界面等数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以\n 及网络环境，pc 计算机与服务器在同一局域网络。\n 操作系统： Windows7 / Windows XP\n 管理工具： pgAdmin4\n DBMS 系统： PostgreSQL 11\n 七、实验步骤： 1. 在数据库服务器中，采用 SQL 语句执行方式，创建图书销售管理系统数\n 据库 BookSale。\n 2.在 BookSale 数据库中，采用 SQL 语句执行方式，创建 book（图书表）、auther\n （作者表）、publisher（出版社表）、stock（库存流水表）、customer（客户表）、\n sale（销售表），以及各表主键外键的创建，并为给表创建索引。\n 3.为 book、auther、publisher、customer 表准备样本数据，采用 SQL 语句执\n 行方式，将样本数据插入到表中。采用 SQL 语句对 book、auther、publisher、\n customer 表进行数据修改、删除、查询、统计等访问操作。\n 4.创建视图 BOOK_AUTHER_PUBLISHER，该视图查询数据库，输出图书名、\n 作者、出版社以及图书价格等数据。对视图 Book_View 进行数据查询访问操作。\n 5.编写触发器函数，实现在 sale 表数据插入时，级联操作 stock 表，将图书\n 的库存流水进行记录，同时级联更新 book 表中对应图书的库存数据。\n 6.创建完触发器函数之后，创建相对应的触发器，实现上一步中提到的功能。\n 7.测试触发器的功能，准备 sale 表的样本数据，并将其插入 sale 表，插入之\n 后查看 stock 表是否有对应的更新，并对比插入 sale 数据前后 book 中对应数据\n 的修改情况。\n 8.编写存储过程函数，实现统计某日图书的销售总量以及总金额数据。\n 9.调用存储过程函数，查看输出结果是否准确实现业务数据处理功能。  八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建BookSale数据库 语句为：CREATE DATABASE BookSale;  成功创建数据库  2.创建各种数据库表，主外键约束和索引 SQL语句： CREATE TABLE AUTHOR(   AU_ID  char(18)  NOT NULL,   AU_Name  varchar(20)  NOT NULL,   AU_Gender  char(2)  NOT NULL,   AU_Phone  char(20)  NOT NULL,   AU_Address  varchar(11)  NOT NULL,   CONSTRAINT PK_AUTHOR PRIMARY KEY(AU_ID) );  CREATE TABLE PUBLISHER(   PUB_ID  char(11)  NOT NULL,   PUB_Name  varchar(20)  NOT NULL,   PUB_phone varchar(15)  NOT NULL,   PUB_Address varchar(50) NOT NULL,   CONSTRAINT PK_PUBLISHER PRIMARY KEY(PUB_ID) );  CREATE TABLE BOOK(   BOOK_ISBN  char(13)  NOT NULL,   AU_ID  char(18)  NULL,   PUB_ID  char(11)  NULL,   BOOK_Name  varchar(50)  NOT NULL,   BOOK_Pubdate  date  NOT NULL,   BOOK_Price money NOT NULL,   BOOK_Category  varchar(20)  NOT NULL,   BOOK_Stock  int4 NOT NULL,   CONSTRAINT PK_BOOK PRIMARY KEY(BOOK_ISBN),   CONSTRAINT FK_BOOK_AUTHOR FOREIGN KEY(AU_ID)   REFERENCES AUTHOR(AU_ID)   ON DELETE RESTRICT   ON UPDATE RESTRICT,   CONSTRAINT FK_BOOK_PUBLISHER FOREIGN KEY(PUB_ID)   REFERENCES PUBLISHER(PUB_ID)   ON DELETE RESTRICT   ON UPDATE RESTRICT );  CREATE TABLE CUSTOMER(   CUS_ID  char(18)  NOT NULL,   CUS_Name  varchar(20)  NOT NULL,   CUS_Phone  varchar(15)  NOT NULL,   CUS_Address  varchar(50)  NOT NULL,   CONSTRAINT PK_CUSTOMER PRIMARY KEY(CUS_ID) );  CREATE TABLE SALE(   SALE_ID  varchar(11)  NOT NULL,   BOOK_ISBN  char(13)  NULL,   CUS_ID  char(18)  NULL,   SALE_Date  date  NOT NULL,   SALE_Amount  money  NOT NULL,   SALE_QTY  INT4  NOT NULL,   CONSTRAINT FK_SALE_BOOK FOREIGN KEY(BOOK_ISBN)   REFERENCES BOOK(BOOK_ISBN)   ON DELETE RESTRICT   ON UPDATE  RESTRICT,   CONSTRAINT FK_SALE_CUSTOMER FOREIGN KEY(CUS_ID)   REFERENCES CUSTOMER(CUS_ID)   ON  DELETE RESTRICT   ON UPDATE RESTRICT );  CREATE TABLE STOCK(   STOCK_ID  varchar(10)  NOT NULL,   BOOK_ISBN  char(13)  NULL,   STOCK_Change  int4  NOT NULL,   STOCK_Operation  char(4)  NOT NULL,   STOCK_Datetime  date  NOT NULL,   CONSTRAINT PK_STOCK PRIMARY KEY(STOCK_ID),   CONSTRAINT FK_STOCK_BOOK FOREIGN KEY(BOOK_ISBN)   REFERENCES BOOK(BOOK_ISBN)   ON DELETE RESTRICT   ON UPDATE RESTRICT ); 结果及表界面：   创建表成功 3.向表中插入数据 SQL语句： INSERT INTO AUTHOR VALUES('0001','八月','女','12','哈尔滨'); INSERT INTO AUTHOR VALUES('0002','VI','女','23','瑞士'); INSERT INTO AUTHOR VALUES('0003','鲁迅','男','34','绍兴');  INSERT INTO PUBLISHER VALUES('P001','电子出版社','0987','成都'); INSERT INTO PUBLISHER VALUES('P002','人民出版社','9867','上海'); INSERT INTO PUBLISHER VALUES('P003','北师大出版社','4567','北京');  INSERT INTO BOOK VALUES('ISBN1','0001','P001','最好的我们','2015-07-16','30','青春文学','20'); INSERT INTO BOOK VALUES('ISBN2','0002','P002','寻找前世之旅','2016-09-26','40','奇幻穿越','30'); INSERT INTO BOOK VALUES('ISBN3','0003','P003','朝花夕拾','1925-01-29','20','怀旧散文','40');  INSERT INTO CUSTOMER VALUES('C001','耿耿','8764','青岛'); INSERT INTO CUSTOMER VALUES('C002','余淮','5639','青岛'); INSERT INTO CUSTOMER VALUES('C003','叶隐','3429','南京');  向表中插入数据成功！ 4.对AUTHOR表进行增删查改操作 原AUTHOR表内容：  插入新数据  插入数据后新AUTHOR表内容：  从表中删除新插入的数据：  删除后表内容：  更新表中数据：  更新后表内容：   5.创建视图 SQL语句： CREATE VIEW BOOK_AUTHOR_PUBLISHER AS SELECT A.AU_Name AS 作者,B.BOOK_Name AS 图书名,B.BOOK_Price AS 图书价格,P.PUB_Name AS 出版社 FROM AUTHOR AS A,BOOK AS B,PUBLISHER AS P WHERE P.PUB_ID=B.PUB_ID AND A.AU_ID=B.AU_ID;  采用视图查询：  视图创建成功！  6.创建触发器函数 SQL： CREATE OR REPLACE FUNCTION Tri()   RETURNS TRIGGER AS $Tri$   BEGIN     IF(TG_OP='INSERT') THEN \tINSERT INTO STOCK VALUES(NEW.SALE_ID,NEW.BOOK_ISBN,new.SALE_QTY,'出库',new.SALE_DATE); \tUPDATE BOOK SET BOOK.BOOK_STOCK=BOOK.BOOK_STOCK-NEW.SALE_QTY \tWHERE BOOK.BOOK_ISBN=NEW.BOOK_ISBN; \tRETURN NEW; \tEND IF; \tRETURN NULL; \tEND; $Tri$ LANGUAGE plpgsql;  触发器函数创建成功！ 7.创建触发器 SQL: CREATE TRIGGER Tri_InsertSale AFTER INSERT ON SALE FOR EACH ROW EXECUTE PROCEDURE Tri();  触发器创建成功！  8.测试触发器 向SALE表中插入数据 SQL： INSERT INTO SALE VALUES('S001','ISBN1','C001','2019-06-18','600','20'); INSERT INTO SALE VALUES('S002','ISBN2','C002','2019-06-18','1200','30'); INSERT INTO SALE VALUES('S003','ISBN3','C003','2019-06-18','2000','40');  查看STOCK表的数据：  根据STOCK表的数据可以看出触发器功能正确！ 9.创建存储过程 SQL： CREATE OR REPLACE FUNCTION Pro_CurrentSale(OUT saleAmount int4,OUT salePrice money)   RETURNS record AS $$      BEGIN      SELECT SUM(SALE_QTY) INTO saleAmount \t FROM SALE \t WHERE SALE_DATE='2019-06-18'; \t SELECT SUM(SALE_AMOUNT) INTO salePrice \t FROM SALE \t WHERE SALE_DATE='2019-06-18'; \t RETURN;   END;   $$ LANGUAGE plpgsql;  10.调用存储过程 SQL: SELECT * FROM Pro_CurrentSale();  存储过程功能正确！ 九、总结及心得体会： 通过本次实验，我对postgre数据库中表的创建、数据增删改查以及触发器、存储过程的创建及用法有了更加深刻的理解。向表中插入数据的过程中要注意各个表的外键约束，否则很容易出现错误。 十、对本实验过程及方法、手段的改进建议： 实验效果显著，收获颇丰，无需改进。                                                      报告评分：                                          指导教师签字： 电子科技大学信息与软件工程学院    实 验 报 告    学    号     2017221304023     姓    名           倪雅琼      （实验）\t课程名称     数据库原理及应用  理论教师          文军         实验教师          何中海           电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：倪雅琼\t\t学号：2017221304023         指导教师：何中海  实验地点：信软楼西303     实验时间：2019.6.21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：4 三、实验目的： 了解 DBMS 系统对数据库管理的内容与方法，特别是理解数据库安全机制和\n 作用，以及 PostgreSQL 数据库角色管理、用户管理、权限管理的基本方法，培\n 养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并\n 完成上述角色与用户的权限管理。 四、实验原理： 1.设计数据存取权限控制模型，对各角色进行不同权限的赋予，保证数据库\n 数据的安全性。\n 2.使用 SQL 语句进行角色、用户的创建、对角色进行权限赋予、对用户分派\n 角色。\n 3.使用不同的用户登录时，就拥有了该用户的权限，在对数据库表进行操作\n 的时候就会受到不同程度的制约。 五、实验内容\n 使用 pgAdmin4 数据库管理工具对图书销售管理系统数据库进行数据库安全\n 管理 五、实验内容： 1.针对图书销售管理系统数据库，设计数据存取权限控制模型。\n 2.在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。\n 3.在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色\n 赋予数据库对象权限。 4.在数据库中，分别创建客户用户 U_Customer、商家用户 U_Seller。\n 5.分别为客户用户 U_Customer、商家用户 U_Seller 分派客户（R_Client）、\n 商家（R_Seller）角色。\n 6.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理\n 数据库，验证所实现数据存取权限控制模型的正确性。\n 在实验计算机上，利用 pgAdmin4 数据库管理工具及 SQL 语句，完成图书销\n 售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等\n 数据，为撰写实验报告提供素材。 六、实验器材（设备、元器件）： “数据库原理及应用”实验所涉及的机房硬件设备为 pc 计算机、服务器以\n 及网络环境，pc 计算机与服务器在同一局域网络。\n 操作系统： Windows7 / Windows XP\n 管理工具： pgAdmin4\n DBMS 系统： PostgreSQL 11\n 七、实验步骤： 1.针对图书销售管理系统，在设计数据存取权限控制模型。\n 2. 在 pgAdmin4 中 的 BookSale 数 据 库 中 ， 使 用 SQL 语 句 创 建 客 户\n （R_Customer）角色、商家（R_Seller）角色。\n 3.在 pgAdmin4 中，根据第一步设计的数据存取权限控制模型对客户\n （R_Customer）角色、商家（R_Seller）角色赋予所定义的数据库对象权限。\n 4.在 pgAdmin4 中，分别创建客户用户 U_Customer、商家用户 U_Seller，并\n 为客户用户分配客户角色，为商家用户分配商家角色。\n 5.分别以客户用户 U_Customer、商家用户 U_Seller 身份访问图书销售管理\n 数据库，并分别以这两个用户对各数据库表进行操作，以验证是否正确分配了两\n 用户不同的角色权限。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建数据存取权限控制模型如下：  2.创建客户角色和商家角色 SQL: CREATE ROLE \"R_Customer\" WITH   LOGIN   NOSUPERUSER   NOCREATEDB   NOCREATEROLE   INHERIT   NOREPLICATION   CONNECTION LIMIT -1;   CREATE ROLE \"R_Seller\" WITH   LOGIN   NOSUPERUSER   NOCREATEDB   NOCREATEROLE   INHERIT   NOREPLICATION   CONNECTION LIMIT -1;  角色创建成功！ 3.赋予角色权限 SQL: GRANT SELECT,INSERT,UPDATE,DELETE ON SALE TO \"R_Seller\"; GRANT SELECT ON AUTHOR TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON CUSTOMER TO \"R_Seller\"; GRANT SELECT ON PUBLISHER TO \"R_Seller\"; GRANT SELECT ON SALE TO \"R_Seller\"; GRANT SELECT,INSERT,UPDATE,DELETE ON STOCK TO \"R_Seller\";  GRANT SELECT ON AUTHOR TO \"R_Customer\"; GRANT SELECT ON BOOK TO \"R_Customer\"; GRANT SELECT ON CUSTOMER TO \"R_Customer\"; GRANT SELECT ON PUBLISHER TO \"R_Customer\"; GRANT SELECT ON SALE TO \"R_Customer\"; GRANT SELECT ON STOCK TO \"R_Customer\";  4.创建用户，并将赋予角色权限 SQL: CREATE USER \"U_Customer\"   LOGIN   INHERIT   IN ROLE \"R_Customer\";    CREATE USER \"U_Seller\"   LOGIN   INHERIT   IN ROLE \"R_Seller\";  5.验证权限 登录客户用户:  测试一：查看 book 表 SQL 语句：select * from book  客户用户可查看 book 表，权限正确。  测试二：删除 book 表中的数据 SQL 语句：delete from book where book_name = '最好的我们';  删除失败，客户用户不具有删除 book 表中数据的权限，权限正 确。\n 测试三：查看 author 表 SQL 语句：select * from author 运行界面和结果展示如图:  结果分析：客户用户可查看 author 表，权限正确。  测试四：插入一条数据到 author 表中 SQL 语句：insert into author values('0005','哈哈','男','90','南京'); 客户用户插入一条新数据到 author 表  结果分析：客户用户无法在 author 表中插入数据，权限正确。  测试五：查看 sale 表 SQL 语句：select * from sale  结果分析：客户用户无查看销售表的权限，权限正确。五个测试均验证通过， 测试客户用户的权限正确。  登录商家用户  测试一：查看 customer SQL 语句：select * from customer  结果分析：商家用户具有查看客户表的权限，权限正确。  测试二：插入一条数据到 author 中 SQL 语句：insert into author values('0005','哈哈','男','90','南京');  商家用户查询插入一条新数据后的 author 表   结果分析：author 表中新增了如上插入的数据，商家用户具有插入 author 表 数据的权限，权限正确。  测试三：从 stock 表中删除一条数据 SQL 语句：delete from stock where stock_id = 'S001'    结果分析：商家用户不具有删除 stock 表数据的权限，权限正确。  测试四：更新 sale 表的一条数据 SQL 语句：UPDATE sale SET sale_date = '2019-05-21' WHERE sale_id = 'S001'   商家用户查看 sale 表数据  结果分析：sale 表中对应的数据被修改正确，商家用户具有修改 sale 数据的 权限，权限正确。  通过四个测试，每个测试结果都正确，说明商家用户权限赋予 正确。  删除失败，客户用户不具有删除 book 表中数据的权限，权限正 确。  九、总结及心得体会： 通过本次实验，我更加深入的理解了数据库角色创建和赋权，以及如何为用户赋予角色。在一定程度上保证了数据库安全。 十、对本实验过程及方法、手段的改进建议： 实验效果显著，收获颇丰，无需改进。 报告评分： 指导教师签字： ",
  "studentID": "2017221304023"
 },
 "92": {
  "content": "电子科技大学信息与软件工程学院    实验报告    学号 2017221304028 姓名 杨文 （实验）\t课程名称 数据库 理论教师 文军 实验教师 李中华     电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：杨文\t\t学号：2017221304028   指导教师：文军  实验地点：信软楼303     实验时间：2019.6.14 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：5学时 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。  四、实验原理： （1）数据库对象（方案、表、索引、视图等）DDL编程应用解决数据库实现及性能优化； （2）数据库数据增、删、查、改DML编程应用解决数据操作访问； （3）数据库触发器、数据库函数编程应用解决业务规则及后端功能实现。  五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。  六、实验器材（设备、元器件）： 实验PC计算机  实验步骤： （1）图书销售管理系统数据库BookSale创建操作   （2）在图书销售管理系统数据库BookSale中创建数据库表                         （3）在图书销售管理系统数据库BookSale中创建数据库视图   （4）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引   在数据库BookSale中插入数据                （6）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作           （7）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。   （8）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。   （9）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。   对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。    八、总结及心得体会： 通过本次实验，提高了数据库SQL应用编程能力和数据库后端编程能力，学会了基本的数据库触发器、存储过程编程方法。同时，将书本中的知识应用于实际实验中，对未来更深一步的学习奠定了基础。                                                      报告评分：                                       指导教师签字： 电 子 科 技 大 学 实   验   报   告 学生姓名：杨文\t\t学号：2017221304028   指导教师：文军  实验地点：信软楼303     实验时间：2019.6.21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3学时 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  实验原理： （1）数据库对象（方案、表、索引、视图等）DDL编程应用解决数据库实现及性能优化； （2）数据库数据增、删、查、改DML编程应用解决数据操作访问； （3）数据库触发器、数据库函数编程应用解决业务规则及后端功能实现。 实验二：图书销售管理系统数据库安全管理    （综合型实验） 图书销售管理系统数据库安全管理涉及相关知识点： （1）数据库角色、用户及权限管理； （2）图书销售管理系统数据库管理实现。  实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。  实验器材（设备、元器件）： 实验PC计算机  实验步骤： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。   （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。  （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。   （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller； 分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。   （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，     八、总结及心得体会： 通过这次实验，了解了DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，提高了对数据库的管理能力，受益匪浅。                                                       报告评分：                                       指导教师签字： ",
  "studentID": "2017221304028"
 },
 "93": {
  "content": "\n电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼304          实验时间：2019.06.14      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理 在pgadmin4工具编写SQL语句 数据库基本操作数据 Create database dbname 创建数据库 Create table tbname 创建数据表 Insert into tbname values(v1,v2,v3,….) 插入数据 Delete from tbname where v1 = ‘条件’ 删除目标记录 Update tbname set v2 = ‘xx’,v3=’xx’where v1= ‘条件’实现表数据更新 Alter table <tbname> add <新列名称><数据类型>[完整性约束]      视图视图是一种从基础数据库表中获取数据所组成的虚拟表，在数据库中只需储 视图结构定义，而不存储视图所包含的数据，使用视图可以简化复杂的SQL查询，提高数据访问安全性，提供一定的数据逻辑独立性，可以集中展示用户所感兴趣的特定数据。  2.1视图创建      Create view viewname as      Select xx,xx,xx      From tb1,tb2,tb3…      Where 条件连接            2.2视图查看      Select * from viewname;            3. 存储过程是由一组能完成特定功能的SQL语句构成，它把经常会反复使用的SQL语句逻辑块封装起来，经编译后，存储在数据库服务端，当再次调用时，不需再次编译，用户连接到数据库服务端时，用户通过指定存储过程的名称并给出参数，数据库就可以找到相应的存储过程并予以调用。  3.1存储过程的创建 Create [or replace] function ([[argmode][argname]argtype[{default|=} [returns retype | returns table(column_name column_type[,…])] As $$ Declare    --声明段 Begin    --函数体语句 End； $$ language lang_name;  3.2存储过程的调用 Select function_name;      4触发器与存储过程不同，存储过程通过其他程序启动运行或直接启动运行，而触发器由一个事件触发启动运行，也就是触发器在某个事件发生时自动隐式运行。Postgresql 触发器在系统执行某种特定类型的操作时，数据库将自动执行指定的特殊函数。触发器常用于定义逻辑计较复杂的完整性约束，或某种业务规则的约束  4.1 触发器的创建    Create [constraint] Trigger name {before | after |instead of}{event[or]} On table_name [from referenced_table_name] [for[each]{row|statement}]      [when (condition)]      Execute procedure function_name(arguments)       五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤   1. 创建数据库BookSale   2. 根据业务逻辑，参考书上例题图书销售系统创建数据库表    Author（作者信息表）    Publisher（出版社信息表）    Bookinfo（图书信息表）    Booksell（销售表）    Bookstore（图书库存表）    Bookclass（图书类别表）  3.用SQL语句insert，delete,select,alter,实现对数据库表的增、删、查、改    4. 创建存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。      用select function_name()实现调用存储过程。      5. 编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理      6.向bookstore表中插入数据检验触发器的正确性。 八、实验数据及结果分析  1.create database BookSale; 结果：图1-1  2. 1 创建数据库表 create table author( authorid char(12) primary key, authorname varchar(30) not null, address varchar(30), authortel char(11) ); create table publisher( pubid char(12) primary key, pubname varchar(40) not null, pubtel varchar(20) not null, pubaddress varchar(60)      create table bookclass( classid char(5) primary key, classname varchar(20) not null ); create table bookinfo( bookid char(22) primary key, pubid char(12) not null, classid char(5) not null, bookname varchar(80) not null, pubdate date not null, price money not null, brefinfo varchar(2000), authorid char(12) not null, constraint pubid_fk foreign key(pubid) references publisher(pubid) on delete cascade, constraint classid_fk foreign key(classid) references bookclass(classid) on delete cascade, constraint authorid_fk foreign key(authorid) references author(authorid) on delete cascade ); create table bookstore( bookid char(22) primary key, storenum int not null, constraint bookid_fk foreign key(bookid) references  bookinfo(bookid) on delete cascade ); create table booksell( serialnum serial primary key, bookid char(22) not null, selldate date not null, sellnum int not null, amount money not null, constraint bookid_fk foreign key(bookid) references bookinfo(bookid) on delete cascade )  结果：  2.2 创建视图、索引 索引创建于数据量较大，并且查询次数较高的表中，因此选择bookinfo表和author 表 create view bookinfoview as  select bf.bookname as 书名, a.authorname as 作者名, bf.price as 价格, bc.classname as 类别, p.pubname as 出版社名称, bf.pubdate as 出版日期, bs.storenum as 库存量,bf.brefinfo as 简介 from bookinfo as bf, author as a, publisher as p, bookstore as bs, bookclass as bc where bf.authorid = a.authorid and bf.pubid = p.pubid and bf.bookid = bs.bookid and bf.classid = bc.classid;  create index bookid_idx on bookinfo(booid); create index authorid_idx on author(authorid); 结果：  增、删、查、改SQL操作 insert into author values('000000000001','李四','中国四川省成都市','12345678912'); insert into author values('000000000002','张三','中国四川省绵阳市','12345678923'); insert into author values('000000000003','王二麻子','中国四川省宜宾市','12345678934'); insert into publisher values('000000000001','电子工业出版社','66666666','中国河北省A市'); insert into publisher values('000000000002','石油工业出版社','88888888','中国东北省A市'); insert into publisher values('000000000003','清华大学出版社','11111111','中国四川省成都市'); insert into bookclass values('00001','自然'); insert into bookclass values('00002','科学'); insert into bookclass values('00003','人文'); insert into bookclass values('00004','古诗词'); insert into bookclass values('00005','散文');      insert into bookinfo values('1','000000000001','00001','张三的生物进化论','2017-05-01',30,'暂无','000000000002'); insert into bookinfo values('2','000000000002','00005','李四的精选散文集','2017-03-02',50,'值得拥有','000000000002'); insert into bookinfo values('3','000000000003','00004','洞主的优美诗集','2018-01-02',100,'现代诗集','000000000003'); insert into bookinfo values('4','000000000002','00002','老王的6级应试技巧','2019-05-06',388,'来自超级大佬的指导','000000000002'); insert into bookinfo values('5','000000000001','00001','生物进化论','2017-08-01',30,'暂无','000000000002'); insert into bookinfo values('6','000000000002','00002','张三的自然与科学','2017-05-01',100,'暂无','000000000002'); insert into bookinfo values('7','000000000003','00004','张三精选','2018-05-01',30,'暂无','000000000002'); insert into bookinfo values('8','000000000001','00001','张三的初级生物教材','2019-05-01',30,'暂无','000000000002'); insert into bookinfo values('9','000000000001','00001','张三的高级生物教材','2017-05-01',99,'暂无','000000000002');  insert into bookstore values('1',100); insert into bookstore values('2',0); insert into bookstore values('3',1000); insert into bookstore values('4',988); insert into booksell (bookid,selldate,sellnum,amount)values('1','2019-05-07',10,300); insert into booksell (bookid,selldate,sellnum,amount)values('1','2019-05-08',7,210); insert into booksell (bookid,selldate,sellnum,amount)values('2','2019-05-07',3,150); insert into booksell (bookid,selldate,sellnum,amount)values('4','2019-04-01',10,3880); insert into booksell (bookid,selldate,sellnum,amount)values('4','2019-04-02',5,1940); insert into booksell (bookid,selldate,sellnum,amount)values('4','2019-05-10',20,7760); insert into booksell (bookid,selldate,sellnum,amount)values('4','2019-06-12',20,7760); insert into booksell (bookid,selldate,sellnum,amount)values('3','2019-06-12',20,2000); insert into booksell (bookid,selldate,sellnum,amount)values('1','2019-05-10',10,300); 结果：  3.1删除bookclass 表中classname 为人文的一项，并查看结果  delete from bookclass where classname = '人文'; select * from bookclass;   4 . 编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 create or replace function Pro_CurrentSale() returns table(booknum int, amount money) as $$ begin  return QUERY select cast(sum(sellnum)as int), cast(sum(booksell.amount)as money)  from booksell  where booksell.selldate = current_date; end; $$ language plpgsql; select pro_currentsale(); 结果：  编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。\ncreate table bookstore_tri_tb( username varchar(20), bookid char(22), updatetime date, oldstorenum int, newstorenum int,   create or replace function Tri_InsertSale() returns trigger as $$ begin insert into bookstore_tri_tb select user,new.bookid,now(),old.storenum,new.storenum; return new; end; $$ language plpgsql;  insert into bookstore values('9',100); insert into bookstore values('6',500); insert into bookstore values('7',980); insert into bookstore values('8',133);  create trigger bookstore_tri after insert on bookstore for each row execute procedure Tri_InsertSale(); 结果：     九、总结及心得体会   \n 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼304  \t\t   实验时间：2019.06.21    三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理 安全性时任何系统都必须解决的关键技术问题，特别是数据库存储了组织机构最重要的信息数据，如财务数据、交易数据、经营数据等，数据库系统的安全至关重要，实施数据库安全管理是十分重要的工作，而对数据库用户创建及权限分配是数据库维护安全的重要的一面。 用户的创建 SQL提供了专门创建用户的SQL命令语句，在数据库中，只能通过特定权限的用户创建其他用户，如系统管理员或超级用户。因此为每个用户分配合适的权限，尤为重要。创建用户的SQL语句基本格式为 Create user <用户账号>[[with] option […]]; Superuser|nosuperuser: 指定创建的用户是否为超级用户 Createdb | nocreatedb 指定创建的用户是否具有创建数据库的权限 Createrole | nocreaterole 指定创建的用户是否具有创建角色的权限 Inherit | noinherit 指定创建的用户是否具有继承角色的权限 Login | nologin 指定创建的用户是否具有登陆权限 Replication | noreplication 指定创建的用户是否具有复制权限 Bypassrls | nobypassrls 指定创建的用户是否具有绕过安全策略的权限 Connection limit 指定创建的用户访问数据连接的数目限制 [encrypted | unencrypted] password ‘xxx’指定创建的用户密码是否需要加密 Valid until ‘timestamp’ 指定创建的用户密码失效时间 In role role_name[,…]指定创建的用户成为那些角色的成员     角色的创建 角色的创建与用户创建过程相似，但没有密码等设置要求。       权限赋予 可以直接将对表的操作权限直接赋予用户，如 Grant select,update,alter,delete on table_name to userxx; 但是这样需要为每个用户单独赋予权限，当用户数量较多时，工作量大，且难以管理。 通过创建角色，赋予角色相应权限，用户采用继承角色的方式获得相应的权限 五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤   1.  根据业务逻辑及实际需求为商家、客户、系统管理员分配在每个数据库表上的操作权限。   2.  利用SQL语句创建客户R_Customer 及商家R_Seller 角色。   3.  利用SQL语句grant 为客户R_Customer、商家R_Seller角色参考数据存取权限模型赋予相应权限。  4.   利用SQL语句创建U_Customer、商家用户U_Seller。  5.   分别登陆客户用户及商家用户，检查权限设置正确性。 八、 实验数据及结果分析 1. 针对图书销售管理系统数据库，设计数据存取权限控制模型 商家角色应该具有对所有表的增、删、改、更新的操作，客户角色对作者信息表、出版社信息表、图书信息表、图书分类表的读取权限，但是对于图书销售表及图书库存量应予以屏蔽，但可以将bookinfoview视图读取权限赋予用户，使其可以查看目标图书的库存量 2. 在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 create role \"R_Customer\" with login nosuperuser nocreatedb nocreaterole inherit noreplication connection limit -1;  create role \"R_Seller\" with login nosuperuser nocreatedb nocreaterole inherit noreplication connection limit -1;   3.   在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据 库对象权限。 grant select on author to \"R_Customer\"; grant select on publisher to \"R_Customer\"; grant select on bookinfo to \"R_Customer\"; grant select on bookclass to \"R_Customer\"; grant select on bookinfoview to \"R_Customer\"; grant select,insert,update,delete on author to \"R_Seller\"; grant select,insert,update,delete on publisher to \"R_Seller\"; grant select,insert,update,delete on bookinfo to \"R_Seller\"; grant select,insert,update,delete on booksell to \"R_Seller\"; grant select,insert,update,delete on bookstore to \"R_Seller\"; grant select,insert,update,delete on bookclass to \"R_Seller\";    4. 在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 create user \"U_Customer\" with login nosuperuser nocreatedb nocreaterole inherit noreplication connection limit -1 in role \"R_Customer\" password 'customer1';    create user \"U_Seller\" with login nosuperuser nocreatedb nocreaterole inherit noreplication connection limit -1 in role \"R_Seller\" password 'seller1';  5.分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性  5.1 客户对数据库表只有读取权限，可以读取信息成功，但施加其他操作便会报错               客户不具有对bookseller表的读取权限        总结及心得体会    熟悉了sql语言、数据库管理和对postgre数据库的使用。 ",
  "studentID": "2017221305014"
 }
}