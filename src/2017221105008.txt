电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221105008      姓    名       王亦达          （实验）	课程名称   数据库原理及应用    理论教师        文军           实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：王亦达		学号：2017221105008   指导教师：文军 实验地点：信软学院楼西303    实验时间：2017-6-14 一、实验名称：图书销售管理系统数据库SQL应用编程 二、实验学时：5学时 三、实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。 四、实验原理： 在关系数据库系统中，所有对数据库的访问操作均可通过DBMS执行SQL语句来实现。例如，通过执行CREATE TABLE、ALTER TABLE、DROP TABLE语句实现数据库表的创建、修改和删除；通过执行INSERT、UPDATE、DELETE等语句实现数据库中数据的添加、修改、删除；并通过执行SELECT语句实现数据库数据的查询。在PostgreSQL数据库系统中，可以使用数据库开发工具pgAdmin或psql命令行工具执行SQL语句，实现数据库对象及其数据的操作。 存储过程、触发器和游标都可使用PL/pgSQL编程实现的数据处理，按照PL /pgSQL提供的语句和程序结构，实现数据库后端功能编程处理。可以使用数据库开发工具pgAdmin或psql命令行工具执行PL/pgSQL程序，实现数据库后端功能处理。 五、实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 六、实验器材（设备、元器件）：     PC一台，PostgreSQL 11。 七、实验步骤： （1）创建BookSale数据库 （2）创建数据库表 创建Book表储存图书信息 创建Customer表储存顾客信息 创建Seller表储存销售员信息 创建SaleRecord表记录图书销售信息 创建Buyer表储存进货员信息 创建BuyRecord表储存进货记录 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 添加数据 Customer表 Book表 Seller表 SaleRecord表     Buyer表v./ BuyRecord表 删除数据 查找数据  修改数据  （4）编写函数Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  （5）编写过程语句块，实现对函数Pro_CurrentSale的调用，并输出统计结果。  （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 1）创建触发器执行函数  2）创建触发器  （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1、数据库表的创建结果  图1 book表  图2 customer表  图3 seller表  图4 salerecord表  图5 buyer表  图6 buyrecord表 2、数据添加结果 Book表  图7 Book表结果 Customer表  图8 Customer表结果 Seller表  图9 Seller表结果 Buyer表  图10 Buyer表结果 SaleRecord表  图11 SaleRecord表结果 BuyRecord表  图12 BuyRecord表结果 3、删除后的SaleRecord表  图13 删除后的SaleRecord表 4、查找数据结果  图14 查找数据结果 5、修改后SaleRecord表  图15 修改后SaleRecord表 6、创建函数结果  图16 创建函数结果 7、函数执行结果  图17 函数执行结果 8、创建触发器   1）触发器执行函数的创建  图18 触发器执行函数创建结果   2）在SaleRecord表上创建触发器  图19 创建触发器结果 9、对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 添加语句：  添加前Book表  图20 添加前Book表 添加后Book表  图21 添加后Book表 可以看到添加前《平凡世界》库存为152本，添加后库存变为151本，说明触发器功能正确。 九、总结及心得体会：     本次实验我实践了数据库的创建，表的创建，表的增、删、查、改，过程函数函数的创建和触发器的创建，通过实验我对数据库表的操作更熟练了，也解决了过程函数和触发器的创建与执行的问题，对数据库函数有了更深的理解，今后使用过程函数也会越来越熟练。 十、对本实验过程及方法、手段的改进建议：     无                                                      报告评分：                                          指导教师签字：  电子科技大学信息与软件工程学院    实 验 报 告    学    号    2017221105008      姓    名       王亦达          （实验）	课程名称   数据库原理及应用    理论教师        文军           实验教师       何中海              电子科技大学教务处制表    电 子 科 技 大 学 实   验   报   告 学生姓名：王亦达		学号：2017221105008   指导教师：文军 实验地点：信软学院楼西303    实验时间：2017-6-21 一、实验名称：图书销售管理系统数据库安全管理 二、实验学时：3学时 三、实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 四、实验原理： 在PostgreSQL数据库系统中，实现数据存取安全模型是恶报数据库安全访问的基本手段，在数据安全存取模型中，需要设计书看的角色、角色的数据库对象操作权限、数据库用户、数据库用户的角色赋予，以及数据库对象的操作权限集合。根据设计的数据安全存取模型，系统管理员使用数据库管理工具pgAdmin去创建角色，授予系统管理权限和对象操作权限。此外，系统管理员还需要创建用户，并对用户赋予必要的角色，之后，用户就可以对 数据库对象进行访问。 五、实验内容： （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 六、实验器材（设备、元器件）：     PC一台，PostgreSQL 11。 七、实验步骤： （1）创建角色权限表  （2）创建客户（R_Customer）、商家（R_Seller）角色。  （3）为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。  （4）创建客户用户U_Customer、商家用户U_Seller。  （5）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 八、实验结果与分析（含重要数据结果分析或核心代码流程分析） 1、添加角色结果  图1 添加角色结果 2、为角色赋予对象权限执行情况  图2 赋予对象权限 3、创建用户结果  图3 创建用户结果 5、用客户（U_Customer）用户访问验证 （1）对Book的查找 由图4可以看到，客户用户可以对book表进行查找  图4 客户查找book表验证 （2）对Book表的插入 由图5可以看出，客户没有对book表插入的权限   图5 客户插入book表验证 （3）对Customer的查找 由图6可以看出，客户有对Customer表进行查找的权限。  图6 客户查找Customer表验证 （4）对Customer表的插入 由图7可以看出，客户有对Customer表的插入权限。  图7 客户插入Customer表验证 （5）对Customer表的删除 由图8可以看出，客户没有对Customer表的删除权限。  图8 客户删除Customer表验证 （6）对SaleRecord表的查找 由图9可以看出，客户有对SaleRecord表的查找权限。  图9 客户查找SaleRecord表验证 （7）对Buyer表的查找 由图10可以看出，客户没有对Buyer表的查找权限。  图10 客户查找Buyer表验证 （8）对BuyRecord表的查找 由图11可以看出，客户没有对BuyRecord表的查找权限。  图11 客户查找BuyRecord表验证 6、用商家（U_Seller）用户访问验证 （1）对Seller表的查找 由图12可以看出，商家有对Seller表的查找权限。  图12 商家查找Seller表验证 （2）对Seller表的插入 由图13可以看出，商家有对Seller表的插入权限。  图13 商家插入Seller表验证 （3）对Seller表的修改 由图14可以看出，商家有对Seller表的修改权限。  图14 商家修改Seller表验证 （4）对Seller表的删除 由图15可以看出，商家有对Seller表的删除权限。  图15 商家删除Seller表验证 九、总结及心得体会：     通过本次实验我练习了数据库安全管理的方法，学会了创建角色、管理角色权限和用户权限的验证，对数据库安全管理有了更深的认识，也加强了对SQL语言的掌握。 十、对本实验过程及方法、手段的改进建议：     无                                                      报告评分：                                          指导教师签字： 