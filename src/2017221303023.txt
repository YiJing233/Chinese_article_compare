
电 子 科 技 大 学 实   验   报   告  一、实验一：图书销售管理系统数据库SQL应用编程 二、实验室名称：信软楼304					   实验时间：2019.6.3      三、实验目的 针对图书销售管理数据库开发，了解SQL语言DDL、DML、DQL类型语句在数据库操作访问中的应用方法，培养数据库SQL编程访问能力。同时也掌握基本的数据库触发器、存储过程SQL编程方法，培养数据库后端编程能力。本实验完成图书销售管理系统数据库的SQL数据操作访问和后端数据处理功能。 四、实验原理  在一个PostgreSQL数据库中，可以创建多种数据库对象。 创建数据库 在数据库系统中，最大的数据库对象就是数据库本身。SQL提供了数据库对象的创建与维护语句，包括数据库创建、数据库属性修改、数据库删除等。以下分别对这些语句进行说明。 数据库创建SQL语句基本语句格式为 CREATE DATABASE <数据库名>; 创建表   表(Table)是一种用户组织存储数据的数据库对象。在PostgreSQL 数据库中，表首先属于某个schema,而schema又属于某个数据库，其他数据库对象与表对象一样，从而构成了PostgreSQL 数据库的3层逻辑结构。在PostgreSQL数据库中，表对象可以有3种类型:关系表、继承表、外部表。从中可以看出PostgreSQL 数据库作为对象关系数据库与关系数据库不同之处。 创建视图 视图(View)是-种基于虚拟表操作数据的数据库对象。与大多数关系数据库-样,PostgreSQL数据库使用视图用于简化查询逻辑，当然也可使用视图更新基本表中的数据。此外，PostgreSQL数据库还支持物化视图，可通过缓存来实现快速的数据库查询处理。 创建索引 索引是一种针对表 中指定列的值进行排序的数据结构，使用它可以加快表中数据的查询。索引对象创建SQL语句基本语句格式为 CREATE INDEX <索引名> ON <表名>< (列名....1)>; 其中，CREATE INDEX 为创建索引语句的关键词: <索引名>为在指定表中针对某列创建索引的名称。该语句执行后，系统在表中为指定列创建其列值的索引，使索引可实现数据表的快速查询。 数据增、删、查、改SQL操作 INSERT、UPDATE、DELETE 3种语句为核心，分别完成数据的插人、更新与删除处理。 所有数据查询操作都可以通过SELECT语句实现，其基本语句格式为 SELECT [ALL|DISTINCT] <目标列>[,<目标列>…] [INTO <新表> ] FROM <表名>[,<表名>…] [ WHERE <条件表达式> ] [ GROUP BY  <列名> [HAVING <条件表达式>] [ ORDER BY <列名> [ ASG | DESG ] 存储过程及其调用 存储过程是一种数据库的对象，由一组能完成特定功能的 SQL语句集构成。它把经常会被重复使用的SQL语句逻辑块封装起来，经编译后，存储在数据库服务器端。当被再次调用时，不需要再次编通;当客户端连接到数据库时，用户通过指定存储过程的名称并给出参数。数据库就可以找到相应的存储过程并子以调用。 许多数据库为创建存储过程和函数提供不同命令，如Oracle、MySQL、SQL Server等数据库管理系统，使用CREATE PRECEDURE命令创建存储过程，使用CREATE FUNCTION命令创建函数。PostgreSQL 数据库没有为创建存储过程提供专用命令，而是通过创建数据库函数来实现存储过程的功能， 触发器及其应用  触发器( Trigger)是一-种事件触发自动执行数据库访问操作功能程序的数据库对象。PostgreSQL数据库与其他关系数据库一样， 均支持多种类型触发器，如插人触发器、修改触发器、删除触发器，同时还可设置触发级别(语句级、行级)，以及触发时机(修改前触发、修改后触发)。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行SQL编程操作，并完成触发器、存储过程后端编程，具体实验内容如下: （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库SQL应用编程操作，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 创建数据库，名为booksale  2.创建表  3.创建今日销售（today_sale_view）视图  4.创建图书编号索引成功  5.数据操作 5.1.添加数据到表中    5.2删除数据  5.3修改数据  5.4.查找数据  6.编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。  7.实现对存储过程Pro_CurrentSale的调用，并输出统计结果  8.编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 8.1编写存储过程，由于修改仓库对应数量  8.2.编写insert行级触发器，作用于sale表  9.对图书销售表Insert触发器Tri_InsertSale程序进行功能验证  九、总结及心得体会 通过本次实验实现了数据库的基本操作，对表的创建，添加删除以及修改数据。以及基本的视图创建和函数编写。 
 电 子 科 技 大 学 实   验   报   告  一、实验二：图书销售管理系统数据库安全管理 二、实验室名称：信软楼304  					 实验时间：2019.6.14      三、实验目的 了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。  四、实验原理 在数据库存取控制安全模型中，每个数据库对象被定义若干操作访问权限。每个用户可以对应多个角色，每个角色也可对应多个用户。用户、角色均可以被赋予若干数据库对象的操作访问权限。一旦用户通过系统身份认证，DBMS就限制该用户在权限许可的范围内针对特定数据库对象进行访问操作。 用户要 访问数据库。必须先在DBMS中创建用户账号，并成为数据库的用户。此后，用户每次连接访份鉴别，只有合法用户才能进入在PostgreSQL数据库系统中，用户访向访问操作数据库对象。 SQL命令创建 标准SQL提供了专门创建用户的SQL操作命令语句。在数据库中，只能通过特定权限的用户创建其他用户，如系统管理员用户或超级用户可以执行创建用户的SQL操作命令语句，创建其他用户。 创建用户的SQL语句基本格式为CREATE USER <用户账号名> [ [with] option […] ]； 其中，CREATE USER为创建用户语可的关键词: <用户账号名>为将被创建的用户名称，opion为用户的属性选项在PstgrSQL数据库用户创建中，允许有如 option 属性选项。 权限管理 数据库权限管理指DBA或数据库对象拥有者对其所拥有对象进行权限控制设置。权限管理的基本操作包括授予权限、收回权限和拒绝权限。在DBMS中，我们可以通过执行权限控制SQL语句或通过运行数据库管理工具实现用户权限的管理。 执行SQL控制语句进行权限管理 在SQL中，用于权限管理的控制语句有GRANT授权语句、REVOKE收回权限语句和DENY拒绝权限语句。 角色管理 在DBMS中，为了方便对众多用户及其权限进行管理，系统通常将组具有相同权限的用户定义为角色( Role )。不同的角色就代表不同权限集合的用户集合。 进行角色管理的好处是系统管理员只需对具有不同权限的用户类别进行划分，并将其定义为不同角色，不同角色授予不同的权限，而不必关心具体有多少用户。当角色中的成员发生变化时，如新增用户或删除用户，系统管理员都无须做任何关于权限的操作。 在DBMS中，角色分为预定义的系统角色和用户定义角色两种。 在DBMS中，角色管理是对用户自定义角色进行操作管理，包括角色创建、角色修改、角色删除。  五、实验内容 使用pgAdmin4数据库管理工具对图书销售管理系统数据库进行数据库安全管理，具体实验内容如下: （1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 在实验计算机上，利用pgAdmin4数据库管理工具及SQL语句，完成图书销售管理系统数据库安全管理，同时记录实验过程的步骤、操作、运行结果界面等数据，为撰写实验报告提供素材。 六、实验设备及环境 “数据库原理及应用”实验所涉及的机房硬件设备为pc计算机、服务器以及网络环境，pc计算机与服务器在同一局域网络。 操作系统： Windows7 / Windows XP 管理工具： pgAdmin4 DBMS系统： PostgreSQL 11 七、实验步骤 （1）针对图书销售管理系统数据库，设计数据存取权限控制模型 数据库有客户、商家两类角色，分别为其赋予对数据库对象的不同权限 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 实验数据及结果分析 对图书销售管理系统数据库，使用powerdesigner设计数据存取权限控制模型。   创建客户（R_Customer）、商家（R_Seller）角色  为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限  创建客户用户U_Customer、商家用户U_Seller且为其分派客户（R_Customer）、商家（R_Seller）角色  分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性  九、总结及心得体会 通过本次实验了解了数据库中用户的创建以及相关权限的分配，实现了数据库的安全机制。创建用户时权限的分配至关重要，若分配不当会造成严重后果。