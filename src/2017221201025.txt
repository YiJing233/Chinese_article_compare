电子科技大学信息与软件工程学院    实 验 报 告    学    号      2017221201025        姓    名         税文俐           （实验）	课程名称     数据库原理及应用       理论教师          陆鑫            实验教师         何中海                   电 子 科 技 大 学 实   验   报   告 学生姓名：税文俐		学号：2017221201025      指导教师：何中海   实验地点：信软楼西303                      实验时间：2019.6. 14 实验名称：图书销售管理系统数据库SQL应用编程 实验学时：4 实验目的： 针对图书借阅管理数据库开发，掌握DDL、DML、DQL类型SQL语句在数据库操作访问中的应用方法，培养数据库SQL应用编程能力。同时也掌握基本的数据库触发器、存储过程编程方法，培养数据库后端编程能力。本实验还需要培养数据库SQL应用编程的复杂工程问题解决能力。。 实验原理： 首先对图书销售管理系统进行数据需求分析,定义组成系统数据结构的实体、实体属性以及实体之间的关系。通过建模设计工具完成系统概念数据模型设计。进一步对图书销售管理数据库进行物理模型设计,给出数据库设计方案 基于数据库设计方案,通过SL编程执行来完成对数据库的实现操作。在本实验中,使用SL语句完成对数据库、关系表、索引、视图、触发器、存储过程的创建,并编写SL语句对数据库表进行数据的增删查改操作,以及利用视图存储过程、触发器实现业务数据处理 实验内容： （1）图书销售管理系统数据库BookSale创建操作 （2）在图书销售管理系统数据库BookSale中创建数据库表、视图、索引等对象 （3）对图书销售管理系统数据库表进行数据增、删、查、改SQL操作 （4）编写存储过程Pro_CurrentSale，实现当日图书销售量及销售金额汇总统计。 （5）编写过程语句块，实现对存储过程Pro_CurrentSale的调用，并输出统计结果。 （6）编写图书销售表Insert触发器Tri_InsertSale，实现图书库存数据同步修改处理。 （7）对图书销售表Insert触发器Tri_InsertSale程序进行功能验证。 实验器材（设备、元器件）：实验PC计算机、PostgreSQL 11 实验步骤：  在数据库服务器中,采用SQL语句执行方式,创建图书销售管理系统数据库 BookSale 在 BookSale数据库中,采用SQL语句执行方式,创建表Book、Purchase、Sell、Supplier,以及各表主键外键的创建。 为Book表创建索引 为Book、Purchase、Sell、Supplier、Stock表准备样本数据,采用SQL语句执行方式,将样本数据插入到表中。 采用SQL语句对Book、Purchase、Sell、Supplier、Stock表进行数据修改、删除、查询、统计等访问操作 创建视图BookOfRenWenShe，StoryBook对视图进行数据查询访问操作 编写存储过程函数,实现统计某日图书的销售总量以及总金额数据 调用存储过程函数,查看输出结果是否准确实现业务数据处理功能。 编写触发器函数,实现在sale表数据插入时,级联操作 stock表,将图书的库存流水进行记录,同时级联更新book表中对应图书的库存数据 创建完触发器函数之后,创建相对应的触发器,实现上一步中提到的功能 测试触发器的功能,准备sale表的样本数据,并将其插入sale表,插入之后查看 stock表是否有对应的更新,并对比插入sale数据前后book中对应数据的修改情况 实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.创建BookSale数据库 SQL语句如下：   创建结果： 2.创建各数据库表以及表中的主外键 创建结果： 3.创建以图书名称来索引图书表  4.为各表插入样本数据 （1）Book表： 插入结果： （2）Supplier表   结果： （3）Sell表  （4）purchase表 5.增删查改操作 （1）更新Book数据  （2）更新Supplier表    （3）查找文学类书籍  （4）删除《那不勒斯四部曲》这本书 已经没有这本书了 6.创建视图 （1）创建人文社书籍的视图  （2）创建小说类书籍的视图  7. 编写存储过程Pro_CurrentSale   8. 编写过程语句块，实现对存储过程Pro_CurrentSale的调用  9.创建触发器函数InsertSale()  10.创建触发器Tri_InsertSale  11.对触发器进行测试 （1）Book表原始数据  （2）对Sell表进行更新  （3）查看Stock表 可知：有出库数据 （4）查看Book表 可知：Book表数据更新 总结及心得体会： 在编写触发器的时候，要先建立存储数据的表，在编写触发器函数，然后才是建立触发器。当对表进行数据更新后，即是调用了触发器。 数据库设计时，要考虑清楚该数据库要实现的功能，从而设计相应地表。 对本实验过程及方法、手段的改进建议： 在编写SQL语句之前，应该先进行构思，设计好数据库才开始动手。避免之后花过多时间进行修改 对表的外主键的设定有多种方式，要灵活运用 
 电 子 科 技 大 学 实   验   报   告 学生姓名：税文俐		学号：2017221201025      指导教师：何中海   实验地点：信软楼西303                      实验时间：2019.6. 21 实验名称：图书销售管理系统数据库安全管理 实验学时：3 实验目的： 对图书销售管理系统数据库进行系统安全管理。了解该DBMS系统对数据库管理的内容与方法，特别是理解数据库安全机制和作用，以及PostgreSQL数据库角色管理、用户管理、权限管理的基本方法，培养数据库管理能力。在图书销售管理系统数据库中，创建必要的角色和用户，并完成上述角色与用户的权限管理。 实验原理： 设计数据存取权限控制模型,对各角色进行不同权限的赋予,保证数据库数据的安全性。 使用SQL语句进行角色、用户的创建、对角色进行权限赋予、对用户分派角色 使用不同的用户登录时,就拥有了该用户的权限,在对数据库表进行操作的时候就会受到不同程度的制约 实验内容： （（1）针对图书销售管理系统数据库，设计数据存取权限控制模型。 （2）在数据库中，创建客户（R_Customer）、商家（R_Seller）角色。 （3）在数据库中，根据业务规则为客户（R_Customer）、商家（R_Seller）角色赋予数据库对象权限。 （4）在数据库中，分别创建客户用户U_Customer、商家用户U_Seller。 （5）分别为客户用户U_Customer、商家用户U_Seller分派客户（R_Client）、商家（R_Seller）角色。 （6）分别以客户用户U_Customer、商家用户U_Seller身份访问图书销售管理数据库，验证所实现数据存取权限控制模型的正确性。 实验器材（设备、元器件）：实验PC计算机、PostgreSQL 11 实验步骤：  1.针对图书销售管理系统,在设计数据存取权限控制模型 2.在 pgadmin4中的 Booksale数据库中,使用SQL语句创建客户( R_Customer)角色、商家( R_Seller)角色 3.在 pgadmin4中,根据第一步设计的数据存取权限控制模型对客户( R_Customer)角色、商家( R_Seller)角色赋予所定义的数据库对象权限。 4.在 pgadmin4中,分别创建客户用户 U_Customer、商家用户 U_Seller,并为客户用户分配客户角色,为商家用户分配商家角色 5.分别以客户用户 U_Customer、商家用户 U_Seller身份访问图书销售管理数据库,并分别以这两个用户对各数据库表进行操作,以验证是否正确分配了两用户不同的角色权限。 实验结果与分析（含重要数据结果分析或核心代码流程分析） 1.针对图书销售管理系统,在设计数据存取权限控制模型 2.创建客户和商家角  3.赋予客户、商家权限  4. 创建客户用户和商家用户,并将客户角色和商家角色赋予他们        5.分别以客户、商家用户登录，验证权限是否赋予成功 （1）以客户用户登录 （2）能查看Book表数据 （3）不能删除Book表中数据  （4）无法查看Purchase表 （5）以商家用户登录 （6）可以查看Purchase表 （7）可以删除Book表数据 （8）删除结果  总结及心得体会： 根据功能设想谁会使用该数据库，在进行角色的设计和拥有的权限。 设计时考虑系统的安全需要。 对本实验过程及方法、手段的改进建议： 对角色的功能需要要思考全面